---
title: アナライザー ルールの重要度および非表示
ms.date: 03/26/2019
ms.topic: conceptual
helpviewer_keywords:
- code analysis, managed code
- analyzers
- Roslyn analyzers
author: gewarren
ms.author: gewarren
manager: jillfra
ms.workload:
- dotnet
ms.openlocfilehash: d4b5ad6ca824e6c7091c6c508b51c2d51501b2fd
ms.sourcegitcommit: 75807551ea14c5a37aa07dd93a170b02fc67bc8c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/11/2019
ms.locfileid: "67821525"
---
# <a name="use-roslyn-analyzers"></a>Roslyn アナライザーを使用して、

.NET コンパイラ プラットフォーム ("Roslyn") アナライザー ルール、または*診断*、入力すると、c# または Visual Basic のコードを分析します。 各診断が、プロジェクトを上書きできる既定の重大度と抑制状態です。 この記事では、設定ルールの重要度、規則のセットを使用して、違反を抑制するについて説明します。

## <a name="analyzers-in-solution-explorer"></a>ソリューション エクスプ ローラーでアナライザー

アナライザーの診断からのカスタマイズの大部分を行うことができます**ソリューション エクスプ ローラー**します。 場合する[アナライザーをインストール](../code-quality/install-roslyn-analyzers.md)、NuGet パッケージとして、**アナライザー**ノードが表示されます、**参照**または**依存関係**内のノード**ソリューション エクスプ ローラー**します。 展開する場合**アナライザー**、および 1 つのアナライザーのアセンブリを展開し、アセンブリ内のすべての診断情報を参照してください。

![ソリューション エクスプ ローラー ノード アナライザー](media/analyzers-expanded-in-solution-explorer.png)

説明、既定の重要度を含む、診断のプロパティを表示することができます、**プロパティ**ウィンドウ。 ルールを選択します右クリックし、プロパティを表示する**プロパティ**、または規則を選択し、キーを押します**Alt**+**Enter**。

![診断のプロパティの [プロパティ] ウィンドウ](media/analyzer-diagnostic-properties.png)

診断のオンライン ドキュメントを参照してください、診断で右クリックし、選択**ヘルプの表示**します。

各診断での横にあるアイコン**ソリューション エクスプ ローラー**規則セット エディターで開くと表示のアイコンに対応しています。

- 円の中の"i"を示す、[重大度](#rule-severity)の**情報**
- "!"三角形の中を示す、[重大度](#rule-severity)の**警告**
- 円の中の"x"を示す、[重大度](#rule-severity)の**エラー**
- 明るい色の背景上にある円の"i"を示す、[重大度](#rule-severity)の**非表示**
- 円で下向きの矢印は、診断が中止になっていることを示します

![ソリューション エクスプ ローラーで診断アイコン](media/diagnostics-icons-solution-explorer.png)

## <a name="rule-sets"></a>規則セット

A[ルール セット](../code-quality/using-rule-sets-to-group-code-analysis-rules.md)は個々 の診断の重大度と抑制の状態を格納する XML ファイルです。

> [!NOTE]
> 規則セットは、(バイナリ) の静的コード分析と Roslyn アナライザーの両方からの規則を含めることができます。

規則セット エディターで設定するアクティブなルールを編集するを右クリックし、**参照** > **アナライザー**ノード**ソリューション エクスプ ローラー** を選択します **。アクティブなルール セットを開く**します。 Visual Studio がファイルの設定、既定の規則のコピーを作成、名前を初めて規則セットを編集している場合は、  *\<projectname > .ruleset*プロジェクトに追加します。 このカスタムの規則も設定では、プロジェクトのアクティブなルールになります。

プロジェクトの設定のアクティブなルールを変更するに移動、**コード分析**のプロジェクトのプロパティ タブ。 規則セットの下の一覧からを選択**この規則セットを実行**します。 規則セットを開くには、次のように選択します。**開く**します。

> [!NOTE]
> 規則のセットの .NET core と .NET Standard プロジェクトがメニュー コマンドをサポートして**ソリューション エクスプ ローラー**、たとえば、**オープンのアクティブなルール セット**します。 既定以外の規則が .NET Core または .NET Standard プロジェクトでは、手動で設定を指定する[追加、 **CodeAnalysisRuleSet**プロパティ](using-rule-sets-to-group-code-analysis-rules.md#specify-a-rule-set-for-a-project)プロジェクト ファイル。 Visual Studio で設定するルールをルール セット エディター UI 内のルールも構成できます。

## <a name="rule-severity"></a>ルールの重要度

アナライザーの規則の重要度を構成するまたは*診断*場合は、する[、アナライザーをインストール](../code-quality/install-roslyn-analyzers.md)NuGet パッケージとして。 次の表では、診断の重大度のオプションを示します。

|重要度|ビルド時の動作|エディターの動作|
|-|-|-|
|Error|として違反が表示される*エラー*で、**エラー一覧**とコマンド ラインで問題により、ビルドが失敗して、出力をビルドします。|問題のコードは、波線、およびスクロール バーの小さな赤いボックスでマークされている赤色の下線が付きます。|
|警告|違反として表示*警告*で、**エラー一覧**とコマンドラインでビルド出力しますが、ビルド失敗が発生しません。|問題のコードは、緑の波線、およびスクロール バーの小さな緑色のボックスで下線付きです。|
|Info|違反の表示として*メッセージ*で、**エラー一覧**とコマンド ライン ビルドの出力ではまったくありません。|問題のコードは、波線、およびスクロール バーの小さな灰色のボックスでマークされているグレーの下線が付きます。|
|非表示|非表示をユーザーにします。|非表示をユーザーにします。 診断は、ただし、IDE の診断エンジンに報告されます。|
|なし|完全に抑制します。|完全に抑制します。|

さらに、「リセットできます」ルールの重大度設定することで**既定**します。 各診断が既定の重要度でわかるように、**プロパティ**ウィンドウ。

次のスクリーン ショットは、次の 3 つの異なる重大度レベルのコード エディターで次の 3 つの異なる診断違反を示します。 波線、だけでなく、右にスクロール バーの小さなボックスの色に注意してください。

![コード エディターでのエラー、警告、および情報の違反](media/diagnostics-severity-colors.png)

次のスクリーン ショットに示すように同じ 3 つの違反を示しています、**エラー一覧**:

![エラー一覧 に、エラー、警告、および情報の違反](media/diagnostics-severities-in-error-list.png)

取得したルールの重大度を変更する**ソリューション エクスプ ローラー**、内、または、  *\<projectname > .ruleset* でルールの重大度を変更した後、ソリューションに追加されるファイル**ソリューション エクスプ ローラー**します。

![ソリューション エクスプ ローラーで、規則セット ファイル](media/ruleset-in-solution-explorer.png)

### <a name="set-rule-severity-from-solution-explorer"></a>ソリューション エクスプ ローラーからのルールの重要度の設定

1. **ソリューション エクスプ ローラー**、展開**参照** > **アナライザー** (**依存関係** >  **アナライザー** .NET Core プロジェクトの場合)。

1. 重要度を設定する規則を含むアセンブリを展開します。

1. クリックし、ルールを右クリックして**設定ルール セットの重要度**します。 スライド アウト メニューには、重大度オプションのいずれかを選択します。

   ルールの重大度は、アクティブなルール セット ファイルに保存されます。

### <a name="set-rule-severity-in-the-rule-set-file"></a>規則セット ファイル内のルールの重要度の設定

1. 開く、[ルール セット](analyzer-rule-sets.md)ファイルをダブルクリックして**ソリューション エクスプ ローラー**選択**オープンのアクティブなルール セット**の右クリック メニューで、**アナライザー**ノード、または選択して**オープン**上、**コード分析**プロジェクトのプロパティ ページ。

1. 含んでいるアセンブリを展開して、ルールを参照します。

1. **アクション**列が、ドロップダウン リストを開く値を選択し、一覧から目的の重大度を選択します。

   ![規則セット ファイルがエディターで開く](media/ruleset-file-in-editor.png)

## <a name="suppress-violations"></a>違反を抑制します。

規則違反を抑制する複数の方法はあります。

- **分析**メニュー

  選択**分析** > **コード分析を実行し、アクティブな懸案事項の抑制**メニューバーの現在のすべての違反を抑制します。 これは、「基準」と呼ばれます。

- **ソリューション エクスプ ローラー**

  違反を抑制して**ソリューション エクスプ ローラー**、ルールの重大度を設定**None**します。

- **ルール セット エディター**

  規則セット エディターからの違反を抑制するのにその名前の横にあるボックスをオフにします。 または設定**アクション**に**None**します。

- **コード エディター**

  コード エディターからの違反を抑制するのには、違反とキーを押してコードの行にカーソルを置き**Ctrl**+**します。** 開く、**クイック アクション**メニュー。 選択**CAXXXX を抑制する** >  **/抑制ファイル内でソース**します。

  ![クイック アクション メニューから診断を抑制します。](media/suppress-diagnostic-from-editor.png)

- **エラー一覧**

  1 つまたは複数の診断を抑制することができます、**エラー一覧**を抑制するたいものを選択し、右クリックし、選択して**抑制** > **で Source/In抑制ファイル**します。

  - 表示されないようにする場合**でソース**、**変更のプレビュー**ダイアログが開きのプレビューを表示、 C# [#pragma warning](/dotnet/csharp/language-reference/preprocessor-directives/preprocessor-pragma-warning)または Visual Basic [#Disable警告](/dotnet/visual-basic/language-reference/directives/directives)ソース コードに追加されるディレクティブ。

    ![#Pragma 警告を追加するコード ファイルのプレビュー](media/pragma-warning-preview.png)

  - 選択した場合**抑制ファイル内**、**変更のプレビュー**ダイアログが開きのプレビューを表示、<xref:System.Diagnostics.CodeAnalysis.SuppressMessageAttribute>グローバル抑制ファイルに追加される属性。

    ![SuppressMessage 属性を抑制ファイルに追加のプレビュー](media/preview-changes-in-suppression-file.png)

  **変更のプレビュー**ダイアログ ボックスで、**適用**します。

  > [!NOTE]
  > 表示されない場合、**抑制**メニュー オプション**ソリューション エクスプ ローラー**違反がビルドおよびいないライブ分析から送信される可能性があります。 **エラー一覧**診断、または両方からの違反、ライブ コード分析およびビルド規則が表示されます。 ビルドの診断は、古くなっていることができます、ためなど、違反を修正するコードを編集しましたが、再構築していない場合は抑制できませんからこれらの診断、**エラー一覧**します。 ライブ分析、または IntelliSense からの診断は、現在のソースの最新の状態は常とから抑制することができます、**エラー一覧**します。 除外する*ビルド*から選択すると、診断の切り替え、**エラー一覧**からソース フィルター**ビルド + IntelliSense**に**Intellisenseのみ**. 次に、抑制して、前述のように続行する診断を選択します。
  >
  > ![Visual Studio でのエラー一覧のソース フィルター](media/error-list-filter.png)

## <a name="command-line-usage"></a>コマンドラインの使用状況

コマンドラインでプロジェクトをビルドする、次の条件が満たされた場合に、規則違反がビルド出力に表示されます。

- アナライザーは、VSIX 拡張機能ではなく、Nuget パッケージとしてインストールされます。

- プロジェクトのコードでは、1 つまたは複数の規則が違反しました。

- [重大度](#rule-severity)違反した規則に設定されている**警告**、ビルドが失敗するを違反が発生しない場合または**エラー**違反がビルドの失敗がどのように発生する場合。

ビルド出力の詳細度では、規則違反を示すかどうかには影響しません。 使用しても**quiet**詳細度、規則違反は、ビルド出力に表示されます。

> [!TIP]
> いずれかでコマンドラインからの静的コード分析を実行するのに慣れている場合*FxCopCmd.exe*または msbuild を使用、 **RunCodeAnalysis**フラグは、Roslyn アナライザーの実行をする方法を次に示します。

Msbuild を使用してプロジェクトをビルドするときに、コマンドラインでアナライザーの違反を参照してくださいするには、このようなコマンドを実行します。

```cmd
msbuild myproject.csproj /target:rebuild /verbosity:minimal
```

次の図は、アナライザーの規則違反を含むプロジェクトをビルドしてからコマンド ライン ビルドの出力を示しています。

![ルール違反を示す MSBuild 出力](media/command-line-build-analyzers.png)

## <a name="dependent-projects"></a>依存プロジェクト

.NET Core プロジェクトで NuGet のアナライザーを含むプロジェクトへの参照を追加する場合これらのアナライザーは自動的に追加、依存プロジェクトすぎます。 例では、依存プロジェクトが、単体テスト プロジェクトの場合、この動作を無効にする NuGet パッケージではプライベートとしてマークを付ける、 *.csproj*または *.vbproj* を設定して、参照先プロジェクトのファイル**PrivateAssets**属性。

```xml
<PackageReference Include="Microsoft.CodeAnalysis.FxCopAnalyzers" Version="2.9.0" PrivateAssets="all" />
```

## <a name="see-also"></a>関連項目

- [Visual Studio で Roslyn アナライザーの概要](../code-quality/roslyn-analyzers-overview.md)
- [Roslyn アナライザーのバグを送信します。](https://github.com/dotnet/roslyn-analyzers/issues)
- [ルール セットの使用](../code-quality/using-rule-sets-to-group-code-analysis-rules.md)
- [コード分析の警告を抑制します。](../code-quality/in-source-suppression-overview.md)
