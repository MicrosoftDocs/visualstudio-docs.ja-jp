---
title: 使用して、Visual Studio で Roslyn アナライザーを構成
ms.date: 03/26/2018
ms.prod: visual-studio-dev15
ms.technology: vs-ide-code-analysis
ms.topic: conceptual
helpviewer_keywords:
- code analysis, managed code
- analyzers
- Roslyn analyzers
author: gewarren
ms.author: gewarren
manager: douge
ms.workload:
- dotnet
ms.openlocfilehash: 6668b3727e5df17c3d436e37f2edd78a67a79eba
ms.sourcegitcommit: 36835f1b3ec004829d6aedf01938494465587436
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/23/2018
ms.locfileid: "39204155"
---
# <a name="configure-and-use-roslyn-analyzer-rules"></a>構成し、Roslyn アナライザーの規則を使用

.NET コンパイラ プラットフォーム ("Roslyn") アナライザー ルール、または*診断*、入力すると、c# または Visual Basic のコードを分析します。 各診断が、プロジェクトを上書きできる既定の重大度と抑制状態です。 この記事では、設定ルールの重要度、規則のセットを使用して、違反を抑制するについて説明します。

## <a name="analyzers-in-solution-explorer"></a>ソリューション エクスプ ローラーでアナライザー

アナライザーの診断からのカスタマイズの大部分を行うことができます**ソリューション エクスプ ローラー**します。 場合する[アナライザーをインストール](../code-quality/install-roslyn-analyzers.md)、NuGet パッケージとして、**アナライザー**ノードが表示されます、**参照**または**依存関係**内のノード**ソリューション エクスプ ローラー**します。 展開する場合**アナライザー**、および 1 つのアナライザーのアセンブリを展開し、アセンブリ内のすべての診断情報を参照してください。

![ソリューション エクスプ ローラー ノード アナライザー](media/analyzers-expanded-in-solution-explorer.png)

説明、既定の重要度を含む、診断のプロパティを表示することができます、**プロパティ**ウィンドウ。 ルールを選択します右クリックし、プロパティを表示する**プロパティ**、または規則を選択し、キーを押します**Alt**+**Enter**。

![診断のプロパティの [プロパティ] ウィンドウ](media/analyzer-diagnostic-properties.png)

診断のオンライン ドキュメントを参照してください、診断で右クリックし、選択**ヘルプの表示**します。

各診断での横にあるアイコン**ソリューション エクスプ ローラー**規則セット エディターで開くと表示のアイコンに対応しています。

- 円の中の"i"を示す、[重大度](#rule-severity)の**情報**
- "!"三角形の中を示す、[重大度](#rule-severity)の**警告**
- 円の中の"x"を示す、[重大度](#rule-severity)の**エラー**
- 明るい色の背景上にある円の"i"を示す、[重大度](#rule-severity)の**非表示**
- 円で下向きの矢印は、診断が中止になっていることを示します

![ソリューション エクスプ ローラーで診断アイコン](media/diagnostics-icons-solution-explorer.png)

## <a name="rule-sets"></a>規則セット

A[ルール セット](../code-quality/using-rule-sets-to-group-code-analysis-rules.md)は個々 の診断の重大度と抑制の状態を格納する XML ファイルです。 規則セットが 1 つのプロジェクトに適用され、プロジェクトは、複数の規則セットを持つことができます。 右クリックし、エディターで設定するアクティブなルールを表示する、**アナライザー**内のノード**ソリューション エクスプ ローラー**選択**オープンのアクティブなルール セット**します。 場合は、ルールにアクセスする最初の時間設定、という名前のファイル *\<projectname > .ruleset*がプロジェクトに追加されに表示されます**ソリューション エクスプ ローラー**します。

> [!NOTE]
> 規則セットには、(バイナリ) の静的コード分析と Roslyn アナライザーの規則の両方が含まれます。

プロジェクトの [アクティブなルールを変更することができます、**コード分析**のプロジェクトのプロパティ] タブ。 規則セットを選択して、**この規則セットを実行**ドロップダウン リスト。 規則セットから開くこともできます、**コード分析**プロパティ ページを選択して**開く**します。

## <a name="rule-severity"></a>ルールの重要度

アナライザーの規則の重要度を構成するまたは*診断*場合は、する[、アナライザーをインストール](../code-quality/install-roslyn-analyzers.md)NuGet パッケージとして。 次の表では、診断の重大度のオプションを示します。

|重要度|ビルド時の動作|エディターの動作|
|-|-|-|
|Error|として違反が表示される*エラー*で、**エラー一覧**とコマンド ラインで問題により、ビルドが失敗して、出力をビルドします。|問題のコードは、波線、およびスクロール バーの小さな赤いボックスでマークされている赤色の下線が付きます。|
|警告|違反として表示*警告*で、**エラー一覧**とコマンドラインでビルド出力しますが、ビルド失敗が発生しません。|問題のコードは、緑の波線、およびスクロール バーの小さな緑色のボックスで下線付きです。|
|Info|違反の表示として*メッセージ*で、**エラー一覧**とコマンド ライン ビルドの出力ではまったくありません。|問題のコードは、波線、およびスクロール バーの小さな灰色のボックスでマークされているグレーの下線が付きます。|
|非表示|非表示をユーザーにします。|非表示をユーザーにします。 診断は、ただし、IDE の診断エンジンに報告されます。|
|なし|完全に抑制します。|完全に抑制します。|

さらに、「リセットできます」ルールの重大度設定することで**既定**します。 各診断が既定の重要度でわかるように、**プロパティ**ウィンドウ。

次のスクリーン ショットは、次の 3 つの異なる重大度レベルのコード エディターで次の 3 つの異なる診断違反を示します。 波線、だけでなく、右にスクロール バーの小さなボックスの色に注意してください。

![コード エディターでのエラー、警告、および情報の違反](media/diagnostics-severity-colors.png)

次のスクリーン ショットに示すように同じ 3 つの違反を示しています、**エラー一覧**:

![エラー一覧 に、エラー、警告、および情報の違反](media/diagnostics-severities-in-error-list.png)

取得したルールの重大度を変更する**ソリューション エクスプ ローラー**、内、または、  *\<projectname > .ruleset* でルールの重大度を変更した後、ソリューションに追加されるファイル**ソリューション エクスプ ローラー**します。

![ソリューション エクスプ ローラーで、規則セット ファイル](media/ruleset-in-solution-explorer.png)

### <a name="to-set-rule-severity-from-solution-explorer"></a>ソリューション エクスプ ローラーから規則の重要度を設定するには

1. **ソリューション エクスプ ローラー**、展開**参照** > **アナライザー** (**依存関係** >  **アナライザー** .NET Core プロジェクトの場合)。

1. 重要度を設定する規則を含むアセンブリを展開します。

1. クリックし、ルールを右クリックして**設定ルール セットの重要度**します。 スライド アウト メニューには、重大度オプションのいずれかを選択します。

   ルールの重大度は、アクティブなルール セット ファイルに保存されます。

### <a name="to-set-rule-severity-in-the-rule-set-file"></a>ルールの重大度がファイルを設定する規則を設定するには

1. 開いている規則セット ファイルをダブルクリックして**ソリューション エクスプ ローラー**選択**オープンのアクティブなルール セット**の右クリック メニューで、**アナライザー**ノード、または選択して**オープン**上、**コード分析**プロジェクトのプロパティ ページ。

1. 含んでいるアセンブリを展開して、ルールを参照します。

1. **アクション**列が、ドロップダウン リストを開く値を選択し、一覧から目的の重大度を選択します。

   ![規則セット ファイルがエディターで開く](media/ruleset-file-in-editor.png)

## <a name="suppress-violations"></a>違反を抑制します。

規則違反を抑制する複数の方法はあります。

- 現在のすべての違反を抑制するのには、選択**分析** > **コード分析を実行し、アクティブな懸案事項の抑制**メニュー バーでします。 これは、「基準」と呼ばれます。

- 診断を抑制する**ソリューション エクスプ ローラー**、その重要度を設定**None**します。

- 規則セット エディターから診断を抑制するのに、名前の横にあるボックスをオフにしますか、設定**アクション**に**None**します。

- コード エディターから診断を抑制するのには、違反とキーを押してコードの行にカーソルを置き**Ctrl**+**します。** 開く、**クイック アクション**メニュー。 選択**CAxxxx を抑制する** > **ソース**または**CAxxxx を抑制する** > **抑制ファイル内**します。

   ![クイック アクション メニューから診断を抑制します。](media/suppress-diagnostic-from-editor.png)

- 診断を抑制する、**エラー一覧**を参照してください[違反エラーの一覧からを抑制する](#suppress-violations-from-the-error-list)します。

### <a name="suppress-violations-from-the-error-list"></a>エラーの一覧からの違反を抑制します。

1 つまたは複数の診断を抑制することができます、**エラー一覧**を抑制するたいものを選択し、右クリックし、選択して**抑制** > **でソース**または**抑制** > **抑制ファイル内**します。

   - 選択した場合**でソース**、**変更のプレビュー**ダイアログが開き、c# のプレビューを示します[#pragma warning](/dotnet/csharp/language-reference/preprocessor-directives/preprocessor-pragma-warning)または Visual Basic [#Disable warning](/dotnet/visual-basic/language-reference/directives/directives)ソース コードに追加されるディレクティブ。

      ![#Pragma 警告を追加するコード ファイルのプレビュー](media/pragma-warning-preview.png)

   - 選択した場合**抑制ファイル内**、**変更のプレビュー**ダイアログが開きのプレビューを表示、<xref:System.Diagnostics.CodeAnalysis.SuppressMessageAttribute>グローバル抑制ファイルに追加される属性。

      ![SuppressMessage 属性を抑制ファイルに追加のプレビュー](media/preview-changes-in-suppression-file.png)

   **変更のプレビュー**ダイアログ ボックスで、**適用**します。

**エラー一覧**診断、または両方からの違反、ライブ コード分析およびビルド規則が表示されます。 ビルドの診断は、古くなっていることができます、ためなど、違反を修正するコードを編集しましたが、再構築していない場合は抑制できませんからこれらの診断、**エラー一覧**します。 ただし、ライブ分析、または IntelliSense からの診断の現在のソースの最新の状態は常から抑制することができます、**エラー一覧**します。 抑制のオプションは、右クリックして、または、コンテキスト メニューで無効になっている、いずれかが必要以上のビルド、選択した診断があること可能性があります。 選択項目から、ビルドの診断を除外するには、スイッチ、**エラー一覧**からソース フィルター**ビルド + IntelliSense**に**Intellisense のみ**します。 次に、抑制して、前述のように続行する診断を選択します。

![Visual Studio でのエラー一覧のソース フィルター](media/error-list-filter.png)

> [!NOTE]
> .NET Core プロジェクトで NuGet のアナライザーを含むプロジェクトへの参照を追加する場合これらのアナライザーは自動的に追加、依存プロジェクトすぎます。 例では、依存プロジェクトが、単体テスト プロジェクトの場合、この動作を無効にする NuGet パッケージではプライベートとしてマークを付ける、 *.csproj*または *.vbproj*参照先プロジェクトのファイル。
>
> ```xml
> <PackageReference Include="Microsoft.CodeAnalysis.FxCopAnalyzers" Version="2.6.0" PrivateAssets="all" />
> ```

## <a name="see-also"></a>関連項目

- [Visual Studio で Roslyn アナライザーの概要](../code-quality/roslyn-analyzers-overview.md)
- [Roslyn アナライザーのバグを送信します。](https://github.com/dotnet/roslyn-analyzers/issues)
- [ルール セットの使用](../code-quality/using-rule-sets-to-group-code-analysis-rules.md)
- [コード分析の警告を抑制します。](../code-quality/in-source-suppression-overview.md)