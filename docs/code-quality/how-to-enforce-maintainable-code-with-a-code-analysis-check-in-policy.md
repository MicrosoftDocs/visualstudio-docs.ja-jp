---
title: "方法: コード分析のチェックイン ポリシーを使用して保守が容易なコードを適用する | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-general"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "コード分析、チェックイン ポリシー"
ms.assetid: d1b3b04f-4dd9-40e6-b2d4-b414d33fb647
caps.latest.revision: 8
author: "stevehoag"
ms.author: "shoag"
manager: "wpickett"
caps.handback.revision: 8
---
# 方法: コード分析のチェックイン ポリシーを使用して保守が容易なコードを適用する
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

開発者はコード メトリックス ツールを使用して、コードの複雑さと保守容易性を測定することができますが、コード メトリックスはチェックイン ポリシーの一部として呼び出すことはできません。  しかし、コードがコード メトリックスの基準に準拠しているかどうかを検証するコード分析規則を有効にし、チェックイン ポリシーによって規則を適用することができます。  コード メトリックスの詳細については、「[コード メトリックス値](../code-quality/code-metrics-values.md)」を参照してください。  
  
 コード分析のチェックイン ポリシーを使用して保守が容易なコードを適用するために、開発者は継承の深さ、クラス結合度、保守容易性指数、複雑度の各規則を有効にできます。  これら 4 つの規則はすべて、コード分析ポリシー エディターの \[保守容易性の規則\] カテゴリの下にあります。  
  
 [!INCLUDE[esprfound](../code-quality/includes/esprfound_md.md)] のバージョン コントロールの管理者は、チェックイン ポリシー要件にコード分析の保守容易性の規則を追加することができます。  これらのチェックイン ポリシーでは、開発者はチェックインを開始する前に、これらの規則の変更に基づいてコード分析を実行するように要求されます。  
  
### コード分析ポリシー エディターを開くには  
  
1.  **チーム エクスプローラー**で、チーム プロジェクトを右クリックし、**\[チーム プロジェクトの設定\]** をクリックして、**\[ソース管理\]** をクリックします。  
  
     **\[ソース管理\]** ダイアログ ボックスが表示されます。  
  
2.  **\[チェックイン ポリシー\]** タブで、**\[追加\]** をクリックします。  
  
     **\[チェックイン ポリシーの追加\]** ダイアログ ボックスが表示されます。  
  
3.  **\[チェックイン ポリシー\]** の一覧で、**\[コード分析\]** チェック ボックスをオンにし、**\[OK\]** をクリックします。  
  
     **\[コード分析ポリシー エディター\]** ダイアログ ボックスが表示されます。  
  
### コード分析の保守容易性の規則を有効にするには  
  
1.  **\[コード分析ポリシー エディター\]** ダイアログ ボックスの **\[規則の設定\]** で、**\[保守容易性の規則\]** ノードを展開します。  
  
2.  次の規則のチェック ボックスをオンにします。  
  
    -   継承の深さ: **CA1501 AvoidExcessiveInheritance** \- しきい値: 深さ 5 レベル以上で警告  
  
    -   複雑度: **CA1502 AvoidExcessiveComplexity** \- しきい値: 25 以上で警告  
  
    -   保守容易性指数: **CA1505 AvoidUnmaintainableCode** \- しきい値: 20 以下で警告  
  
    -   クラス結合度: **CA1506 AvoidExcessiveClassCoupling** \- しきい値: クラスの場合は 80 以上で警告、メソッドの場合は 30 以上で警告  
  
    -   また、規則違反があったらビルドをできないようにするには、規則の説明の横にある **\[警告をエラーとして扱う\]** チェック ボックスをオンにします。  
  
3.  \[OK\] をクリックします。  これで、以降のチェックインに新しいチェックイン ポリシーが適用されるようになります。  
  
## 参照  
 [コード メトリックス値](../code-quality/code-metrics-values.md)   
 [コード分析を用いたチェックイン ポリシーの作成と使用](../code-quality/creating-and-using-code-analysis-check-in-policies.md)