---
title: .NET のライブ コード分析スコープを構成する
ms.date: 09/01/2020
description: Visual Studio でのバックグラウンド分析について説明します。 表示されているドキュメント、開いているすべてのドキュメント、またはすべてのファイルとプロジェクトに分析を制限する方法を示します。
ms.custom: SEO-VS-2020
ms.topic: conceptual
helpviewer_keywords:
- live code analysis
- background analysis
- analysis scope
- full solution analysis
author: mikadumont
ms.author: midumont
manager: jmartens
ms.workload:
- dotnet
ms.openlocfilehash: 7a6a7253d4104fbcde09b96b86f5f83a864677cf
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/08/2021
ms.locfileid: "99860400"
---
# <a name="configure-live-code-analysis-for-net"></a>.NET のライブ コード分析を構成する

Visual Studio では、エディターでのソース ファイルの編集中に、一連のライブ コード分析 ("*バックグラウンド分析*" とも呼ばれます) が実行されます。 その一部は、Visual Studio IDE の許容できる編集エクスペリエンスを実現するために必要な最小限の分析です。 IDE 機能の応答性を向上させるためのものもあります。 さらに、Roslyn アナライザーによる診断やコード修正など、追加の IDE 機能を有効にすることを目的としたものもあります。 これらの分析は、機能に基づいて次のようにグループ化できます。

- **診断のバックグラウンド計算**: ソース ファイル内のエラー、警告、提案を計算するための分析。 これらの診断は、エラー一覧のエントリとして表示され、エディターには波線として表示されます。 これらは次の 2 つのカテゴリに分類できます。
  - C# および Visual Basic コンパイラ診断。
  - Roslyn アナライザー診断。これには次のものが含まれます。

    - コード スタイルの提案用の組み込み IDE アナライザー
    - コード品質の提案用の組み込み CA アナライザー
    - 現在のソリューションのプロジェクト用に[インストールされている](./install-roslyn-analyzers.md)サード パーティのアナライザー パッケージ

- **その他のバックグラウンド分析**: IDE 機能の応答性と Visual Studio の相互作用を向上させるための分析。 このような分析の例を次に示します。
  - 開いているファイルのバックグラウンド解析。
  - 特定の IDE 機能の応答性を向上させるために、シンボルを認識するためのファイルが開かれているプロジェクトのバックグラウンドのコンパイル。
  - 構文およびシンボル キャッシュの作成。
  - フォーム、コントロールなど、ソース ファイルのデザイナーの関連付けの検出。

## <a name="default-analysis-scope"></a>既定の分析スコープ

既定では、診断のバックグラウンド計算のためのライブ コード分析は、Visual Studio で "_開かれている_" すべてのファイルに対して実行されます。 上記の "_その他のバックグラウンド分析_" のうち、少なくとも 1 つのファイルが開かれているすべてのプロジェクトに対して実行されるものはほとんどありません。 一方、ソリューション全体に対して実行されるバックグラウンド分析はほとんどありません。

## <a name="custom-analysis-scope"></a>カスタム分析スコープ

各バックグラウンド分析の既定のスコープは、お客様のシナリオとソリューションの大半で最適なユーザー エクスペリエンス、機能、パフォーマンスを実現できるように調整されています。 ただし、お客様はこのスコープをカスタマイズして、バックグラウンド分析を増減することが必要な場合があります。 次に例を示します。

- 省電力モード: ユーザーは、ノート PC のバッテリを使用している場合に、バッテリ寿命を延ばすために消費電力を最小限に抑えたい場合があります。 このシナリオでは、バックグラウンド分析を最小限に抑える必要があります。
- オンデマンド コード分析: ユーザーは、アナライザーのライブ実行を無効にして、オンデマンドでコード分析を手動で実行する方がよい場合に、バックグラウンド分析を最小限に抑える必要があります。 [オンデマンドでコード分析を手動で実行する方法](./how-to-run-code-analysis-manually-for-managed-code.md)に関する記事を参照してください。
- ソリューションの完全な分析: ユーザーは、エディターで開いているかどうかに関係なく、ソリューション内のすべてのファイルのすべての診断を常に確認することを望んでいる場合があります。 このシナリオでは、バックグラウンド分析スコープをソリューション全体に最大化する必要があります。

Visual Studio 2019 バージョン 16.5 以降では、ユーザーは C# および Visual Basic プロジェクトのすべてのライブ コード分析 (診断計算を含む) のスコープを明示的にカスタマイズできます。 使用できる分析スコープは次のとおりです。

- **現在のドキュメント**: ライブ コード分析スコープを最小化して、エディターに現在表示されているファイルのみを対象に実行します。
- **開かれているドキュメント**: 前のセクションで説明した既定のライブ コード分析スコープ。
- **ソリューション全体**: ライブ コード分析スコープを最大化して、ソリューション全体のすべてのファイルとプロジェクトを対象に実行します。

以下の手順に従って、[ツール] の [オプション] ダイアログで上記のカスタム分析スコープのいずれかを選択できます。

1. **[オプション]** ダイアログ ボックスを開くには、Visual Studio のメニュー バーで、 **[ツール]**  >  **[オプション]** の順に選択します。

2. **[オプション]** ダイアログ ボックスで、 **[テキスト エディター]**  >  **[C#]** または **[Basic]**  >  **[詳細設定]** の順に選択します。

3. 目的の **バックグラウンドの分析スコープ** を選択して、分析スコープをカスタマイズします。 完了したら、 **[OK]** を選択します。

![分析スコープ。](./media/background-analysis-scope.png)

> [!NOTE]
> Visual Studio 2019 バージョン 16.5 より前では、 **[ツール]**  >  **[オプション]**  >  **[テキスト エディター]**  >  **[C#]** または **[Basic]**  >  **[詳細設定]** タブの **[完全ソリューション解析を有効にする]** チェック ボックスを使用して、診断計算の分析スコープをソリューション全体にカスタマイズできます。Visual Studio の以前のバージョンでは、バックグラウンド分析スコープの最小化はサポートされていません。

## <a name="automatically-minimize-live-code-analysis-scope"></a>ライブ コード分析スコープを自動的に最小化

Visual Studio では、使用可能なシステム メモリが 200 MB 以下であることが検出されると、ライブ コード分析スコープが "現在のドキュメント" に自動的に最小化されます。 これが行われると、Visual Studio で一部の機能が無効化されたことを通知するアラートが表示されます。 ボタンを使用すると、必要に応じて前の分析スコープに戻すことができます。

![分析スコープの最小化を通知するアラートのテキスト](./media/fsa_alert.png)

## <a name="see-also"></a>関連項目

- [自動機能の中断](./automatic-feature-suspension.md)
- [省電力モード機能の要求](https://github.com/dotnet/roslyn/issues/38429)
