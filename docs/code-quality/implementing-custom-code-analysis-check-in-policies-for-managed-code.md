---
title: マネージコード用のカスタムコード分析チェックインポリシー
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- vs.code.analysis.selecttfsrulesets
- vs.code.analysis.browsefortfsruleset
- vs.code.analysis.policyeditor
ms.assetid: fd029003-5671-4b24-8b6f-032e0a98b2e8
author: gewarren
ms.author: gewarren
manager: jillfra
ms.workload:
- dotnet
ms.openlocfilehash: 55294f7418de085cb4ceccd4063a4b2b55cbc6c4
ms.sourcegitcommit: 39a04f42d23597b70053686d7e927ba78f38a9a8
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/05/2019
ms.locfileid: "71975032"
---
# <a name="implement-custom-code-analysis-check-in-policies-for-managed-code"></a>マネージド コード用のカスタム コード分析チェックイン ポリシーを実装する

コード分析チェックイン ポリシーは、Azure DevOps プロジェクトのメンバーがバージョン管理にチェックインする前にソース コードに対して実行する必要がある一連のルールを指定します。 標準のセットを提供する Microsoft*ルール セット*をそのグループのコード分析ルール機能領域に挿入します。 *カスタム チェックイン ポリシーの規則セット*プロジェクトに固有のコード分析規則のセットを指定します。 規則セットは、.ruleset ファイルに格納されます。

チェックイン ポリシーは、Azure DevOps プロジェクト レベルで設定し、バージョン コントロール ツリーの .ruleset ファイルの場所で指定されました。 チームのポリシーのカスタム規則セットのバージョン管理の場所に制限はありません。

コード分析は、各プロジェクトのプロパティ ウィンドウで各コード プロジェクトに対して構成されます。 コード プロジェクトの設定、カスタム ルールは、ローカル コンピューター上の .ruleset ファイルの物理的な場所によって指定されます。 コード プロジェクトと同じドライブ上にある .ruleset ファイルを指定すると、Visual Studio はプロジェクトの構成ファイルに相対パスを使用します。

プロジェクトのカスタム規則セットが、コード プロジェクトの一部ではない特殊なフォルダーでチェックイン ポリシー .ruleset ファイルを保存するには、Azure DevOps を作成することをお勧めします。 専用のフォルダーにファイルを保存する場合は、ルール ファイルを編集できるユーザーを制限する権限を適用できるディレクトリ構造を簡単に移動することができますを別のディレクトリまたはコンピューターにプロジェクトが含まれます。

## <a name="create-the-project-custom-check-in-rule-set"></a>プロジェクトのカスタム チェックの規則セットを作成します。

Azure DevOps プロジェクトの設定、カスタム ルールを作成する最初にフォルダーを作成する特殊なチェックイン ポリシーの規則セットの**ソース管理エクスプ ローラー**します。 規則セット ファイルを作成し、バージョン管理にファイルを追加します。 最後に、コード分析チェックイン ポリシー プロジェクトとして設定するルールを指定します。

> [!NOTE]
> Azure DevOps プロジェクトで、フォルダーを作成するには、最初に割り当てる必要があります、プロジェクトのルート、ローカル コンピューター上の場所にします。

### <a name="to-create-the-version-control-folder-for-the-check-in-policy-rule-set"></a>チェックイン ポリシーのルール セットのバージョン管理フォルダーを作成するには

1. チーム エクスプ ローラーでプロジェクト ノードを展開し、**ソース管理**します。

2. **フォルダー**ウィンドウで、プロジェクトを右クリックしておよびクリックして**新しいフォルダー**します。

3. メインのソース管理 ウィンドウで右クリック**新しいフォルダー**、 をクリックして**の名前を変更**、ルール セットのフォルダーの名前を入力します。

### <a name="to-create-the-check-in-policy-rule-set"></a>チェックイン ポリシーの規則セットを作成するには

1. **ファイル**メニューで、**新規**、 をクリックし、**ファイル**します。

2. **カテゴリ**一覧で、**全般**します。

3. **テンプレート**リストで、ダブルクリック**コード分析規則セット**します。

4. [ルールを指定して](../code-quality/how-to-create-a-custom-rule-set.md)をルール セットに含めるし、規則を保存するには、作成したルール セットのフォルダーにファイルを設定します。

### <a name="to-add-the-rule-set-file-to-version-control"></a>規則を追加するには、バージョン管理にファイルを設定します。

1. **ソース管理エクスプ ローラー**、新しいフォルダーを右クリックし、クリックして**フォルダーに項目の追加**します。

     詳細については、次を参照してください。 [Git と Azure リポジトリ](/azure/devops/repos/git/overview?view=vsts)します。

2. 規則セットを作成したファイルをクリックおよびクリック**完了**します。

     ファイルがソース管理に追加し、チェック アウトしています。

3. **ソース管理エクスプ ローラー**詳細 ウィンドウ、ファイル名を右クリックし、順にクリックします**保留中の変更をチェックイン**します。

4. **チェックイン**ダイアログ ボックスで、クリックしてコメントを追加するオプションがある**チェックイン**します。

    > [!NOTE]
    > Azure DevOps プロジェクトのコード分析チェックイン ポリシーを既に構成して、選択した場合、**のみ現在のソリューションの一部であるファイルを含むチェックインを強制**、ポリシー エラーに関する警告がトリガーされます。 ポリシーのエラー] ダイアログ ボックスで、[**ポリシー エラーをオーバーライドし、チェックインを続行**します。 必要なコメントを追加し、クリックして**OK**します。

### <a name="to-specify-the-rule-set-file-as-the-check-in-policy"></a>ルールを指定するには、チェックイン ポリシーとしてファイルを設定します。

1. **チーム**メニューで、**プロジェクト設定**、 をクリックし、**ソース管理**。

2. をクリックして**チェックイン ポリシー**、 をクリックし、**追加**します。

3. **チェックイン ポリシー**リストで、ダブルクリック**コード分析**、ことを確認し、**マネージ コードに対するコード分析を強制** チェック ボックスをオンします。

4. **この規則セットを実行**一覧で、 **\<ソース管理からのルール セットの選択 >** します。

5. バージョン管理でチェックイン ポリシーの規則セット ファイルのパスを入力します。

     パスは、次の構文に従う必要があります。

     **$/** `TeamProjectName` **/** `VersionControlPath`

    > [!NOTE]
    > 次の手順のいずれかを使用してパスをコピーする**ソース管理エクスプ ローラー**:

    - **フォルダー**ウィンドウで、規則セット ファイルを含むフォルダーをクリックします。 表示されるフォルダーのバージョン コントロール パスのコピー、**ソース**ボックス、および規則セット ファイルの名前を手動で入力します。

    - 詳細ウィンドウで、規則セット ファイルを右クリックし、**プロパティ**します。 **全般** タブで、値をコピーします**サーバー名**します。

## <a name="synchronize-code-projects-to-the-check-in-policy-rule-set"></a>コード プロジェクトのチェックイン ポリシーの規則セットへの同期します。

プロジェクトのチェックイン ポリシーの規則は、コード プロジェクトのプロパティ ダイアログ ボックスで、コード プロジェクト構成のコード分析規則セットとして設定を指定します。 規則セットは、コード プロジェクトと同じドライブに存在する場合は、相対パスがファイル ダイアログ ボックスからのパスを選択すると、ルール セットを指定する使用されます。 相対パスにより、プロジェクトのプロパティ設定のようなローカル バージョンを使用するその他のコンピューターに移植する制御構造体。

### <a name="to-specify-a-project-rule-set-as-the-rule-set-of-a-code-project"></a>プロジェクトの規則を指定するには、コード プロジェクトの規則のセットとして設定します。

1. 必要に応じて、チェックイン ポリシーの規則セットのフォルダーとファイルをバージョン コントロールから取得します。

   この手順を実行することができます**ソース管理エクスプ ローラー**フォルダーおよび をクリックしを右クリックし、ルールの設定**最新バージョンの取得**します。

2. **ソリューション エクスプ ローラー**コード プロジェクトを右クリックし、クリックして**プロパティ**します。

3. **コード分析 をクリック**します。

4. 必要に応じて、適切なオプションをクリックします。、**構成**と**プラットフォーム**を一覧表示します。

::: moniker range="vs-2017"

5. 指定された構成を使用してコードプロジェクトがビルドされるたびにコード分析を実行するには、[**ビルド時にコード分析を有効に**する] チェックボックスをオンにします。

::: moniker-end

::: moniker range=">=vs-2019"

5. 指定された構成を使用してコードプロジェクトがビルドされるたびにコード分析を実行するには、 **[バイナリアナライザー]** セクションの **[ビルドで実行]** を選択します。

::: moniker-end

6. [**この規則セットを実行**します] の一覧で、 **\<Browse を参照**します。

8. チェックインポリシー規則セットファイルのローカルバージョンを選択します。