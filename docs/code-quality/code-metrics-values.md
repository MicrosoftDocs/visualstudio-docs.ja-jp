---
title: コードメトリックスの計算
ms.date: 11/02/2018
description: サイクロマティック複雑度、クラス結合、およびその他の Visual Studio code メトリックについて説明します。 メトリックを使用して開発の進行状況を追跡し、リスクを特定する方法について説明します。
ms.custom: SEO-VS-2020
ms.topic: conceptual
f1_keywords:
- vs.codeanalysis.codemetrics.toolwindow
dev_langs:
- CSharp
- VB
- FSharp
helpviewer_keywords:
- code metrics [Visual Studio]
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: 6e77667feae806b66092195f30b028ccca653b2b
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/08/2021
ms.locfileid: "99860452"
---
# <a name="code-metrics-values"></a>コードメトリックスの値

また、最新のソフトウェアアプリケーションが複雑になるほど、コードの信頼性と保守性が向上します。 コード メトリックスとは、開発者が開発中のコードをより理解できるようにする、ソフトウェアの一連の基準です。 コードメトリックスを利用することにより、開発者は、どの型やメソッドを作成し直すか、さらに詳細にテストする必要があるかを理解できます。 開発チームは、潜在的なリスクを特定し、プロジェクトの現在の状態を把握し、ソフトウェア開発中の進行状況を追跡できます。

開発者は、Visual Studio を使用して、マネージコードの複雑さと保守性を測定するコードメトリックスデータを生成できます。 コードメトリックスデータは、ソリューション全体または単一のプロジェクトに対して生成できます。

Visual Studio でコードメトリックスデータを生成する方法の詳細については、「 [方法: コードメトリックスデータを生成](../code-quality/how-to-generate-code-metrics-data.md)する」を参照してください。

## <a name="software-measurements"></a>ソフトウェアの測定

次の一覧は、Visual Studio によって計算されるコードメトリックスの結果を示しています。

- **保守容易性のインデックス** -コードを維持するための相対的な容易さを表す 0 ~ 100 のインデックス値を計算します。 値が大きい場合は、保守性が向上します。 色分けされた評価を使用して、コード内の問題点をすばやく特定できます。 緑色の評価は 20 ~ 100 の範囲であり、コードの保守性が優れていることを示しています。 黄色の評価は 10 ~ 19 で、コードが適度に保守可能であることを示します。 赤色の評価は、0 ~ 9 の評価であり、保守性が低いことを示します。 詳細については、「 [保守容易性インデックスの範囲と意味](code-metrics-maintainability-index-range-and-meaning.md)」を参照してください。

- **サイクロマティック複雑** 度-コードの構造的な複雑さを測定します。 これは、プログラムのフロー内のさまざまなコードパスの数を計算することによって作成されます。 複雑な制御フローを持つプログラムは、適切なコードカバレッジを実現するためにより多くのテストを必要とし、保守が少なくなります。 詳細については、「 [サイクロマティック複雑性」の Wikipedia のエントリ](https://wikipedia.org/wiki/Cyclomatic_complexity)を参照してください。

- **継承の深さ** -基底クラスに戻るために、相互に継承されるさまざまなクラスの数を示します。 継承の深さは、基底クラスの変更が継承されたクラスに影響を与える可能性があるという点で、クラス結合と似ています。 この値が大きいほど、継承が深いほど、基底クラスの変更によって重大な変更が発生する可能性が高くなります。 継承の深さを小さくするために、低い値は良好で、大きな値は悪くなります。

- **クラス結合** -パラメーター、ローカル変数、戻り値の型、メソッドの呼び出し、ジェネリックまたはテンプレートのインスタンス化、基底クラス、インターフェイスの実装、外部型で定義されたフィールド、および属性の装飾を使用して、一意のクラスへの結合を測定します。 優れたソフトウェア設計では、型とメソッドが高い凝集度と低結合を持つ必要があります。 結合率が高い場合は、他の型との依存関係が多数あるため、再利用と保守が困難な設計が示されます。 詳細については、「 [クラス結合](code-metrics-class-coupling.md)」を参照してください。

::: moniker range=">=vs-2019"

- [**ソースコードの行**]-ソースファイルに存在するソースコード行の正確な数を示します (空白行を含む)。 このメトリックは、Visual Studio 2019 バージョン16.4 と 2.9.5 () 以降で使用できます。

- **実行可能コードの行** -実行可能なコード行または操作のおおよその数を示します。 これは、実行可能コードの操作の数です。 このメトリックは、Visual Studio 2019 バージョン16.4 と 2.9.5 () 以降で使用できます。 この値は、通常、前のメトリック、つまりレガシモードで使用される MSIL 命令ベースのメトリックである **コード行** と密接に一致します。
::: moniker-end
::: moniker range="vs-2017"

- **コード行** -コード内の行のおおよその数を示します。 このカウントは IL コードに基づいているため、ソースコードファイル内の行の正確な数ではありません。 高カウントは、型またはメソッドが過剰な処理を試行していて、分割する必要があることを示している場合があります。 また、型またはメソッドを維持するのが困難な場合もあります。

   > [!NOTE]
   > コードメトリックスツールの [コマンドラインバージョン](../code-quality/how-to-generate-code-metrics-data.md#command-line-code-metrics) では、IL ではなくソースコードが分析されるため、実際のコード行がカウントされます。
::: moniker-end

## <a name="anonymous-methods"></a>匿名メソッド

*匿名メソッド* は、名前のないメソッドにすぎません。 匿名メソッドは、コードブロックをデリゲートパラメーターとして渡すために最も頻繁に使用されます。 メソッドやアクセサーなどのメンバーで宣言されている匿名メソッドのコードメトリックスの結果は、メソッドを宣言するメンバーに関連付けられています。 これらは、メソッドを呼び出すメンバーに関連付けられていません。

## <a name="generated-code"></a>生成されたコード

一部のソフトウェアツールとコンパイラは、プロジェクトに追加されたコードを生成します。プロジェクト開発者は、表示されないか、変更できません。 ほとんどの場合、コードメトリックスは、メトリック値を計算するときに、生成されたコードを無視します。 これにより、メトリック値に、開発者が表示および変更できる内容を反映させることができます。

Windows フォーム用に生成されたコードは、開発者が表示および変更できるコードであるため、無視されません。

## <a name="next-steps"></a>次の手順

- [方法: コードメトリックスデータを生成する](../code-quality/how-to-generate-code-metrics-data.md)
- [[コードメトリックスの結果] ウィンドウを使用する](../code-quality/working-with-code-metrics-data.md)