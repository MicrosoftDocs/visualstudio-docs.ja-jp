---
title: コード分析の標準チェックイン ポリシーを作成または更新する
description: Azure DevOps プロジェクトのすべてのコード プロジェクトでコード分析が実行されるようにする方法について説明します。 プロジェクト コード分析のチェックイン ポリシーを構成する方法を示します。
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: how-to
f1_keywords:
- vs.codeanalysis.policyeditor
helpviewer_keywords:
- code analysis, migrating check-in policy
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: 3d46ed89880c41cbcaa6982c386e2ff8f115f8de
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/08/2021
ms.locfileid: "99860114"
---
# <a name="how-to-create-or-update-standard-code-analysis-check-in-policies"></a>方法: 標準のコード分析チェックイン ポリシーを作成または更新する

コード分析のチェックイン ポリシーを使用することで、Azure DevOps プロジェクトのすべてのコード プロジェクトでコード分析を実行するように要求できます。 コード分析を必要にすると、コード ベースにチェックインされるコードの品質を向上させることができます。

> [!NOTE]
> この機能は、Team Foundation Server を使用している場合にのみ使用できます。

コード分析のチェックイン ポリシーの設定はプロジェクトの設定で行い、ポリシーは各コード プロジェクトに適用されます。 コード分析の実行は、コード プロジェクトのプロジェクト (.xxproj) ファイルで、コード プロジェクトに対して構成されます。 コード分析の実行は、ローカル コンピューター上で実行されます。 コード分析のチェックイン ポリシーを有効にするときは、コード プロジェクトのチェックインされるファイルを、最後の編集の後でコンパイルする必要があります。また、少なくともプロジェクト設定の規則が含まれるコード分析の実行を、変更が行われたコンピューターで実行する必要があります。

- マネージド コードの場合は、コード分析規則のサブセットが含まれる "*規則セット*" を指定して、チェックイン ポリシーを設定します。

- C/C++ コードの場合、Visual Studio 2017 バージョン 15.6 以前のチェックイン ポリシーでは、すべてのコード分析規則を実行する必要があります。 プリプロセッサ ディレクティブを追加することで、Azure DevOps プロジェクト内の個々のコード プロジェクトに対する特定の規則を無効にすることができます。 15.7 以降では、 **/analyze:ruleset** を使用して、実行するルールを指定できます。 詳細については、[規則セットを使用した実行対象の C++ 規則の指定](/cpp/code-quality/using-rule-sets-to-specify-the-cpp-rules-to-run)に関する記事を参照してください。

マネージド コードのチェックイン ポリシーを指定すると、チーム メンバーは、コード プロジェクトのコード分析の設定を、Azure DevOps プロジェクトのポリシー設定と同期させることができます。

## <a name="to-open-the-check-in-policy-editor"></a>チェックイン ポリシー エディターを開くには

1. チーム エクスプローラーでプロジェクト名を右クリックし、 **[プロジェクトの設定]** をポイントして、 **[ソース管理]** をクリックします。

1. **[ソース管理]** ダイアログ ボックスで、 **[チェックイン ポリシー]** タブを選択します。

1. 次のいずれかの操作を行います。

    - **[追加]** をクリックして、新しいチェックイン ポリシーを作成します。

    - ポリシーを変更するには、 **[ポリシーの種類]** の一覧で既存の **コード分析** 項目をダブルクリックします。

## <a name="to-set-policy-options"></a>ポリシーのオプションを設定するには

次のオプションをオンまたはオフにします。

|オプション|説明|
|------------|-----------------|
|**現在のソリューションの一部であるファイルのみのチェックインを強制**|コード分析は、ソリューションとプロジェクトの構成ファイルで指定されているファイルに対してのみ実行できます。 このポリシーにより、ソリューションの一部であるすべてのコードが分析されることが保証されます。|
|**C/C++ コード分析 (/analyze) を強制**|チェックインする前にコード分析を実行するため、すべての C または C++ プロジェクトを /analyze コンパイラ オプションを使用してビルドする必要があるようにします。|
|**マネージド コードのコード分析を強制**|すべてのマネージド プロジェクトで、チェックインの前に、コード分析とビルドを実行する必要があるようにします。|

## <a name="to-specify-a-managed-rule-set"></a>マネージド規則セットを指定するには

**[この規則セットを実行]** の一覧で、次のいずれかの方法を使用します。

- Microsoft の標準規則セットを選択します。

- **[\<Select Rule Set from Source Control...>]** をクリックして、カスタム規則セットを選択します。 その後、ソース管理ブラウザーで規則セットのバージョン コントロール パスを入力します。 バージョン コントロール パスの構文は次のとおりです。

   **$/** `TeamProjectName` **/** `VersionControlPath`

カスタム チェックイン ポリシーの規則セットを作成して実装する方法の詳細については、[マネージド コード用のカスタム チェックイン ポリシーの実装](../code-quality/implementing-custom-code-analysis-check-in-policies-for-managed-code.md)に関する記事を参照してください。

## <a name="see-also"></a>こちらもご覧ください

- [マネージド コード用のカスタム コード分析チェックイン ポリシーを実装する](../code-quality/implementing-custom-code-analysis-check-in-policies-for-managed-code.md)
