---
title: Visual Studio でロード テストを作成して実行する
ms.date: 10/01/2016
ms.topic: conceptual
helpviewer_keywords:
- unit tests, in load tests
- unit tests, load test walkthrough
- load tests, walkthrough
ms.assetid: bbf075a5-96d5-48ed-a03c-330f0fc04748
author: gewarren
ms.author: gewarren
manager: douge
ms.prod: visual-studio-dev15
ms.technology: vs-ide-test
ms.openlocfilehash: 22014010ea0ef7d101a446b6e89591797f5f2550
ms.sourcegitcommit: e13e61ddea6032a8282abe16131d9e136a927984
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/26/2018
---
# <a name="walkthrough-create-and-run-a-load-test-that-contains-unit-tests"></a>チュートリアル: 単体テストを含むロード テストを作成して実行する

このチュートリアルでは、単体テストを含むロード テストを作成します。

このチュートリアルでは、Visual Studio Enterprise を使用してロード テストを作成および実行する手順を説明します。 ロード テストは、Web パフォーマンス テストおよび単体テストのコンテナーです。 ロード テストは、新しいロード テスト ウィザードを使用して作成します。

ロード テストでは、目的のロード シミュレーションを生成するために変更できる多くのランタイム プロパティを公開しています。 このチュートリアルでは、新しいロード テスト ウィザードを使用して、単体テストをロード テストに追加します。

このチュートリアルでは、次のタスクを行います。

-   単体テストを使用するロード テストを作成します。

-   ロード テストの設定をいくつか変更します。

-   ロード テストを実行します。

-   「[チュートリアル: マネージ コードに対する単体テストの作成と実行](../test/walkthrough-creating-and-running-unit-tests-for-managed-code.md)」に記載されている手順を実行して、いくつかの単体テストのある Web パフォーマンス テストとロード テストのプロジェクトを含む、簡単な C# クラス ライブラリを作成します。

## <a name="create-a-load-test-containing-unit-tests-using-the-new-load-test-wizard"></a>新しいロード テスト ウィザードを使用した、単体テストを含むロード テストの作成

### <a name="to-start-the-new-load-test-wizard"></a>新しいロード テスト ウィザードを開始するには

1.  「[チュートリアル: マネージ コードに対する単体テストの作成と実行](../test/walkthrough-creating-and-running-unit-tests-for-managed-code.md)」で作成した Bank ソリューションを開きます。

2.  **ソリューション エクスプローラー**で、Bank ソリューション ノードのショートカット メニューを開き、**[追加]** をポイントして、**[新しいプロジェクト]** をクリックします。

     [新しいプロジェクトの追加] ダイアログ ボックスが表示されます。

3.  [新しいプロジェクトの追加] ダイアログ ボックスで、**[Visual C#]** を展開し、**[テスト]** をクリックします。 テンプレートの一覧で **[Web パフォーマンスとロード テストのプロジェクト]** をクリックし、**[名前]** フィールドに「`BankLoadTest`」と入力します。 **[OK]** をクリックします。

     BankLoadTest という Web パフォーマンスとロード テストのプロジェクトがソリューションに追加されます。

4.  新しい BankLoadTest Web パフォーマンスとロード テストのショートカット メニューを開き、**[追加]** をポイントして、**[ロード テスト]** をクリックします。

5.  **新しいロード テスト** ウィザードが開始します。

6.  **新しいロード テスト** ウィザードの最初のページは、**[ようこそ]** ページです。

7.  **[次へ]** をクリックします。

### <a name="to-edit-settings-for-load-test-scenario"></a>ロード テスト シナリオの設定を編集するには

1.  **[ロード テスト シナリオの名前の入力]** ボックスに、「**ScenarioSample**」と入力します。

     *シナリオ*とは、グループ化機構です。 一連のテストおよびこれらのテストをロードの下で実行するためのプロパティで構成されています。

2.  **[待ち時間のプロファイル]** を `Use normal distribution centered on recorded think times` に設定します。 待ち時間は、ユーザーが Web ページで次のページに進むまでの考慮時間を表します。

1.  終了したら、**[次へ]** をクリックします。

### <a name="to-edit-load-pattern-setting-for-test-scenario"></a>テスト シナリオのロード パターン設定を編集するには

1.  **[ステップ ロード]** を選択します。

    > [!NOTE]
    > ロード パターンは、持続とステップの 2 種類から選択します。 それぞれに役割がありますが、このチュートリアルでは **[ステップ ロード]** を選択します。

2.  **[ユーザー カウントの開始]** を 10 ユーザーに設定します。

3.  **[ステップ継続時間]** を 10 秒に設定します。

4.  **[ユーザー カウントのステップ]** を 10 ユーザー/ステップに設定します。

5.  **[最大ユーザー カウント]** を 100 ユーザーに設定します。

6.  **[次へ]** をクリックします。

### <a name="to-select-test-mix-model-for-the-scenario"></a>シナリオのテスト ミックス モデルを選択するには

1.  [テスト ミックスを何に基づいてモデル化しますか?] で、**[テストの合計数]** を選択します。

2.  **[次へ]** をクリックします。

### <a name="to-add-unit-tests-to-the-scenario"></a>シナリオに単体テストを追加するには

1.  次の手順で、**テストをロード テスト シナリオに追加し、テスト ミックスを編集**します。

2.  **[追加]** をクリックして、テストを選択します。

3.  **[使用可能なテスト]** ペインに表示される CreditTest 単体テストを選択します。このペインには、Web パフォーマンスとロード テストのプロジェクト内の Web パフォーマンス テストおよび単体テストがすべて表示されます。

4.  矢印をクリックして、**[選択されたテスト]** ペインに CreditTest 単体テストを追加します。

5.  DebitTest 単体テストおよび FreezeAccountTest 単体テストについて、手順 3. と 4. を繰り返します。

6.  3 つの単体テストの追加が終了したら、**[OK]** をクリックします。

     テスト ミックスが表示されます。

7.  CreditTest の配分の下のスライダーを少し右へ動かして、テストの配分を調整します。 配分が 100% のままになるように、他のスライダーが自動的に左へ移動することに注意してください。

8.  **[次へ]** をクリックします。

### <a name="to-select-network-mix-for-test-scenario"></a>テスト シナリオのネットワーク ミックスを選択するには

1.  [LAN] をクリックして、ネットワーク帯域幅ミックスに追加します。

     その他のネットワークの種類も追加できます。 スライダーを使用して、テストの配分とウェイトを調整します。

2.  **[次へ]** をクリックします。

### <a name="to-specify-computers-to-monitor-with-counter-sets-during-load-test-run"></a>ロード テストの実行中にカウンター セットで監視するコンピューターを指定するには

1.  **[次へ]** をクリックします。

     カウンター セットの詳細については、「[ロード テストでのコンピューターのカウンター セットとしきい値規則の指定](../test/specify-counter-sets-and-threshold-rules-for-load-testing.md)」を参照してください。

### <a name="to-edit-run-setting-for-load-test"></a>ロード テストの実行設定を編集するには

1.  **[ロード テストの継続時間]** を選択し、ロード テストの*スモーク テスト*を行うために **[実行継続時間]** を 2 分に設定します。

     ロード テストをビルドする場合、すべてが正しく構成され、期待どおりに実行されることを検証するために、短く、軽いロード テストを実行することが、推奨される方法です。 このプロセスは、*スモーク テスト*と呼ばれます。

2.  **[完了]** を選択します。 **ロード テスト エディター**で、ロード テストが開きます。

## <a name="running-the-load-test"></a>ロード テストの実行
 ロード テストを作成したら、そのロード テストを実行して、ロード シミュレーションに Bank アプリケーションが応答する動作を確認します。 ロード テストを実行している間、**[ロード テスト アナライザー]** ウィンドウが表示されます。

### <a name="to-run-the-load-test"></a>ロード テストを実行するには

1.  **ロード テスト エディター**でロード テストを開いている状態で、ツール バーにある緑色の **[テストの実行]** ボタンをクリックします。 ロード テストが実行を開始します。

2.  テスト シミュレーションでいずれかのしきい値を超えた場合、ツリー コントロール ノードにアイコンが表示され、しきい値違反について示されます。 エラーの場合は赤い丸がオーバーレイ表示され、警告の場合は黄色い三角形がオーバーレイ表示されます。 しきい値を超えたカウンターを探し、アイコンをグラフにドラッグすることによって、グラフを作成できます。 この操作は、テストの実行中に行うことができます。

## <a name="see-also"></a>関連項目

- [テスト ミックスを編集して、ロード テスト シナリオに含めるテストを指定](../test/edit-the-test-mix-to-specify-which-web-browsers-types-in-a-load-test-scenario.md)
- [仮想ネットワークの種類の指定](../test/specify-virtual-network-types-in-a-load-test-scenario.md)
- [ロード テスト シナリオの編集](../test/edit-load-test-scenarios.md)
- [ロード パターンを編集して仮想ユーザー アクティビティをモデル化](../test/edit-load-patterns-to-model-virtual-user-activities.md)
- [テキスト ミックス モデルを編集して仮想ユーザーがテストを実行する確率を指定](../test/edit-test-mix-models-to-specify-the-probability-of-a-virtual-user-running-a-test.md)