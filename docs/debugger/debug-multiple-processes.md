---
title: 複数のプロセスをデバッグする | Microsoft Docs
ms.date: 11/20/2018
ms.topic: how-to
f1_keywords:
- vs.debug.programs
- vs.debug.processes.attaching
- vs.debug.activeprogram
- vs.debug.attaching
- vs.debug.attachedprocesses
dev_langs:
- CSharp
- VB
- FSharp
- C++
ms.assetid: bde37134-66af-4273-b02e-05b3370c31ab
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 94a61e0083b17fa095b419a2066a4f8b9c39dfb7
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/02/2020
ms.locfileid: "85350603"
---
# <a name="debug-multiple-processes-c-visual-basic-c"></a>複数のプロセスをデバッグする (C#、Visual Basic、C++)

Visual Studio では、複数のプロセスが含まれるソリューションをデバッグできます。 プロセスの開始と切り替え、中断、続行、ソースのステップ実行、デバッグの停止、個々のプロセスの終了やプロセスからのデタッチを行うことができます。

## <a name="start-debugging-with-multiple-processes"></a>複数のプロセスのデバッグを開始する

Visual Studio ソリューション内の複数のプロジェクトを個別に実行できる場合は、デバッガーを起動するプロジェクトを選択できます。 **ソリューション エクスプローラー**では、現在のスタートアップ プロジェクトが太字で表示されます。

スタートアップ プロジェクトを変更するには、**ソリューション エクスプローラー**で別のプロジェクトを右クリックして、 **[スタートアップ プロジェクトに設定]** を選択します。

プロジェクトをスタートアップ プロジェクトにしないで**ソリューション エクスプローラー**からプロジェクトのデバッグを始めるには、プロジェクトを右クリックし、 **[デバッグ]**  >  **[新しいインスタンスを開始]** または **[新しいインスタンスにステップ イン]** を選択します。

**ソリューションのプロパティから 1 つまたは複数のスタートアップ プロジェクトを設定するには:**

1. **ソリューション エクスプローラー**でソリューションを選択してから、ツール バーの **[プロパティ]** アイコンを選択するか、ソリューションを右クリックして **[プロパティ]** を選択します。

1. **[プロパティ]** ページで、 **[共通プロパティ]**  >  **[スタートアップ プロジェクト]** を選択します。

   ![プロジェクトのスタートアップの種類の変更](../debugger/media/dbg_execution_startmultipleprojects.png "DBG_Execution_StartMultipleProjects")

1. **[現在の選択]** 、 **[シングル スタートアップ プロジェクト]** とプロジェクト ファイル、または **[マルチ スタートアップ プロジェクト]** を選択します。

   **[マルチ スタートアップ プロジェクト]** を選択した場合は、各プロジェクトの起動順序を変更し、実行するアクションを次のいずれかに変更できます: **[開始]** 、 **[デバッグなしで開始]** 、 **[なし]** 。

1. **[適用]** を選択するか、または **[OK]** を選択し適用してダイアログを閉じます。

### <a name="attach-to-a-process"></a><a name="BKMK_Attach_to_a_process"></a> プロセスにアタッチする

リモート デバイスなど、Visual Studio の外部のプロセスで実行されているアプリに、デバッガーを "*アタッチ*" することもできます。 アプリにアタッチした後は、Visual Studio のデバッガーを使用できます。 デバッグ機能は制限される可能性があります。 それは、アプリがデバッグ情報付きでビルドされたかどうか、アプリのソース コードにアクセスできるかどうか、および JIT コンパイラによってデバッグ情報が追跡されているかどうかによって異なります。

詳細については、[実行中のプロセスへのアタッチ](../debugger/attach-to-running-processes-with-the-visual-studio-debugger.md)に関するページを参照してください。

**実行中のプロセスにアタッチするには:**

1. アプリが実行されている状態で、 **[デバッグ]**  >  **[プロセスにアタッチ]** を選択します。

   ![[プロセスにアタッチ] ダイアログ ボックス](../debugger/media/dbg_attachtoprocessdlg.png "[プロセスにアタッチ] ダイアログ ボックス")

1. **[プロセスにアタッチ]** ダイアログ ボックスで、 **[選択可能なプロセス]** の一覧からプロセスを選択して、 **[アタッチ]** を選択します。

>[!NOTE]
>デバッガーは、子プロジェクトが同じソリューション内にある場合でも、デバッグ対象のプロセスによって開始された子プロセスに自動的にアタッチされません。 子プロセスをデバッグするには、開始後に子プロセスにアタッチするか、新しいデバッガー インスタンスで子プロセスを開始するように Windows レジストリ エディターを構成します。

### <a name="use-the-registry-editor-to-automatically-start-a-process-in-the-debugger"></a><a name="BKMK_Automatically_start_an_process_in_the_debugger"></a> レジストリ エディターを使用して、デバッガーでプロセスを自動的に開始する

場合によっては、別のプロセスで起動されたアプリのスタートアップ コードをデバッグする必要があります。 たとえば、サービスやカスタムのセットアップ動作などです。 デバッガーを起動してアプリに自動的にアタッチすることができます。

1. *regedit.exe* を実行して Windows レジストリ エディターを開始します。

1. レジストリ エディターで、**HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options** に移動します。

1. デバッガーで起動するアプリのフォルダーを選択します。

   アプリが子フォルダーとして一覧に表示されない場合は、**Image File Execution Options** を右クリックし、 **[新規]**  >  **[キー]** を選択して、アプリ名を入力します。 または、ツリーで新しいキーを右クリックし、 **[名前の変更]** を選択して、アプリ名を入力 ます。

1. ツリーで新しいキーを右クリックし、 **[新規]**  >  **[文字列値]** を選択します。

1. 新しい値の名前を「**新しい値 #1**」から「`debugger`」に変更します。

1. **debugger** を右クリックして、 **[修正]** を選択します。

   ![[文字列の編集] ダイアログ ボックス](../debugger/media/dbg_execution_automaticstart_editstringdlg.png "[文字列の編集] ダイアログ ボックス")

1. **[文字列の編集]** ダイアログ ボックスで、 **[値のデータ]** ボックスに「`vsjitdebugger.exe`」と入力し、 **[OK]** を選択します。

   ![regedit.exe の自動デバッガー開始エントリ](../debugger/media/dbg_execution_automaticstart_result.png "regedit.exe の自動デバッガー開始エントリ")

## <a name="debug-with-multiple-processes"></a><a name="BKMK_Switch_processes__break_and_continue_execution__step_through_source"></a> 複数のプロセスのデバッグを行う
<a name="BKMK_Configure_the_execution_behavior_of_multiple_processes"></a>

複数のプロセスで構成されるアプリをデバッグすると、中断、ステップ実行、続行のデバッガー コマンドは、既定ですべてのプロセスに適用されます。 たとえば、あるプロセスがブレークポイントで中断されると、他のすべてのプロセスの実行も中断されます。 コマンドの実行対象をより詳細に制御するために、この既定の動作を変更できます。

**1 つのプロセスが中断したときにすべてのプロセスを中断するかどうかを変更するには:**

- **[ツール]** (または **[デバッグ]** ) > **[オプション]**  >  **[デバッグ]**  >  **[全般]** で、 **[1 つのプロセスが中断したときには、他のプロセスも中断する]** チェック ボックスをオンまたはオフにします。

### <a name="break-step-and-continue-commands"></a><a name="BKMK_Break__step__and_continue_commands"></a> 中断、ステップ実行、続行のコマンド

次の表では、 **[1 つのプロセスが中断したときには、他のプロセスも中断する]** チェック ボックスがオンまたはオフのときの、デバッグ コマンドの動作について説明します。

|**コマンド**|選択済み|選択を解除|
|-|-|-|
|**[デバッグ]**   >  **[すべて中断]**|すべてのプロセスが中断されます。|すべてのプロセスが中断されます。|
|**[デバッグ]**  >  **[続行]**|すべてのプロセスが再開されます。|一時停止中のすべてプロセスが再開されます。|
|**[デバッグ]**  >  **[ステップ イン]** 、 **[ステップ オーバー]** 、 **[ステップ アウト]**|現在のプロセスのステップ実行中にすべてのプロセスが実行されます。 <br />その後、すべてのプロセスが中断されます。|現在のプロセスがステップ実行されます。 <br />一時停止中のプロセスが再開されます。 <br />実行中のプロセスが続行されます。|
|**[デバッグ]**  >  **[現在のプロセスにステップ インする]** 、 **[現在のプロセスにステップ オーバーする]** 、 **[現在のプロセスにステップ アウトする]**|N/A|現在のプロセスがステップ実行されます。<br />他のプロセスの既存の状態 (一時停止中または実行中) が維持されます。|
|ソース ウィンドウの **[ブレークポイント]**|すべてのプロセスが中断されます。|ソース ウィンドウのプロセスのみ中断されます。|
|ソース ウィンドウの **[カーソル行の前まで実行]**<br />ソース ウィンドウのプロセスは現在のプロセスであることが必要です。|ソース ウィンドウのプロセスがカーソル位置まで実行されてから中断されている間に、すべてのプロセスが実行されます。<br />その後、他のすべてのプロセスが中断されます。|ソース ウィンドウのプロセスはカーソル位置まで実行されます。<br />他のプロセスの既存の状態 (一時停止中または実行中) が維持されます。|
|**[プロセス]** ウィンドウ > **[プロセスのブレーク]**|N/A|選択したプロセスが中断されます。<br />他のプロセスの既存の状態 (一時停止中または実行中) が維持されます。|
|**[プロセス]** ウィンドウ > **[プロセスの続行]**|N/A|選択したプロセスが再開されます。<br />他のプロセスの既存の状態 (一時停止中または実行中) が維持されます。|

### <a name="find-the-source-and-symbol-pdb-files"></a><a name="BKMK_Find_the_source_and_symbol___pdb__files"></a> ソースとシンボル (.pdb) ファイルを検索する
プロセスのソース コード内を移動するには、デバッガーでソース ファイルとシンボル ファイルにアクセスする必要があります。 詳細については、[シンボル (.pdb) ファイルとソース ファイル](../debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger.md)の指定に関する記事をご覧ください。

プロセスのファイルにアクセスできない場合は、 **[逆アセンブル]** ウィンドウを使用して移動できます。 詳細については、[[逆アセンブル] ウィンドウを使用する](../debugger/how-to-use-the-disassembly-window.md)」を参照してください。

### <a name="switch-between-processes"></a><a name="BKMK_Switch_between_processes"></a> プロセスの切り替え

デバッグ中には複数のプロセスにアタッチできますが、デバッガーでアクティブになっているプロセスは常に 1 つだけです。 **[デバッグの場所]** ツール バーまたは **[プロセス]** ウィンドウでアクティブまたは*現在*のプロセスを設定できます。 プロセス間で切り替えるには、両方のプロセスが中断モードであることが必要です。

**[デバッグの場所] ツール バーから現在のプロセスを設定するには:**

1. **[デバッグの場所]** ツール バーを開くには、 **[表示]**  >  **[ツール バー]**  >  **[デバッグの場所]** を選択します。

1. デバッグ中に、 **[デバッグの場所]** ツール バーで、 **[プロセス]** ドロップダウンから現在のプロセスとして設定するプロセスを選択します。

   ![プロセスを切り替える](../debugger/media/dbg_execution_switchbetweenmodules.png "DBG_Execution_SwitchBetweenModules")

**[プロセス] ウィンドウで現在のプロセスを設定するには:**

1. **[プロセス]** ウィンドウを開くには、デバッグ中に、 **[デバッグ]**  >  **[Windows]**  >  **[プロセス]** を選択します。

1. **[プロセス]** ウィンドウでは、現在のプロセスが黄色の矢印でマークされます。 現在のプロセスとして設定するプロセスをダブルクリックします。

   ![[プロセス] ウィンドウ](../debugger/media/dbg_processeswindow.png "DBG_ProcessesWindow")

あるプロセスに切り替えると、それがデバッグ対象の現在のプロセスとして設定されます。 デバッガーのウィンドウに現在のプロセスの状態が表示され、すべてのステップ実行コマンドは現在のプロセスにのみ影響を与えます。

## <a name="stop-debugging-with-multiple-processes"></a>複数のプロセスのデバッグを停止する

既定では、 **[デバッグ]**  >  **[デバッグの停止]** を選択すると、デバッガーが終了するか、またはすべてのプロセスからデタッチされます。

- 現在のプロセスがデバッガーで開始された場合、そのプロセスは終了されます。

- デバッガーを現在のプロセスにアタッチした場合、デバッガーはプロセスからデタッチされ、プロセスは実行中のままになります。

Visual Studio ソリューションからプロセスのデバッグを開始した後は、既に実行されている別のプロセスにアタッチした後、 **[デバッグの停止]** を選択すると、デバッグ セッションが終了します。 Visual Studio で開始されたプロセスは終了しますが、アタッチしたプロセスは引き続き実行されています。

**[デバッグの停止]** によって個々のプロセスがどのような影響をうけるかを制御するには、 **[プロセス]** ウィンドウでプロセスを右クリックし、 **[デバッグの停止時にデタッチ]** チェック ボックスをオンまたはオフにします。

>[!NOTE]
>**[1 つのプロセスが中断したときには、他のプロセスも中断する]** デバッガー オプションは、停止、終了、プロセスからのデタッチには影響を与えません。

### <a name="stop-terminate-and-detach-commands"></a>停止、終了、デタッチのコマンド

次の表では、複数のプロセスでのデバッガーの停止、終了、デタッチ コマンドの動作について説明します。

|**コマンド**|**説明**|
|-|-|
|**[デバッグ]**  >  **[デバッグの停止]**|**[プロセス]** ウィンドウで動作が変更されていない限り、デバッガーによって開始されたプロセスは終了され、アタッチされたプロセスはデタッチされます。|
|**[デバッグ]**  >  **[すべて中止]**|すべてのプロセスが終了されます。|
|**[デバッグ]**  >  **[すべてデタッチ]**|すべてのプロセスからデバッガーがデタッチされます。|
|**[プロセス]** ウィンドウ > **[プロセスのデタッチ]**|選択したプロセスからデバッガーがデタッチされます。<br />他のプロセスの既存の状態 (一時停止中または実行中) が維持されます。|
|**[プロセス]** ウィンドウ > **[プロセスの終了]**|選択したプロセスが終了されます。<br />他のプロセスの既存の状態 (一時停止中または実行中) が維持されます。|
|**[プロセス]** ウィンドウ > **[Detach when debugging stops]\(デバッグが停止したらデタッチする\)**|オンになっている場合は、 **[デバッグ]**  >  **[デバッグの停止]** を選択すると、選択されているプロセスからデタッチします。 <br />オフになっている場合、 **[デバッグ]**  >  **[デバッグの停止]** を選択すると、選択されているプロセスが終了します。 |

## <a name="see-also"></a>関連項目

- [シンボル (.pdb) とソース ファイルの指定](../debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger.md)
- [実行中のプロセスにアタッチする](../debugger/attach-to-running-processes-with-the-visual-studio-debugger.md)
- [デバッガーでのコード間の移動](../debugger/navigating-through-code-with-the-debugger.md)
- [Just-In-Time デバッグ](../debugger/just-in-time-debugging-in-visual-studio.md)
- [マルチスレッド アプリケーションのデバッグ](../debugger/debug-multithreaded-applications-in-visual-studio.md)