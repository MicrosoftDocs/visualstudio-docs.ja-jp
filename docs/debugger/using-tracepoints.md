---
title: デバッガーでトレースポイントを使用する |Microsoft Docs
ms.date: 9/4/2019
ms.topic: conceptual
helpviewer_keywords:
- tracepoints, about tracepoints
author: Sagar-S-S
ms.author: sashe
manager: AndSter
ms.workload:
- multiple
ms.openlocfilehash: fe9d96290474283164ed9761a0cb9aa7734f1a9d
ms.sourcegitcommit: 2db01751deeee7b2bdb1db25419ea6706e6fcdf8
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/17/2019
ms.locfileid: "71069032"
---
# <a name="use-tracepoints-in-the-visual-studio-debugger"></a>Visual Studio デバッガーでのトレースポイントの使用

トレースポイントを使用すると、コードの変更や停止を行わずに、構成可能な条件の下で出力ウィンドウに情報を記録できます。 この機能はマネージコードとネイティブコードの両方でサポートされています。またC#、JavaScript やなどのいくつかの言語でもサポートされています。

## <a name="let39s-take-an-example"></a>例&#39;を見てみましょう

次のサンプルプログラムは、ループ`for`が別の反復処理を実行するたびに1ずつ増加するカウンター変数を持つ単純なループです。

![カウンターの例](../debugger/media/counterexample.png "カウンターの例")

## <a name="set-tracepoints-in-source-code"></a>ソースコードでのトレースポイントの設定

トレースポイントを設定するには、 **[ブレークポイントの設定]** ウィンドウの **[アクション]** チェックボックスで出力文字列を指定します。

1. トレースポイントを初期化するには、まず、トレースポイントを設定する行番号の左側の余白をクリックします。

   ![ブレークポイントの初期化](../debugger/media/breakpointinitialization.png "ブレークポイントの初期化")

2. 赤い円の上にマウスポインターを移動し、歯車アイコンをクリックします。
3. **[ブレークポイントの設定]** ウィンドウが開きます。

   ![ブレークポイントウィンドウ](../debugger/media/breakpointwindow.png "ブレークポイントウィンドウ")

4. **[アクション]** チェックボックスをオンにします。

   ![[チェックされたアクション] ボックス](../debugger/media/checkedactionsbox.png "[チェックされたアクション] ボックス")

   赤い円がひし形に変わり、ブレークポイントからトレースポイントに切り替えたことを示します。

5. [**出力ウィンドウのメッセージを表示**する] ボックスに、ログインするメッセージを入力します (詳細については、この記事の後半のセクションを参照してください)。

   これで、トレースポイントが設定されました。 必要に応じ&quot;て [閉じる]ボタンをクリックすると、出力ウィンドウにいくつかの情報が記録されます。&quot;

6. メッセージを表示するかどうかを決定する条件を追加する場合は、 **[条件]** チェックボックスをオンにします。

   チェックされた![条件ボックス]チェックされた(../debugger/media/checkedconditionsbox.png "条件ボックス")

   条件には、次の3つの選択肢があります。**条件式**、**フィルター**、および**ヒットカウント**。

## <a name="actions-menu"></a>[アクション] メニュー

このメニューを使用すると、[出力] ウィンドウにメッセージを記録できます。 メッセージボックスに出力する文字列を入力します (引用符は必要ありません)。 変数の値を表示する場合は、中かっこで囲まれていることを確認してください。

たとえば、出力コンソールに`counter`変数の値を表示する場合は、[メッセージ] ボックスに「{counter}」と入力します。

![カウンターの出力メッセージ](../debugger/media/counteroutputmessage.png "カウンターの出力メッセージ")

**[閉じる]** をクリックし、プログラムをデバッグする (**F5 キーを押す**) と、出力ウィンドウに次の出力が表示されます。

![出力ウィンドウのアクションメッセージ](../debugger/media/actionsmessageinoutputwindow.png "出力ウィンドウのアクションメッセージ")

特別なキーワードを使用して、より具体的な情報を表示することもできます。 次に示すように、キーワードを正確に入力します (各キーワードの前に "$" を使用し、キーワード自体にはすべて大文字を使用します)。

| キーワード | 表示される内容 |
| --- | --- |
| $ADDRESS | 現在の命令 |
| $CALLER | 関数名の呼び出し |
| $CALLSTACK | [呼び出し履歴] |
| $FUNCTION | 現在の関数名 |
| $PID | プロセス ID |
| $PNAME | プロセス名 |
| $TID | スレッド ID |
| $TNAME   | スレッド名 |
| $TICK | ティック数 (Windows GetTickCount から) |

## <a name="conditions-menu"></a>[条件] メニュー

条件を使用すると、出力メッセージをフィルター処理できるため、特定のシナリオでのみ表示されます。 使用できる条件には、3つの主要な種類があります。

### <a name="conditional-expression"></a>条件式
条件式では、特定の条件が満たされた場合にのみ出力メッセージが表示されます。

条件式では、特定の条件が true の場合、または変更された場合に、メッセージを出力するようにトレースポイントを設定できます。 たとえば、 `for`ループの反復処理中にカウンターの値のみを表示する場合は、 **[true]** オプションを選択し、メッセージテキストボックスに`i%2 == 0` 「」と入力します。

![条件式が True です](../debugger/media/conditionalexpressionistrue.png "条件式が True です")

`for`ループの反復が変化したときに counter の値を印刷する場合は、 **[変更された場合]** オプションを選択し、メッセージテキストボックスに「」と入力`i`します。

![変更時の条件式](../debugger/media/conditionalexpressionwhenchanged.png "変更時の条件式")


**[変更された場合]** オプションの動作は、プログラミング言語によって異なります。

- ネイティブコードの場合、デバッガーは条件の最初の評価を変更と見なしません。そのため、最初の評価ではトレースポイントにヒットしません。
- マネージコードの場合、デバッガーは、[変更された**場合**] が選択された後の最初の評価でトレースポイントにヒットします。

条件の設定時に使用できる有効な式の詳細については、「[デバッガーの式](expressions-in-the-debugger.md)」を参照してください。

### <a name="hit-count"></a>ヒットカウント
ヒットカウント条件を使用すると、トレースポイントが設定されているコード行が指定された回数だけ実行された後にのみ、出力を送信できます。

[ヒットカウント] では、トレースポイントが設定されているコード行が、に等しいか、の倍数であるか、または指定されたヒットカウント値以上の場合に、メッセージを出力するように選択できます。 ニーズに最も適したオプションを選択し、目的のイテレーションを表すフィールド (たとえば、5) に整数値を入力します。

![条件式のヒットカウント](../debugger/media/conditionalexpressionhitcount.png "条件式のヒットカウント")

### <a name="filter"></a>Assert
フィルター条件として、に表示されるデバイス、プロセス、またはスレッドの出力を指定します。

![条件式フィルター](../debugger/media/conditionalexpressionfilter.png "条件式フィルター")

フィルター式の一覧:

- MachineName = "name"
- ProcessId = value
- ProcessName = "name"
- ThreadId = value
- ThreadName = "name"

文字列 (名前など) を二重引用符で囲みます。 値は、引用符なしで入力できます。 句は`&` 、(`AND`)、 `||` (`OR`)、 `!` (`NOT`)、およびかっこを使用して結合できます。

## <a name="considerations"></a>考慮事項

トレースポイントは、クリーンでスムーズなエクスペリエンスを実現することを目的としていますが、使用するタイミングに注意する必要がある考慮事項がいくつかあります。

オブジェクトのプロパティまたは属性を検査するときに、その値が変化することがあります。 これは、トレースポイント機能自体に起因するバグではありませんが、トレースポイントを使用してオブジェクトを検査することで、これらの偶発的な変更を回避することはできません。

**アクション**メッセージボックスで式を評価する方法は、現在開発に使用している言語とは異なる場合があります。 たとえば、文字列を出力する場合、通常はまたは`Debug.WriteLine()` `console.log()`を使用している場合でも、メッセージを引用符で囲む必要はありません。 また、出力式の中かっこ`{ }`構文 () は、開発言語で値を出力する場合とは異なる場合もあります。 (ただし、中かっこ (`{ }`) 内の内容は、開発言語の構文を使用して記述する必要があります)。
