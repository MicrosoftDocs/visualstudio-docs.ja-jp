---
title: デバッガでブレークポイントを使用する |マイクロソフトドキュメント
ms.custom: ''
ms.date: 10/28/2019
ms.topic: conceptual
f1_keywords:
- vs.debug.breakpointswin
- vs.debug.disassembly.insert
- vs.debug.sourcewin.edit
- vs.debug.file
- vs.debug.breakpt.new
- vs.debug.whenbreakpointishit
- vs.debug.breakpt.location.address
- vs.debug.breakpt.constraints
- vs.debug.breakpoints.delete
- vs.debug.breakpt.location.data
- vc.breakpoints
- vs.debug.breakpt.condition
- vs.debug.breakpt.location.function
- vs.debug.breakpoints
- vs.debug.menu.insert
- vs.debug.filenames
- vs.debug.breakpt.action
- vs.debug.sourcewin.insert
- vs.debug.address
- vs.debug.data
- vs.debug.func
- vs.debug.breakpt.location.file
helpviewer_keywords:
- breakpoints, about breakpoints
ms.assetid: 020b2e97-3b3e-4b2c-872d-b5c6025e120e
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: a6a8ee96834fc20186ba6719a7c4f377fea45d6b
ms.sourcegitcommit: 95f26af1da51d4c83ae78adcb7372b32364d8a2b
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/13/2020
ms.locfileid: "79301027"
---
# <a name="use-breakpoints-in-the-visual-studio-debugger"></a>Visual Studio デバッガーでブレークポイントを使用する

ブレークポイントは、開発者のツールボックスで最も重要なデバッグ手法の 1 つです。 ブレークポイントは、デバッガーの実行を一時停止する場合に設定します。 たとえば、コード変数の状態を確認したり、特定のブレークポイントで呼び出し履歴を確認したりできます。  ブレークポイントを使用しているときに警告または問題を解決しようとしている場合は[、「Visual Studio デバッガーでのブレークポイントのトラブルシューティング」](../debugger/troubleshooting-breakpoints.md)を参照してください。

> [!NOTE]
> 解決しようとしているタスクまたは問題がわかっているが、使用するブレークポイントの種類を知る必要がある場合は、「[デバッグ タスクを見つける](../debugger/find-your-debugging-task.md#pause-running-code)」を参照してください。

## <a name="set-breakpoints-in-source-code"></a><a name="BKMK_Overview"></a>ソース コードにブレークポイントを設定する

ブレークポイントは、実行可能ファイルの任意のコード行に設定できます。 たとえば、次の C# コードでは、変数宣言、ループ、またはループ内の任意`for`のコードにブレークポイントを`for`設定できます。 名前空間またはクラスの宣言、またはメソッド シグネチャにブレークポイントを設定することはできません。

ソース コードにブレークポイントを設定するには、コード行の横にある左端の余白をクリックします。 行を選択して**F9**キーを押すか、[**ブレークポイントのデバッグ** > **Toggle Breakpoint**] を選択するか、右クリックして [**ブレークポイント** > **の挿入**] を選択することもできます。 ブレークポイントは、左マージンに赤い点で表示されます。

C# を含むほとんどの言語では、ブレークポイントと現在の実行行が自動的に強調表示されます。 C++ コードの場合は、[**ツール**] (または **[デバッグ****]** > ) を選択してブレークポイントと現在の行の強調表示を有効に> オプション**デバッグ** >  **ブレークポイントと現在のステートメントのソース行全体を強調表示 (C++ のみ)** を選択します。

![ブレークポイントを設定する](../debugger/media/basicbreakpoint.png "基本的なブレークポイント")

デバッグを行うと、その行のコードが実行される前に、ブレークポイントで実行が停止します。 ブレークポイントシンボルは黄色の矢印を示します。

次の例のブレークポイントでは、値`testInt`は 1 です。 したがって、黄色のステートメントがまだ実行されていないため、変数が初期化されて (値が 1 に設定された) 後も値は変更されていません。

![実行が停止されているブレークポイント](../debugger/media/breakpointexecution.png "ブレークポイントの実行")

デバッガーがブレークポイントで停止すると、[変数値](../debugger/debugger-feature-tour.md#inspect-variables-with-data-tips)や[呼び出し履歴](../debugger/how-to-use-the-call-stack-window.md)など、アプリの現在の状態を確認できます。

ブレークポイントを操作するための一般的な手順を次に示します。

- ブレークポイントはトグルです。 このボタンをクリックするか **、F9**キーを押すか、[**ブレークポイントのデバッグ** > **]** を使用して、削除または再挿入することができます。

- ブレークポイントを削除せずに無効にするには、ブレークポイントの上にマウス ポインターを合わせるか右クリックし、[**ブレークポイントを無効にする**] を選択します。 無効にしたブレークポイントは、左マージンまたは**ブレークポイント**ウィンドウに空のドットとして表示されます。 ブレークポイントを再度有効にするには、ブレークポイントにカーソルを合わせるか右クリックし、[**ブレークポイントを有効にする**] を選択します。

- 条件とアクションの設定、ラベルの追加と編集、ブレークポイントのエクスポートを行う場合は、ブレークポイントを右クリックして適切なコマンドを選択するか、ブレークポイントの上にマウスカーソルを置いて **[設定]** アイコンを選択します。

## <a name="breakpoint-actions-and-tracepoints"></a><a name="BKMK_Print_to_the_Output_window_with_tracepoints"></a>ブレークポイントアクションとトレースポイント

*トレースポイント*は、**出力**ウィンドウにメッセージを出力するブレークポイントです。 トレースポイントは、プログラミング言語の一時的なトレースステートメントのように動作し、コードの実行を一時停止しません。 トレースポイントを作成するには、[**ブレークポイントの設定]** ウィンドウで特別なアクションを設定します。 詳細な手順については、「 [Visual Studio デバッガーでトレースポイントを使用する](../debugger/using-tracepoints.md)」を参照してください。

## <a name="breakpoint-conditions"></a>ブレークポイント条件

条件を設定して、ブレークポイントを実行するタイミングと場所を制御することができます。 条件は、デバッガーが認識する有効な式であればどれでも指定できます。 有効な式の詳細については、「[デバッガーでの式](../debugger/expressions-in-the-debugger.md)」を参照してください。

**ブレークポイント条件を設定するには**

1. ブレークポイント シンボルを右クリックし、[**条件 ]** を選択します。 または、ブレークポイントシンボルの上にマウスを移動し、[**設定]** アイコンを選択し、[**ブレークポイントの設定]** ウィンドウで **[条件**] を選択します。

   ブレークポイントを右クリックして [設定] を選択し、[**条件**] を選択して、[**ブレークポイント****]** ウィンドウで条件を設定することもできます。

   ![[ブレークポイント設定]](../debugger/media/breakpointsettings.png "ブレークポイント設定")

2. ドロップダウンで、[**条件式**]、[**ヒット カウント**]、[**フィルタ**] の順に選択し、それに応じて値を設定します。

3. [**閉じる**] を選択するか **、Ctrl キーを押して**+**Enter** **[ブレークポイントの設定]** ウィンドウを閉じます。 または、[**ブレークポイント]** ウィンドウで **[OK] を**選択してダイアログを閉じます。

条件が設定されたブレークポイントは、**+** ソース コードおよび**ブレークポイント**ウィンドウにシンボルとともに表示されます。

<a name="BKMK_Specify_a_breakpoint_condition_using_a_code_expression"></a>
### <a name="create-a-conditional-expression"></a>条件式を作成する

**[条件式**] を選択すると **、[True]** または [**変更時**] の 2 つの条件を選択できます。 式が満たされたときに中断する場合**は [True]** を、式の値が変更されたときに中断するように**変更する場合**を選択します。

次の例では、ブレークポイントは、値`testInt`が**4**の場合にのみヒットします。

![[ブレークポイントの条件] が true](../debugger/media/breakpointconditionistrue.png "ブレークポイントが true")

次の例では、ブレークポイントは`testInt`、値が変更された場合にのみヒットします。

![ブレークポイント 変更時](../debugger/media/breakpointwhenchanged.png "ブレークポイント 変更時")

無効な構文でブレークポイント条件を設定すると、警告メッセージが表示されます。 有効な構文でブレークポイント条件を指定しても、セマンティクスが無効な場合は、ブレークポイントに初めて達したときに警告メッセージが表示されます。 いずれの場合も、デバッガーは無効なブレークポイントに達すると中断します。 ブレークポイント条件が有効で、評価結果が `false`の場合にのみ、ブレークポイントはスキップされます。

>[!NOTE]
>「**変更時**」フィールドの動作は、プログラミング言語によって異なります。
>- ネイティブ コードの場合、デバッガーは条件の最初の評価を変更とは見なさないため、最初の評価でブレークポイントにヒットしません。
>- マネージ コードの場合、[**変更時**] が選択された後、最初の評価でデバッガーがブレークポイントにヒットします。

<a name="using-object-ids-in-breakpoint-conditions-c-and-f"></a>
### <a name="use-object-ids-in-conditional-expressions-c-and-f-only"></a>条件式でオブジェクト ID を使用する (C# および F# のみ)

 特定のオブジェクトの動作を観察する必要がある場合があります。 たとえば、オブジェクトがコレクションに複数回挿入された理由を調べる場合があります。 C# および F# では、[参照型](/dotnet/csharp/language-reference/keywords/reference-types)の特定のインスタンスのオブジェクト ID を作成し、ブレークポイント条件で使用できます。 オブジェクト ID は、共通言語ランタイム (CLR) のデバッグ サービスで生成されて、オブジェクトに関連付けられます。

**オブジェクト ID を作成するには:**

1. オブジェクトが作成された後、コード内のブレークポイントを設定します。

2. デバッグを開始し、ブレークポイントで実行が一時停止したら **、[Windows** > **ローカルの****デバッグ** > ] または **[Alt**+**4]** を選択して **[ローカル**] ウィンドウを開きます。

   [**ローカル**] ウィンドウで特定のオブジェクト インスタンスを見つけ、右クリックして [**オブジェクト ID の作成**] を選択します。

   **[ローカル**]**$** ウィンドウにプラスの数字が表示されます。 これが、オブジェクト ID です。

3. 調査するポイントに新しいブレークポイントを追加します。たとえば、オブジェクトをコレクションに追加する場合などです。 ブレークポイントを右クリックし、**[条件]** を選択します。

4. **[条件式**] フィールドでオブジェクト ID を使用します。 たとえば、変数`item`がコレクションに追加するオブジェクトである場合**は、[true]** を選択し **、item ==\<$n>**> を\<入力します。

   そのオブジェクトがコレクションに追加されると、実行が停止します。

   オブジェクト ID を削除するには、[**ローカル]** ウィンドウで変数を右クリックし、[**オブジェクト ID**の削除] を選択します。

> [!NOTE]
> オブジェクト ID による参照は弱参照であり、これによって、オブジェクトがガベージ コレクションの対象から外れることはありません。 オブジェクト ID は、現在のデバッグ セッションでのみ有効です。

### <a name="set-a-hit-count-condition"></a>ヒットカウント条件の設定

コード内のループが一定の反復数の後に不適切な状態を開始する可能性がある場合は、その反復処理に達するために繰り返し**F5**キーを押す必要がなくなり、そのヒット数の後に実行を停止するようにブレークポイントを設定できます。

[**ブレークポイントの設定]** ウィンドウの **[条件**] で 、[**ヒット カウント**] を選択し、反復回数を指定します。 次の例では、ブレークポイントは、他のすべての反復でヒットするように設定されています。

![ブレークポイントのヒット カウント](../debugger/media/breakpointhitcount.png "ブレークポイントヒットカウント")

### <a name="set-a-filter-condition"></a>フィルタ条件の設定

指定されたデバイスでのみ、または指定されたプロセスとスレッドでのみ、ブレークポイントが発生するように制限できます。

[**ブレークポイントの設定]** ウィンドウの **[条件**] で 、[**フィルタ**] を選択し、次の式の 1 つ以上を入力します。

- MachineName = "name"
- ProcessId = value
- ProcessName = "name"
- ThreadId = value
- ThreadName = "name"

文字列の値を二重引用符で囲みます。 句は、 `&` (AND)、 `||` (OR)、 `!` (NOT)、およびかっこを使用して結合できます。

## <a name="set-function-breakpoints"></a><a name="BKMK_Set_a_breakpoint_in_a_source_file"></a>関数ブレークポイントの設定

関数が呼び出されたときに実行を中断できます。 これは、関数名はわかっても、その場所は知らない場合などに便利です。 また、同じ名前の関数があり、それらすべてを分割する場合にも便利です (オーバーロードされた関数や異なるプロジェクトの関数など)。

**関数ブレークポイントを設定するには**

1. [**Debug** > **新しいブレークポイント** > **関数ブレークポイント**のデバッグ] を選択するか **、Alt**+**F9** > **Ctrl**+**B**を押します。

   [ブレークポイント] ウィンドウで **[新しい** > **関数ブレークポイント****]** を選択することもできます。

1. [**新しい関数ブレークポイント**]ダイアログで、[関数名]ボックスに**関数名**を入力します。

   関数の指定を絞り込むには、次の手順に従います。

   - 完全修飾関数名を使用します。

     例: `Namespace1.ClassX.MethodA()`

   - オーバーロードされた関数のパラメーターの型を追加します。

     例: `MethodA(int, string)`

   - '!' 記号を使用してモジュールを指定します。

     例: `App1.dll!MethodA`

   - ネイティブ C++ でコンテキスト演算子を使用します。

     `{function, , [module]} [+<line offset from start of method>]`

     例: `{MethodA, , App1.dll}+2`

1. [**言語**] ドロップダウンで、関数の言語を選択します。

1. **[OK]** を選択します。

### <a name="set-a-function-breakpoint-using-a-memory-address-native-c-only"></a>メモリ アドレスを使用して関数ブレークポイントを設定する (ネイティブ C++ のみ)
 オブジェクトのアドレスを使用して、クラスの特定のインスタンスによって呼び出されるメソッドに関数ブレークポイントを設定できます。  たとえば、アドレス指定可能なオブジェクト`my_class`型を指定すると、インスタンスが呼び出すメソッド`my_method`に関数ブレークポイントを設定できます。

1. クラスのインスタンスがインスタンス化された後、どこかにブレークポイントを設定します。

2. インスタンスのアドレスを検索します (たとえば、 `0xcccccccc`)。

3. [**Debug** > **新しいブレークポイント** > **関数ブレークポイント**のデバッグ] を選択するか **、Alt**+**F9** > **Ctrl**+**B**を押します。

4. [**関数名**] ボックスに次の項目を追加し **、[C++** 言語] を選択します。

   ```cpp
   ((my_class *) 0xcccccccc)->my_method
   ```

::: moniker range=">= vs-2019"

## <a name="set-data-breakpoints-net-core-30-or-higher"></a><a name="BKMK_set_a_data_breakpoint_managed"></a>データ ブレークポイントの設定 (.NET Core 3.0 以降)

データ ブレークポイントは、特定のオブジェクトのプロパティが変更されたときに実行を中断します。

**データ ブレークポイントを設定するには**

1. NET Core プロジェクトでデバッグを開始し、ブレークポイントに達するまで待ちます。

2. [**自動**]、[**ウォッチ**]、または **[ローカル]** ウィンドウで、プロパティを右クリックし、コンテキスト メニューの **[値が変更されたときにブレーク**] を選択します。

    ![マネージ データ ブレークポイント](../debugger/media/managed-data-breakpoint.png "マネージ データ ブレークポイント")

NET Core のデータ ブレークポイントは、次の場合は機能しません。

- ツールヒント、ローカル、自動、またはウォッチ ウィンドウで展開できないプロパティ
- 静的変数
- クラスを使用して、デバッガーの種類プロキシ属性
- 構造体の内部のフィールド

::: moniker-end

## <a name="set-data-breakpoints-native-c-only"></a><a name="BKMK_set_a_data_breakpoint_native_cplusplus"></a>データ ブレークポイントの設定 (ネイティブ C++ のみ)

 データ ブレークポイントは、指定したメモリ アドレスに格納されている値が変更されると実行を中断します。 値が読み取られても変更されていなければ、実行は中断されません。

**データ ブレークポイントを設定するには**

1. C++ プロジェクトでデバッグを開始し、ブレークポイントに達するまで待ちます。 [**デバッグ**] メニューの [**新しいブレークポイント** > **データ ブレークポイント]** を選択します。

    また、[**ブレークポイント**] ウィンドウで **[新しい** > **データ ブレークポイント**] を選択するか、**または [自動**変数]、[**ウォッチ**] 、または **[ローカル**] ウィンドウで項目を右クリックし、コンテキスト メニューの **[値が変更されたときにブレーク**] を選択することもできます。

2. [**アドレス]** ボックスに、メモリ アドレス、またはメモリ アドレスに評価される式を入力します。 たとえば、「 `&avar` 」と入力すると、変数 `avar` の値が変更されたときに中断します。

3. **[バイト数]** ドロップダウンで、デバッガーがウォッチするバイト数を選択します。 たとえば、 **[4]** を選択すると、 `&avar` で始まる 4 バイトがウォッチされ、そのバイト値のいずれかが変更されると中断します。

データ ブレークポイントは、次の条件では機能しません。
- デバッグ対象外のプロセスがメモリ位置に書き込む場合
- メモリ位置が 2 つ以上のプロセス間で共有されている場合
- メモリ位置がカーネル内で更新される場合 たとえば、メモリが 32 ビット Windows`ReadFile`関数に渡された場合、メモリはカーネル モードから更新されるため、デバッガーは更新時に中断しません。
- ウォッチ式が 32 ビットハードウェアでは 4 バイトより大きく、64 ビットハードウェアでは8バイトより大きい。 これは、x86 アーキテクチャの制限です。

> [!NOTE]
> - データ ブレークポイントは、特定のメモリ アドレスによって異なります。 変数のアドレスはデバッグ セッションごとに変わるため、各デバッグ セッションの終了時にデータ ブレークポイントが自動的に無効になります。
>
> - ローカル変数にデータ ブレークポイントを設定すると、関数が終了してもブレークポイントは有効なままですが、メモリ アドレスは変更されるので、ブレークポイントは予測どおりに機能しなくなります。 ローカル変数にデータ ブレークポイントを設定する場合は、関数が終了する前にブレークポイントを削除または無効にする必要があります。

## <a name="manage-breakpoints-in-the-breakpoints-window"></a><a name="BKMK_Specify_advanced_properties_of_a_breakpoint_"></a>[ブレークポイント] ウィンドウでブレークポイントを管理する

 **[ブレークポイント**] ウィンドウを使用して、ソリューション内のすべてのブレークポイントを表示および管理できます。 この一元的な場所は、大規模なソリューションや、ブレークポイントが重要な複雑なデバッグ シナリオで特に役立ちます。

**「ブレークポイント」** ウィンドウでは、ブレークポイントの検索、並べ替え、フィルター処理、有効/無効、または削除を行うことができます。 条件やアクションを設定したり、新しい関数またはデータ ブレークポイントを追加したりすることもできます。

**[ブレークポイント**] ウィンドウを開くには**Debug** > **、[Windows** > **ブレークポイント**のデバッグ] を選択するか **、Alt**+**F9**キーまたは**Ctrl**+Ctrl Alt**B**キー**を**+押します。

![ブレークポイント ウィンドウ](../debugger/media/breakpointswindow.png "[ブレークポイント] ウィンドウ")

**[ブレークポイント]** ウィンドウに表示する列を選択するには、[**列の表示]** を選択します。 列ヘッダーを選択して、その列でブレークポイントの一覧を並べ替えます。

### <a name="breakpoint-labels"></a><a name="BKMK_Set_a_breakpoint_at_a_function_return_in_the_Call_Stack_window"></a>ブレークポイントラベル
ラベルを使用して、[ブレークポイント] ウィンドウでブレークポイントの一覧を並べ替えたり、フィルタ**処理**したりできます。

1. ブレークポイントにラベルを追加するには、ソース コードまたは [ブレークポイント] ウィンドウで**ブレークポイント**を右クリックし、[ラベルの**編集**] を選択します。 新しいラベルを追加するか、既存のラベルを選択して **、[OK] を**選択します。
2. **[ブレークポイント**] ウィンドウで [ラベル]、[**条件**] 、またはその他の列ヘッダーを選択して **、ブレークポイント**の一覧を並べ替えます。 ツールバーの「列を表示」を選択すると、表示する**列**を選択できます。

### <a name="export-and-import-breakpoints"></a>ブレークポイントをエクスポートおよびインポートする
 ブレークポイントの状態と場所を保存または共有するには、ブレークポイントをエクスポートまたはインポートします。

- 単一のブレークポイントを XML ファイルにエクスポートするには、ソース コードまたは**ブレークポイント**ウィンドウでブレークポイントを右クリックし、**エクスポートまたは選択した****エクスポート**を選択します。 エクスポート場所を選択し、[**保存**] を選択します。 既定の場所はソリューション フォルダーです。
- 複数のブレークポイントをエクスポートするには、[**ブレークポイント]** ウィンドウで、ブレークポイントの横にあるボックスを選択するか、[**検索**] フィールドに検索条件を入力します。 [**現在の検索条件に一致するすべてのブレークポイントをエクスポート]** アイコンを選択し、ファイルを保存します。
- すべてのブレークポイントをエクスポートするには、すべてのボックスの選択を解除し、**検索**フィールドを空白のままにします。 [**現在の検索条件に一致するすべてのブレークポイントをエクスポート]** アイコンを選択し、ファイルを保存します。
- ブレークポイントをインポートするには、[**ブレークポイント]** ウィンドウで [**ファイルからブレークポイントをインポート**] アイコンを選択し、XML ファイルの場所に移動して [**開く**] を選択します。

## <a name="set-breakpoints-from-debugger-windows"></a><a name="BKMK_Set_a_breakpoint_from_debugger_windows"></a>デバッガー ウィンドウからブレークポイントを設定する

[**呼び出し履歴**] ウィンドウと [**逆アセンブリ]** デバッガー ウィンドウからブレークポイントを設定することもできます。

### <a name="set-a-breakpoint-in-the-call-stack-window"></a>[呼び出し履歴] ウィンドウにブレークポイントを設定する

 呼び出し元の関数が返す命令または行を中断するには、[**呼び出し履歴**] ウィンドウにブレークポイントを設定します。

**[呼び出し履歴] ウィンドウでブレークポイントを設定するには、次の手順を実行します。**

1. **[呼び出し履歴**] ウィンドウを開くには、デバッグ中に一時停止する必要があります。  > [Windows**呼び出し履歴****のデバッグ** > **Windows**] をクリックするか **、Ctrl**+Alt**C**キー**を**+押します。

2. [**呼び出し履歴**] ウィンドウで、呼び出**Breakpoint** > し元の関数を右クリックし、[**ブレークポイント挿入ブレークポイント**] を選択するか **、F9**キーを押します。

   ブレークポイント シンボルは、呼び出し履歴の左マージンの関数呼び出し名の横に表示されます。

呼び出し履歴ブレークポイントは、関数内の次の実行可能命令に対応するメモリの場所を持つアドレスとして **、[ブレークポイント]** ウィンドウに表示されます。

デバッガは命令で中断します。

呼び出し履歴の詳細については、「[方法 : 呼び出し履歴ウィンドウを使用する](../debugger/how-to-use-the-call-stack-window.md)」を参照してください。

コードの実行中にブレークポイントを視覚的にトレースするには、[デバッグ中に呼び出し履歴にメソッドをマップする](../debugger/map-methods-on-the-call-stack-while-debugging-in-visual-studio.md)を参照してください。

### <a name="set-a-breakpoint-in-the-disassembly-window"></a>[逆アセンダ] ウィンドウにブレークポイントを設定する

1. **[逆アセンブリ**] ウィンドウを開くには、デバッグ中に一時停止する必要があります。  > [Windows**逆アセンブル**の**デバッグ** > **Windows**] を選択するか **、Alt キーを押**+**します。**

2. [**逆アセンブル]** ウィンドウで、中断する命令の左余白をクリックします。 また、このオプションを選択して**F9**キーを押すか、**Breakpoint**右クリックして [ > **ブレークポイントの挿入**] を選択することもできます。

## <a name="see-also"></a>関連項目

- [デバッグとは](../debugger/what-is-debugging.md)
- [Visual Studio を使用して、より優れた C# コードを記述する](../debugger/write-better-code-with-visual-studio.md)
- [まずデバッグを見る](../debugger/debugger-feature-tour.md)
- [デバッグのトラブルシューティングを行う Visual Studio デバッガーのブレークポイント](../debugger/troubleshooting-breakpoints.md)
