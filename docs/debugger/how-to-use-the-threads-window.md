---
title: マルチ スレッド アプリをデバッグします。
description: スレッド ウィンドウと、デバッグの場所 ツールバーを使用して、Visual Studio のデバッグします。
ms.date: 11/21/2018
ms.topic: conceptual
dev_langs:
- CSharp
- VB
- FSharp
- C++
helpviewer_keywords:
- multithreaded debugging, tutorial
- tutorials, multithreaded debugging
ms.assetid: adfbe002-3d7b-42a9-b42a-5ac0903dfc25
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: a993dced9be0d5c213c12ae5e40f83be45a537b4
ms.sourcegitcommit: 2193323efc608118e0ce6f6b2ff532f158245d56
ms.translationtype: MTE95
ms.contentlocale: ja-JP
ms.lasthandoff: 01/25/2019
ms.locfileid: "54952668"
---
# <a name="walkthrough-debug-a-multithreaded-app-using-the-threads-window-c-visual-basic-c"></a>チュートリアル: [スレッド] ウィンドウを使用してマルチ スレッド アプリのデバッグ (C#、Visual Basic、C++)

いくつかの Visual Studio ユーザー インターフェイス要素では、マルチ スレッド アプリケーションをデバッグするのに役立ちます。 この記事には、コード エディター ウィンドウで、マルチ スレッドのデバッグ機能が導入されています**デバッグの場所**ツールバー、および**スレッド**ウィンドウ。 マルチ スレッド アプリケーションをデバッグするためには、その他のツールについては、次を参照してください。[マルチ スレッド アプリケーションのデバッグの開始](../debugger/get-started-debugging-multithreaded-apps.md)します。 
  
このチュートリアルを完了して、はわずか数分をかかります、マルチ スレッド アプリケーションのデバッグの基本について説明します。

## <a name="create-a-multithreaded-app-project"></a>マルチ スレッド アプリ プロジェクトを作成します。  

このチュートリアルで使用する次のマルチ スレッド アプリ プロジェクトを作成します。 
  
1. Visual Studio で、**[ファイル]** > **[新規作成]** > **[プロジェクト]** の順に選択します。  
   
1. **[新しいプロジェクト]** ダイアログ ボックスで、次の手順を行います。
   - C#アプリで、 **Visual C#**    > **コンソール アプリ (.NET Framework)** します。  
   - C++ アプリでは、次のように選択します。 **Visual c** > **Windows コンソール アプリケーション**します。
   
1. MyThreadWalkthroughApp、アプリの名前を指定し、選択**OK**します。  
   
   新しいプロジェクトに表示されます**ソリューション エクスプ ローラー**、というソース ファイルと*Program.cs*または*MyThreadWalkthroughApp.cpp*ソース コード ウィンドウで開きます。  
   
1. ソース ファイル内のコードを置き換える、C#または C++ の例のコードから[マルチ スレッド アプリケーションのデバッグの開始](../debugger/get-started-debugging-multithreaded-apps.md)します。  
   
1. 選択**ファイル** > **すべて保存**します。  
  
## <a name="start-debugging"></a>[デバッグ開始] 

1. ソース コードでは、次の行を探します。  
   
   ```csharp  
   Thread.Sleep(3000); 
   Console.WriteLine();
   ```  
   
   ```C++ 
   Thread::Sleep(3000); 
   Console.WriteLine(); 
   ```
   
1. ブレークポイントを設定、`Console.WriteLine();`行の左側の余白をクリックすると、行を選択してキーを押してによって**F9**します。  
   
   ブレークポイントは、コード行の横にある左側の余白に赤い円として表示されます。  
   
1. 選択**デバッグ** > **デバッグの開始**、またはキーを押します**F5**します。  
   
   アプリがデバッグ モードで起動し、ブレークポイントで一時停止します。  
   
1. 中断モードで開き、**スレッド**ウィンドウを選択して**デバッグ** > **Windows** > **スレッド**します。 デバッグ セッションを開くか、参照である必要があります、**スレッド**や他のデバッグ ウィンドウ。 
   
## <a name="examine-thread-markers"></a>スレッド マーカーを調べる

1. ソース コードでは、検索、`Console.WriteLine();`行。 
   
   1. 右クリックし、**スレッド**ウィンドウ、および選択**ソース スレッドを表示**![ソース スレッドを表示](../debugger/media/dbg-multithreaded-show-threads.png "ThreadMarker") メニューから。
   
   ソース コードの横にある余白の線のようになりましたが表示されます、*スレッド マーカー*アイコン![スレッド マーカー](../debugger/media/dbg-thread-marker.png "スレッド マーカー")します。 スレッド マーカーは、スレッドが停止している位置を示します。 位置に 1 つ以上停止したスレッドがある場合、![複数のスレッド](../debugger/media/dbg-multithreaded-show-threads.png "複数のスレッド")アイコンが表示されます。
   
1. スレッド マーカーの上にポインターを置きます。 停止したスレッドまたはスレッドの名前とスレッド ID 番号を示す、データヒントが表示されます。 スレッド名可能性があります`<No Name>`します。  

   >[!TIP]
   >名前のないスレッドを識別する名前を変更できますで、**スレッド**ウィンドウ。 スレッドを右クリックして**の名前を変更**します。
  
1. ショートカット メニューの 利用可能なオプションを表示するソース コードでスレッド マーカーを右クリックします。 

## <a name="flag-and-unflag-threads"></a>スレッドに対するフラグの設定と設定解除を行う 

特に注意するスレッドを追跡するスレッドのフラグを設定することができます。 

フラグを設定し、またはソース コード エディターからのスレッドのフラグ解除、**スレッド**ウィンドウ。 フラグが設定されたスレッド、またはすべてのスレッドのみを表示するかどうかを選択して、**デバッグの場所**または**スレッド**ウィンドウのツールバー。 任意の場所から選択内容では、すべての場所に影響します。 

### <a name="flag-and-unflag-threads-in-source-code"></a>フラグを設定し、ソース コード内のスレッドのフラグを解除 

1. 開く、**デバッグの場所**を選択してツールバー**ビュー** > **ツールバー** > **デバッグの場所**します。 ツールバー領域で右クリックして**デバッグの場所**します。 
   
1. **デバッグの場所**ツールバーが 3 つのフィールド。**プロセス**、**スレッド**、および**のスタック フレーム**します。 ドロップダウン リスト、**スレッド**一覧、およびスレッドの数に注意してください。 **スレッド**で現在実行中のスレッドがマークされている、リスト、 **>** シンボル。 
   
1. ソース コード ウィンドウの余白で、スレッド マーカーのアイコンをポイントし、データヒントで、フラグ アイコン (または空のフラグ アイコンのいずれか) を選択します。 フラグ アイコンが赤に変わります。 
   
   また、スレッド マーカーのアイコンを右クリックすることもできます。 をポイント**フラグ**、し、スレッドにフラグを設定、ショートカット メニューから選択します。  
   
1. **デバッグの場所**ツールバーで、**フラグが設定されたスレッドのみを表示する**アイコン![フラグが設定されたスレッドを表示する](../debugger/media/dbg-threads-show-flagged.png "フラグが設定されたスレッドを表示する")には、右、**スレッド**フィールド。 1 つまたは複数のスレッドのフラグが設定されていない場合、アイコンは淡色表示されます。  
   
   フラグが設定されたスレッドのみが表示されます、**スレッド**ツールバーのドロップダウンでします。 すべてのスレッドを再度表示するには、選択、**フラグが設定されたスレッドのみを表示する**アイコンをもう一度です。
   
   >[!TIP]
   >コード エディターを右クリックし、クリックし、カーソルを配置するにはいくつかのスレッドのフラグを設定した後に**カーソルにフラグが設定されたスレッドの実行**します。 すべてのスレッドのフラグが設定するコードに到達を選択してください。 **フラグが設定されたスレッドをカーソル位置まで実行**は選択した行で実行の順序を制御しやすく、コードのスレッドを一時停止[スレッドの凍結と凍結解除](#bkmk_freeze)します。
   
1. 現在実行中のスレッドのフラグが設定されたまたはフラグの状態を切り替えるには、1 つのフラグを選択します**現在スレッドのフラグ付きの状態を切り替え**の左側に、ツール バー ボタン、**フラグが設定されたスレッドのみを表示する**。ボタンをクリックします。 現在のスレッドに対するフラグの設定は、フラグが設定されたスレッドのみが表示されているときに、現在のスレッドを検索するために役立ちます。 
   
1. スレッドのフラグを解除するソース コードでスレッド マーカーをポイントし、オフにして、またはスレッド マーカーを右クリックし、選択する赤いフラグ アイコンを選択**フラグ解除**します。  

### <a name="flag-and-unflag-threads-in-the-threads-window"></a>フラグを設定し、[スレッド] ウィンドウ内のスレッドのフラグを解除 

**スレッド**ウィンドウで、フラグが設定されたスレッドにある赤いフラグ、スレッドのフラグなしに、横にアイコンを表示されている場合、空のアイコンがあります。

![スレッド ウィンドウ](../debugger/media/dbg-threads-window.png "スレッド ウィンドウ")  
  
フラグが設定された、または現在の状態に応じて、フラグなしにスレッドの状態を変更するフラグ アイコンを選択します。 

行を右クリックして**フラグ**、**フラグ解除**、または**すべてのスレッドのフラグを解除**ショートカット メニューから。 

**スレッド** ウィンドウのツールバーがあります、**フラグが設定されたスレッドのみを表示する**は 2 つのフラグ アイコンのいずれかの右ボタン。 ボタンと同じ動作、**デバッグの場所**ツールバー、およびいずれかのボタンは、両方の場所で表示を制御します。 

### <a name="other-threads-window-features"></a>その他のスレッド ウィンドウの機能

**スレッド**ウィンドウで、その列で、スレッドを並べ替える列のヘッダーを選択します。 並べ替え順序を逆にもう一度選択します。 すべてのスレッドが表示されている場合の場合は、フラグが設定されたまたはフラグの状態で、スレッドを並べ替えますフラグ アイコンの列を選択します。 

2 番目の列、**スレッド**ウィンドウ (ヘッダーなし) では、**現在スレッド**列。 この列の黄色の矢印は、現在の実行ポイントをマークします。 

**場所**がソース コード内の各スレッドが表示される列が表示されます。 横にある展開矢印を選択して、**場所**エントリ、またはそのスレッドに対する部分の呼び出し履歴を表示する、エントリ ポイント。 

>[!TIP]
>スレッドの呼び出し履歴のグラフィック表示、使用、[並列スタック](../debugger/using-the-parallel-stacks-window.md)ウィンドウ。 デバッグ中に、ウィンドウを開き、選択**デバッグ**> **Windows** > **並列スタック**します。  

加え**フラグ**、**フラグ解除**、および**すべてのスレッドのフラグを解除**を右クリック コンテキスト メニュー**スレッド**ウィンドウの項目は。

- **ソース スレッドを表示**ボタンをクリックします。
- **16 進表示**、変更、**スレッド ID**内、**スレッド**ウィンドウの 10 進数から 16 進形式にします。 
- [スイッチにスレッド](#switch-to-another-thread)、そのスレッドに実行を即座に切り替えます。 
- **名前を変更**スレッド名を変更することができます。 
- [凍結および凍結解除](#bkmk_freeze)コマンド。

## <a name="bkmk_freeze"></a> 固定およびスレッドの実行を凍結解除 

固定して凍結解除、またはと中断するか、およびスレッドが作業を実行する順序を制御するスレッドを再開できます。 スレッドの凍結と凍結解除をデッドロックなどの同時実行の問題を解決し、競合状態にすることができます。

> [!TIP]
> 1 つのスレッドは、これは一般的なデバッグ シナリオでも、他のスレッドをフリーズさせないに従って、次を参照してください。[マルチ スレッド アプリケーションのデバッグの開始](../debugger/get-started-debugging-multithreaded-apps.md#bkmk_follow_a_thread)します。
  
**スレッドを凍結および凍結解除するには**  
  
1. **スレッド**ウィンドウで、任意のスレッドを右クリックし、**固定**します。 A**一時停止**アイコン、**現在のスレッド**列は、スレッドが固定されていることを示します。  
   
1. 選択**列**で、**スレッド**クリックしてウィンドウのツールバーで**中断回数**を表示する、**中断回数**列。 凍結されたスレッドの中断カウントの値は**1**します。  
   
1. 凍結されたスレッドを右クリックして**凍結解除**します。  
  
   **一時停止**アイコンが非表示になります、**中断回数**値に変更**0**します。 
  
## <a name="switch-to-another-thread"></a>別のスレッドに切り替える 

表示される、**アプリケーションが中断モードに**ウィンドウを別のスレッドに切り替えるしようとするとします。 このウィンドウは、スレッドが現在のデバッガーを表示するすべてのコードにないことを示します。 たとえば、マネージ コードをデバッグすることがありますが、スレッドがネイティブ コード。 ウィンドウは、問題を解決するための候補を提供します。 
  
**別のスレッドに切り替えるには**

1. **スレッド**ウィンドウで、現在のスレッド ID をメモに黄色の矢印の付いたスレッドは、**現在のスレッド**列。 アプリを続行するには、このスレッドに戻るにします。 
   
1. 別のスレッドを右クリックして**スイッチにスレッド**コンテキスト メニュー。  
   
1. 黄色の矢印の場所が変更されたことを確認、**スレッド**ウィンドウ。 元の現在のスレッド マーカーものままで、概要を説明します。 
   
   ソース コード エディターでスレッド マーカーおよび内のリストにツールヒントを見て、**スレッド**ボックスの一覧、**デバッグの場所**ツールバー。 現在のスレッドがある変更されたことも確認します。 
   
1. **デバッグの場所**ツールバーから別のスレッドを選択して、**スレッド**一覧。 現在のスレッドが他の 2 つの場所も変わることに注意してください。 
   
1. ソース コード エディターで、スレッド マーカーを右クリックして**スイッチにスレッド**、一覧から別のスレッドを選択します。 次の 3 つすべての場所で、現在のスレッドが変わることを確認します。  
   
ソース コードでスレッド マーカーでその場所で停止しているスレッドのみを切り替えることできます。 **[スレッド]** ウィンドウと **[デバッグの場所]** ツール バーを使用すると、任意のスレッドに切り替えることができます。   

マルチ スレッド アプリケーションのデバッグの基本を学習したようになりました。 観察、フラグしフラグを解除すると、および固定し、スレッドの凍結解除を使用して、**スレッド**ウィンドウで、**スレッド**の一覧で、**デバッグの場所**ツールバー、またはスレッド マーカー、ソース コード エディターです。
  
## <a name="see-also"></a>関連項目  
 [マルチスレッド アプリケーションのデバッグ](../debugger/debug-multithreaded-applications-in-visual-studio.md)   
 [方法: デバッグ中に別のスレッドに切り替える](../debugger/how-to-switch-to-another-thread-while-debugging.md)
