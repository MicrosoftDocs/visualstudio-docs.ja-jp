---
title: マルチ スレッド アプリケーションをデバッグします。
description: スレッド ウィンドウと、デバッグの場所 ツールバーを使用して、Visual Studio のデバッグします。
ms.custom: ''
ms.date: 05/18/2017
ms.technology: vs-ide-debug
ms.topic: conceptual
dev_langs:
- CSharp
- VB
- FSharp
- C++
helpviewer_keywords:
- multithreaded debugging, tutorial
- tutorials, multithreaded debugging
ms.assetid: adfbe002-3d7b-42a9-b42a-5ac0903dfc25
author: mikejo5000
ms.author: mikejo
manager: douge
ms.workload:
- multiple
ms.openlocfilehash: f82d53d5bbc9d309ba5d7e8710f0afe2023b8965
ms.sourcegitcommit: d462dd10746624ad139f1db04edd501e7737d51e
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/29/2018
ms.locfileid: "50219888"
---
# <a name="walkthrough-debug-a-multithreaded-application-in-visual-studio-using-the-threads-window"></a>チュートリアル: [スレッド] ウィンドウを使用して Visual Studio でマルチ スレッド アプリケーションをデバッグします。
Visual Studio では、**スレッド**ウィンドウとその他のユーザー インターフェイスのマルチ スレッド アプリケーションのデバッグに役立つ要素です。 このチュートリアルで使用する方法、**スレッド**ウィンドウと**デバッグの場所**ツールバー。 その他のツールについては、次を参照してください。[マルチ スレッド アプリケーションのデバッグの開始](../debugger/get-started-debugging-multithreaded-apps.md)します。 このチュートリアルでは、わずか数分ですが、完了に慣れることがするマルチ スレッド アプリケーションのデバッグ機能を使用します。   
  
このチュートリアルを開始するには、マルチ スレッド アプリケーション プロジェクトが必要です。 次の手順に従って、このようなプロジェクトを作成します。  
  
#### <a name="to-create-the-multithreaded-app-project"></a>マルチ スレッド アプリ プロジェクトを作成するには  
  
1.  **ファイル** メニューの 選択**新規** をクリックし、**プロジェクト**します。  
  
     **[新しいプロジェクト]** ダイアログ ボックスが表示されます。  
  
2.  **プロジェクトの種類**ボックスに、好みの言語をクリックします。 **Visual Basic**、 **Visual C#** 、または**Visual c**します。  
  
3.  **Windows デスクトップ**、選択**コンソール アプリ**します。  
  
4.  **名前**ボックスの [名前] を入力します。  
  
5.  **[OK]** をクリックします。  
  
     新しいコンソール プロジェクトが表示されます。 プロジェクトが作成されると、ソース ファイルが表示されます。 選択した言語に応じて、ソース ファイル名はそれぞれ Module1.vb、Program.cs、MyThreadWalkthroughApp.cpp などとなります。  
  
6.  ソース ファイルに表示されるコードを削除し、トピックのスレッドの作成」セクションに表示される例のコードに置き換えます[スレッドの作成と開始時にデータを渡す](/dotnet/standard/threading/creating-threads-and-passing-data-at-start-time)します。  
  
7.  **ファイル** メニューのをクリックして**すべて保存**します。  
  
#### <a name="to-begin-the-tutorial"></a>このチュートリアルを開始するには  
  
-   ソース コード エディターでは、次のコードを探します。  
  
    ```VB  
    Thread.Sleep(3000)   
    Console.WriteLine()
    ```  
  
    ```csharp  
    Thread.Sleep(3000);  
    Console.WriteLine();  
    ```  
  
    ```C++  
    Thread::Sleep(3000);  
    Console.WriteLine();  
    ```  
  
#### <a name="to-start-debugging"></a>デバッグを開始するには  
  
1. 左側の余白内をクリックして、`Console.WriteLine`新しいブレークポイントを挿入するステートメント。  
  
    ソース コード エディターの左側にある余白、赤い円が表示されます。 これは、ブレークポイントがその場所に設定されていることを示します。  
  
2. **デバッグ** メニューのをクリックして**デバッグの開始** (**F5**)。  
  
    デバッグが開始され、コンソール アプリケーションの実行が始まり、ブレークポイントで停止します。  
  
3. このとき、フォーカスがコンソール アプリケーション ウィンドウにある場合は、[!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] ウィンドウの内側をクリックして、フォーカスを [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] に戻します。  
  
4. ソース コード エディターでは、次のコードを含む行を見つけます。  
  
   ```VB  
   Thread.Sleep(5000)   
   ```  
  
   ```csharp  
   Thread.Sleep(3000);  
   ```  
  
   ```C++  
   Thread::Sleep(3000);  
   ```
  
#### <a name="to-discover-the-thread-marker"></a>スレッド マーカーを見つけるには  

1.  [デバッグ] ツールバーをクリックして、**ソース スレッドを表示**ボタン![ソース スレッドを表示](../debugger/media/dbg-multithreaded-show-threads.png "ThreadMarker")します。 
  
2.  ウィンドウ左端の余白に注目します。 この行に表示されます、*スレッド マーカー*アイコン![スレッド マーカー](../debugger/media/dbg-thread-marker.png "ThreadMarker")布の 2 つのスレッドと類似しています。 スレッド マーカーは、スレッドが停止している位置を示します。  
  
3.  スレッド マーカーの上にポインターを置きます。 DataTip が表示されます。 データヒントは、停止したスレッドごとに名前とスレッド ID 番号を表示します。 この場合、スレッドは 1 つだけで、名前は `<noname>` です。  

    > [!TIP]
    > 名前を変更する名前のないスレッドを識別すると便利です。 [スレッド] ウィンドウで次のように選択します。**の名前を変更**を右クリックして、**名前**スレッド行内の列。
  
4.  ショートカット メニューの 利用可能なオプションを表示するスレッド マーカーを右クリックします。 
    
  
## <a name="flagging-and-unflagging-threads"></a>スレッドに対するフラグの設定と設定解除  
特に注目するスレッドのフラグを設定することができます。 スレッドに対するフラグの設定は、重要なスレッドを追跡するのには気いないスレッドを無視して良い方法です。  
  
#### <a name="to-flag-threads"></a>スレッドにフラグを設定するには   

1.  **ビュー**メニューで、**ツールバー**します。  
  
    必ず、**デバッグの場所**ツールバーが選択されています。

2.  移動して、**デバッグの場所**ツールバーをクリックして、**スレッド**一覧。  
  
    > [!NOTE]
    >  著名な 3 つのリストで、このツールバーを識別できます。**プロセス**、**スレッド**、および**スタック フレーム**します。  
  
3.  ボックスに表示されているスレッド数に注目します。  
  
4.  ソース コード エディターに戻るし、スレッド マーカーを右クリックして![スレッド マーカー](../debugger/media/dbg-thread-marker.png "ThreadMarker")もう一度です。  
  
5.  ショートカット メニューのをポイント**フラグ**スレッドの名前と ID 番号を順にクリックします。  
  
6.  戻り**デバッグの場所**ツールバーと検索、**フラグが設定されたスレッドのみを表示する**アイコン![フラグが設定されたスレッドを表示する](../debugger/media/dbg-threads-show-flagged.png "ThreadMarker")に、右、**スレッド**一覧。  
  
    前に、ボタン上のフラグ アイコンが淡色表示されます。 ここで、ボタンをアクティブになります。  
  
7.  をクリックして、**フラグが設定されたスレッドのみを表示する**アイコン。  
  
    今度は、フラグが設定されたスレッドのみがボックスに表示されます。 (に戻すに 1 つのフラグ ボタンをクリックする**すべてのスレッド**モード)。

8. [スレッド] ウィンドウを選択して開きます**デバッグ > Windows > スレッド**します。

    ![スレッド ウィンドウ](../debugger/media/dbg-threads-window.png "ThreadsWindow")  
  
    **スレッド**ウィンドウで、フラグが設定されたスレッドが著名な赤いフラグ アイコンがアタッチされています。

    > [!TIP]
    > 一部のスレッドのフラグを設定したときに、コード エディターでのコード行を右クリックし、選択**カーソルにフラグが設定されたスレッドの実行**(フラグ付きのスレッドがすべてのコードに到達に選択することを確認してください)。 これは選択されている行のコードを利用して実行の順序を容易に制御し、スレッドを一時停止[スレッドの凍結と凍結解除](#bkmk_freeze)します。
  
11. ソース コード エディターでスレッド マーカーをもう一度右クリックします。  
  
     ショートカット メニューに今回表示される項目に注目します。 代わりに**フラグ**、今参照**フラグ解除**します。 クリックしてしないでください**フラグ解除**します。  

     スレッドのフラグを解除する方法を確認するには、次の手順に移動します。  
  
#### <a name="to-unflag-threads"></a>スレッドのフラグを解除するには  
  
1.  **スレッド**ウィンドウで、フラグが設定されたスレッドに対応する行を右クリックします。  
  
     ショートカット メニューが表示されます。 メニュー項目に**フラグ解除**と**すべてのスレッドのフラグを解除**します。  
  
2.  スレッドのフラグをクリックします。**フラグ解除**します。  

    見て、**デバッグの場所**ツールバーにもう一度です。 **フラグが設定されたスレッドのみを表示する**もう一度ボタンは淡色表示されます。 フラグ解除されたのは、フラグが設定された唯一のスレッドでした。 フラグが設定されたスレッドがないため、ツールバーに戻ります**すべてのスレッド**モード。 をクリックして、**スレッド**ボックスの一覧し、すべてのスレッドを表示できることを確認します。  
  
5.  戻り、**スレッド**ウィンドウ情報列を確認します。  
  
    最初の列では、スレッドの一覧の行ごとにアウトライン フラグ アイコンが表示されます。 (アウトライン意味、スレッドのフラグが設定されたがないことです。)  
  
6.  2 つのスレッド、秒と、一覧の一番下から 3 番目のフラグのアウトライン アイコンをクリックします。 

    フラグ アイコンが中空の枠から塗りつぶされた赤に変わります。  
  
7.  フラグ列の最上部にあるボタンをクリックします。  
  
    このボタンをクリックすると、スレッドの一覧順序が変わります。 スレッドのリストが並べ替えられ、フラグが設定されたスレッドが先頭になります。  
  
8.  再び、フラグ列の最上部にあるボタンをクリックします。  
  
    並べ替え順序がまた変わります。  
  
## <a name="more-about-the-threads-window"></a>[スレッド] ウィンドウの詳細  
  
#### <a name="to-learn-more-about-the-threads-window"></a>[スレッド] ウィンドウについての理解を深めるには  
  
1.  **スレッド**ウィンドウで、左から 3 番目の列を確認します。 この列の上部にあるボタンの表示が**ID**します。  
  
2.  クリックして**ID**します。  
  
     スレッドの一覧がスレッド ID 番号で並べ替えられます。  
  
3.  一覧の中から任意のスレッドを右クリックします。 ショートカット メニューで、 **16 進数表示**します。  
  
     スレッド ID 番号の書式が変わります。  
  
4.  マウス ポインターを合わせ、**場所**一覧で任意のスレッドの列。  
  
     少し遅れて、データヒントが表示されます。 ここには、スレッドの呼び出し履歴の一部が表示されます。

     > [!TIP]
     > スレッドの呼び出し履歴のグラフィック表示、開く、[並列スタック](../debugger/using-the-parallel-stacks-window.md)ウィンドウ (デバッグ中に、次のように選択します。**デバッグ/Windows/パラレル**)。  
  
5.  ラベルが付いた、左から 4 番目の列を見て**カテゴリ**します。 スレッドはカテゴリ別に分類されています。  
  
     プロセスで最初に作成されたスレッドは、メイン スレッドと呼ばれます。 スレッドの一覧でそれを探します。  
  
6.  メイン スレッドを右クリックし、をクリックし、**スレッドに切り替える**します。  
  
     A**ブレーク モード**ウィンドウが表示されます。 デバッガーによって (メイン スレッドのため) を表示できるすべてのコードが現在実行されていないようにを指示します。   
  
7.  見て、**呼び出し履歴**ウィンドウと**デバッグの場所**ツールバー。  
  
     内容、**呼び出し履歴**ウィンドウが変更されました。 

## <a name="bkmk_freeze"></a> スレッドの実行を凍結と凍結解除 

停止および再開することができます (中断および再開) スレッドのスレッドが作業を実行する順序を制御します。 デッドロックなどの同時実行の問題を解決し、競合状態が役立ちます。

> [!TIP]
> 参照してください (また、一般的なデバッグ シナリオ) は、他のスレッドを凍結しないで 1 つのスレッドに従う場合[マルチ スレッド アプリケーションのデバッグの開始](../debugger/get-started-debugging-multithreaded-apps.md#bkmk_follow_a_thread)します。
  
#### <a name="to-freeze-and-unfreeze-threads"></a>スレッドを凍結および凍結解除するには  
  
1.  **スレッド**ウィンドウで、任意のスレッドを右クリックし、順にクリックします**固定**します。  
  
2.  2 番目の列 (現在のスレッド列) を確認します。 一時停止アイコンが表示されます。 これらの一時停止アイコンは、スレッドが固定されていることを示します。  
  
3.  表示、**中断回数**列で選択、**列**一覧。

    スレッドの中断カウントが 1 になっていることを確認します。  
  
4.  凍結されたスレッドを右クリックし、をクリックし、**凍結解除**します。  
  
     現在のスレッドの列と**中断回数**列の変更。 
  
## <a name="switching-the-to-another-thread"></a>切り替え、別のスレッドに 
  
#### <a name="to-switch-threads"></a>スレッドを切り替えるには  
  
1.  **スレッド**ウィンドウで、左 (現在のスレッド列) から 2 番目の列を確認します。 この列の最上部にあるボタンにはテキストもアイコンもありません。
  
2.  現在のスレッドの列を見るし、1 つのスレッドが黄色の矢印を持つことに注意してください。 黄色の矢印は、このスレッドが (これは、実行ポインターの現在の場所です)、現在のスレッドであることを示します。
  
    現在のスレッドのアイコンが表示されているスレッドの ID 番号をメモしてを作成します。 現在のスレッドのアイコンは、別のスレッドに移動しますが、終了したときに配置する必要があります。 
  
3.  別のスレッドを右クリックし、をクリックし、**スレッドに切り替える**します。  
  
4.  見て、**呼び出し履歴**ソース コード エディターのウィンドウ。 内容が変わっていることを確認します。  
  
5.  見て、**デバッグの場所**ツールバー。 現在のスレッドのアイコンがも変わっていることをします。  
  
6.  移動して、**デバッグの場所**ツールバー。 別のスレッドからの選択、**スレッド**一覧。  
  
7.  見て、**スレッド**ウィンドウ。 現在のスレッドのアイコンが変更されました。  
  
8. ソース コード エディターでは、スレッド マーカーを右クリックします。 ショートカット メニューのをポイント**スレッドに切り替える**スレッド名/ID 番号をクリックします。  
  
     別のスレッドを現在のスレッドのアイコンを変更する 3 つの方法を確認できました: を使用して、**スレッド**ウィンドウで、**スレッド**で一覧表示、**デバッグの場所**ツールバーで、およびソース コード エディターでスレッド マーカー。  
  
     スレッド マーカーをクリックして特定の場所で停止しているスレッドのみを切り替えることができます。 使用して、**スレッド**ウィンドウと**デバッグの場所**ツールバーで、他のスレッドに切り替えることができます。   
  
## <a name="see-also"></a>関連項目  
 [マルチ スレッド アプリケーションをデバッグします。](../debugger/debug-multithreaded-applications-in-visual-studio.md)   
 [方法 : デバッグ中に別のスレッドに切り替える](../debugger/how-to-switch-to-another-thread-while-debugging.md)
