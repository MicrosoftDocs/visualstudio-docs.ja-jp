---
title: "[スレッド] ウィンドウを使用するマルチ スレッド アプリケーションのデバッグ |Microsoft ドキュメント"
ms.custom: H1HackMay2017
ms.date: 05/18/2017
ms.reviewer: 
ms.suite: 
ms.technology:
- vs-ide-debug
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- CSharp
- VB
- FSharp
- C++
helpviewer_keywords:
- multithreaded debugging, tutorial
- tutorials, multithreaded debugging
ms.assetid: adfbe002-3d7b-42a9-b42a-5ac0903dfc25
caps.latest.revision: 
author: mikejo5000
ms.author: mikejo
manager: ghogen
ms.workload:
- multiple
ms.openlocfilehash: 367bade1041012670ae47937c21be42e38157dca
ms.sourcegitcommit: 9a2f937e42305db6e3eaa7aadc235b0ba9aafc83
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/29/2018
---
# <a name="walkthrough-debug-a-multithreaded-application-in-visual-studio-using-the-threads-window"></a>チュートリアル: [スレッド] ウィンドウを使用して Visual Studio でのマルチ スレッド アプリケーションをデバッグします。
Visual Studio では、**スレッド**ウィンドウとその他のユーザー インターフェイスのマルチ スレッド アプリケーションのデバッグに役立つ要素です。 このチュートリアルで使用する方法、**スレッド**ウィンドウおよび**デバッグの場所**ツールバー。 その他のツールについては、次を参照してください。[マルチ スレッド アプリケーションのデバッグの開始](../debugger/get-started-debugging-multithreaded-apps.md)です。 このチュートリアルでは、わずか数分が完了することを理解するマルチ スレッド アプリケーションのデバッグの機能とします。   
  
このチュートリアルを開始するには、マルチ スレッド アプリケーション プロジェクトが必要です。 次の手順に従って、このようなプロジェクトを作成します。  
  
#### <a name="to-create-the-multithreaded-app-project"></a>マルチ スレッド アプリ プロジェクトを作成するには  
  
1.  **ファイル** メニューの 選択**新規** をクリックし、**プロジェクト**です。  
  
     **[新しいプロジェクト]** ダイアログ ボックスが表示されます。  
  
2.  **プロジェクトの種類**s ボックスで、任意の言語 をクリックします。 **Visual Basic**、 **Visual c#**、または**Visual c**です。  
  
3.  **テンプレート**ボックスで、選択**コンソール アプリ**です。  
  
4.  **名前**ボックス名前 を入力します。  
  
5.  **[OK]**をクリックします。  
  
     新しいコンソール プロジェクトが表示されます。 プロジェクトが作成されると、ソース ファイルが表示されます。 選択した言語に応じて、ソース ファイル名はそれぞれ Module1.vb、Program.cs、MyThreadWalkthroughApp.cpp などとなります。  
  
6.  ソース ファイルに表示されるコードを削除し、このトピックの「を作成する、スレッド」セクションに表示される例のコードに置き換えます[スレッドの作成と開始時にデータを渡す](/dotnet/standard/threading/creating-threads-and-passing-data-at-start-time)です。  
  
7.  **ファイル** メニューのをクリックして**すべて保存**です。  
  
#### <a name="to-begin-the-tutorial"></a>このチュートリアルを開始するには  
  
-   ソース コード エディターで、次のコードを探します。  
  
    ```VB  
    Thread.Sleep(3000)   
    Console.WriteLine()
    ```  
  
    ```csharp  
    Thread.Sleep(3000);  
    Console.WriteLine();  
    ```  
  
    ```C++  
    Thread::Sleep(3000);  
    Console.WriteLine();  
    ```  
  
#### <a name="to-start-debugging"></a>デバッグを開始するには  
  
1.  左側の余白内をクリックして、`Console.WriteLine`新しいブレークポイントを挿入するステートメント。  
  
     ソース コード エディターの左側の余白で、赤い円が表示されます。 これは、ブレークポイントがその場所に設定されていることを示します。  
  
2.  **デバッグ** メニューのをクリックして**デバッグの開始** (**f5 キーを押して**)。  
  
     デバッグが開始され、コンソール アプリケーションの実行が始まり、ブレークポイントで停止します。  
  
3.  このとき、フォーカスがコンソール アプリケーション ウィンドウにある場合は、[!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] ウィンドウの内側をクリックして、フォーカスを [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] に戻します。  
  
4.  ソース コード エディターでは、次のコードを含む行を探します。  
  
    ```VB  
    Thread.Sleep(5000)   
    ```  
  
    ```csharp  
    Thread.Sleep(3000);  
    ```  
  
    ```C++  
    Thread::Sleep(3000);  
    ```
  
#### <a name="to-discover-the-thread-marker"></a>スレッド マーカーを見つけるには  

1.  [デバッグ] ツールバーで、をクリックして、**ソース内のスレッドを表示**ボタン![ソース内のスレッドを表示](../debugger/media/dbg-multithreaded-show-threads.png "ThreadMarker")です。 
  
2.  ウィンドウ左端の余白に注目します。 この行に表示されます、*スレッド マーカー*アイコン![スレッド マーカー](../debugger/media/dbg-thread-marker.png "ThreadMarker")布の 2 つのスレッドと類似しています。 スレッド マーカーは、スレッドが停止している位置を示します。  
  
3.  スレッド マーカーの上にポインターを置きます。 DataTip が表示されます。 データヒントは、停止したスレッドごとに名前とスレッド ID 番号を表示します。 この場合、スレッドは 1 つだけで、名前は `<noname>` です。  

    > [!TIP]
    > 名前を変更する名前のないスレッドを特定すると便利です。 [スレッド] ウィンドウで、次のように選択します。**の名前を変更**を右クリックして、**名前**スレッド行内の列です。
  
4.  ショートカット メニューの 利用可能なオプションを表示するスレッド マーカーを右クリックします。 
    
  
## <a name="flagging-and-unflagging-threads"></a>スレッドに対するフラグの設定と設定解除  
特に注目するスレッドのフラグを設定することができます。 スレッドに対するフラグの設定は、重要なスレッドを追跡しを気にせずスレッドを無視することをお勧めします。  
  
#### <a name="to-flag-threads"></a>スレッドにフラグを設定するには   

1.  **[ビュー]** メニューのをポイント**ツールバー**です。  
  
    確認して、**デバッグの場所**ツールバーを選択します。

2.  移動して、**デバッグの場所**ツールバーとクリック、**スレッド** ボックスの一覧です。  
  
    > [!NOTE]
    >  このツールバーは、次の 3 つの主なボックスで識別できます:**プロセス**、**スレッド**、および**スタック フレーム**です。  
  
3.  ボックスに表示されているスレッド数に注目します。  
  
4.  ソース コード エディターに戻るし、スレッド マーカーを右クリックして![スレッド マーカー](../debugger/media/dbg-thread-marker.png "ThreadMarker")もう一度です。  
  
5.  ショートカット メニューをポイント**フラグ**スレッドの名前と ID 番号を順にクリックします。  
  
6.  戻る**デバッグの場所**ツールバーと検索、**フラグが設定されたスレッドのみを表示する**アイコン![フラグが設定されたスレッドを表示する](../debugger/media/dbg-threads-show-flagged.png "ThreadMarker")に、右、**スレッド** ボックスの一覧です。  
  
    ボタンのフラグ アイコンは、前に淡色表示でした。 今では、アクティブなボタンをクリックします。  
  
7.  クリックして、**フラグが設定されたスレッドのみを表示する**アイコン。  
  
    今度は、フラグが設定されたスレッドのみがボックスに表示されます。 (に戻すに 1 つのフラグ ボタンをクリックすることができます**すべてのスレッド**モードです)。

8. [スレッド] ウィンドウを選択して開きます**デバッグ > Windows > スレッド**です。

    ![Threads Window](../debugger/media/dbg-threads-window.png "ThreadsWindow")  
  
    **スレッド**ウィンドウで、フラグが設定されたスレッドがそれに付随する目立つ色の赤フラグ アイコン。

    > [!TIP]
    > いくつかのスレッドのフラグを設定したときに、コード エディター内のコード行を右クリックして選択**カーソルにフラグが設定されたスレッドの実行**(コードをすべてフラグが設定されたスレッドが到達に選択することを確認してください)。 これは、選択した行で実行の順序を簡単に制御し、コードの上のスレッドを一時停止[スレッドの凍結と凍結解除](#bkmk_freeze)です。
  
11. ソース コード エディターでスレッド マーカーをもう一度右クリックします。  
  
     ショートカット メニューに今回表示される項目に注目します。 代わりに**フラグ**、確認**フラグ解除**です。 クリックしてしないでください**フラグ解除**です。  

     スレッドのフラグを解除する方法を調べるには、次の手順に移動します。  
  
#### <a name="to-unflag-threads"></a>スレッドのフラグを解除するには  
  
1.  **スレッド**ウィンドウで、フラグが設定されたスレッドに対応する行を右クリックします。  
  
     ショートカット メニューが表示されます。 メニュー項目に**フラグ解除**と**すべてのスレッドのフラグを解除**です。  
  
2.  スレッドのフラグをクリックして**フラグ解除**です。  

    見て、**デバッグの場所**ツールバーをもう一度です。 **フラグが設定されたスレッドのみを表示する**ボタンが再び淡色表示されます。 フラグ解除されたのは、フラグが設定された唯一のスレッドでした。 フラグが設定されたスレッドが存在しないため、ツールバーに戻ります**すべてのスレッド**モード。 クリックして、**スレッド**ボックスの一覧し、すべてのスレッドを表示できることを確認してください。  
  
5.  戻り、**スレッド**ウィンドウおよび情報の列を調べます。  
  
    最初の列には、スレッドの一覧の行ごとにアウトライン フラグ アイコンが表示されます。 (アウトラインでは、スレッドいないフラグが設定されたされます。)  
  
6.  2 つのスレッド、秒と、一覧の下部から 3 番目のフラグのアウトライン アイコンをクリックします。 

    フラグ アイコンが中空の枠から塗りつぶされた赤に変わります。  
  
7.  フラグ列の最上部にあるボタンをクリックします。  
  
    このボタンをクリックすると、スレッドの一覧順序が変わります。 スレッドのリストが並べ替えられ、フラグが設定されたスレッドが先頭になります。  
  
8.  再び、フラグ列の最上部にあるボタンをクリックします。  
  
    並べ替え順序がまた変わります。  
  
## <a name="more-about-the-threads-window"></a>[スレッド] ウィンドウの詳細  
  
#### <a name="to-learn-more-about-the-threads-window"></a>[スレッド] ウィンドウについての理解を深めるには  
  
1.  **スレッド**ウィンドウで、左端から 3 番目の列に注目します。 この列の上部にあるボタンの表示**ID**です。  
  
2.  をクリックして**ID**です。  
  
     スレッドの一覧がスレッド ID 番号で並べ替えられます。  
  
3.  一覧の中から任意のスレッドを右クリックします。 ショートカット メニューをクリックして**16 進表示**です。  
  
     スレッド ID 番号の書式が変わります。  
  
4.  マウス ポインターを合わせ、**場所**任意のスレッドの一覧の列です。  
  
     少し遅れて、データヒントが表示されます。 ここには、スレッドの呼び出し履歴の一部が表示されます。

     > [!TIP]
     > スレッドの呼び出し履歴のグラフィック表示、開く、[並列スタック](../debugger/using-the-parallel-stacks-window.md)ウィンドウ (デバッグ中に次のように選択します。**デバッグ/Windows/並列スタック**)。  
  
5.  というラベルの付いた、左から 4 番目の列に注目**カテゴリ**です。 スレッドはカテゴリ別に分類されています。  
  
     プロセスで最初に作成されたスレッドは、メイン スレッドと呼ばれます。 スレッドの一覧でそれを探します。  
  
6.  メイン スレッドを右クリックし、をクリックして**スレッドに切り替える**です。  
  
     A**中断モード**ウィンドウが表示されます。 デバッガーがない現在実行している (メイン スレッドのため) 表示できるすべてのコードを示します。   
  
7.  見て、**呼び出し履歴**ウィンドウおよび**デバッグの場所**ツールバー。  
  
     内容、**呼び出し履歴**ウィンドウが変更されました。 

## <a name="bkmk_freeze"></a>スレッドの実行を凍結と凍結解除 

凍結および凍結解除することができます (中断および再開) スレッドのスレッドが作業を実行する順序を制御します。 デッドロックなどの同時実行の問題を解決するには、競合状態が役立ちます。

> [!TIP]
> 参照してください (も一般的なデバッグ シナリオ) 他のスレッドを凍結しないで 1 つのスレッドに従う場合[マルチ スレッド アプリケーションのデバッグの開始](../debugger/get-started-debugging-multithreaded-apps.md#bkmk_follow_a_thread)です。
  
#### <a name="to-freeze-and-unfreeze-threads"></a>スレッドを凍結および凍結解除するには  
  
1.  **スレッド** ウィンドウでは、任意のスレッドを右クリックし、をクリックして**凍結**です。  
  
2.  2 番目の列 (現在のスレッド列) を確認します。 一時停止アイコンが表示されます。 これらの一時停止アイコンは、スレッドが固定されていることを示します。  
  
3.  表示、**中断回数**列でを選択して、**列** ボックスの一覧です。

    スレッドの中断カウントが 1 になっていることを確認します。  
  
4.  凍結されたスレッドを右クリックし、をクリックして**凍結解除**です。  
  
     現在のスレッド列と**中断回数**列の変更。 
  
## <a name="switching-the-to-another-thread"></a>切り替え、別のスレッドに 
  
#### <a name="to-switch-threads"></a>スレッドを切り替えるには  
  
1.  **スレッド**ウィンドウで、左 (現在のスレッド列) から 2 番目の列を確認します。 この列の最上部にあるボタンにはテキストもアイコンもありません。
  
2.  現在のスレッドの列を見るし、1 つのスレッドが黄色の矢印を持つことに注意してください。 黄色の矢印は、このスレッドが現在のスレッド (これは、実行ポインターの現在の場所です) であることを示します。
  
    現在のスレッドのアイコンが表示されているスレッド ID 番号をメモを作成します。 現在のスレッドのアイコンは、別のスレッドに移動しますが、完了するときに配置する必要があります。 
  
3.  別のスレッドを右クリックし、をクリックして**スレッドに切り替える**です。  
  
4.  見て、**呼び出し履歴**ソース コード エディターのウィンドウ。 内容が変わっていることを確認します。  
  
5.  見て、**デバッグの場所**ツールバー。 現在のスレッドのアイコンがも変わっています。  
  
6.  移動して、**デバッグの場所**ツールバー。 別のスレッドを選択して、**スレッド** ボックスの一覧です。  
  
7.  見て、**スレッド**ウィンドウです。 現在のスレッドのアイコンが変更されました。  
  
8. ソース コード エディターでは、スレッド マーカーを右クリックします。 ショートカット メニューをポイント**スレッドに切り替える**スレッド名/ID 番号 をクリックします。  
  
     別のスレッドを現在のスレッドのアイコンを変更する 3 つの方法を学びました: を使用して、**スレッド** ウィンドウで、**スレッド**一覧に、**デバッグの場所**ツールバーで、およびソース コード エディターでスレッド マーカー。  
  
     スレッド マーカーには、特定の場所で停止しているスレッドのみを切り替えることができます。 使用して、**スレッド**ウィンドウと**デバッグの場所**ツールバーで、任意のスレッドに切り替えることができます。   
  
## <a name="see-also"></a>参照  
 [マルチ スレッド アプリケーションをデバッグします。](../debugger/debug-multithreaded-applications-in-visual-studio.md)   
 [方法 : デバッグ中に別のスレッドに切り替える](../debugger/how-to-switch-to-another-thread-while-debugging.md)
