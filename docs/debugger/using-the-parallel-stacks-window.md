---
title: '[並列スタック] ウィンドウでスレッドを表示する | Microsoft Docs'
ms.date: 11/20/2018
ms.topic: conceptual
f1_keywords:
- vs.debug.parallelstacks
dev_langs:
- CSharp
- VB
- FSharp
- C++
helpviewer_keywords:
- debugger, parallel tasks window
ms.assetid: f50efb78-5206-4803-bb42-426ef8133f2f
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: e9728346bc4c6d805bb0febd3a0d5bef0ed809a5
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "62902422"
---
# <a name="view-threads-and-tasks-in-the-parallel-stacks-window-c-visual-basic-c"></a>[並列スタック] ウィンドウでスレッドを表示する (C#、Visual Basic、C++)

**[並列スタック]** ウィンドウは、マルチスレッド アプリケーションをデバッグする場合に役立ちます。 これにはいくつかのビューがあります。

- [スレッド ビュー](#threads-view)には、アプリのすべてのスレッドの呼び出し履歴情報が表示されます。 スレッドとそれらのスレッドのスタック フレームの間を移動できます。

- [タスク ビュー](#tasks-view)には、タスク中心の呼び出し履歴情報が表示されます。
  - マネージド コードでは、 **[タスク]** ビューに、<xref:System.Threading.Tasks.Task?displayProperty=fullName> オブジェクトの呼び出し履歴が表示されます。
  - ネイティブ コードでは、 **[タスク]** ビューに、[タスク グループ](/cpp/parallel/concrt/task-parallelism-concurrency-runtime)、[並列アルゴリズム](/cpp/parallel/concrt/parallel-algorithms)、[非同期エージェント](/cpp/parallel/concrt/asynchronous-agents)、および[軽量タスク](/cpp/parallel/concrt/task-scheduler-concurrency-runtime)の呼び出し履歴が表示されます。

- [メソッド ビュー](#method-view)では、選択されたメソッドの呼び出し履歴がピボットされます。

## <a name="use-the-parallel-stacks-window"></a>[並列スタック] ウィンドウを使用する

**[並列スタック]** ウィンドウを開くには、デバッグ セッション中である必要があります。 **[デバッグ]**  >  **[ウィンドウ]**  >  **[並列スタック]** の順に選択します。

### <a name="toolbar-controls"></a>ツール バー コントロール

**[並列スタック]** ウィンドウには、次のツールバー コントロールがあります。

![[並列スタック] ウィンドウのツールバー](../debugger/media/parallel_stackstoolbar.png "[並列スタック] ツールバー")

|アイコン|Control|説明|
|-|-|-|
|![[スレッド] および [タスク] コンボ ボックス](media/parallel_toolbar1.png "[スレッド] および [タスク] コンボ ボックス")|**[スレッド]** / **[タスク]** コンボ ボックス|スレッドの呼び出し履歴とタスクの呼び出し履歴の表示を切り替えます。 詳細については、「[タスク ビュー](#tasks-view)」および「[スレッド ビュー](#threads-view)」を参照してください。|
|![[フラグが設定されたもののみを表示] アイコン](media/parallel_toolbar2.png "[フラグが設定されたもののみを表示] アイコン")|[フラグが設定されたもののみを表示]|**[GPU スレッド]** ウィンドウや **[並列ウォッチ]** ウィンドウなど、他のデバッガー ウィンドウでフラグが設定されているスレッドの呼び出し履歴のみを表示します。|
|![[メソッド ビューの切り替え] アイコン](media/parallel_toolbar3.png "[メソッド ビューの切り替え] アイコン")|**[メソッド ビュー]** の切り替え|呼び出し履歴ビューと **[メソッド ビュー]** を切り替えます。 詳細については、「[メソッド ビュー](#method-view)」を参照してください。|
|![現在のものに自動スクロールするアイコン](media/parallel_toolbar4.png "現在のものに自動スクロールするアイコン")|[現在のスタック フレームに自動スクロール]|現在のスタック フレームが表示されるようにグラフを自動スクロールします。 この機能は、他のウィンドウから現在のスタック フレームを変更する場合や、大きなダイアグラム内で新しいブレークポイントにヒットした場合に役立ちます。|
|![ズームの切り替えアイコン](media/parallel_toolbar5.png "ズームの切り替えアイコン")|[ズーム コントロールの切り替え]|ウィンドウの左側のズーム コントロールの表示と非表示を切り替えます。 <br /><br />ズーム コントロールを表示するかどうかに関係なく、**Ctrl** キーを押しながらマウス ホイールを回転させるか、**Ctrl**+**Shift**+ **+** キーを押してズームインし、**Ctrl**+**Shift**+ **-** キーを押してズームアウトすることで、ズームすることもできます。 |

### <a name="stack-frame-icons"></a>スタック フレーム アイコン
次のアイコンでは、すべてのビューのアクティブおよび現在のスタック フレームに関する情報が提供されます。

|アイコン|説明|
|-|-|
|![黄色の矢印](media/icon_parallelyellowarrow.gif)|現在のスレッドの現在の場所 (アクティブなスタック フレーム) を示します。|
|![スレッド アイコン](media/icon_parallelthreads.gif)|現在のスレッド以外の現在の場所 (アクティブなスタック フレーム) を示します。|
|![緑色の矢印](media/icon_parallelgreenarrow.gif)|現在のスタック フレーム (現在のデバッガー コンテキスト) を示します。 メソッド名は、表示される場所に関係なく、太字になります。|

### <a name="context-menu-items"></a>コンテキスト メニュー項目
次のショートカット メニュー項目は、 **[スレッド]** ビューまたは **[タスク]** ビューでメソッドを右クリックすると表示されます。 最後の 6 つの項目は、[[呼び出し履歴] ウィンドウ](how-to-use-the-call-stack-window.md)と同じです。

![[並列スタック] ウィンドウのショートカット メニュー](../debugger/media/parallel_contmenu.png "[並列スタック] ウィンドウのショートカット メニュー")

|メニュー項目|説明|
|-|-|
|**フラグ**|選択した項目にフラグを設定します。|
|**フラグ解除**|選択した項目のフラグを解除します。|
|**凍結**|選択した項目を凍結します。|
|**解凍**|選択した項目の凍結を解除します。|
|**フレームに切り替え**|**[呼び出し履歴]** ウィンドウの対応するメニュー コマンドと同じです。 しかし、 **[並列スタック]** ウィンドウでは、1 つのメソッドが複数のフレームに存在する場合があります。 この項目のサブメニューで目的のフレームを選択することができます。 スタック フレームの 1 つが現在のスレッドにある場合、既定では、そのフレームがサブメニューで選択されます。|
|**[タスクに移動]** または **[スレッドに移動]**|**[タスク]** または **[スレッド]** ビューに切り替え、同じスタック フレームを強調表示したままにします。|
|**ソース コードへ移動**|ソース コード ウィンドウ内の対応する場所に移動します。 |
|**逆アセンブルを表示**|**[逆アセンブリ]** ウィンドウ内の対応する場所に移動します。|
|**外部コードの表示**|外部コードの表示と非表示を切り替えます。|
|**16 進数で表示**|10 進数と 16 進数の表示を切り替えます。|
|**ソースのスレッドを表示**|ソース コード ウィンドウ内のスレッドの場所にフラグを設定します。 |
|**シンボルの読み込み情報**|**[シンボルの読み込み情報]** ダイアログ ボックスを開きます。|
|**シンボルの設定**|**[シンボルの設定]** ダイアログ ボックスを開きます。 |

## <a name="threads-view"></a>スレッド ビュー

**[スレッド]** ビューでは、現在のスレッドのスタック フレームと呼び出しパスが青色で強調表示されます。 スレッドの現在の場所は、黄色の矢印で示されます。

現在のスタック フレームを変更するには、別のメソッドをダブルクリックします。 これにより、選択したメソッドが現在のスレッドと別のスレッドのどちらの一部であるかに応じて、現在のスレッドも切り替わる場合があります。

**[スレッド]** ビュー グラフが大きすぎてウィンドウに収まらない場合は、ウィンドウに **[概観]** コントロールが表示されます。 コントロール内でフレームを移動して、グラフのさまざまな部分に移動できます。

次の図は、メインからマネージド、さらにネイティブ コードへと切り替わる 1 つのスレッドを示しています。 現在のメソッドには 6 つのスレッドがあります。 あるものは Thread.Sleep に進み、またあるものは Console.WriteLine に進んでから、SyncTextWriter.WriteLine に進みます。

 ![[並列スタック] ウィンドウの [スレッド] ビュー](../debugger/media/parallel_stack1.png "[並列スタック] ウィンドウの [スレッド] ビュー")

次の表では、 **[スレッド]** ビューの主な機能について説明します。

|引き出し線|[要素名]|説明|
|-|-|-|
|1|呼び出し履歴のセグメントまたはノード|1 つまたは複数のスレッドの一連のメソッドが含まれます。 フレームに矢印の線が結ばれていない場合は、そのフレームではスレッドの呼び出しパス全体が表示されます。|
|2|青の強調表示|現在のスレッドの呼び出しパスを示します。|
|3|矢印の線|ノードを結び、スレッドのすべての呼び出しパスを構成します。|
|4|ノード ヘッダー|ノードのプロセスとスレッドの数を表示します。|
|5|メソッド|同じメソッド内の 1 つ以上のスタック フレームを表します。|
|6|メソッドのツールヒント|メソッドの上にカーソルを置くと表示されます。 **[スレッド]** ビューのツールヒントでは、すべてのスレッドが **[スレッド]** ウィンドウに似たテーブルに表示されます。 |

## <a name="tasks-view"></a>タスク ビュー
アプリで <xref:System.Threading.Tasks.Task?displayProperty=fullName> オブジェクト (マネージド コード) または `task_handle` オブジェクト (ネイティブ コード) を使用して並列処理を表す場合は、 **[タスク]** ビューを使用できます。 **タスク** ビューには、スレッドではなくタスクの呼び出し履歴が表示されます。

**[タスク]** ビューでは、次のようになります。

- タスクを実行していないスレッドの呼び出し履歴は表示されません。
- タスクを実行しているスレッドの呼び出し履歴は上下の項目が非表示になり、タスクに最も関連するフレームが表示されます。
- 1 つのスレッドに複数のタスクがある場合、それらのタスクの呼び出し履歴が個々のノードに表示されます。

呼び出し履歴全体を表示するには、スタック フレームを右クリックし、 **[スレッドに移動]** を選択して **[スレッド]** ビューに戻ります。

次の図の上部には **[スレッド]** ビュー、下部には対応する **[タスク]** ビューが示されています。

![[スレッド] および [タスク] ビュー](../debugger/media/parallel_threads-tasks.png "[スレッド] および [タスク] ビュー")

メソッドの上にカーソルを置くと、ツールヒントが追加情報と共に表示されます。 **[タスク]** ビューのツールヒントでは、すべてのタスクが **[タスク]** ウィンドウに似たテーブルに表示されます。

次の図の上部には **[スレッド]** ビューのメソッドのツールヒント、下部には対応する **[タスク]** ビューのものが示されています。

![[スレッド] および [タスク] ツールヒント](../debugger/media/parallel_threads-tasks-tooltips.png "[スレッド] および [タスク] ツールヒント")

## <a name="method-view"></a>メソッド ビュー
**[スレッド]** ビューまたは **[タスク]** ビューで、ツール バーの **[メソッド ビューの切り替え]** アイコンを選択することで、現在のメソッドのグラフをピボットできます。 **メソッド ビュー**を使用すると、現在のメソッドを呼び出すか現在のメソッドから呼び出されるすべてのスレッドのすべてのメソッドをひと目で確認できます。 次の図は、左側の **[スレッド]** ビューと、右側の **[メソッド ビュー]** で、同じ情報がどのように表示されるかを示しています。

![[スレッド] ビューと [メソッド ビュー]](../debugger/media/parallel_methodview.png "[スレッド] ビューと [メソッド ビュー]")

新しいスタック フレームに切り替えると、そのメソッドが現在のメソッドになり、新しいメソッドのすべての呼び出し元と呼び出し先が **[メソッド ビュー]** に表示されます。 これにより、そのメソッドが呼び出し履歴に含まれているかどうかに応じて、一部のスレッドの表示と非表示が切り替わる場合があります。 呼び出し履歴ビューに戻るには、 **[メソッド ビュー]** ツールバー アイコンをもう一度選択します。

## <a name="see-also"></a>関連項目
- [マルチ スレッド アプリケーションのデバッグの開始](../debugger/get-started-debugging-multithreaded-apps.md)
- [チュートリアル: 並行アプリケーションをデバッグする](../debugger/walkthrough-debugging-a-parallel-application.md)
- [デバッガーでのはじめに](../debugger/debugger-feature-tour.md)
- [マネージド コードをデバッグする](../debugger/debugging-managed-code.md)
- [並列プログラミング](/dotnet/standard/parallel-programming/index)
- [[タスク] ウィンドウを使用する](../debugger/using-the-tasks-window.md)
- [Task クラス](../extensibility/debugger/task-class-internal-members.md)
