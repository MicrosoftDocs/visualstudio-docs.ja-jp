---
title: 変数にウォッチを設定 |Microsoft Docs
ms.custom: seodec18
ms.date: 10/11/2018
ms.topic: conceptual
f1_keywords:
- vs.debug.watch
helpviewer_keywords:
- debugging [Visual Studio], Watch window
- expressions [debugger], evaluating
- variables [debugger], evaluating
- expression evaluation
- registers, evaluating
- debugging [Visual Studio], expression evaluation
author: mikejo5000
ms.author: mikejo
manager: douge
ms.workload:
- multiple
ms.openlocfilehash: b01c0a80c9e45aa56f2a627b73659e7558257e35
ms.sourcegitcommit: 37fb7075b0a65d2add3b137a5230767aa3266c74
ms.translationtype: MTE95
ms.contentlocale: ja-JP
ms.lasthandoff: 01/02/2019
ms.locfileid: "53936510"
---
# <a name="watch-variables-with-watch-windows-and-quickwatch"></a>ウォッチ ウィンドウと クイック ウォッチ変数なウォッチ 

使用することができます、デバッグ中**ウォッチ**windows と **[クイック ウォッチ]** 変数と式をウォッチします。 Windows はデバッグ セッション中にのみ使用できます。

**ウォッチ**windows は、デバッグ中に、一度にいくつかの変数を表示できます。 **[クイック ウォッチ]** ダイアログは、一度に 1 つの変数を表示し、デバッグを続行する前に閉じる必要があります。

コードをデバッグしようとした初めての場合は、読み取りをする可能性があります[より適切に記述することでバグを修正C#コード](../debugger/write-better-code-with-visual-studio.md)と[超初心者向けのデバッグ](../debugger/debugging-absolute-beginners.md)にこの記事に進む前にします。

## <a name="observe-variables-with-a-watch-window"></a>ウォッチ ウィンドウで変数を観察します。

1 つ以上を開くことができます**ウォッチ** ウィンドウでは、複数の変数を観察し、**ウォッチ**ウィンドウ。 

たとえばの値にウォッチを設定する`a`、 `b`、および`c`次のコード。

```C++
int main()
{
    int a, b, c;
    a = 1;
    b = 2;
    c = 0;

    for (int i = 0; i < 10; i++)
    {
        a++;
        b *= 2;
        c = a + b;
    }

    return 0;
}

```

1. ブレークポイントを設定、`c = a + b;`左の余白をクリックして行を選択すると**デバッグ** > **ブレークポイントの切り替え**、キーを押して**F9**。
   
1. 緑を選択してデバッグを開始**開始**矢印または**デバッグ** > **デバッグの開始**、またはキーを押します**F5**します。 実行がブレークポイントで一時停止します。
   
1. 開く、**ウォッチ**ウィンドウを選択して**デバッグ** > **Windows** > **ウォッチ** >  **ウォッチ 1**、キーを押して**Ctrl**+**Alt**+**W** > **1**.
   
   追加で開くことができます**ウォッチ**windows を選択して windows **2**、 **3**、または**4**します。
   
1. **ウォッチ**ウィンドウで、空の行を選択し、型の変数`a`します。 同じ`b`と`c`します。
   
   ![変数のウォッチ](../debugger/media/watchvariables.png "WatchVariables")
   
1. 選択してデバッグを続行**デバッグ** > **ステップ イン**キーを押して**F11**を進める必要に応じて。 変数の値で、**ウォッチ**を反復処理するように変更 ウィンドウ、`for`ループします。
   
>[!NOTE]
>C++ の場合のみ、 
>- 変数名、または変数名を使用する式のコンテキストを修飾する必要があります。 コンテキストは、関数、ソース ファイル、または変数が配置されているモジュールです。 コンテキストを修飾する場合を使用して、[コンテキスト演算子 (C++)](../debugger/context-operator-cpp.md)で構文、**名前**で、**ウォッチ**ウィンドウ。 
>  
>- レジスタ名と変数の名前を使用して追加できます **$\<登録&nbsp;名 >** または **@\<登録&nbsp;名 >** を**名前**で、**ウォッチ**ウィンドウ。 詳細については、「 [Pseudovariables](../debugger/pseudovariables.md)」を参照してください。

## <a name="use-expressions-in-a-watch-window"></a>ウォッチ ウィンドウで式を使用

デバッガーによって認識される有効な式を確認できます、**ウォッチ**ウィンドウ。

たとえば、前のセクションで、コードの取得できます 3 つの値の平均値を入力して`(a + b + c) / 3`で、**ウォッチ**ウィンドウ。

![式をウォッチ](../debugger/media/watchexpression.png "式をウォッチ")

式を評価する規則、**ウォッチ**ウィンドウは、通常はコードの言語で式を評価するための規則と同じです。 式に構文エラーがある場合は、コード エディターのように、同じコンパイラ エラーを想定します。 たとえば、直前の正規表現で間違いはでは、このエラーを生成します。、**ウォッチ**ウィンドウ。

![ウォッチ式のエラー](../debugger/media/watchexpressionerror.png "式のエラーをご覧ください。")

2 本の波線アイコンの円が表示される、**ウォッチ**ウィンドウ。 このアイコンは、デバッガーは、潜在的なスレッド間の依存関係のため、式を評価しないことを意味します。 他のスレッドを一時的に実行するアプリでコードを評価する必要がありますが、中断モードでは、アプリのすべてのスレッドが停止通常します。 他のスレッドを一時的に実行できるように持つことができます、アプリと、デバッガーの状態に予期しない影響がブレークポイントとそれらのスレッドの例外などのイベントを無視することができます。

### <a name="bkmk_refreshWatch"></a> ウォッチ値を更新します。

更新アイコン (円形の矢印) が表示される、**ウォッチ**ウィンドウ式が評価されるとき。 更新アイコンは、エラーまたは期限切れである値を示します。 

値を更新するには、更新アイコンを選択するか、space キーを押します。 デバッガーで、式の再評価が試行されます。 ただし、する可能性がありますいないか、値が評価されなかった理由に応じて、式の再評価できます。 

更新アイコンをポイントまたは参照してください、**値**列の式が評価されなかった理由。 原因は次のとおりです。

- 前の例のように、式の評価中にエラーが発生しました。 タイムアウトが発生する、または変数がスコープ外に出る可能性があります。
  
- 式はアプリでの副作用をトリガーする関数呼び出しです。 参照してください[式の副作用](#bkmk_sideEffects)します。
  
- プロパティと暗黙的関数呼び出しの自動評価は無効です。 
  
プロパティと暗黙的関数呼び出しの自動評価が無効になっているため、更新アイコンが表示された場合は、選択して有効できます**プロパティの評価とその他の暗黙的な関数呼び出しを有効にする**で**ツール**  > **オプション** > **デバッグ** > **全般**します。

更新アイコンを使用してを示しています。

1. **ツール** > **オプション** > **デバッグ** > **全般**、オフ、 **プロパティの評価とその他の暗黙的な関数呼び出しを有効にする**チェック ボックスをオンします。 
   
1. 次のコードを入力し、**ウォッチ**でウォッチ ウィンドウの設定、`list.Count`プロパティ。 
   
   ```csharp
   static void Main(string[] args)
   {
       List<string> list = new List<string>();
       list.Add("hello");
       list.Add("goodbye");
   }
   ```
   
1. デバッグを開始します。 **ウォッチ**ウィンドウには、次のメッセージのようなものが表示されます。
   
   ![更新ウォッチ](../debugger/media/refreshwatch.png "ウォッチの更新")
   
1. 値を更新するには、更新アイコンを選択するか、space キーを押します。 デバッガーでは、式を再評価します。 

### <a name="bkmk_sideEffects"></a> 式の副作用 

式を評価するで、変数の値を変更または、それ以外の場合、アプリの状態に影響します。 たとえば、次の式を評価すると、 `var1`の値が変わります。

```csharp
var1 = var2
```

このコードが発生することができます、[副作用](https://en.wikipedia.org/wiki/Side_effect_\(computer_science\))します。 副作用デバッグが困難なアプリの動作を変更することで。

副作用のある式は、最初に入力するときに 1 回だけ評価されます。 式は、その後で灰色表示で表示、**ウォッチ**ウィンドウ、およびさらに評価が無効になっています。 ツールヒントまたは**値**列は、式に副作用が発生するについて説明します。 再評価を強制するには、値の横に表示される更新アイコンを選択します。

副作用の指定を防ぐために 1 つの方法では、関数の自動評価をオフにします。 **ツール** > **オプション** > **デバッグ** > **全般**の選択を解除**プロパティの評価とその他の暗黙的な関数呼び出しを有効にする**します。

C#のみ、プロパティの評価または暗黙的な関数呼び出しが入っていないときに強制的に評価できますを追加して、 **ac**書式修飾子を変数に**名前**で、**ウォッチ**ウィンドウ。 「[C# の書式指定子](../debugger/format-specifiers-in-csharp.md)」を参照してください。

## <a name="bkmk_objectIds"></a> オブジェクト Id を使用して、[ウォッチ] ウィンドウで (C#および Visual Basic)

特定のオブジェクトの動作を確認することがあります。 たとえば、その変数がスコープ外になった後、ローカル変数で参照先オブジェクトを追跡したい場合があります。 C# と Visual Basic では、参照型の特定のインスタンスのオブジェクト ID を作成し、それらの ID を**ウォッチ** ウィンドウやブレークポイントの条件で使用できます。 オブジェクト ID は、共通言語ランタイム (CLR) のデバッグ サービスで生成されて、オブジェクトに関連付けられます。

> [!NOTE]
> オブジェクト Id は、ガベージ コレクションの対象からオブジェクトを防ぐことはできませんの弱い参照を作成します。 オブジェクト ID は、現在のデバッグ セッションでのみ有効です。

次のコードで、`MakePerson()`メソッドを作成、`Person`ローカル変数を使用します。 

```csharp
class Person
{
    public Person(string name)
    {
        Name = name;
    }
    public string Name { get; set; }
}

public class Program
{
    static List<Person> _people = new List<Person>();
    public static void Main(string[] args)
    {
        MakePerson();
        DoSomething();
    }

    private static void MakePerson()
    {
        var p = new Person("Bob");
        _people.Add(p);
    }

    private static void DoSomething()
    {
        // more processing
         Console.WriteLine("done");
    }
}
```

名前を確認する、`Person`で、`DoSomething()`メソッドへの参照を追加することができます、`Person`のオブジェクト ID、**ウォッチ**ウィンドウ。

1. 後のコードにブレークポイントを設定、`Person`オブジェクトが作成されました。
   
1. デバッグを開始します。
   
1. 実行がブレークポイントで一時停止したときに開く、**ローカル**ウィンドウを選択して**デバッグ** > **Windows** > **[ローカル]**.
   
1. **ローカル**ウィンドウで、右クリックし、`Person`変数を選択します**オブジェクト ID の作成**です。
   
   ドル記号を表示する必要があります (**$**) の数値でさらに、**ローカル**ウィンドウ オブジェクトの id です。
   
1. オブジェクト ID を追加、**ウォッチ**オブジェクト ID を右クリックしてウィンドウ**ウォッチ式の追加**します。
   
1. 別のブレークポイントを設定、`DoSomething()`メソッド。
   
1. デバッグを続行します。 実行が一時停止したとき、`DoSomething()`メソッド、**ウォッチ**ウィンドウが表示されます、`Person`オブジェクト。
   
   > [!NOTE]
   > オブジェクトのプロパティを表示する`Person.Name`を選択してプロパティの評価を有効にする必要があります**ツール** > **オプション** >  **デバッグ** > **全般** > **プロパティの評価とその他の暗黙的な関数呼び出しを有効にする**します。

## <a name="dynamic-view-and-the-watch-window"></a>動的ビューとウォッチ ウィンドウ

一部のスクリプト言語 (JavaScript や Python など) を使用して、動的または[アヒル](https://en.wikipedia.org/wiki/Duck_typing)入力、および .NET 4.0 およびそれ以降のバージョンは、通常のデバッグ ウィンドウで観察が困難なであるオブジェクトをサポートしています。

**ウォッチ**ウィンドウには、実装する型から作成されると、動的なオブジェクトとしてこれらのオブジェクトが表示されます、<xref:System.Dynamic.IDynamicMetaObjectProvider>インターフェイス。 動的オブジェクトのノードは、動的オブジェクトの動的メンバーの表示が、メンバーの値を編集することはありません。 

更新する**動的ビュー**値で、[更新アイコン](#bkmk_refreshWatch)動的オブジェクトのノードの横にあります。 

のみを表示する、**動的ビュー**オブジェクトは、追加、**動的**の動的オブジェクト名の後の書式指定子、**ウォッチ**ウィンドウ。

- C# の場合: `ObjectName, dynamic`
- Visual Basic の場合: `$dynamic, ObjectName`

>[!NOTE]
>- C#内の値が自動的に再評価するデバッガー、**動的ビュー**次のコード行をステップ実行する場合。 
>- Visual Basic のデバッガーを使用して追加の式を自動的に更新する、**動的ビュー**します。
>- **動的ビュー**のメンバーを評価すると、[副作用](https://en.wikipedia.org/wiki/Side_effect_\(computer_science\))が発生する場合があります。 

**新しいウォッチを挿入するには、変数をキャスト動的オブジェクトをオブジェクトに。**
  
1. 任意の子を右クリックし、**動的ビュー**します。
1. 選択**ウォッチ式の追加**します。 `object.name`なります`((dynamic) object).name`で新しいメッセージが表示され**ウォッチ**ウィンドウ。

さらに、デバッガー、**動的ビュー**にオブジェクトの子ノード、 **[自動変数]** ウィンドウ。 開くには、 **[自動変数]** ウィンドウで、デバッグ中に、**デバッグ** > **Windows** > **[自動変数]** します。 

**動的ビュー**も COM オブジェクトのデバッグが向上します。 デバッガーにラップされた COM オブジェクトを取得します**System.__ComObject**、追加、**動的ビュー**オブジェクトのノード。

## <a name="observe-a-single-variable-or-expression-with-quickwatch"></a>1 つの変数または クイック ウォッチの式を確認します。

使用することができます **[クイック ウォッチ]** 1 つの変数を観察します。 

たとえば、次のコードでは。

```csharp
static void Main(string[] args)
{
    int a, b;
    a = 1;
    b = 2;
    for (int i = 0; i < 10; i++)
    {
        a = a + b;
    }
}
```

観察する、`a`変数 
   
1. `a = a + b;` の行にブレークポイントを設定します。
   
1. デバッグを開始します。 実行がブレークポイントで一時停止します。
   
1. 変数を選択`a`コード。
   
1. 選択**デバッグ** > **[クイック ウォッチ]**、キーを押します**shift キーを押し**+**F9**、または右クリックし、選択 **[クイック ウォッチ]** します。 
   
   **[クイック ウォッチ]** ダイアログが表示されます。 `a`変数は、**式**ボックスで、**値**の**1**します。
   
   ![[クイック ウォッチ] 変数](../debugger/media/quickwatchvariable.png "[クイック ウォッチ] の変数")
   
1. 入力式など、変数を使用して、式を評価する`a + b`で、**式**ボックス、および選択**再評価**します。
   
   ![[クイック ウォッチ] 式](../debugger/media/quickwatchexpression.png "クイック ウォッチの式")
   
1. 変数または式から追加する **[クイック ウォッチ]** を**ウォッチ**ウィンドウで、**ウォッチ式の追加**します。
   
1. 選択**閉じます**を閉じる、 **[クイック ウォッチ]** ウィンドウ。 (**[クイック ウォッチ]** はモーダル ダイアログを開いている限り、デバッグを続行することはできません)。
   
1. デバッグを続行します。 内の変数を観察できます、**ウォッチ**ウィンドウ。

## <a name="see-also"></a>関連項目
 [デバッグとは](../debugger/what-is-debugging.md)  
 [より良い C# コードを書くことでバグを修正する](../debugger/write-better-code-with-visual-studio.md)  
 [最初に、デバッグについて](../debugger/debugger-feature-tour.md)[デバッガー ウィンドウ](../debugger/debugger-windows.md)
