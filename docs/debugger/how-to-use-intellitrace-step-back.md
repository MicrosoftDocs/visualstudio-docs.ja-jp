---
title: IntelliTrace ステップ ライトバックを使用してスナップショットを表示します。
ms.description: Learn how to take snapshots, and view snapshots with IntelliTrace step-back
ms.custom: mvc
ms.date: 05/01/2018
ms.technology: vs-ide-debug
ms.topic: tutorial
ms.assetid: 7c60d929-d993-49dc-9db3-43b30be9912b
author: mikejo5000
ms.author: mikejo
manager: douge
ms.workload:
- multiple
ms.openlocfilehash: 68fec4e10d172f79908e57828c542a444d081b50
ms.sourcegitcommit: 33c954fbc8e05f7ba54bfa2c0d1bc1f9bbc68876
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/07/2018
---
# <a name="view-snapshots-using-intellitrace-step-back-in-visual-studio"></a>Visual Studio で IntelliTrace を使用してスナップショットの表示手順ライトバック

IntelliTrace ステップ ライトバックは、ステップのイベント、アプリケーションのすべてのブレークポイントとデバッガーのスナップショットを取得する自動的にします。 記録されたスナップショットにより、前のブレークポイントまたはステップに戻り、過去の時点でのアプリケーションの状態を確認できるようになります。 IntelliTrace ステップ バックでは、以前のアプリケーションの状態を確認したいが、デバッグの再開や必要なアプリ状態の再作成は必要でない場合に時間を節約できます。

IntelliTrace ステップ ライトバックは Visual Studio Enterprise 2017 15.5 以降のバージョンから利用できるよう、Windows 10 Anniversary 更新を必要とまたはそれ以降。 この機能は現在サポートされて ASP.NET、WinForms、WPF、コンソールの管理対象アプリ、およびマネージ クラス ライブラリをデバッグします。 Visual Studio 2017 Enterprise バージョン 15.7 preview 1 から始めての機能も ASP.NET Core と .NET Core のサポートします。 UWP アプリケーションのデバッグは現在サポートされていません。

このチュートリアルでは、次の作業を行います。

> [!div class="checklist"]
> * Intellitrace イベントとスナップショットを有効にします。
> * 手順背面とステップ転送のコマンドを使用してイベントを移動します。
> * イベントのスナップショットの表示
  
## <a name="enable-intellitrace-events-and-snapshots-mode"></a>IntelliTrace イベントとスナップショット モードを有効にします。 

1. Visual Studio Enterprise では、プロジェクトを開きます。

1. 開いている**ツール** > **オプション** > **IntelliTrace**設定、およびオプションを選択する**IntelliTrace イベントとスナップショット**. 

    ![IntelliTrace イベントとスナップショット モードを有効にする](../debugger/media/intellitrace-enable-snapshots.png "IntelliTrace イベントを有効にしてスナップショット モード")

1. 例外で表示するスナップショットのオプションを構成する場合は、選択**IntelliTrace** > **詳細**から、**オプション** ダイアログ ボックス。

    これらのオプションは、Visual Studio 2017 Enterprise 15.7 のバージョンので利用可能です。

    ![例外でスナップショットの動作を構成します。](../debugger/media/intellitrace-enable-snapshots-on-exceptions.png)

    イベントとスナップショットを有効にすると例外でのスナップショットの取得も既定で有効にします。 選択を解除するを例外でスナップショットを無効にする**例外イベントのスナップショットを収集**です。 この機能を有効にすると、未処理の例外のスナップショットを取得します。 処理済みの例外では、スナップショットが作成され、以前にスローされる例外の再スローがない場合、例外がスローされた場合にのみです。 例外でスナップショットの最大数を設定するには、ドロップダウン リストから値を選択します。 最大値は、アプリは中断モード (ときに、アプリでは、ブレークポイントがヒット) などの入力を時間ごとに適用されます。

    > [!NOTE]
    > IntelliTrace で記録する、スナップショットが例外イベントの場合のみ取得されます。 IntelliTrace が記録するイベントを指定するには、選択**ツール** > **オプション** > **IntelliTrace イベント**です。

1. プロジェクトで、1 つまたは複数のブレークポイントを設定し、デバッグを開始 (キーを押します**f5 キーを押して**)、コードをステップ実行してデバッグを開始または (**F10**または**F11**)。

    IntelliTrace は、各デバッガー ステップ、ブレークポイント イベント、および未処理の例外イベントに、アプリケーションのプロセスのスナップショットを取得します。 これらのイベントが記録されて、**イベント** タブで、**診断ツール**ウィンドウで、その他の IntelliTrace イベントと共にします。 このウィンドウを開くには、選択**デバッグ** > **Windows** > **診断ツールを表示する**です。

    スナップショットが使用可能なイベントの横にあるカメラ アイコンが表示されます。 

    ![スナップショット付きの [イベント] タブ](../debugger/media/intellitrace-events-tab-with-snapshots.png "ブレークポイントおよびステップ上のスナップショットでは、[イベント] タブ")

    パフォーマンス上の理由から、非常に短時間にステップするときに、スナップショットは取得されません。 ステップの横にある [カメラ] アイコンが表示されない場合は、ステップ実行速度が低下してみてください。

## <a name="navigate-and-view-snapshots"></a>移動し、スナップショットを表示します。

1. 使用してイベント間を移動、 **(Alt + [) 下位手順**と**つ進む (Alt +])** デバッグ ツールバーのボタンです。

    これらのボタンに表示されるイベントの移動、**イベント** タブで、**診断ツール ウィンドウ**します。 ステップ実行前後イベントに自動的にアクティブに[デバッグ履歴](../debugger/historical-debugging.md)選択したイベントにします。

    ![戻るボタンと進むボタン](../debugger/media/intellitrace-step-back-icons-description.png "旧バージョンとステップとつ進むボタン")

    背面のステップまたはステップ前進するときに Visual Studio はデバッグ履歴モードになります。 このモードでは、デバッガーのコンテキストは、選択したイベントが記録された時刻に切り替わります。 Visual Studio は、ソース ウィンドウ内のコードの対応する行にも、ポインターを移動します。 

    このビューからの値を検査することができます、**呼び出し履歴**、**ローカル**、 **[自動変数]**、および**ウォッチ**windows です。 データヒントを表示し、式の評価を実行する変数もポイントすることができます、**イミディ エイト**ウィンドウです。 その時点で実行されるアプリケーションのプロセスのスナップショットは、データは、「です。

    したがって、たとえば、ブレークポイントにヒットし、手順を実行した場合 (**F10**) では、**手順旧バージョンと** で、ブレークポイントに対応するコードの行の履歴のモードで Visual Studio に配置します。 

    ![スナップショットを使用してイベントをアクティブ化中の履歴モード](../debugger/media/intellitrace-historical-mode-with-snapshot.png "スナップショットを使用してイベントをアクティブ化中の履歴モード")

2. ライブ実行に戻り、次のように選択します。**続行 (F5)**  をクリックして、**ライブ デバッグに戻って**情報バーにリンクします。 

3. スナップショットを表示することも、**イベント**タブです。これを行うには、スナップショットを使用してイベントを選択し、をクリックして**履歴デバッグの有効化**です。

    ![デバッグ履歴をアクティブ化イベントを](../debugger/media/intellitrace-activate-historical-debugging.png "イベント履歴デバッグの有効化")

    異なり、**次のステートメントの設定**コマンド、スナップショットを表示するには、コードが再実行していません。 これにより、アプリケーションの状態の静的ビューの時点で過去に発生した時間内です。

    ![IntelliTrace ステップ ライトバックの概要](../debugger/media/intellitrace-step-back-overview.png "の概要の IntelliTrace の手順に戻る")

    Visual Studio での変数を検査する方法の詳細については、次を参照してください[デバッガーの機能のツアー。](../debugger/debugger-feature-tour.md)  

## <a name="frequently-asked-questions"></a>よく寄せられる質問

#### <a name="how-is-intellitrace-step-back-different-from-intellitrace-events-only-mode"></a>IntelliTrace ステップ ライトバックの IntelliTrace イベントのみのモードからさまざまな方法

イベントのみのモードでの IntelliTrace を使用して、デバッグの履歴のブレークポイントとデバッガーのステップでアクティブ化するのにはできます。 ただし、IntelliTrace は、内のデータのみをキャプチャ、**ローカル**と **[自動変数]** ウィンドウが開いて、およびのみが展開されているデータをキャプチャした場合に、windows とビューにします。 イベントのみのモードにする多くの場合はありません変数や複雑なオブジェクトの完全なビュー。 さらに、式の評価と表示内のデータ、**ウォッチ**ウィンドウはサポートされていません。 

イベントとスナップショット モードでは、IntelliTrace は、複雑なオブジェクトを含む、アプリケーションのプロセスの全体のスナップショットをキャプチャします。 行のコードでは、ブレークポイントで停止された (および情報を以前に拡大するかどうかは関係ありません) かのように、同じ情報を表示できます。 式の評価は、スナップショットを表示するときにもサポートされます。  

#### <a name="what-is-the-performance-impact-of-this-feature"></a>この機能のパフォーマンスに与える影響とは何ですか。 

ステップ実行の全体的なパフォーマンスに対する影響は、アプリケーションによって異なります。 スナップショットのオーバーヘッドは、約 30 ミリ秒です。 スナップショットが作成されるときに、アプリのプロセスが分割され、分岐したコピーが中断されます。 スナップショットを表示したときに、Visual Studio は、プロセスの分岐したコピーをアタッチします。 各スナップショットは、Visual Studio は、ページのテーブルのみをコピーし、ページをコピー オン ライトに設定します。 デバッガーのステップに関連付けられたスナップショット間でヒープのオブジェクトを変更する場合、それぞれのページ テーブルは、コピーされ、最小限のメモリ コスト。 Visual Studio では、スナップショットを作成するための十分なメモリがないことが検出する場合、に取りませんいずれか。
 
## <a name="known-issues"></a>既知の問題  
* Windows 10 に収まる作成者更新 (RS3) よりも古い Windows のバージョンの IntelliTrace イベントとスナップショット モードを使用している場合、およびアプリケーションのデバッグ プラットフォーム ターゲットが x86 に設定されている場合は、IntelliTrace はスナップショットを取得できません。

    回避策:
    * インストールまたは Windows 10 に収まる作成者 Update (RS3) にアップグレードします。 
    * 代わりにします。 
        1. Visual Studio インストーラーからデスクトップ (x86、x64) コンポーネント用の VC++ 2015.3 v140 ツールセットをインストールします。
        2. 対象アプリケーションをビルドします。
        3. コマンド ライン ツールを使用して editbin 設定、`Largeaddressaware`実行可能ファイルの対象のフラグ。 たとえば、(変更後のパスを更新するには) このコマンドを使用する場合があります:"C:\Program Files (x86) \Microsoft Visual Studio\Preview\Enterprise\VC\Tools\MSVC\14.12.25718\bin\Hostx86\x86\editbin.exe"/Largeaddressaware"C:\Path\To\Application\app.exe"です。
        4. デバッグを開始するには、**F5** キーを押します。 ここで、ブレークポイントとデバッガーのステップでスナップショットを取得します。

        > [!Note]
        > `Largeaddressaware`実行可能ファイルが変更を再構築するたびにフラグを設定する必要があります。

* アプリケーションのプロセスのスナップショットが作成されて保存されているメモリ マップト ファイルを使用するアプリケーションの場合にスナップショットを使用して、プロセスは (親プロセスには、そのロックが解放) の後もメモリ マップト ファイルに対する排他ロックを保持します。 他のプロセスは、読み取り、ですが、メモリ マップト ファイルに書き込まれません。

    回避策:
    * すべてのスナップショットをオフには、デバッグ セッションを終了します。 

* アプリケーションがプロセスには、多数のアプリケーションでは、Dll の数が多いなどの一意のメモリ領域をデバッグするときにスナップショットが有効になっているとパフォーマンスをステップ実行受ける可能性があります。 Windows の将来のバージョンでは、この問題が修正されます。 この問題が発生する場合に到達でお知らせstepback@microsoft.comです。 

* 持つファイルを保存するときに**デバッグ > IntelliTrace > の保存の IntelliTrace セッション**イベントとスナップショット モードの場合、スナップショットからキャプチャされた追加のデータは、.itrace ファイルにします。 ブレークポイントおよびステップのイベントには、IntelliTrace イベントのみのモードでファイルを保存した場合と同じ情報が表示されます。 

## <a name="next-steps"></a>次の手順

このチュートリアルでは、IntelliTrace ステップ ライトバックを使用する方法を学びました。 他の IntelliTrace 機能の詳細についてを知りたい場合があります。

> [!div class="nextstepaction"]
> [IntelliTrace の機能](../debugger/intellitrace-features.md)
