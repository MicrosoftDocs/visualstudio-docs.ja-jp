---
title: 'チュートリアル: マルチ スレッド アプリケーションのデバッグ |Microsoft Docs'
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-debug
ms.topic: conceptual
dev_langs:
- FSharp
- VB
- CSharp
- C++
helpviewer_keywords:
- multithreaded debugging, walkthrough
- walkthroughs, multithreaded debugging
ms.assetid: 590ffd57-0556-43d8-8962-ee27e5b2b7d7
caps.latest.revision: 42
author: MikeJo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: 8fead0386d1ba820be21e65009c78791c7368bcd
ms.sourcegitcommit: 8b538eea125241e9d6d8b7297b72a66faa9a4a47
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/23/2019
ms.locfileid: "58978062"
---
# <a name="walkthrough-debugging-a-multithreaded-application"></a>チュートリアル: マルチ スレッド アプリケーションのデバッグ
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

[!INCLUDE[vs_dev11_long](../includes/vs-dev11-long-md.md)] では、改良された**スレッド**ウィンドウとその他のユーザー インターフェイスのマルチ スレッド アプリケーションをデバッグするが簡単に強化します。 このチュートリアルにはあまり時間がかかりませんが、これを完了することで、マルチスレッド アプリケーションのデバッグに使用する新しいインターフェイスを理解できます。  
  
 このチュートリアルを始めるには、マルチスレッド アプリケーション プロジェクトが必要です。 次の手順に従って、このようなプロジェクトを作成します。  
  
#### <a name="to-create-the-walkthrough-project"></a>チュートリアル用のプロジェクトを作成するには  
  
1.  **ファイル** メニューの 選択**新規** をクリックし、**プロジェクト**します。  
  
     **[新しいプロジェクト]** ダイアログ ボックスが表示されます。  
  
2.  **プロジェクトの種類**s ボックスに、好みの言語をクリックします。**Visual Basic**、 **Visual C#**、または**Visual C**します。  
  
3.  **テンプレート**ボックスで、選択**コンソール アプリケーション**または**CLR コンソール アプリケーション**します。  
  
4.  **名前**ボックスの [名前] を入力します。  
  
5.  **[OK]** をクリックします。  
  
     新しいコンソール プロジェクトが表示されます。 プロジェクトが作成されると、ソース ファイルが表示されます。 選択した言語に応じて、ソース ファイル名はそれぞれ Module1.vb、Program.cs、MyThreadWalkthroughApp.cpp などとなります。  
  
6.  ソース ファイルに表示されるコードを削除し、トピックのスレッドの作成」セクションに表示される例のコードに置き換えます[スレッドの作成と開始時にデータを渡す](http://msdn.microsoft.com/library/52b32222-e185-4f42-91a7-eaca65c0ab6d)します。  
  
7.  **[ファイル]** メニューの **[すべてを保存]** をクリックします。  
  
#### <a name="to-begin-the-walkthrough"></a>チュートリアルを開始するには  
  
-   ソース コード ウィンドウで、次のコードを探します。  
  
    ```vb  
    Thread.Sleep(3000)   
    Console.WriteLine(  
    ```  
  
```csharp  
Thread.Sleep(3000);  
Console.WriteLine();  
```  
  
```cpp  
Thread::Sleep(3000);  
Console.WriteLine();  
```  
  
#### <a name="to-start-debugging"></a>デバッグを開始するには  
  
1.  右クリックし、`Console.WriteLine`ステートメントでは、ポイント**ブレークポイント**順にクリックします**ブレークポイントの挿入**します。  
  
     ソース ウィンドウ左端の余白に赤い丸が表示されます。 これは、ブレークポイントがその場所に設定されていることを示します。  
  
2.  **[デバッグ]** メニューの **[デバッグの開始]** をクリックします。  
  
     デバッグが開始され、コンソール アプリケーションの実行が始まり、ブレークポイントで停止します。  
  
3.  このとき、フォーカスがコンソール アプリケーション ウィンドウにある場合は、[!INCLUDE[vsprvs](../includes/vsprvs-md.md)] ウィンドウの内側をクリックして、フォーカスを [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] に戻します。  
  
4.  ソース ウィンドウで、次のコードが含まれている行を探します。  
  
    ```vb  
    Thread.Sleep(5000)   
    ```  
  
```csharp  
Thread.Sleep(3000);  
```  
  
```cpp  
Thread::Sleep(3000);  
```  
  
1.  
  
#### <a name="to-discover-the-thread-marker"></a>スレッド マーカーを見つけるには  
  
1. 右クリックし、**スレッド**ウィンドウで、 をクリックし、**ソース スレッドを表示**。  
  
2. ウィンドウ左端の余白に注目します。 マーカーがある行には、2 色のより糸の形をしたアイコンがあります。 色は、片方は赤で、もう片方は青です。 スレッド マーカーは、スレッドが停止している位置を示します。 このことから、スレッドはこの位置で停止していると考えられます。  
  
3. スレッド マーカーの上にポインターを置きます。 データヒントが表示されます。 データヒントは、停止したスレッドごとに名前とスレッド ID 番号を表示します。 この場合、スレッドは 1 つだけで、名前は `<noname>` です。  
  
4. スレッド マーカーを右クリックします。 ショートカット メニューに表示される項目に注目します。  
  
   このアイコンは、*スレッド マーカー*:  
  
   ![スレッド マーカー](../debugger/media/threadmarker.gif "ThreadMarker")  
  
## <a name="flagging-and-unflagging-threads"></a>スレッドに対するフラグの設定と設定解除  
 [!INCLUDE[vs_orcas_long](../includes/vs-orcas-long-md.md)] では、特に注目するスレッドにフラグを設定できます。 スレッドに対するフラグの設定は、重要なスレッドを追跡し、注目する必要がないスレッドを無視するのに適しています。  
  
#### <a name="to-flag-threads"></a>スレッドにフラグを設定するには  
  
1.  **ビュー**メニューで、**ツールバー**します。  
  
     必ず、**デバッグの場所**ツールバーが選択されています。  
  
2.  移動して、**デバッグの場所**ツールバーをクリックして、**スレッド**一覧。  
  
    > [!NOTE]
    >  このツールバーは、著名な 3 つのリストで識別できます。**プロセス**、**スレッド**、および**のスタック フレーム**します。  
  
3.  ボックスに表示されているスレッド数に注目します。  
  
4.  右クリックして、ソース ウィンドウに戻り、**スレッド**マーカーをもう一度です。  
  
5.  ショートカット メニューのをポイント**フラグ**スレッドの名前と ID 番号を順にクリックします。  
  
6.  戻り**デバッグの場所**ツールバーをクリックして、**スレッド**一覧を再度表示します。  
  
     今度は、フラグが設定されたスレッドのみがボックスに表示されます。 右側にあるフラグ ボタンをクリック、**スレッド**一覧。 そのボタンに表示されるフラグ アイコンは、それまでは淡色表示でした。 明るい赤で塗りつぶされたアイコンに変わっていることを確認します。  
  
7.  フラグ アイコンの上にポインターを置きます。  
  
     ポップアップが表示されます。 このポップアップはどのようなモード、**スレッド**リストします。**表示するには、スレッドのみフラグが設定された**します。  
  
8.  切り替わりますフラグ ボタンをクリックして**すべてのスレッド**モード。  
  
9. をクリックして、**スレッド**リストをもう一度をできるようになりましたも表示されるすべてのスレッドを確認します。  
  
10. 切り替わりますフラグ ボタンをクリックして**フラグが設定されたスレッドのみを表示する**します。  
  
11. **[デバッグ]** メニューの **[ウィンドウ]** をポイントし、**[スレッド]** をクリックします。  
  
     **スレッド**ウィンドウが表示されます。 1 つのスレッドに、目立つ色のフラグ アイコンが割り当てられています。  
  
12. ソース ウィンドウで、スレッド マーカーをもう一度右クリックします。  
  
     ショートカット メニューに今回表示される項目に注目します。 代わりに**フラグ**、今参照**フラグ解除**します。 クリックしてしないでください**フラグ解除**します。  
  
13. スレッドのフラグ解除に関する次の手順に進みます。  
  
#### <a name="to-unflag-threads"></a>スレッドのフラグを解除するには  
  
1.  **スレッド**ウィンドウで、フラグが設定されたスレッドに対応する行を右クリックします。  
  
     ショートカット メニューが表示されます。 メニュー項目に**フラグ解除**と**すべてのフラグを解除**します。  
  
2.  スレッドのフラグをクリックします。**フラグ解除**します。  
  
3.  赤いフラグ アイコンをクリックします。  
  
4.  見て、**デバッグの場所**ツールバーにもう一度です。 フラグ ボタンが再び淡色表示になっていることを確認します。 フラグ解除されたのは、フラグが設定された唯一のスレッドでした。 フラグが設定されたスレッドがないため、ツールバーに戻ります**すべてのスレッド**モード。 をクリックして、**スレッド**ボックスの一覧し、すべてのスレッドを表示できることを確認します。  
  
5.  戻り、**スレッド**ウィンドウ情報列を確認します。  
  
     各列の先頭に表示されるボタンのほとんどに、列の内容を示すタイトルが表示されます。 ただし、左端の列にはタイトルはありません。 その代わりにアイコンがありますが、これはフラグの枠です。 スレッドの一覧の各行にも同じ枠があります。 この枠は、スレッドにフラグが設定されていないことを示しています。  
  
6.  一覧の下から 2 番目と 3 番目の 2 つのスレッドのフラグ枠をクリックします。  
  
     フラグ アイコンが中空の枠から塗りつぶされた赤に変わります。  
  
7.  フラグ列の最上部にあるボタンをクリックします。  
  
     このボタンをクリックすると、スレッドの一覧順序が変わります。 スレッドのリストが並べ替えられ、フラグが設定されたスレッドが先頭になります。  
  
8.  再び、フラグ列の最上部にあるボタンをクリックします。  
  
     並べ替え順序がまた変わります。  
  
## <a name="more-about-the-threads-window"></a>[スレッド] ウィンドウの詳細  
  
#### <a name="to-learn-more-about-the-threads-window"></a>[スレッド] ウィンドウについての理解を深めるには  
  
1.  **スレッド**ウィンドウで、左から 3 番目の列を確認します。 この列の上部にあるボタンの表示が**ID**します。  
  
2.  クリックして**ID**します。  
  
     スレッドの一覧がスレッド ID 番号で並べ替えられます。  
  
3.  一覧の中から任意のスレッドを右クリックします。 ショートカット メニューで、 **16 進数表示**します。  
  
     スレッド ID 番号の書式が変わります。  
  
4.  マウス ポインターを一覧の任意のスレッドの上に置きます。  
  
     少し遅れて、データヒントが表示されます。 ここには、スレッドの呼び出し履歴の一部が表示されます。  
  
5.  ラベルが付いた、左から 4 番目の列を見て**カテゴリ**します。 スレッドはカテゴリ別に分類されています。  
  
     プロセスで最初に作成されたスレッドは、メイン スレッドと呼ばれます。 スレッドの一覧でそれを探します。  
  
6.  メイン スレッドを右クリックし、をクリックし、**スレッドに切り替える**します。  
  
     警告ダイアログ ボックスが表示されます。 そこには、[!INCLUDE[vsprvs](../includes/vsprvs-md.md)] がメイン スレッドのソース コードを表示できないというメッセージが表示されます。  
  
     **[OK]** をクリックします。  
  
7.  見て、**呼び出し履歴**ウィンドウと**デバッグの場所**ツールバー。  
  
     内容、**呼び出し履歴**ウィンドウが変更されました。  
  
## <a name="switching-the-active-thread"></a>アクティブ スレッドの切り替え  
  
#### <a name="to-switch-threads"></a>スレッドを切り替えるには  
  
1.  **スレッド**ウィンドウで、左から 2 番目の列を確認します。 この列の最上部にあるボタンにはテキストもアイコンもありません。 この列は、**アクティブ スレッド**列。  
  
2.  見て、**アクティブ スレッド**列と 1 つのスレッドが黄色の矢印を持つことに注意してください。 これは、*アクティブ スレッド インジケーター*します。  
  
3.  アクティブ スレッド インジケーターがあるスレッド ID 番号をメモしておきます。 これからアクティブ スレッド インジケーターを動かしますが、完了したら元に戻す必要があるためです。  
  
4.  別のスレッドを右クリックし、をクリックし、**スレッドに切り替える**します。  
  
5.  見て、**呼び出し履歴**ソース ウィンドウのウィンドウ。 内容が変わっていることを確認します。  
  
6.  見て、**デバッグの場所**ツールバー。 アクティブ スレッドも変わっていることを確認します。  
  
7.  移動して、**デバッグの場所**ツールバー。 をクリックして、**スレッド**ボックスし、ドロップダウン リストから別のスレッドを選択します。  
  
8.  見て、**スレッド**ウィンドウ。 アクティブ スレッド インジケーターが変わっていることを確認します。  
  
9. ソース ウィンドウで、スレッド マーカーを右クリックします。 ショートカット メニューのをポイント**に切り替える**スレッド名/ID 番号をクリックします。  
  
     3 つのアクティブなスレッドを変更する方法を確認できました: を使用して、**スレッド**ウィンドウで、**スレッド**ボックスに、**デバッグの場所**ツールバー、およびスレッド インジケーターで、ソース ウィンドウです。  
  
     スレッド インジケーターを使用すると、特定の場所で停止されたスレッドのみを切り替えることができます。 **[スレッド]** ウィンドウと **[デバッグの場所]** ツール バーを使用すると、任意のスレッドに切り替えることができます。  
  
## <a name="freezing-and-thawing-thread-execution"></a>スレッド実行の凍結と凍結解除  
  
#### <a name="to-freeze-and-unfreeze-threads"></a>スレッドを凍結および凍結解除するには  
  
1.  **スレッド**ウィンドウで、任意のスレッドを右クリックし、順にクリックします**固定**します。  
  
2.  アクティブ スレッド列に注目します。 2 本の垂直バーが表示されることを確認します。 この 2 本の青いバーは、スレッドが凍結していることを示しています。  
  
3.  見て、 **Suspend**列。 スレッドの中断カウントが 1 になっていることを確認します。  
  
4.  凍結されたスレッドを右クリックし、をクリックし、**凍結解除**します。  
  
     アクティブ スレッド列と**Suspend**列の変更。  
  
## <a name="see-also"></a>関連項目  
 [マルチスレッド アプリケーションのデバッグ](../debugger/debug-multithreaded-applications-in-visual-studio.md)   
 [方法: デバッグ中に別のスレッドに切り替える](../debugger/how-to-switch-to-another-thread-while-debugging.md)
