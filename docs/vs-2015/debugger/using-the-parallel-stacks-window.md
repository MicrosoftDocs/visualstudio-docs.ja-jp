---
title: '[並列スタック] ウィンドウを使用する |Microsoft Docs'
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-debug
ms.topic: conceptual
f1_keywords:
- vs.debug.parallelstacks
dev_langs:
- FSharp
- VB
- CSharp
- C++
helpviewer_keywords:
- debugger, parallel tasks window
ms.assetid: f50efb78-5206-4803-bb42-426ef8133f2f
caps.latest.revision: 22
author: MikeJo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: e89125c8e1dea25ab02fe64c21b8166e9d65194a
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/02/2020
ms.locfileid: "85542221"
---
# <a name="using-the-parallel-stacks-window"></a>[並列スタック] ウィンドウの使用
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

[ **並列スタック** ] ウィンドウは、マルチスレッドアプリケーションをデバッグする場合に便利です。 **スレッドビュー**には、アプリケーション内のすべてのスレッドの呼び出し履歴情報が表示されます。 これを使用して、スレッドとそれらのスレッドのスタック フレームの間を移動できます。 マネージコードでは、[ **タスク] ビュー** にオブジェクトの呼び出し履歴が表示され <xref:System.Threading.Tasks.Task?displayProperty=fullName> ます。 ネイティブコードでは、タスク **ビュー** には、 [タスクグループ](https://msdn.microsoft.com/library/42f05ac3-2098-494a-ba84-737fcdcad077)、 [並列アルゴリズム](https://msdn.microsoft.com/library/045dca7b-4d73-4558-a44c-383b88a28473)、 [非同期エージェント](https://msdn.microsoft.com/library/6cf6ccc6-87f1-4e14-af15-ea8ba58fef1a)、および [軽量タスク](https://msdn.microsoft.com/library/9aba278c-e0c9-4ede-b7c6-fedf7a365d90)の呼び出し履歴が表示されます。  
  
## <a name="threads-view"></a>スレッド ビュー  
 次の図は、Main から A、B の順に移行した後に外部コードに移った 1 つのスレッドと、 同じ外部コードから始まり A に移行した他の 2 つのスレッドを示しています。そのうちの 1 つは、その後 B を経て外部コードに移り、もう一方は C を経て AnonymousMethod に移っています。  
  
 ![並列スタック ウィンドウのスレッド ビュー](../debugger/media/parallel-stacksthread.png "Parallel_StacksThread")  
  
 図に示すように、現在のスレッドの呼び出しパスは青で強調表示され、アクティブなスタック フレームは黄色の矢印で示されます。 [ **並列スタック** ] ウィンドウで別のメソッドを選択して、現在のスタックフレームを変更できます。 このとき、選択したメソッドが既に現在のスレッドの一部であるか別のスレッドの一部であるかに応じて、現在のスレッドも切り替わる場合があります。 次の表では、図に示すように、[ **並列スタック** ] ウィンドウの主な機能について説明します。  
  
|コールアウトの文字|要素名|説明|  
|--------------------|------------------|-----------------|  
|A|呼び出し履歴のセグメントまたはノード|1 つ以上のスレッドの一連のメソッドのコンテキストが含まれます。 ノードに矢印の線が結ばれていない場合は、スレッドのすべての呼び出しパスを表します。|  
|B|青の強調表示|現在のスレッドの呼び出しパスを示します。|  
|C|矢印の線|ノードを結び、スレッドのすべての呼び出しパスを構成します。|  
|D|ノードのヘッダーのツールヒント|呼び出しパスがこのノードを共有する各スレッドの ID とユーザー定義名を示します。|  
|E|メソッドのコンテキスト|同じメソッド内の 1 つ以上のスタック フレームを表します。|  
|F|メソッドのコンテキストのツールヒント|スレッドビューでは、[ **スレッド** ] ウィンドウと同様に、テーブル内のすべてのスレッドが表示されます。 タスクビューでは、[ **並列タスク** ] ウィンドウと同様に、テーブル内のすべてのタスクが表示されます。|  
  
 さらに、[並列スタック] ウィンドウには、グラフが大きすぎてウィンドウに収まりきらない場合に、メインウィンドウに **概観ビュー** アイコンが表示されます。 このアイコンをクリックすると、ウィンドウ内にグラフ全体を表示できます。  
  
## <a name="method-context-icons"></a>メソッドのコンテキストのアイコン  
 アクティブなスタック フレームと現在のスタック フレームに関する情報を示すアイコンを次の表に示します。  
  
|アイコン|説明|  
|-|-|
|![並列スタックの黄色の矢印](../debugger/media/icon-parallelyellowarrow.gif "Icon_ParallelYellowArrow")|メソッドのコンテキストに現在のスレッドのアクティブなスタック フレームが含まれていることを示します。|  
|![並列スタック スレッドのアイコン](../debugger/media/icon-parallelthreads.gif "Icon_ParallelThreads")|メソッドのコンテキストに現在のスレッド以外のアクティブなスタック フレームが含まれていることを示します。|  
|![並列スタックの緑色の矢印](../debugger/media/icon-parallelgreenarrow.gif "Icon_ParallelGreenArrow")|メソッドのコンテキストに現在のスタック フレームが含まれていることを示します。 対応するメソッド名は、表示されるすべてのノードで太字で表されます。|  
  
## <a name="toolbar-controls"></a>ツール バー コントロール  
 次の図と表は、[並列スタック] のツール バーで使用できるコントロールを示したものです。  
  
 ![並列スタック ウィンドウのツール バー](../debugger/media/parallel-stackstoolbar.png "Parallel_StacksToolbar")  
  
|コールアウトの文字|コントロール|説明|  
|--------------------|-------------|-----------------|  
|A|[スレッド]/[タスク] ボックス|スレッドの呼び出し履歴とタスクの呼び出し履歴の表示を切り替えます。 詳細については、「タスク ビュー」および「スレッド ビュー」を参照してください。|  
|B|[フラグが設定されたもののみを表示]|[ **GPU スレッド** ] ウィンドウや [ **並列ウォッチ** ] ウィンドウなど、他のデバッグウィンドウでフラグが設定されているスレッドの呼び出し履歴のみを表示します。|  
|C|[メソッド ビューの切り替え]|スタック ビューとメソッド ビューを切り替えます。 詳細については、「メソッド ビュー」を参照してください。|  
|D|[現在のスタック フレームに自動スクロール]|現在のスタック フレームがビューに表示されるように図を自動でスクロールします。 この機能は、他のウィンドウから現在のスタック フレームを変更する場合や、大きなダイアグラム内で新しいブレークポイントにヒットした場合に役立ちます。|  
|E|[ズーム コントロールの切り替え]|ズーム コントロールの表示と非表示を切り替えます。 ズームコントロールを表示するかどうかに関係なく、CTRL キーを押しながらマウスホイールを回すか、 **ctrl + shift + ' + '** を使用してズームインし、 **ctrl + shift + '-'** を使用してズームアウトすることもできます。CTRL キーを押し **ながら F8** キーを押すと、画面に合わせることができます。|  
  
### <a name="context-menu-items"></a>コンテキスト メニュー項目  
 次の図と表は、スレッド ビューまたはタスク ビューでメソッドのコンテキストを右クリックしたときに使用できるショートカット メニュー項目を示したものです。 最後の 6 つの項目は、[呼び出し履歴] ウィンドウの機能をそのまま使用したものであり、動作も同じになります。  
  
 ![並列スタック ウィンドウのショートカット メニュー](../debugger/media/parallel-contmenu.png "Parallel_ContMenu")  
  
|メニュー項目|説明|  
|---------------|-----------------|  
|フラグ|選択した項目にフラグを設定します。|  
|フラグ解除|選択した項目のフラグを解除します。|  
|Freeze|選択した項目を凍結します。|  
|凍結解除|選択した項目の凍結を解除します。|  
|[タスクに移動] ([スレッドに移動])|実行される機能はツール バーのボックスと同じですが、同じスタック フレームが強調表示されたままになります。|  
|[ソース コードへ移動]|ユーザーが右クリックしたスタック フレームに対応するソース コード内の位置に移動します。|  
|[フレームに切り替え]|[呼び出し履歴] ウィンドウの対応するメニュー コマンドと同じです。 ただし、[並列スタック] では、複数のフレームが 1 つのメソッドのコンテキストに対応する場合があります。 そのため、このメニュー項目には、それぞれ特定のスタック フレームを表すサブメニューがあります。 現在のスレッドのスタック フレームが 1 つだけの場合は、そのスタック フレームに対応するメニューが選択されます。|  
|[逆アセンブルを表示]|ユーザーが右クリックしたスタック フレームに対応する逆アセンブル ウィンドウ内の位置に移動します。|  
|[外部コードの表示]|外部コードの表示と非表示を切り替えます。|  
|[16 進数で表示]|10 進数と 16 進数の表示を切り替えます。|  
|シンボルの読み込み情報|対応するダイアログ ボックスを表示します。|  
|[シンボルの設定]|対応するダイアログ ボックスを表示します。|  
  
## <a name="tasks-view"></a>タスク ビュー  
 アプリケーションが <xref:System.Threading.Tasks.Task?displayProperty=fullName> オブジェクト (マネージコード) またはオブジェクト (ネイティブコード) を使用して並列処理を表現している場合は、 `task_handle` [並列スタック] ウィンドウのツールバーにあるコンボボックスを使用して、[ *タスク] ビュー*に切り替えることができます。 タスク ビューには、スレッドではなくタスクの呼び出し履歴が表示されます。 タスク ビューがスレッド ビューと異なる点は次のとおりです。  
  
- タスクを実行していないスレッドの呼び出し履歴は表示されません。  
  
- タスクを実行しているスレッドの呼び出し履歴は上下の項目が非表示になり、タスクに関連する重要なフレームだけが表示されます。  
  
- 1 つのスレッドに複数のタスクがある場合、それらのタスクの呼び出し履歴が個々のノードに分けられます。  
  
  次の図は、右側に [並列スタック] のタスク ビュー、左側に対応するスレッド ビューを示したものです。  
  
  ![[並列スタック] ウィンドウのタスク ビュー](../debugger/media/parallel-tasksview.png "Parallel_TasksView")  
  
  呼び出し履歴全体を表示するには、スタックフレームを右クリックし、[ **スレッドに移動**] をクリックするだけで、スレッドビューに戻ります。  
  
  前の表で説明したように、メソッドのコンテキストにカーソルを置くと詳しい情報を表示できます。 次の図は、スレッド ビューおよびタスク ビューのツールヒントに表示される情報を示しています。  
  
  ![並列スタック ウィンドウのツールヒント](../debugger/media/parallel-stack-tooltips.png "Parallel_Stack_Tooltips")  
  
## <a name="method-view"></a>メソッド ビュー  
 スレッド ビューまたはタスク ビューでツール バーの [メソッド ビュー] アイコンをクリックすると、現在のメソッドを中心とするグラフを表示できます。 メソッド ビューを使用すると、現在のメソッドを呼び出すか現在のメソッドから呼び出されるすべてのスレッドのすべてのメソッドを一目で確認できます。 次の図は、スレッド ビューと共に、同じ情報がメソッド ビューではどのように表示されるかを示したものです。  
  
 ![[並列スタック] ウィンドウのメソッド ビュー](../debugger/media/parallel-methodview.png "Parallel_MethodView")  
  
 新しいスタック フレームに切り替えると、そのメソッドが現在のメソッドになり、新しいメソッドのすべての呼び出し元と呼び出し先がウィンドウに表示されます。 これにより、そのメソッドが呼び出し履歴に含まれているかどうかに応じて、一部のスレッドの表示と非表示が切り替わる場合があります。 スタック ビューに戻るには、ツール バーの [メソッド ビュー] ボタンをもう一度クリックします。  
  
## <a name="see-also"></a>参照  
 [チュートリアル: 並行アプリケーションのデバッグ](../debugger/walkthrough-debugging-a-parallel-application.md)   
 [デバッガーの基本](../debugger/debugger-basics.md)   
 [マネージコードのデバッグ](../debugger/debugging-managed-code.md)   
 [並列プログラミング](https://msdn.microsoft.com/library/4d83c690-ad2d-489e-a2e0-b85b898a672d)   
 [[タスク] ウィンドウの使用](../debugger/using-the-tasks-window.md)   
 [チュートリアル: 並行アプリケーションのデバッグ](../debugger/walkthrough-debugging-a-parallel-application.md)   
 [Task クラス](../extensibility/debugger/task-class-internal-members.md)
