---
title: 分離シェルアプリケーションのサービスのガイドライン |Microsoft Docs
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- Visual Studio Shell integrated mode, serviceability
- Shell integrated mode [Visual Studio], serviceability
ms.assetid: 747d1a47-b8b3-4e8b-93c0-768724be48f2
caps.latest.revision: 16
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: 093690c293ff6857eedc50d5eccc793d7d5bb114
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/02/2020
ms.locfileid: "68159272"
---
# <a name="servicing-guidelines-for-isolated-shell-applications"></a>分離シェル アプリケーションのガイドラインの提供
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Visual Studio の分離シェルアプリケーションを配布する場合は、インストール後にアプリケーションのソフトウェア更新プログラムを提供できる必要があります。 これを行うには、Microsoft インストーラー (MSI) ファイルを使用してアプリケーションをインストールする必要があります。 この種のインストールにより、Microsoft が提供するソフトウェアの更新を Web からダウンロードして、ユーザーの介入なしで顧客が使用できるようにすることができます。  
  
## <a name="servicing-requirements"></a>サービスの要件  
 インストールプログラムが次の3つの条件を満たしていることを確認することで、分離シェルのインストールで更新が許可されていることを確認できます。  
  
### <a name="redistribute-by-using-an-msi"></a>MSI を使用して再配布する  
 Msi を使用してアプリケーションを再配布する必要があります。これは、MSI が製品 id を保持し、アプリケーションの物理的な場所がクライアントコンピューター上にあることを確認するためです。 マージモジュール (.msm ファイル) はこのような保証を提供しないため、使用しないでください。  
  
### <a name="accounting-for-custom-actions"></a>カスタムアクションのアカウンティング  
 カスタムアクションは、インストーラープログラムの標準ではないインストールディレクティブです。 カスタムアクションでは、ファイルの場所、レジストリの設定、ユーザー設定、またはその他のインストール項目などのパラメーターが変更されます。 カスタムアクションは、インストール時にデータを操作する場合があります。  
  
 インストールプログラムでカスタムアクションを使用する場合は、ユーザーがアプリケーションをアンインストールするときに操作を元に戻すために、すべてのインストール時カスタムアクションに対応するカスタムアクションが必要であることを確認する必要があります。 インストールプログラムが、対応するアンインストールカスタムアクションを提供できない場合、アプリケーションを削除すると、そのアプリケーションが部分的にインストールされたままになります。  
  
- 特定のバージョンのファイルまたはハッシュ値に依存するカスタム動作は、ソフトウェア更新プログラムによってこれらのバージョンまたはハッシュ値が変更されると失敗します。 この場合、カスタム動作でこれらの値を手動で更新する必要があります。 ファイルまたはハッシュ値のバージョンが製品のバージョン間で共有されている場合、追加の問題が発生します。 可能な限り、この依存関係は避けてください。  
  
### <a name="accounting-for-shared-files"></a>共有ファイルのアカウンティング  
 共有ファイルは同じ名前で、複数の製品によって同じ場所にインストールされます。 これらの製品は、バージョン、在庫保持ユニット (SKU)、またはその両方で異なる場合があり、製品は特定のコンピューターに共存できます。 ただし、共有ファイルは、いくつかの理由からサービスの問題を作成します。  
  
- 共有ファイルを更新すると、アプリケーションの互換性の問題が発生する可能性があります。1つのアプリケーションに対する更新によって、更新されていない2つ目のアプリケーションで使用されるファイルのバージョンが変更される可能性があるためです ファイルを共有する製品のインストーラーは、共有ファイルへの参照をカウントします。 そのため、製品をアンインストールしても、インストールされているインスタンスの数を減らす以外に、共有ファイルには影響しません。  
  
- Quick Fix Engineering (QFE) インストーラーは、QFE インストーラーがサービスを提供した製品のバージョンにファイルのバージョンを戻します。 このプロセスは、更新された共有ファイルを配信したアプリケーションを中断する可能性があります。
