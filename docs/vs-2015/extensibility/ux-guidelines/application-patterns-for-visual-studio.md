---
title: Visual Studio のアプリケーション パターン |Microsoft Docs
ms.custom: ''
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.reviewer: ''
ms.suite: ''
ms.technology:
- vs-ide-sdk
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 8ed68602-4e28-46fe-b39f-f41979b308a2
caps.latest.revision: 8
ms.author: gregvanl
manager: ghogen
ms.openlocfilehash: d3c0be041628d840908b1814e26f14a488651603
ms.sourcegitcommit: af428c7ccd007e668ec0dd8697c88fc5d8bca1e2
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/16/2018
ms.locfileid: "51748466"
---
# <a name="application-patterns-for-visual-studio"></a>Visual Studio のアプリケーション パターン
[!INCLUDE[vs2017banner](../../includes/vs2017banner.md)]

##  <a name="BKMK_WindowInteractions"></a> ウィンドウの相互作用  
  
### <a name="overview"></a>概要  
 Visual Studio で使用される 2 つのメイン ウィンドウの型は、ドキュメント エディターやツール ウィンドウです。 まれですが、可能な大規模なモードレス ダイアログ ボックスが。 これらは、シェルでモードレスすべてが、そのパターンは根本的に異なるです。 このトピックでは、ドキュメント ウィンドウ、ツール ウィンドウ、モードレス ダイアログ ボックスの違いについて説明します。 モーダル ダイアログのパターンは、「[ダイアログ](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_Dialogs)します。  
  
### <a name="comparing-window-usage-patterns"></a>ウィンドウの使用状況パターンの比較  
 **ドキュメント ウィンドウ**ほぼ常に表示されるドキュメント内でも。 これにより、ドキュメント エディター"center ステージ"に関する補足的なツール ウィンドウを配置します。  
  
 A**ツール ウィンドウ**が IDE の端に対する – 表示、非表示、または自動的に隠された存在することがより小さなウィンドウが折りたたまれている、最も多く表示されます。 ただし、場合があります記載されている、ドキュメント内をオフにして、**ウィンドウとドッキング**ウィンドウのプロパティ。 これは、結果、不動産、詳細が、一般的な設計の決定も: Visual Studio に統合しようとすると、ツール ウィンドウまたはドキュメント ウィンドウに、機能を表示する必要があるかどうかを決定する必要があります。  
  
 **モードレス ダイアログ**Visual Studio ではありません。 多くの場合は – 定義 – 浮動ツール ウィンドウとように実装する必要があります。 モードレス ダイアログ ボックスは、シェルの側にドッキングされている標準ツール ウィンドウのサイズにも制限は、ケースで許可されます。 できる場合は、ユーザーがダイアログをセカンダリのモニターに移動する可能性が高いでしょう。  
  
 慎重にどのコンテナーの種類について必要があると考えてください。 UI 設計のため、共通の使用状況パターンに関する考慮事項は、次の表にされます。  
  
||ドキュメント ウィンドウ|ツール ウィンドウ|モードレス ダイアログ|  
|-|---------------------|-----------------|---------------------|  
|**[Position]**|常にも、ドキュメント内に位置し、IDE の端にドッキングしません。 これは、ことができます「から取り出す」できるように、メインのシェルから個別に寄せて配置されます。|IDE の端に通常タブ ドッキング (固定)、配置するカスタマイズされた、自動非表示することができますが、またはも、ドキュメント内でドッキングします。|IDE から独立した大規模なフローティング ウィンドウ。|  
|**モデルをコミットします。**|*遅延コミット*<br /><br /> ドキュメント内のデータを保存するには、ユーザーは、ファイルと保存、名前を付けて保存、またはすべてを保存コマンドを実行する必要があります。 ドキュメント ウィンドウが、保存のいずれかにコミットし、「変更」内のデータの概念コマンド。 ドキュメント ウィンドウを閉じるときにすべての内容のディスクに保存されたありまたは紛失のいずれか。|*即時のコミット*<br /><br /> 保存されていないモデル。 ファイルを編集するを支援する inspector ツール ウィンドウ、ファイルは、アクティブなエディターまたはデザイナーで開く必要があり、エディターまたはデザイナーは、保存を所有します。|*遅延または即時のコミット*<br /><br /> 最も多くの場合は、大規模なモードレス ダイアログ ボックスでは、変更をコミットするアクションが必要で、ダイアログのセッション内で加えられた変更をロールバック「キャンセル」操作をできます。  これにより、ツール ウィンドウが常に直ちにコミット モデルがあることで、ツール ウィンドウからモードレス ダイアログが区別されます。|  
|**可視性**|*開く/(ファイル) を作成し、閉じる*<br /><br /> ドキュメント ウィンドウを開くと、既存のドキュメントを開くか、新しいドキュメントを作成するテンプレートを使用してによって行われます。 ない"開いている\<特定のエディター >"コマンド。|*非表示にして表示*<br /><br /> 単一インスタンスのツール ウィンドウを非表示または表示できます。 ビュー内かどうかの内容と、ツール ウィンドウ内の状態を永続化または非表示します。 マルチ インスタンス ツールできますが閉じられただけでなく windows 非表示になります。 複数インスタンスのツール ウィンドウが閉じられたときに、コンテンツとツール ウィンドウ内の状態は破棄されます。|*コマンドからの起動*<br /><br /> ダイアログ ボックスは、タスク ベースのコマンドから起動されます。|  
|**インスタンス**|*複数インスタンス*<br /><br /> 一部のエディターは許可することも、同じファイルを 1 つ以上のエディターで開くときに、いくつかのエディターが、同じ時刻と異なるファイルを編集開くことができる (を使用して、**ウィンドウ > 新しいウィンドウ**コマンド)。<br /><br /> 単一のエディターが (プロジェクト デザイナー) と同時に 1 つまたは複数のファイルを編集することがあります。|*1 つまたは複数インスタンス*<br /><br /> コンテンツ (プロパティ ブラウザー) のようにコンテキストを使用するか (タスク一覧、ソリューション エクスプ ローラー) は、他のウィンドウにフォーカス/コンテキストのプッシュに変更されます。<br /><br /> ない限り、説得力のある理由に、単一インスタンスと複数インスタンスの両方のツール ウィンドウがアクティブなドキュメント ウィンドウを関連付ける必要があります。|*単一インスタンス*|  
|**例**|**テキスト エディター**、コード エディターなど<br /><br /> **デザイン サーフェイス**フォーム デザイナーなどのモデル化画面、<br /><br /> **ダイアログ ボックスのようなレイアウトを制御**、マニフェスト デザイナーなど|**ソリューション エクスプ ローラー**ソリューションと、ソリューション内に含まれるプロジェクトを提供します。<br /><br /> **サーバー エクスプ ローラー**を開く ウィンドウで、ユーザーが選択したサーバーとデータの接続の階層ビューを提供します。 クエリなど、データベース階層からオブジェクトを開く、ドキュメント ウィンドウが開き、クエリを編集できます。<br /><br /> **プロパティ ブラウザー**ドキュメント ウィンドウまたは別のツール ウィンドウのいずれかを選択したオブジェクトのプロパティが表示されます。 プロパティは、階層のグリッド ビューまたは複雑なダイアログのようなコントロールが表示され、ユーザーがこれらのプロパティの値を設定できるようにします。||  
  
##  <a name="BKMK_ToolWindows"></a> ツール ウィンドウ  
  
### <a name="overview"></a>概要  
 ツール ウィンドウは、ドキュメント ウィンドウ内で発生したユーザーの作業をサポートします。 Visual Studio が提供し、操作できる基本的なルート オブジェクトを表す階層を表示する、使用できます。  
  
 IDE の新しいツール ウィンドウを検討するときの作成者が必要です。  
  
-   タスクに適した既存のツール ウィンドウを使用して、同様の機能で新しいファイルを作成できません。 新しいツール ウィンドウは、大幅に異なる「ツール」または同様の期間に、またはピボット ハブに既存のウィンドウにすることで統合できない機能が提供される場合にのみ作成する必要があります。  
  
-   必要に応じて、ツール ウィンドウの上部にある場合は、標準のコマンド バーを使用します。  
  
-   コントロールのプレゼンテーションとキーボードのナビゲーションの他のツール ウィンドウに既に存在するパターンと一致します。  
  
-   他のツール ウィンドウでコントロールのプレゼンテーションと一致します。  
  
-   ドキュメントに固有のツール ウィンドウは、親ドキュメントをアクティブにするタイミングにのみ表示されるようにする、自動表示可能であればことがあります。  
  
-   (矢印キーをサポートする) のキーボードでナビゲート可能なウィンドウのコンテンツを確認します。  
  
#### <a name="tool-window-states"></a>ツール ウィンドウの状態  
 Visual Studio のツール ウィンドウでは、(自動的に隠す機能) のようなユーザー側でアクティブにその一部は、別の状態があります。 などの他の状態自動表示を正しいコンテキストに存在し、必要ない場合に非表示にするツール ウィンドウを許可します。 合計で 5 つのツール ウィンドウの状態があります。  
  
- **ドッキングされている固定**ツール ウィンドウは、ドキュメント領域の 4 辺のいずれかに接続できます。 ツール ウィンドウのタイトル バーの押しピン アイコンが表示されます。 ツール ウィンドウは、シェルと他のツール ウィンドウの端に沿って水平方向または垂直方向にドッキングでき、タブにリンクすることもできます。  
  
- **自動的に隠された**ツール ウィンドウは固定されません。 ウィンドウは、ドキュメント領域の端に (ツール ウィンドウの名前とアイコン) を持つタブを残したまま、見えないようにスライドできます。 ツール ウィンドウは、ユーザーがタブ上に置いたときにスライドします。  
  
- **自動表示**ツール ウィンドウは、エディターなど、UI のもう 1 つの要素が起動するかがフォーカスを取得するときに自動的に表示されます。  
  
- **浮動小数点**ツール ウィンドウを IDE の外部にポイントします。 これは、マルチ モニターの構成に役立ちます。  
  
- **タブ付きドキュメント**ツール ウィンドウをドキュメント内でもドッキングすることができます。 これは、複数の不動産、フレームの端にドッキング可能数を超える必要があるオブジェクト ブラウザーなどの大規模なツール ウィンドウに役立ちます。  
  
  ![ツール ウィンドウの状態で Visual Studio](../../extensibility/ux-guidelines/media/0702-01-toolwindowstates.png "0702 01_ToolWindowStates")  
  
  **Visual Studio でツール ウィンドウの状態**  
  
#### <a name="single-instance-and-multi-instance"></a>単一インスタンスと複数インスタンス  
 ツール ウィンドウとは、単一インスタンスまたは複数のインスタンスです。 いくつかの単一インスタンスのツール ウィンドウは、マルチ インスタンスのツール ウィンドウがない場合に、アクティブなドキュメント ウィンドウに関連する可能性があります。 マルチ インスタンスのツール ウィンドウは、ウィンドウの新しいインスタンスを作成して、ウィンドウ、新しいウィンドウ コマンドに応答します。 次の図は、ウィンドウのインスタンスがアクティブなときに、新しいウィンドウ コマンドを有効にするツール ウィンドウを示しています。  
  
 ![Visual Studio でのコマンドを有効にするツール ウィンドウ](../../extensibility/ux-guidelines/media/0702-02-toolwindowenablingcommand.png "0702 02_ToolWindowEnablingCommand")  
  
 **ツール ウィンドウのウィンドウのインスタンスがアクティブなときに、新規ウィンドウ コマンドを有効にします。**  
  
 単一インスタンスのツール ウィンドウを非表示または表示され、マルチ インスタンス ツールできますが閉じられただけでなく windows 非表示にできます。 タブでリンクされた、フローティング、または (ドキュメント ウィンドウに類似) マルチ ドキュメント インターフェイス (MDI) 子ウィンドウとして設定、すべてのツール ウィンドウをドッキングできます。 すべてのツール ウィンドウは、ウィンドウ メニューに適切なウィンドウ管理コマンドに応答する必要があります。  
  
 ![Visual Studio でのウィンドウ管理コマンド](../../extensibility/ux-guidelines/media/0702-03-windowmanagementcontrols.png "0702 03_WindowManagementControls")  
  
 **Visual Studio ウィンドウのメニュー ウィンドウ管理コマンド**  
  
#### <a name="document-specific-tool-windows"></a>ドキュメントに固有のツール ウィンドウ  
 ドキュメントの特定の種類に基づいて変更するのには、一部のツール ウィンドウが設計されています。 これらのウィンドウは IDE のアクティブなドキュメント ウィンドウに適用可能な機能を反映するように継続的に更新します。  
  
 ツール ウィンドウの内容が変更を選択されたエディターを反映するには、ツールボックス、ドキュメント アウトラインがあります。 これらのウィンドウは、エディター ウィンドウにコンテキストを提供していませんがフォーカスがあるときに、基準値を表示します。  
  
#### <a name="navigable-list-tool-windows"></a>ナビゲート可能なリスト ツール ウィンドウ  
 一部のツール ウィンドウは、ユーザーが対話ナビゲート可能な項目の一覧を表示します。 この種類のウィンドウでは常には一覧で、現在の項目のフィードバック、ウィンドウがアクティブでない場合でもです。 一覧への応答が、 **GoToNextLocation**と**GoToPrevLocation**も ウィンドウで現在選択されている項目を変更してコマンド  
  
 ナビゲート可能なリスト ツール ウィンドウには、ソリューション エクスプ ローラーと検索結果 ウィンドウがあります。  
  
### <a name="tool-window-types"></a>ツール ウィンドウの種類  
  
#### <a name="common-tool-windows-and-their-functions"></a>一般的なツール ウィンドウとその機能  
  
|型|ツール ウィンドウ|関数|  
|----------|-----------------|--------------|  
|**階層**|ソリューション エクスプローラー|プロジェクト、その他のファイル、およびソリューション項目内に含まれているドキュメントの一覧を表示する階層ツリー。 プロジェクト内のアイテムの表示は、プロジェクトの種類 (たとえば、参照に基づく、ディレクトリ ベース、または混合モードの種類) を所有しているパッケージによって定義されます。|  
|**階層**|クラス ビュー|クラスと、ファイル自体の独立したドキュメントのワーキング セットのさまざまな要素の階層ツリー。|  
|**階層**|サーバー エクスプローラー|ソリューションのすべてのサーバーとデータ接続を表示する階層ツリー。|  
|**階層**|[ドキュメント アウトライン]|アクティブなドキュメントの階層構造です。|  
|**グリッド**|プロパティ|値ピッカーをこれらのプロパティを編集すると、選択したオブジェクトのプロパティの一覧を表示するグリッドです。|  
|**グリッド**|タスク一覧|ユーザーが作成/編集/削除タスクとコメントにできるグリッドです。|  
|**コンテンツ**|ヘルプ|ユーザーの「操作方法」からのヘルプの取得のさまざまなメソッドへのアクセスを許可する ウィンドウ MSDN フォーラムにビデオ。|  
|**コンテンツ**|ダイナミック ヘルプ|現在の選択範囲に該当するトピックへのリンクを表示するツール ウィンドウ。|  
|**コンテンツ**|オブジェクト ブラウザー|階層オブジェクトのコンポーネントで、左側のウィンドウとオブジェクトのプロパティと、右側の列内のメソッドの一覧を含む 2 つの列フレーム セット。|  
|**ダイアログ**|検索を高度な検索|検索または検索、さまざまなファイル、ソリューション内で置換するユーザーを許可する ダイアログ。|  
|**その他**|ツールボックス|ツール ウィンドウは、ドラッグ ソースの整合性を提供するすべてのデザイナーのデザイン画面上に削除される要素を格納するために使用します。|  
|**その他**|スタート ページ|開発者向けニュース、Visual Studio のヘルプ、および最近使ったプロジェクトのフィードにアクセス権を持つユーザーのポータル、Visual Studio です。 ユーザーは、StartPage.xaml ファイルを Visual Studio の"Common7\IDE\StartPages\"program files ディレクトリから Visual Studio ドキュメント ディレクトリで、[startpages] フォルダーにコピーし、いずれか、XAML を手動で編集してカスタム スタート ページを作成もできますかVisual Studio または別のコード エディターで開くことです。|  
|**デバッガー:** windows タスクのデバッグおよびアクティビティの監視に固有のグループ|Autos||  
|**デバッガー:** windows タスクのデバッグおよびアクティビティの監視に固有のグループ|イミディエイト||  
|**デバッガー:** windows タスクのデバッグおよびアクティビティの監視に固有のグループ|出力|テキスト形式のイベントや状態を宣言があるたびに、出力ウィンドウを使用できます。|  
|**デバッガー:** windows タスクのデバッグおよびアクティビティの監視に固有のグループ|メモリ||  
|**デバッガー:** windows タスクのデバッグおよびアクティビティの監視に固有のグループ|ブレークポイント||  
|**デバッガー:** windows タスクのデバッグおよびアクティビティの監視に固有のグループ|実行中||  
|**デバッガー:** windows タスクのデバッグおよびアクティビティの監視に固有のグループ|ドキュメント||  
|**デバッガー:** windows タスクのデバッグおよびアクティビティの監視に固有のグループ|呼び出し履歴||  
|**デバッガー:** windows タスクのデバッグおよびアクティビティの監視に固有のグループ|ローカル||  
|**デバッガー:** windows タスクのデバッグおよびアクティビティの監視に固有のグループ|ウォッチ||  
|**デバッガー:** windows タスクのデバッグおよびアクティビティの監視に固有のグループ|逆アセンブリ||  
|**デバッガー:** windows タスクのデバッグおよびアクティビティの監視に固有のグループ|レジスタ||  
|**デバッガー:** windows タスクのデバッグおよびアクティビティの監視に固有のグループ|スレッド||  
  
##  <a name="BKMK_DocumentEditorConventions"></a> ドキュメント エディターの表記規則  
  
### <a name="document-interactions"></a>ドキュメントの相互作用  
 "Document well"は、IDE 内で最大の領域と場所、ユーザー一般的には重点を置いた、注意補足的なツール ウィンドウによる支援がタスクを完了するには。 文書の編集者は、ユーザーが開き、Visual Studio 内で保存する作業の基本的な単位を表します。 ソリューション エクスプ ローラーまたは他のアクティブな階層ウィンドウに関連付けられている選択範囲の厳密な意味は保持されます。 ユーザーは、これらの階層ウィンドウのいずれかをポイントし、ソリューション、プロジェクト、または Visual Studio のパッケージで提供されるもう 1 つのルート オブジェクトのいずれかに、ドキュメントが含まれているとの関係を把握できる必要があります。  
  
 ドキュメントの編集には、一貫したユーザー エクスペリエンスが必要です。 手元のタスクの代わりにウィンドウの管理とコマンドを見つけるに集中するユーザーを許可するのには、そのドキュメントの種類を編集するためのユーザーのタスクに最適なドキュメント ビューの戦略を選択します。  
  
#### <a name="common-interactions-for-the-document-well"></a>ドキュメント ウェルの一般的な相互作用  
  
-   共通の一貫した対話モデルを維持**新しいファイル**と**ファイルを開く**で発生します。  
  
-   ドキュメント ウィンドウが開いたときに、関連するウィンドウおよびメニューで関連する機能を更新します。  
  
-   メニュー コマンドが適切に統合の共通のメニューなど**編集**、**形式**、および**ビュー**メニュー。 膨大な量の特殊化されたコマンドが使用可能な場合は、し、新しいメニューを作成できます、ドキュメントがフォーカスが場合にのみこれが表示されます。  
  
-   エディターの上部にある組み込みのツールバーを配置する場合があります。 エディターの外部に表示される個別のツールバーにこれをお勧めします。  
  
-   ソリューション エクスプ ローラーまたは類似のアクティブな選択範囲を常に維持階層 ウィンドウ。  
  
-   ソリューション エクスプ ローラーでドキュメントをダブルクリックとして同じアクションを実行する必要があります**オープン**します。  
  
-   ユーザーをオーバーライドまたはを使用して特定のドキュメント型の既定のアクションをリセットできるようにする場合は、ドキュメントの種類では、1 つ以上のエディターを使用できます、**プログラムから開く**ファイルを右クリックしてダイアログ ボックス**開く**ショートカット メニューから。  
  
-   ドキュメント内のウィザードをもビルドはありません。  
  
### <a name="user-expectations-for-specific-document-types"></a>特定のドキュメントの種類のユーザーの期待  
 ドキュメント エディターのいくつかの異なる基本型があるし、それぞれが同じ型の他のユーザーと整合性のある相互作用のセット。  
  
- **テキスト ベース エディター:** コード エディター、ログ ファイル  
  
- **デザイン画面:** WPF フォーム デザイナー、Windows フォーム  
  
- **ダイアログ スタイルの編集:** マニフェスト デザイナー、プロジェクトのプロパティ  
  
- **モデル デザイナー:** 、ワークフロー デザイナー、codemap、アーキテクチャの図の流れ  
  
  でも、ドキュメントを使用するいくつかのエディター以外の種類もあります。 次のドキュメント ウィンドウの標準的なやり取りする必要はドキュメント自体で編集することがない、中にします。  
  
- **レポート:** IntelliTrace レポート、HYPER-V でのレポート、プロファイラー レポート  
  
- **ダッシュ ボード:** 診断ハブ  
  
#### <a name="text-based-editors"></a>テキスト ベースのエディター  
  
-   ドキュメントは、プレビュー タブのモデルを開くことがなく、ドキュメントをプレビューすることができますに参加します。  
  
-   ドキュメント アウトラインなどのコンパニオン ツール ウィンドウ内では、ドキュメントの構造を表すことができます。  
  
-   IntelliSense (該当する) 場合は、他のコード エディターで一貫して動作します。  
  
-   ポップアップや支援の UI は、CodeLens などの既存のような UI のようなスタイルやパターンに従います。  
  
-   または、ステータス バーで、ドキュメントの上部にある情報バー コントロールにドキュメントの状態に関するメッセージが表示されます。  
  
-   ユーザーは、フォントおよび色を使用しての外観をカスタマイズできる必要があります、**ツール > オプション**ページ、共有のフォントおよび色 ページまたは、エディターに固有の 1 つのいずれか。  
  
#### <a name="design-surfaces"></a>デザイン画面  
  
-   空のデザイナーは、透かしを開始する方法を示す画面が必要です。  
  
-   ビューの切り替えのメカニズムをダブルクリックしてコード エディター、または両方のウィンドウとの対話を許可するドキュメント ウィンドウ内のタブを開くなどの既存のパターンに従います。  
  
-   高度の特定のツール ウィンドウが必要でない限り、ツールボックスを使用して、デザイン画面に要素を追加を行ってください。  
  
-   画面上のアイテムは、一貫性のある選択モデルに従います。  
  
-   など、埋め込みのツールバーにドキュメントに固有のコマンドのみ、されません一般的なコマンドが含まれている**保存**します。  
  
#### <a name="dialog-style-editors"></a>ダイアログ スタイル エディター  
  
-   コントロールのレイアウトは、通常のダイアログのレイアウト規則に従う必要があります。  
  
-   エディター内のタブは、ドキュメントのタブの外観と一致しないように、許可されている内部タブの 2 つのスタイルのいずれかが一致する必要があります。  
  
-   ユーザーは、キーボードのみを使用するコントロールと対話できる必要があります。標準のニーモニックを使用してエディターをアクティブ化と制御を通じて、またはタブ移動するか。  
  
-   デザイナーには、一般的なモデルの保存を使用する必要があります。 全体的な保存またはコミット ボタンが配置されるありません画面で、適切なその他のボタンがあります。  
  
#### <a name="model-designers"></a>モデル デザイナー  
  
-   空のデザイナーは、透かしを開始する方法を示す画面が必要です。  
  
-   デザイン画面に要素を追加することは、ツールボックスを使用して行う必要があります。  
  
-   画面上のアイテムは、一貫性のある選択モデルに従います。  
  
-   など、埋め込みのツールバーにドキュメントに固有のコマンドのみ、されません一般的なコマンドが含まれている**保存**します。  
  
-   画面の指示またはウォーターマークは、凡例が表示されます。  
  
-   ユーザーは、使用するフォントと色の外観をカスタマイズできる必要があります、**ツール > オプション**ページ、共有のフォントおよび色 ページまたは、エディターに固有の 1 つのいずれか。  
  
#### <a name="reports"></a>レポート  
  
-   レポートは通常は専用であり、モデルの保存に参加していません。 ただし、他の関連情報または展開したり折りたたんだりするセクションへのリンクなどの操作が含まれる場合します。  
  
-   画面で、ほとんどのコマンドは、ハイパーリンク、ボタンではない必要があります。  
  
-   レイアウトは、ヘッダーを含めるし、標準のレポート レイアウトのガイドラインに従う必要があります。  
  
#### <a name="dashboards"></a>ダッシュボード  
  
-   ダッシュ ボード必要はありません、相互作用モデル自体がさまざまな他のツールを提供するための手段として使用します。  
  
-   モデルの保存に参加しません。  
  
-   ユーザーは、エディターをアクティブ化とコントロール間をタブ移動するか、標準のニーモニックを使用して、キーボードのみを使用するコントロールと対話できる必要があります。  
  
##  <a name="BKMK_Dialogs"></a> ダイアログ ボックス  
  
### <a name="introduction"></a>はじめに  
 Visual Studio でのダイアログでは、通常、1 つの個々 のユーザーの作業単位をサポートする必要があり、し、破棄します。  
  
 ダイアログ ボックスを必要があることを決定した場合に優先順位の 3 つの選択肢があります。  
  
1. Visual Studio での共有、ダイアログ ボックスのいずれかの機能を統合します。  
  
2. 既存のようなダイアログで検出されたパターンを使用して、独自のダイアログを作成します。  
  
3. 新しいダイアログ ボックス、次の操作およびレイアウトのガイドラインを作成します。  
  
   このトピックでは、Visual Studio ワークフロー内で適切なダイアログのパターンとダイアログのデザインの一般的な規則を選択する方法について説明します。  
  
### <a name="themes"></a>テーマ  
 Visual Studio でのダイアログ ボックスでは、2 つの基本的なスタイルのいずれかに従います。  
  
#### <a name="standard-unthemed"></a>標準 (unthemed)  
 ダイアログの大部分は標準のユーティリティのダイアログ ボックスで、unthemed をする必要があります。 図案化された"modern"ボタンやコントロールを作成しようとしたりされません一般的なコントロールを再テンプレート化をしないでください。 コントロールと次の chrome 外観[ダイアログ ボックスの標準の Windows デスクトップ ガイドライン](https://msdn.microsoft.com/library/windows/desktop/dn742499\(v=vs.85\).aspx)します。  
  
#### <a name="themed"></a>テーマが適用されました。  
 「署名」ダイアログの専門分野は、テーマが適用された可能性があります。 テーマが適用されたダイアログ ボックスでは、スタイルに関連付けられているいくつかの特別な対話パターンを持つ独自の外観があります。 テーマ、ダイアログのこれらの要件を満たしている場合のみ。  
  
- ダイアログ ボックスが表示され、多くの場合、または多数のユーザーを使用する一般的な経験は、(たとえば、**新しいプロジェクト**ダイアログ。  
  
- ダイアログ ボックスに、著名な製品のブランド要素が含まれています (たとえば、**アカウント設定**ダイアログ)。  
  
- その他のテーマが適用されたダイアログ ボックスを含むより大きなフローの不可欠な部分として、ダイアログ ボックスが表示されます (たとえば、 **接続済みサービス**ダイアログ)。  
  
- ダイアログは、昇格または製品バージョンを区別する戦略的な役割を果たすエクスペリエンスの重要な部分です。  
  
  テーマが適用されたダイアログを作成するには、適切な環境の色を使用し、適切なレイアウトと相互作用のパターンに従ってください。 (を参照してください[Layout for Visual Studio](../../extensibility/ux-guidelines/layout-for-visual-studio.md))  
  
### <a name="dialog-design"></a>ダイアログのデザイン  
 適切に設計されたダイアログ ボックスでは、次の要素を考慮。  
  
-   サポートされているユーザーのタスク  
  
-   ダイアログのテキストのスタイル、言語、および用語  
  
-   コントロールの選択肢と UI の規則  
  
-   視覚的なレイアウトの仕様およびコントロールの配置  
  
-   キーボード アクセス  
  
#### <a name="content-organization"></a>組織のコンテンツ  
 これらの基本的な種類のダイアログ間の違いを考慮してください。  
  
-   [単純なダイアログ](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_SimpleDialogs)1 つのモーダル ウィンドウでコントロールを表示します。 プレゼンテーションには、フィールドの選択や、アイコン バーなどの複雑なコントロール パターンのバリエーションが含まれます。  
  
-   [ダイアログ ボックスに階層化](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_LayeredDialogs)単一の UI コントロールの複数のグループを構成するときに、実際の画面を最大限に活用するために使用します。 ダイアログ ボックスのグループ化「階層化されている」のタブ コントロールや、リスト コントロールのナビゲーション ボタンをユーザーが特定の時点で表示するグループ化を選択できます。  
  
-   [ウィザード](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_Wizards)はタスクの完了までの手順の論理シーケンスを通じてユーザーを転送するために役立ちます。 シーケンシャル パネル、ことがあります前のパネルで行った選択に依存するさまざまなワークフロー (「分岐」) の概要では、一連の選択肢が提供されています。  
  
####  <a name="BKMK_SimpleDialogs"></a> 単純なダイアログ ボックス  
 単純なダイアログは、1 つのモーダル ウィンドウ内のコントロールのプレゼンテーションです。 このプレゼンテーションには、フィールドの選択などの複雑なコントロール パターンのバリエーションが含まれます。 単純なダイアログは、標準の一般的なレイアウトと複雑なコントロールのグループ化に必要な特定のレイアウトに従ってください。  
  
 ![Visual Studio で簡単なダイアログ](../../extensibility/ux-guidelines/media/0704-01-createstrongnamekey.png "0704 01_CreateStrongNameKey")  
  
 **作成する厳密な名前キーは、Visual Studio で簡単なダイアログの例を示します。**  
  
####  <a name="BKMK_LayeredDialogs"></a> 階層化ダイアログ  
 複数層のダイアログ ボックスには、タブ、ダッシュ ボード、および埋め込みのツリーが含まれます。 1 つの UI で提供されるコントロールの複数のグループがある場合は、不動産を最大化に使用されます。 グループは、ユーザーがいつでも表示するグループ化を選択できるようにに重ねられています。  
  
 最も簡単な場合は、グループ化を切り替えるためのメカニズムは、タブ コントロールです。 いくつかの選択肢があります。 優先順位を指定し、最も適切なスタイルを選択する方法のレイヤーを参照してください。  
  
 **ツール > オプション**ダイアログは、埋め込みのツリーを使用して、階層化 ダイアログの例を示します。  
  
 ![Visual Studio での階層ダイアログ](../../extensibility/ux-guidelines/media/0704-02-toolsoptions.png "0704 02_ToolsOptions")  
  
 **ツール > オプションは、Visual Studio での階層ダイアログの例を示します。**  
  
####  <a name="BKMK_Wizards"></a> ウィザード  
 ウィザードは、タスクが完了するまでの手順の論理シーケンスを通じてユーザーを転送するために役立ちます。 シーケンシャル パネルは、一連の選択肢が提供され、ユーザーが、次に進む前に各ステップを続行する必要があります。 十分な既定値が使用可能な**完了**ボタンが有効になります。  
  
 タスクにモーダル ウィザードを使用します。  
  
-   ユーザーの選択に応じてさまざまなパスが提供されている、分岐を含める  
  
-   以降の手順が前のステップからのユーザー入力に依存して、手順間の依存関係を含む  
  
-   提供されている選択肢と各手順で考えられる結果について説明する UI を使用することは十分に複雑です  
  
-   トランザクションでは、一連の変更がコミットされる前に完全に完了する手順を必要とするには  
  
### <a name="common-conventions"></a>一般的な規則  
 最適な設計とをダイアログ ボックスを使用して機能を実現するには、ダイアログのサイズ、位置、標準、制御の構成と配置、UI テキスト、タイトル バー、コントロールのボタン、およびアクセス キーでこれらの規則に従います。  
  
 レイアウトに固有のガイドラインについては、次を参照してください。 [Layout for Visual Studio](../../extensibility/ux-guidelines/layout-for-visual-studio.md)します。  
  
#### <a name="size"></a>サイズ  
 ダイアログ ボックスが最小 1024 x 768 の画面解像度内に収まる必要があり、最初のダイアログのサイズは 700 900 ピクセルを超えることはできません。 ダイアログ ボックスは、サイズを変更できる可能性がありますが、必須ではありません。  
  
 ダイアログのサイズ変更可能な場合の 2 つの推奨事項があります。  
  
1.  最小サイズが定義されているコントロールの最適化はダイアログの、クリッピングなしに設定し、適切なローカライズの成長に対応する調整します。  
  
2.  あるユーザー スケール サイズはセッションからセッションを保持します。 など、ユーザーが 150% ダイアログをスケーリングする場合は、ダイアログの後続の起動が 150% で表示されます。  
  
#### <a name="position"></a>位置  
 最初の起動時に、IDE 内で中央揃えダイアログを表示する必要があります。 をダイアログのサイズを変更できない場合は、ダイアログの最後の位置が保存される必要なため、それ以降の起動時の中央に表示されます。 をダイアログのサイズ変更可能な場合、サイズをそれ以降の起動時に永続化する必要があります。 モーダルであるサイズ変更可能なダイアログ ボックスの位置が永続化する必要はありません。 IDE 内で中央揃えに表示するには、ユーザーの表示の構成が変更されたときに、予期しないまたは使用不能の位置に表示されるダイアログ ボックスの可能性ができないようにします。 移動できるモードレスのダイアログ ボックスのユーザーの位置を維持するそれ以降の起動時に、ダイアログ ボックスは、大規模なワークフローの一環として頻繁に使用する可能性があります。  
  
 最上位のダイアログが右側に連鎖する必要がありますダイアログには、その他のダイアログ ボックスを生成する必要があります、ときとが新しい場所に移動した、ユーザーに明らかになるように、親からダウンします。  
  
#### <a name="modality"></a>モダリティ  
 モーダルの中では、ユーザーに続行する前に、ダイアログをキャンセルまたは完了に必要なを意味します。 モーダル ダイアログ ボックスでは、環境内の他の部分と対話するユーザーをブロック、タスク フローの機能の使用してくださいにできるだけ控えめします。 モーダルの操作が必要なときに Visual Studio はさまざまな共有のダイアログ ボックスに、機能を統合するには。 新しいダイアログ ボックスを作成する必要がある場合は、同様の機能を既存のダイアログの相互作用のパターンに従います。  
  
 ユーザーが一度に 2 つのアクティビティを実行する必要がある場合**検索**と**置換**新しいコードを記述しているときに、ダイアログする必要がありますモードレスため、ユーザーはそれらの間に簡単に切り替えることができます。 通常、visual Studio は、この種類のリンクされたタスクのエディター サポートのツール ウィンドウを使用します。  
  
#### <a name="control-configuration"></a>コントロールの構成  
 Visual Studio で同じことを実現する既存のコントロール構成と一致します。  
  
#### <a name="title-bars"></a>タイトル バー  
  
- タイトル バーのテキストは、それを起動したコマンドの名前を反映する必要があります。  
  
- ダイアログのタイトル バーにアイコンを使用しません。 システムを必要して 1 つの場合、Visual Studio ロゴを使用します。  
  
- ダイアログのないを最小化または最大化ボタン。  
  
- タイトル バーの [ヘルプ] ボタンが非推奨とされました。 新しいダイアログ ボックスにそれらを追加しないでください。 存在は、概念的には、タスクに関連するヘルプ トピックを起動する必要があります。  
  
  ![タイトル バーは、Visual Studio の仕様](../../extensibility/ux-guidelines/media/0704-03-titlebarspecs.png "0704 03_TitleBarSpecs")  
  
  **Visual Studio のダイアログ ボックスのタイトル バーのガイドラインの仕様。**  
  
#### <a name="control-buttons"></a>コントロールのボタン  
 一般に、 **OK**/**キャンセル**/**ヘルプ**ボタンは、ダイアログ ボックスの右下隅の水平方向に整列する必要があります。 ダイアログ コントロール ボタンとビジュアルの混同を提供するようダイアログの下部にあるその他のいくつかのボタンがある場合、代替の垂直方向のスタックが許可されます。  
  
 ![Visual Studio でのボタンの構成を制御](../../extensibility/ux-guidelines/media/0704-04-controlbuttonconfig.png "0704 04_ControlButtonConfig")  
  
 **Visual Studio のダイアログのコントロールのボタンに許容される構成**  
  
 ダイアログ ボックスでは、既定のコントロール ボタンを含める必要があります。 既定値として使用する最適なコマンドを確認するのには、(優先順位の順序で表示)、次のオプションから選択します。  
  
- 既定値として最も安全で最も安全なコマンドを選択します。 これは、データ損失を回避し、意図しないシステムへのアクセスを回避する可能性が高いコマンドを選択することを意味します。  
  
- データの損失やセキュリティ要因がない場合は、利便性に基づく既定のコマンドを選択します。 既定値として最も可能性の高いコマンドなどにより、ダイアログ ボックスは、頻繁にや反復的なタスクをサポートしている場合、ユーザーのワークフローが向上します。  
  
  既定のコマンドの永続的に破壊的な操作を選択しないでください。 このようなコマンドが存在する場合、代わりに、既定値としてより安全なコマンドを選択します。  
  
#### <a name="access-keys"></a>アクセス キー  
 アクセス キーを使用しないでください**OK**/**キャンセル**/**ヘルプ**ボタン。 これらのボタンは、既定では、ショートカット キーにマップされます。  
  
|ボタンの名前|キーボード ショートカット|  
|-----------------|-----------------------|  
|OK|Enter|  
|キャンセル|Esc|  
|ヘルプ|F1|  
  
#### <a name="imagery"></a>画像  
 ダイアログ ボックスでイメージを多用します。 ダイアログ ボックスでの大規模なアイコンを領域を使用するためだけに使用できません。 警告アイコンまたは状態のアニメーションなど、ユーザーにメッセージを伝達の重要な一部である場合にのみ、イメージを使用します。  
  
###  <a name="BKMK_PrioritizingAndLayering"></a> 優先するしくみと、階層化  
  
#### <a name="prioritizing-your-ui"></a>UI の優先順位付け  
 特定の UI 要素に、forefront してより高度な動作とダイアログ ボックスにオプション (あいまいなコマンドを含む) に配置する必要がある場合があります。 表示されるように既定のテキスト ラベルの付いた UI で、ダイアログ ボックスが表示されるときと、表示領域によっては、一般的に使用される機能、forefront を活用しましょう。  
  
#### <a name="layering-your-ui"></a>UI を階層化  
 ダイアログ ボックスは必要ですが、ユーザーに提示する関連の機能は、単純なダイアログに表示される内容を超えるを決定した場合は、UI レイヤーを必要があります。 Visual Studio を使用して、最も一般的な階層化メソッドは、タブや廊下のダッシュ ボードには。 場合によっては、展開したり折りたたんだりするリージョンが適切な可能性があります。 アダプティブ UI は一般に Visual Studio では推奨されません。  
  
 階層化 タブのようなコントロールを使用して UI のさまざまな方法に長所と短所があります。 自分の状況に適切なレイヤー化手法を選択することを確認するのには、次の一覧を確認します。  
  
##### <a name="tabbing"></a>Tab キーによる移動  
  
|メカニズムの切り替え|利点と適切な使用|不適切な使用と短所|  
|-------------------------|------------------------------------|-----------------------------------------|  
|タブ コントロール|関連する設定のダイアログ ページを論理的にグループ化します。<br /><br /> 5 つより少ない (または、ダイアログ ボックスで、1 つの行に収まるタブの数) の便利なダイアログに関連するコントロールのページ<br /><br /> タブ ラベルを簡単にする必要があります: コンテンツを簡単に識別できる 1 つまたは 2 つの単語<br /><br /> 一般的なシステム ダイアログのスタイル<br /><br /> 例:**ファイル エクスプ ローラー > アイテムのプロパティ**|わかりやすい短いラベルの作成は難しい<br /><br /> 過去の 5 つのタブが 1 つのダイアログで、一般にスケーラビリティ<br /><br /> 不適切なは、1 つの行が多すぎるのタブがある場合別の階層化手法を使用します。<br /><br /> 拡張できません。|  
|サイド バー ナビゲーション|タブの他のカテゴリに対応できる簡単な切り替え装置<br /><br /> カテゴリ (階層構造) の単純なリスト<br /><br /> 拡張可能です<br /><br /> 例: **... カスタマイズ > コマンドを追加**|左右の間隔よりも少ないの 3 つのグループがある場合の適切な使い方ではありません。<br /><br /> タスクがドロップ ダウンするのに適したより可能性があります。|  
|ツリー コントロール|無制限のカテゴリでは、します。<br /><br /> グループ化やカテゴリの階層では、します。<br /><br /> 拡張可能です<br /><br /> 例:**ツール > オプション**|頻繁に入れ子になった階層は、過剰な水平方向スクロール可能性します。<br /><br /> Visual Studio がツリー ビューの思わぬ意味|  
|ウィザード|タスク ベースで、連続した手順に従って、タスクの完了を支援します。 ウィザードは高レベルのタスクを表し、各パネルは、サブタスクの全体的なタスクを実行するために必要なを表します。<br /><br /> タスクがときに、ユーザーは、複数のエディターを使用して、ツール ウィンドウのタスクを完了する必要がそれ以外の場合と、Ui の境界を超えたときに便利です。<br /><br /> タスクでは、分岐が必要な場合に役立ちます。<br /><br /> タスクには、手順間の依存関係が含まれている場合に役立ちます。<br /><br /> 別のようなダイアログ ボックスの数を減らす 1 つのダイアログで、意思決定の 1 つの分岐でいくつかのようなタスクを表示する場合に役立ちます。|シーケンシャル ワークフローを必要としない任意のタスクの不適切です<br /><br /> ユーザーが過負荷状態になり、ステップが多すぎると、ウィザードによって混乱になることができます。<br /><br /> ウィザードには、実際の画面が限られている本質的に|  
  
##### <a name="hallways-or-dashboards"></a>廊下やダッシュ ボード  
 廊下とダッシュ ボードは、ダイアログやその他のダイアログ ボックスとウィンドウへのポインターを起動するとして機能するパネルにします。 適切に設計された「ホール」には、のみ、最も一般的なオプション、コマンド、および一般的なタスクをすぐに実行するユーザーを許可する設定は、すぐには表示します。 実際の廊下では、背後にルームにアクセスする入り口を提供するようにここで、頻度の低い UI が個別「ルーム」(多くの場合、その他のダイアログ ボックス) の主な廊下からアクセスできる関連する機能に収集されます。  
  
 または、単純にダッシュ ボードは、別々 の場所に頻度の低い機能をリファクタリングするのではなく、1 つのコレクションで使用可能なすべての機能を提供する UI。  
  
 ![Outlook での廊下の概念](../../extensibility/ux-guidelines/media/0704-08-hallway.png "0704 08_Hallway")  
  
 **Outlook で追加の UI を公開するための廊下の概念**  
  
##### <a name="adaptive-ui"></a>アダプティブ UI  
 使用量に基づいて、UI の表示と非表示またはユーザーの自己報告されたエクスペリエンスが必要な UI を表示するのには他の部分を非表示の別の方法を示します。 これは UI を非表示の使い分けのアルゴリズムは複雑になることし、ルールがケースのセットはいくつかの問題は常に、Visual Studio では推奨されません。  
  
##  <a name="BKMK_Projects"></a> プロジェクト  
  
### <a name="projects-in-the-solution-explorer"></a>ソリューション エクスプ ローラーでプロジェクト  
 ほとんどのプロジェクトは、その参照に基づく、ディレクトリ ベース、または混合に分類されます。 次の 3 つすべての種類のプロジェクトは、ソリューション エクスプ ローラーで同時にサポートされます。 プロジェクトでの作業でユーザー エクスペリエンスのルートは、このウィンドウ内で行われます。 別のプロジェクト ノードは、参照、ディレクトリ、または混合モードの種類のプロジェクトには、プロジェクトの特定のユーザーのパターンに分岐する前に開始点として適用される一般的な相互作用パターンがあります。  
  
 プロジェクトには常にする必要があります。  
  
- プロジェクトの内容を整理するフォルダーをプロジェクトに追加する機能のサポート  
  
- プロジェクトの永続化を一貫したモデルを管理します。  
  
  プロジェクトには、一貫性のある相互作用モデルの管理も必要があります。  
  
- プロジェクト項目を削除します。  
  
- ドキュメントの保存  
  
- プロジェクト プロパティの編集  
  
- 代替ビューでプロジェクトの編集  
  
- ドラッグ アンド ドロップ操作  
  
### <a name="drag-and-drop-interaction-model"></a>ドラッグ アンド ドロップ操作モデル  
 プロジェクトが通常分類自体の参照をベースとして (記憶域内のプロジェクト アイテムへの参照のみを保持すること)、ディレクトリ ベース (物理的にプロジェクトの項目のみを保持することが格納されているプロジェクトの階層内で)、または混合 (参照を保持することまたは 物理項目) で変更します。 IDE 内で同時に 3 つすべての種類のプロジェクトに対応、**ソリューション エクスプ ローラー**します。  
  
 内のプロジェクトの種類ごとに、ドラッグ アンド ドロップの観点から、次の特性を適用する必要があります、**ソリューション エクスプ ローラー**:  
  
- **プロジェクトの参照に基づく:** 重要なポイントは、プロジェクトがストレージ内の項目への参照をドラッグすることです。 参照ベースのプロジェクトは、移動操作のソースとして動作している場合にのみ、プロジェクトからアイテムへの参照を削除する必要があります。 項目いない実際に削除してください、ハード ドライブから。 参照ベースのプロジェクトは、移動 (またはコピー) の操作のターゲットとして機能、する場合に、項目のプライベート コピーを作成することがなく、元のソース項目への参照を追加します。  
  
- **ディレクトリ ベースのプロジェクト:** ドラッグ アンド ドロップの観点から、プロジェクトは参照ではなく、物理的なアイテムの周囲にドラッグします。 ディレクトリ ベースのプロジェクトは、移動操作のソースとして機能、する場合に、ハード ドライブから物理的な項目を削除すると、プロジェクトから削除することを終了する必要があります。 ディレクトリ ベースのプロジェクトは、移動 (またはコピー) の操作のターゲットとして動作する場合は、ソース アイテムのコピーのターゲットの場所にそのください。  
  
- **混合ターゲット プロジェクト:** ドラッグ アンド ドロップの観点から、この種類のプロジェクトの動作は (ストレージ内の項目への参照) または、項目自体のいずれかにドラッグされている項目の種類に基づきます。 上記の参照と物理項目に対して正しい動作。  
  
  プロジェクトの種類を 1 つだけある場合は、**ソリューション エクスプ ローラー**、ドラッグ アンド ドロップ操作を簡単になります。 各プロジェクト システムには、ドラッグ アンド ドロップ動作を定義する機能があるために、特定のガイドライン (Windows エクスプ ローラーのドラッグ アンド ドロップ動作に基づく) は予測可能なユーザー エクスペリエンスを実現する従う必要があります。  
  
- 操作をドラッグして、変更されていない、**ソリューション エクスプ ローラー**移動操作が発生する必要があります (ときに ctrl キーを押しも Shift キーが押し続けられる)。  
  
- Shift ドラッグ操作は、移動操作にもなります。  
  
- Ctrl-ドラッグ操作は、コピー操作で発生する必要があります。  
  
- 参照に基づくと混合プロジェクト システムでは、ソース アイテムにリンク (または参照) を追加の概念がサポートされます。 これらのプロジェクトがドラッグ アンド ドロップ操作の対象の場合 (と**ctrl キーを押しながら shift キーを押し**を押し下げた)、プロジェクトに追加される項目への参照が発生する必要があります  
  
  すべてのドラッグ アンド ドロップ操作は、参照に基づく、ディレクトリ ベースおよび混合プロジェクトの組み合わせ間では取り上げません。 具体的には、問題のあるように振る舞うソース ディレクトリ ベースのプロジェクトが移動の完了時に元の項目を削除する必要があるために、ディレクトリ ベースの移行元のプロジェクトとターゲットの参照に基づくプロジェクト間の移動操作を許可するがします。 ターゲット参照に基づくプロジェクトはし、最終的に、削除された項目への参照。  
  
  誤解を招くように振る舞うターゲット参照に基づくプロジェクトはソース項目の独立したコピーにしないようにするためにこれらの種類のプロジェクト間でコピー操作を許可することもです。 同様に、ctrl キーを押しながら shift キーを押し、ディレクトリ ベースのターゲット プロジェクトにドラッグする必要がありますできませんディレクトリ ベースのプロジェクトが参照を保持できないためです。 ドラッグ アンド ドロップ操作がサポートされていません場合、IDE がドロップを禁止し、(次のポインターの表に示した) 非ドロップ カーソルが、ユーザーを表示する必要があります。  
  
  ドラッグ アンド ドロップの動作を正しく実装する、ドラッグのソースのプロジェクトは本質的に通信する必要があります (たとえばが、参照またはディレクトリ ベースか) をターゲット プロジェクトにします。 この情報は、ソースによって提供されるクリップボードの形式で示されます。 ドラッグ (またはクリップボードのコピー操作) のソースとしてプロジェクトをする必要があります提供か**CF_VSREFPROJECTITEM**S または**CF_VSSTGPROJECTITEMS**プロジェクトが参照に基づくかどうかに応じて、それぞれまたは、ディレクトリ ベースします。 これらの形式の両方がある同一のデータの内容は、Windows のような**ドロップ**形式、ファイル名ではなく、文字列のリストは、二重に準じた**NULL** のリストを終了しました**Projref**文字列 (から返される**IVsSolution::GetProjrefOfItem**または **:: GetProjrefOfProject**に応じて)。  
  
  ドロップ (または貼り付けのクリップボード操作) のターゲットとしてプロジェクトを受け入れる必要があります両方**CF_VSREFPROJECTITEMS**と**CF_VSSTGPROJECTITEMS**ドラッグ アンド ドロップ操作の正確な処理は異なりますが、ターゲット プロジェクトとソース プロジェクトの性質によって異なります。 ソース プロジェクトでは、その性質上を宣言かどうかを提供して**CF_VSREFPROJECTITEMS**または**CF_VSSTGPROJECTITEMS**します。 ドロップのターゲットは、独自の性質を理解し、このため、移動、コピー、かどうかを決定するのに十分な情報は、またはリンクを実行する必要があります。 ユーザーには、ドラッグ アンド ドロップ操作は、Ctrl、shift キー、または ctrl キーと Shift キーを押して実行する必要がありますも変更されます。 ドロップ ターゲットを適切に示すどの操作が事前に実行される重要なはその**DragEnter**と**DragOver**メソッド。 **ソリューション エクスプ ローラー**ソース プロジェクトとターゲットのプロジェクトが同じプロジェクトがかどうかを自動的に認識します。  
  
  (たとえば、devenv.exe を別の 1 つのインスタンス) から Visual Studio のインスタンス間でのプロジェクト項目をドラッグすることはサポートされていません。 **ソリューション エクスプ ローラー**も直接これを無効にします。  
  
  ユーザー常に項目を選択し、ターゲットの場所にドラッグすると、項目が削除される前に表示されますが、次のマウス ポインターを観察し、ドラッグ アンド ドロップ操作の効果を決定できる場合があります。  
  
|マウス ポインター|コマンド|説明|  
|-------------------|-------------|-----------------|  
|![ドロップしない アイコンをマウス](../../extensibility/ux-guidelines/media/0706-01-mousenodrop.png "0706 01_MouseNoDrop")|ドロップしません。|指定した場所に項目を削除できません。|  
|![[コピー] アイコンをマウス](../../extensibility/ux-guidelines/media/0706-02-mousecopy.png "0706 02_MouseCopy")|コピー|項目は、ターゲットの場所にコピーされます。|  
|![マウスはアイコンを「移動」](../../extensibility/ux-guidelines/media/0706-03-mousemove.png "0706 03_MouseMove")|移動|項目は、ターゲットの場所に移動されます。|  
|!["参照の追加 アイコンをマウス](../../extensibility/ux-guidelines/media/0706-04-mouseaddref.png "0706 04_MouseAddRef")|参照の追加|選択したアイテムへの参照は、ターゲットの場所に追加されます。|  
  
#### <a name="reference-based-projects"></a>プロジェクトの参照に基づく  
 次の表は、参照されるベースのターゲット プロジェクトの押されたソース項目と修飾子キーの性質に基づいて実行する必要があります (切り取り/コピー/貼り付け) と同様にドラッグ アンド ドロップ操作をまとめたものです。  
  
|||ソース項目: 参照/リンク|ソース項目: 物理項目またはファイル システム (ドロップ)|  
|-|-|----------------------------------|-------------------------------------------------------------|  
|修飾子のないです。|アクション|移動|リンク|  
|修飾子のないです。|ターゲット|元の項目への参照を追加します。|元の項目への参照を追加します。|  
|修飾子のないです。|ソース|元の項目への参照を削除します|元の項目が保持されます。|  
|修飾子のないです。|結果|**行った**からアクションとして返される **:: 削除**項目を開いたまま storage 内の元の場所|**DROPEFFECT_LINK**からアクションとして返される **:: 削除**項目を開いたまま storage 内の元の場所|  
|Shift キーを押しながらドラッグ|アクション|移動|ドロップしません。|  
|Shift キーを押しながらドラッグ|ターゲット|元の項目への参照を追加します。|ドロップしません。|  
|Shift キーを押しながらドラッグ|ソース|元の項目への参照を削除します|ドロップしません。|  
|Shift キーを押しながらドラッグ|結果|**行った**からアクションとして返される **:: 削除**項目を開いたまま storage 内の元の場所|ドロップしません。|  
|Ctrl キーを押しながらドラッグ|アクション|コピー|ドロップしません。|  
|Ctrl キーを押しながらドラッグ|ターゲット|元の項目への参照を追加します。|ドロップしません。|  
|Ctrl キーを押しながらドラッグ|ソース|元の項目への参照を保持します。|ドロップしません。|  
|Ctrl キーを押しながらドラッグ|結果|**DROPEFFECT_COPY**からアクションとして返される **:: 削除**項目を開いたまま storage 内の元の場所|ドロップしません。|  
|Ctrl キーを押しながら shift キーを押しながらドラッグ|アクション|リンク|リンク|  
|Ctrl キーを押しながら shift キーを押しながらドラッグ|ターゲット|元の項目への参照を追加します。|元の項目への参照を追加します。|  
|Ctrl キーを押しながら shift キーを押しながらドラッグ|ソース|元の項目への参照を保持します。|元の項目が保持されます。|  
|Ctrl キーを押しながら shift キーを押しながらドラッグ|結果|**DROPEFFECT_LINK**からアクションとして返される **:: 削除**項目を開いたまま storage 内の元の場所|**DROPEFFECT_LINK**からアクションとして返される **:: 削除**項目を開いたまま storage 内の元の場所|  
|Ctrl キーを押しながら shift キーを押しながらドラッグ|メモ|Windows エクスプ ローラーのショートカットのドラッグ アンド ドロップの動作と同じです。||  
|切り取り/貼り付け|アクション|移動|リンク|  
|切り取り/貼り付け|ターゲット|元の項目への参照を追加します。|元の項目への参照を追加します。|  
|切り取り/貼り付け|ソース|元の項目への参照を保持します。|元の項目が保持されます。|  
|切り取り/貼り付け|結果|項目は、ストレージ内の元の場所に残ります。|項目は、ストレージ内の元の場所に残ります。|  
|コピー/貼り付け|アクション|コピー|リンク|  
|コピー/貼り付け|ソース|元の項目への参照を追加します。|元の項目への参照を追加します。|  
|コピー/貼り付け|結果|元の項目への参照を保持します。|元の項目が保持されます。|  
|コピー/貼り付け|アクション|項目は、ストレージ内の元の場所に残ります。|項目は、ストレージ内の元の場所に残ります。|  
  
#### <a name="directory-based-projects"></a>ディレクトリ ベースのプロジェクト  
 次の表は、ディレクトリ ベースのターゲット プロジェクトの押されたソース項目と修飾子キーの性質に基づいて実行する必要があります (切り取り/コピー/貼り付け) と同様にドラッグ アンド ドロップ操作をまとめたものです。  
  
|||ソース項目: 参照/リンク|ソース項目: 物理項目またはファイル システム (ドロップ)|  
|-|-|----------------------------------|-------------------------------------------------------------|  
|修飾子のないです。|アクション|移動|移動|  
|修飾子のないです。|ターゲット|ターゲットの場所にコピー項目|ターゲットの場所にコピー項目|  
|修飾子のないです。|ソース|元の項目への参照を削除します|元の項目への参照を削除します|  
|修飾子のないです。|結果|**DROPEFFECT_ 移動**からアクションとして返される **:: 削除**ストレージ内の元の場所に項目を開いたまま|**DROPEFFECT_ 移動**からアクションとして返される **:: 削除**ストレージ内の元の場所に項目を開いたまま|  
|Shift キーを押しながらドラッグ|アクション|移動|移動|  
|Shift キーを押しながらドラッグ|ターゲット|ターゲットの場所にコピー項目|ターゲットの場所にコピー項目|  
|Shift キーを押しながらドラッグ|ソース|元の項目への参照を削除します|元の場所から項目を削除します。|  
|Shift キーを押しながらドラッグ|結果|**DROPEFFECT_ 移動**からアクションとして返される **:: 削除**ストレージ内の元の場所に項目を開いたまま|**DROPEFFECT_ 移動**からアクションとして返される **:: 削除**ストレージ内の元の場所に項目を開いたまま|  
|Ctrl キーを押しながらドラッグ|アクション|コピー|コピー|  
|Ctrl キーを押しながらドラッグ|ターゲット|ターゲットの場所にコピー項目|ターゲットの場所にコピー項目|  
|Ctrl キーを押しながらドラッグ|ソース|元の項目への参照を保持します。|元の項目への参照を保持します。|  
|Ctrl キーを押しながらドラッグ|結果|**DROPEFFECT_ コピー**からアクションとして返される **:: 削除**項目を開いたまま storage 内の元の場所|**DROPEFFECT_ コピー**からアクションとして返される **:: 削除**項目を開いたまま storage 内の元の場所|  
|Ctrl キーを押しながら shift キーを押しながらドラッグ||ドロップしません。|ドロップしません。|  
|切り取り/貼り付け|アクション|移動|移動|  
|切り取り/貼り付け|ターゲット|ターゲットの場所にコピー項目|ターゲットの場所にコピー項目|  
|切り取り/貼り付け|ソース|元の項目への参照を削除します|元の場所から項目を削除します。|  
|切り取り/貼り付け|結果|項目は、ストレージ内の元の場所に残ります。|ストレージの元の場所から削除されます。|  
|コピー/貼り付け|アクション|コピー|コピー|  
|コピー/貼り付け|ターゲット|元の項目への参照を追加します。|ターゲットの場所にコピー項目|  
|コピー/貼り付け|ソース|元の項目が保持されます。|元の項目が保持されます。|  
|コピー/貼り付け|結果|項目は、ストレージ内の元の場所に残ります。|項目は元の場所をストレージに残ります|  
  
#### <a name="mixed-target-projects"></a>混合ターゲット プロジェクト  
 次の表は、混合ターゲット プロジェクトの押されたソース項目と修飾子キーの性質に基づいて実行する必要があります (切り取り/コピー/貼り付け) と同様にドラッグ アンド ドロップ操作をまとめたものです。  
  
|||ソース項目: 参照/リンク|ソース項目: 物理項目またはファイル システム (ドロップ)|  
|-|-|----------------------------------|-------------------------------------------------------------|  
|修飾子のないです。|アクション|移動|移動|  
|修飾子のないです。|ターゲット|元の項目への参照を追加します。|ターゲットの場所にコピー項目|  
|修飾子のないです。|ソース|元の項目への参照を削除します|元の項目への参照を削除します|  
|修飾子のないです。|結果|**DROPEFFECT_ 移動**からアクションとして返される **:: 削除**ストレージ内の元の場所に項目を開いたまま|**DROPEFFECT_ 移動**からアクションとして返される **:: 削除**storage 内の元の場所から項目が削除されました。|  
|Shift キーを押しながらドラッグ|アクション|移動|移動|  
|Shift キーを押しながらドラッグ|ターゲット|元の項目への参照を追加します。|ターゲットの場所にコピー項目|  
|Shift キーを押しながらドラッグ|ソース|元の項目への参照を削除します|元の場所から項目を削除します。|  
|Shift キーを押しながらドラッグ|結果|**DROPEFFECT_ 移動**からアクションとして返される **:: 削除**ストレージ内の元の場所に項目を開いたまま|**DROPEFFECT_ 移動**からアクションとして返される **:: 削除**storage 内の元の場所から項目が削除されました。|  
|Ctrl キーを押しながらドラッグ|アクション|コピー|コピー|  
|Ctrl キーを押しながらドラッグ|ターゲット|元の項目への参照を追加します。|ターゲットの場所にコピー項目|  
|Ctrl キーを押しながらドラッグ|ソース|元の項目への参照を保持します。|元の項目が保持されます。|  
|Ctrl キーを押しながらドラッグ|結果|**DROPEFFECT_ コピー**からアクションとして返される **:: 削除**項目を開いたまま storage 内の元の場所|**DROPEFFECT_ コピー**からアクションとして返される **:: 削除**項目を開いたまま storage 内の元の場所|  
|Ctrl キーを押しながら shift キーを押しながらドラッグ|アクション|リンク|リンク|  
|Ctrl キーを押しながら shift キーを押しながらドラッグ|ターゲット|元の項目への参照を追加します。|元のソース アイテムへの参照を追加します。|  
|Ctrl キーを押しながら shift キーを押しながらドラッグ|ソース|元の項目への参照を保持します。|元の項目が保持されます。|  
|Ctrl キーを押しながら shift キーを押しながらドラッグ|結果|**DROPEFFECT_ リンク**からアクションとして返される **:: 削除**項目を開いたまま storage 内の元の場所|**DROPEFFECT_ リンク**からアクションとして返される **:: 削除**項目を開いたまま storage 内の元の場所|  
|切り取り/貼り付け|アクション|移動|移動|  
|切り取り/貼り付け|ターゲット|ターゲットの場所にコピー項目|ターゲットの場所にコピー項目|  
|切り取り/貼り付け|ソース|元の項目への参照を削除します|元の場所から項目を削除します。|  
|切り取り/貼り付け|結果|項目は、ストレージ内の元の場所に残ります。|ストレージの元の場所から削除されます。|  
|コピー/貼り付け|アクション|コピー|コピー|  
|コピー/貼り付け|ターゲット|元の項目への参照を追加します。|ターゲットの場所にコピー項目|  
|コピー/貼り付け|ソース|元の項目が保持されます。|元の項目が保持されます。|  
|コピー/貼り付け|結果|項目は、ストレージ内の元の場所に残ります。|項目は、ストレージ内の元の場所に残ります。|  
  
 内のドラッグを実装する際、これらの詳細を考慮にする必要があります、**ソリューション エクスプ ローラー**:  
  
- 選択範囲が複数あるシナリオの設計します。  
  
- ファイル名 (完全パス) は、ターゲット プロジェクト間で一意である必要がありますか、ドロップが許可されていない必要があります。  
  
- フォルダー名は一意である必要があります (大文字) が破棄されるレベル。  
  
- ドラッグ (上記のシナリオでは取り上げられていません) の時点でオープンかクローズであるファイルの間の動作の違いがあります。  
  
- 最上位レベルのファイルがフォルダー内のファイルよりも若干異なる方法で動作します。  
  
  注意すべきもう 1 つの問題は、開いてデザイナーまたはエディターを持つアイテムの移動操作を処理する方法を示します。 想定される動作は、次のとおりです (これはすべてのプロジェクト タイプに適用されます)、です。  
  
1. 場合エディターまたはデザイナーを開くには、未保存の変更はありません、し、エディターとデザイナー ウィンドウがサイレント モードで閉じられます。  
  
2. エディターまたはデザイナーを開くには、未保存の変更をあるは、ドラッグのソースが待機は、削除が発生し、ユーザーと、次のようなプロンプト ウィンドウを閉じる前に、開いているドキュメントでコミットされていない変更を保存するように依頼するには:  
  
   ```  
   ==========================================================   
        One or more open documents have unsaved changes.  
   Do you want to save uncommitted changes before proceeding?   
                     [Yes]  [No]  [Cancel]   
   ==========================================================  
   ```  
  
   これは、ユーザーに、ターゲットは、そのコピーを作成します。 前に、進行中の作業を保存する機会を与えます。 新しいメソッド**IVsHierarchyDropDataSource2::OnBeforeDropNotify**がこの処理を有効にする追加されました。  
  
   ストレージであるために、ターゲットは、項目の状態をコピーしされます (いないユーザーが選択した場合、エディターで未保存の変更を含む**いいえ**)。 ターゲットがそのコピーが完了した後 (で**IVsHierarchyDropDataSource::Drop**)、ソース、移動操作の削除の部分を完了する機会が与えられます (で**IVsHierarchyDropDataSource::OnDropNotify**)。  
  
   未保存の変更と任意のエディターは、開いたままする必要があります。 未保存の変更でそれらのドキュメントに対してつまり、移動操作のコピーの部分が実行されますが、delete 部分は中止されます。 ユーザーが複数選択シナリオで**いいえ**未保存の変更でそれらのドキュメントを終了したり、削除しないでください、未保存の変更がない閉じられ削除する必要があります。

