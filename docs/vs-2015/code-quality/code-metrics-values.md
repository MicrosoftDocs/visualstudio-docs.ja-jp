---
title: コードメトリックスの値 |Microsoft Docs
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-code-analysis
ms.topic: conceptual
helpviewer_keywords:
- code metrics
- code analysis
- measure code quality
ms.assetid: bc38831e-2083-4ea4-8527-ee41499a342f
caps.latest.revision: 22
author: jillre
ms.author: jillfra
manager: jillfra
ms.openlocfilehash: 23dba7b7c29c05b55af2c461f36bdaa4b46b948f
ms.sourcegitcommit: a8e8f4bd5d508da34bbe9f2d4d9fa94da0539de0
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/19/2019
ms.locfileid: "72667723"
---
# <a name="code-metrics-values"></a>コード メトリックス値
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

コード メトリックスとは、開発者が開発中のコードをより理解できるようにする、ソフトウェアの一連の基準です。 コードメトリックスを利用することにより、開発者は、どの型やメソッドを作成し直すか、さらに詳細にテストする必要があるかを理解できます。 開発チームは、潜在的なリスクを特定し、プロジェクトの現在の状態を把握し、ソフトウェア開発中の進行状況を追跡できます。

## <a name="software-measurements"></a>ソフトウェアの測定
 次の一覧に、[!INCLUDE[vsprvs](../includes/vsprvs-md.md)] によって計算されるコードメトリックスの結果を示します。

- **保守容易性インデックス**– 0 ~ 100 の範囲のインデックス値を計算します。この値は、コードの保守の相対的な容易さを表します。 値が大きい場合は、保守性が向上します。 色分けされた評価を使用して、コード内の問題点をすばやく特定できます。 緑色の評価は 20 ~ 100 の範囲であり、コードの保守性が優れていることを示しています。 黄色の評価は 10 ~ 19 で、コードが適度に保守可能であることを示します。 赤色の評価は、0 ~ 9 の評価であり、保守性が低いことを示します。

- **サイクロマティック複雑**度–コードの構造的な複雑さを測定します。 これは、プログラムのフロー内のさまざまなコードパスの数を計算することによって作成されます。 制御フローが複雑なプログラムでは、十分なコードカバレッジを実現するために、より多くのテストが必要であり、保守性が低下します。

    > [!NOTE]
    > 場合によっては、[!INCLUDE[vs_dev10_long](../includes/vs-dev10-long-md.md)] におけるメソッドのサイクロマティック複雑度の計算が、以前のバージョンとは異なる場合があります。 詳細については、「[コードメトリックスに関する問題のトラブルシューティング](../code-quality/troubleshooting-code-metrics-issues.md)」の「Visual Studio 2010 での変更点」を参照してください。

- **継承の深さ**–クラス階層のルートに拡張されるクラス定義の数を示します。 階層が深いほど、特定のメソッドやフィールドが定義または再定義されている場所を理解することが難しくなります。

- **クラス結合**–パラメーター、ローカル変数、戻り値の型、メソッドの呼び出し、ジェネリックまたはテンプレートのインスタンス化、基底クラス、インターフェイスの実装、外部の型に定義されたフィールド、および属性を使用して、一意のクラスへの結合を測定します。飾り. 優れたソフトウェア設計では、型とメソッドが高い凝集度と低結合を持つ必要があります。 結合率が高い場合は、他の型との依存関係が多数あるため、再利用と保守が困難な設計が示されます。

- **コード行**: コードのおおよその行数を示します。 このカウントは IL コードに基づいているため、ソースコードファイル内の行の正確な数ではありません。 非常に高いカウントは、型またはメソッドが過剰な作業を試行していて、分割する必要があることを示している可能性があります。 また、型またはメソッドを維持するのが困難な場合もあります。

## <a name="anonymous-methods"></a>匿名メソッド
 *匿名メソッド*は、名前のないメソッドにすぎません。 匿名メソッドは、コードブロックをデリゲートパラメーターとして渡すために最も頻繁に使用されます。 メソッドやアクセサーなど、メンバーで宣言されている匿名メソッドのメトリックの結果は、メソッドを宣言するメンバーに関連付けられています。 これらは、メソッドを呼び出すメンバーに関連付けられていません。

 コードメトリックスが匿名メソッドを扱う方法の詳細については、「[匿名メソッドとコード分析](../code-quality/anonymous-methods-and-code-analysis.md)」を参照してください。

## <a name="generated-code"></a>生成されたコード
 一部のソフトウェアツールとコンパイラは、プロジェクトに追加されたコードを生成します。プロジェクト開発者は、表示されないか、変更できません。 ほとんどの場合、コードメトリックスは、メトリック値を計算するときに、生成されたコードを無視します。 これにより、メトリック値に、開発者が表示および変更できる内容を反映させることができます。

 Windows フォーム用に生成されたコードは、開発者が表示および変更できるコードであるため、無視されません。

## <a name="see-also"></a>参照
 [マネージド コードの複雑さと保守性の測定](../code-quality/measuring-complexity-and-maintainability-of-managed-code.md)
