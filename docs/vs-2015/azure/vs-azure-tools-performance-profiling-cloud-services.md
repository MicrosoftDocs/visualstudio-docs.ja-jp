---
title: クラウド サービスのパフォーマンスのテスト |Microsoft Docs
description: Visual Studio プロファイラーを使用してクラウド サービスのパフォーマンスをテストします。
author: mikejo5000
manager: douge
ms.assetid: 7a5501aa-f92c-457c-af9b-92ea50914e24
ms.topic: conceptual
ms.tgt_pltfrm: multiple
ms.workload: na
ms.date: 11/11/2016
ms.author: mikejo
ms.prod: visual-studio-dev14
ms.technology: vs-azure
ms.openlocfilehash: 25b60e5e4072a0523d17082a5c5646e5bb1ade6a
ms.sourcegitcommit: e481d0055c0724d20003509000fd5f72fe9d1340
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/05/2018
ms.locfileid: "51002409"
---
# <a name="testing-the-performance-of-a-cloud-service"></a>クラウド サービスのパフォーマンスのテスト
## <a name="overview"></a>概要
次の方法では、クラウド サービスのパフォーマンスをテストできます。

* Azure Diagnostics を使用して、要求と接続に関する情報を収集し、顧客の観点からサービスを実行する方法を示すサイトの統計情報を確認します。 開始するを参照してください。 [Azure Cloud Services および Virtual Machines の診断の構成](http://go.microsoft.com/fwlink/p/?LinkId=623009)します。
* 計算的側面から、サービスの実行方法の詳細な分析を取得するのにには、Visual Studio プロファイラーを使用します。 このトピックの説明に従って、サービスを Azure で実行すると、パフォーマンスを測定するのにプロファイラーを使用できます。 プロファイラーを使用して、サービスがコンピューティング エミュレーターでローカル実行パフォーマンスを測定する方法については、次を参照してください[Visual Studio Profiler、コンピューティングエミュレーターを使用して、Azureクラウドサービスのローカルのパフォーマンスをテスト](http://go.microsoft.com/fwlink/p/?LinkId=262845).

## <a name="choosing-a-performance-testing-method"></a>パフォーマンスのテスト方法を選択します。
### <a name="use-azure-diagnostics-to-collect"></a>収集するには、Azure 診断を使用します。
* Web ページまたは要求や接続などのサービスの統計情報。
* ロールの再起動の頻度などのロールの統計情報です。
* 全体の割合、ガベージ コレクターにかかる時間やメモリなどのメモリの使用状況に関する情報は、実行中のロールのセット。

### <a name="use-the-visual-studio-profiler-to"></a>Visual Studio プロファイラーを使用します。
* かかる時間を最も多くの機能を決定します。
* 負荷の高いプログラムの各部分にかかる時間を測定します。
* サービスの 2 つのバージョンのレポートの詳細なパフォーマンスを比較します。
* 個別のメモリ割り当てレベルよりも詳細にメモリの割り当てを分析します。
* マルチ スレッド コードで同時実行の問題を分析します。

プロファイラーを使用する場合は、ローカルまたは Azure でクラウド サービスの実行時にデータを収集できます。

### <a name="collect-profiling-data-locally-to"></a>プロファイリング データのローカル収集します。
* 現実的にシミュレートされた負荷を必要としない特定のワーカー ロールの実行などのクラウド サービスの一部のパフォーマンスをテストします。
* 分離性、制御された条件下では、クラウド サービスのパフォーマンスをテストします。
* Azure にデプロイする前に、クラウド サービスのパフォーマンスをテストします。
* 既存の展開の影響を及ぼすことがなく非公開でクラウド サービスのパフォーマンスをテストします。
* Azure で実行するための料金は発生せず、サービスのパフォーマンスをテストします。

### <a name="collect-profiling-data-in-azure-to"></a>Azure でプロファイリング データを収集します。
* シミュレートされたまたは実際の負荷の下で、クラウド サービスのパフォーマンスをテストします。
* このトピックで後で説明するように、プロファイリング データの収集のインストルメンテーション メソッドを使用します。
* 運用環境でサービスを実行するときと同じ環境で、サービスのパフォーマンスをテストします。

通常、通常のクラウド サービスをテストまたはストレス条件に負荷をシミュレートします。

## <a name="profiling-a-cloud-service-in-azure"></a>Azure でクラウド サービスのプロファイリング
Visual Studio からクラウド サービスを発行するときに、サービスをプロファイルし、必要な情報を提供するプロファイルの設定を指定できます。 ロールの各インスタンスでは、プロファイル セッションが開始されます。 Visual Studio からサービスを発行する方法の詳細については、[Visual Studio から Azure クラウド サービスへの発行](https://msdn.microsoft.com/library/azure/ee460772.aspx)を参照してください。

Visual Studio でのパフォーマンス プロファイリングの詳細については、[パフォーマンス プロファイリングのビギナーズ ガイド](https://msdn.microsoft.com/library/azure/ms182372.aspx)と[プロファイリング ツールを使用したアプリケーション パフォーマンスの分析](https://msdn.microsoft.com/library/azure/z9z62c29.aspx)を参照してください。

> [!NOTE]
> IntelliTrace またはクラウド サービスを発行するときにプロファイルを有効にできます。 両方を有効にすることはできません。
> 
> 

### <a name="profiler-collection-methods"></a>Profiler コレクション メソッド
パフォーマンスの問題に基づく、プロファイリング用、さまざまな収集メソッドを使用することができます。

* **CPU サンプリング**-このメソッドは、CPU 使用率の問題の初期分析に役立つアプリケーション統計情報を収集します。 CPU サンプリングは、ほとんどのパフォーマンス調査を開始するための推奨される方法です。 CPU サンプリング データを収集する際に、プロファイルするアプリケーションにはあまり影響を与えません。
* **インストルメンテーション**-このメソッドを絞った分析および入出力パフォーマンスの問題を分析するために役立つ詳細なタイミング データを収集します。 プロファイリング実行中には、インストルメンテーション メソッドは各エントリ、終了、および関数の関数呼び出しをモジュールで記録します。 この方法は、コード セクションに関する詳細なタイミング情報を収集し、アプリケーションのパフォーマンスに対する入出力操作の影響を理解するのに役立ちます。 このメソッドは、32 ビットのオペレーティング システムを実行しているコンピューターに対して無効です。 このオプションは、のみを実行すると、クラウド サービス、Azure でローカルではなく、コンピューティング エミュレーターで使用します。
* **.NET メモリ割り当て**-このメソッドは、サンプリング プロファイリング メソッドを使用して、.NET Framework メモリ割り当てデータを収集します。 収集されたデータには、割り当てられたオブジェクトのサイズと数が含まれています。
* **同時実行**-このメソッドは、リソース競合データとは、マルチ スレッドおよびマルチ プロセス アプリケーションの分析に役立つプロセスおよびスレッドの実行のデータを収集します。 コンカレンシー メソッドでは、アプリケーション リソースへのロックされたアクセスが解放されるまでスレッドが待機している場合など、コードの実行をブロックする各イベントのデータを収集します。 この方法は、マルチスレッド アプリケーションを分析するのに役立ちます。
* 有効にすることも**階層相互作用プロファイリング**、1 つまたは複数のデータベースと通信する多階層アプリケーションの関数の呼び出しの ADO.NET 同期の実行時間に関する追加情報を提供します。 プロファイル方法のいずれかで階層相互作用データを収集できます。 階層相互作用プロファイルの詳細については、[階層の相互作用ビュー](https://msdn.microsoft.com/library/azure/dd557764.aspx)を参照してください。

## <a name="configuring-profiling-settings"></a>プロファイル設定を構成します。
次の図は、Azure アプリケーションの発行 ダイアログ ボックスからプロファイル設定を構成する方法を示します。

![プロファイリング設定の構成](./media/vs-azure-tools-performance-profiling-cloud-services/IC526984.png)

> [!NOTE]
> 有効にする、**プロファイリングを有効にする**チェック ボックスで、クラウド サービスの発行を使用しているローカル コンピューターにインストールされているプロファイラーをいる必要があります。 既定では、Visual Studio をインストールするときに、プロファイラーがインストールされています。
> 
> 

### <a name="to-configure-profiling-settings"></a>プロファイルの設定を構成するには
1. ソリューション エクスプ ローラーで、Azure プロジェクトのショートカット メニューを開くし、選択**発行**します。 クラウド サービスを発行する方法の詳細については、[Azure ツールを使用してクラウド サービスの発行](http://go.microsoft.com/fwlink/p?LinkId=623012)を参照してください。
2. **Azure アプリケーションの発行**ダイアログ ボックスで、選択、**詳細設定**タブ。
3. プロファイリングを有効にするのには、選択、**プロファイリングを有効にする**チェック ボックスをオンします。
4. プロファイル設定を構成するには、選択、**設定**ハイパーリンク。 プロファイルの設定 ダイアログ ボックスが表示されます。
5. **使用を希望はプロファイル**オプション ボタン、必要なプロファイルの種類を選択します。
6. 階層の相互作用プロファイル データを収集するには、選択、**階層相互作用のプロファイリングを有効にする**チェック ボックスをオンします。
7. 設定を保存する、 **OK**ボタンをクリックします。
   
    このアプリケーションを発行するときに、これらの設定は、各ロールのプロファイル セッションの作成に使用されます。

## <a name="viewing-profiling-reports"></a>プロファイル レポートの表示
プロファイル セッションは、クラウド サービスのロールのインスタンスごとに作成されます。 Visual Studio から各セッションのプロファイル レポートを表示するのには、サーバー エクスプ ローラー ウィンドウを表示し、ロールのインスタンスを選択する Azure の計算ノードを選択します。 次の図に示すように、プロファイル レポートを表示できます。

![Azure からのプロファイル レポートを表示します。](./media/vs-azure-tools-performance-profiling-cloud-services/IC748914.png)

### <a name="to-view-profiling-reports"></a>プロファイル レポートを表示するには
1. Visual Studio でサーバー エクスプ ローラー ウィンドウを表示するには、メニュー バーでビューを選択、サーバー エクスプ ローラー。
2. Azure コンピューティング ノードを選択し、Visual Studio から発行したときに、プロファイル対象として選択したクラウド サービスの Azure デプロイ ノードを選択します。
3. インスタンスのプロファイル レポートを表示するには、サービスでロールを選択、特定のインスタンスのショートカット メニューを開くし、選択し、**プロファイリング レポートの表示**します。
   
    Azure から、レポートの .vsp ファイルがダウンロードされ、Azure アクティビティ ログで、ダウンロードの状態が表示されます。 という名前の Visual Studio のエディターのタブで、プロファイル レポートが表示されます、ダウンロードが完了したら、 <Role name> *<Instance Number>* <identifier>.vsp します。 レポートの集計データが表示されます。
4. 現在のビューの一覧で、レポートの異なるビューを表示するには、表示するビューの種類を選択します。 詳細については、[プロファイリング ツールのレポート ビュー](https://msdn.microsoft.com/library/azure/bb385755.aspx)を参照してください。

## <a name="next-steps"></a>次の手順
[Cloud Services のデバッグ](https://msdn.microsoft.com/library/azure/ee405479.aspx)

[Visual Studio から Azure クラウド サービスへの発行](https://msdn.microsoft.com/library/azure/ee460772.aspx)

