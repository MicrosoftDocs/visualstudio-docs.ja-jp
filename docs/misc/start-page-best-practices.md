---
title: "スタート ページのベスト プラクティス | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-csharp"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "スタート ページのヒント"
  - "スタート ページのベスト プラクティス"
  - "スタート ページのデザイン"
ms.assetid: f6ce1ce0-746e-4004-a37f-6f176f6f5851
caps.latest.revision: 16
caps.handback.revision: 16
manager: "douge"
---
# スタート ページのベスト プラクティス
スタート ページでは Visual Studio のコマンドにアクセスでき、Visual Studio を読み込むときには常にこのページが開くため、カスタム スタート ページを使用または配布する前にその安定性を必ず確認することをお勧めします。 このトピックでは、堅牢なスタート ページ デザインのベスト プラクティスを提案しています。また、便利なユーザー インターフェイス \(UI\) を作成する方法についてのガイドラインが含まれています。  
  
## 安定性のガイドライン  
  
### リソースの可用性  
 堅牢なカスタム スタート ページを作成する際の最も重要な考慮事項は、必要なすべてのリソースが利用できることの確認です。  
  
-   必要なすべてのパッケージがインストールされていること。  
  
-   パッケージがあらかじめ読み込まれていること。  
  
-   必要なすべてのアセンブリが \\PrivateAssemblies\\ フォルダー内にあること。  
  
-   ネットワークまたはインターネット接続を使用するすべてのコンポーネントに、オフラインのシナリオと接続が切断された場合の代替経路があること。  
  
### パフォーマンス  
 スタート ページが大量のメモリを必要とする場合や、多くのリソースを読み込む場合は、起動時のパフォーマンスが受ける影響について検討します。 そうしたスタート ページは、コンポーネントを必要に応じて読み込むか、または現実的な場合はバックグラウンドで読み込むようプログラムして、起動時間が大幅に増加することを回避します。  
  
### 開発プロセス  
 アクティブなスタート ページを直接変更する場合、Visual Studio をクラッシュさせるエラーを誤って持ち込んでしまうおそれがあります。 スタート ページは Visual Studio が起動するたびに開くので、スタート ページのクラッシュは修正するのが困難です。 そのため、スタート ページ ファイルのコピーを変更して、Visual Studio の実験用インスタンスでテストし、信頼性を高めることをお勧めします。 新しいスタート ページが安定したら、Visual Studio のプライマリ インスタンスで実行するように設定できます。  
  
> [!NOTE]
>  また、サードパーティのスタート ページの場合も、プライマリ インスタンスで使用する前に、Visual Studio の実験用インスタンスでテストすることをお勧めします。  
  
##### Visual Studio の実験用インスタンスでスタート ページをテストするには  
  
1.  スタート ページのプロジェクト テンプレートを使用している場合は、F5 キーを押します。 それ以外の場合:  
  
    1.  .xaml ファイルとサポート テキストやマークアップを \\%USERPROFILE%\\My Documents\\Visual Studio *\<バージョン\>*\\StartPages\\ にコピーします。  
  
    2.  必要なアセンブリを *\<Visual Studio インストール パス\>*\\Common7\\IDE\\PrivateAssemblies\\ にコピーします。  
  
    3.  Visual Studio コマンド プロンプトで次のコマンドを使用して、Visual Studio の実験用インスタンスを開きます。  
  
         **Devenv \/rootsuffix exp**  
  
2.  **\[ツール\]** メニューの **\[オプション\]** をクリックします。**\[環境\]** を選択し、次に **\[スタートアップ\]** を選択します。**\[スタート ページのカスタマイズ\]** 一覧で、名前を変更した StartPage.xaml ファイルを選択して、**\[OK\]** をクリックします。  
  
3.  **\[表示\]** メニューの **\[スタート ページ\]** をクリックします。  
  
     カスタム スタート ページが開きます。 変更しているスタート ページがクラッシュする場合は、Visual Studio のプライマリ インスタンスを再起動し、必要な修正を加え、別の実験用インスタンスを開くことで、カスタム スタート ページの変更を続けることができます。  
  
 スタート ページによって Visual Studio のプライマリ インスタンスがクラッシュする場合は、HKEY\_CURRENT\_USER\\Software\\Microsoft\\VisualStudio\\14.0\\StartPage\\Default\\CustomizationEnabled のレジストリ値を 0 に設定し、一時的にカスタム スタート ページを無効にすることができます。 あるいは、現在の既定のスタート ページに対応する .xaml ファイルの名前を一時的に変更することもできます。 いずれかの対応で、エラーを解決するのに十分な時間、Visual Studio を起動できます。  
  
### デバッグ  
 スタート ページ ツール ウィンドウは、スタート ページが最初に読み込まれたときに例外をキャッチしますが、その後は例外をキャッチしません。 次のレジストリ値を "1" に設定することにより、Visual Studio がすべての未処理例外を表示するよう指示できます。  
  
 HKEY\_CURRENT\_USER\\Software\\Microsoft\\VisualStudio\\14.0\\General\\EnableUnhandledExceptionDisplay  
  
 例外情報はメッセージ ボックスに表示されます。そこから、スタート ページ上、他の未処理の場所、さらにはプライマリ Visual Studio インスタンス内のコントロールをデバッグできます。 例外が発生した後にデバッグができない場合は、"devenv \/safemode" コマンドを使用して Visual Studio を再起動し、前のスタート ページに戻り、実験用インスタンスでデバッグを継続することができます。  
  
### 相対パス  
 スタート ページからファイル パスを参照するときは、さまざまなシステム構成に対応するため、常に相対パスを使用します。 ただし、スタート ページ上のすべての相対パスのルートは、\\StartPages\\ フォルダーではなく、devenv.exe が存在する、..\\*Visual Studio インストール フォルダー*\\Common7\\IDE に解決されます。 \\StartPages\\ フォルダーへの相対パスを設定するには、VS スタート ページ相対コンバーターを使用します。 これを行うには、次の例に示すように、オブジェクトの `Source` プロパティを `vs:StartPageRelative` に設定します。  
  
 XAML  
  
```  
<Image Source="{vs:StartPageRelative myImage.png}" .../>  
```  
  
 Visual Studio に含まれているリソース、またはその他のパッケージに含まれるファイルにアクセスするときには、標準の相対パスの構文を使用します。  
  
### 配置  
 カスタム スタート ページを他のユーザーに展開するときには、次のベスト プラクティスをお勧めします。  
  
#### ユーザー設定  
  
-   ユーザーの設定を尊重します。 既存のスタート ページの基本設定を上書きしません。  
  
#### VSIX  
 次のプラクティスは、VSIX 配置に適用されます。  
  
-   VSIX マニフェスト内の [GettingStartedGuide](http://msdn.microsoft.com/ja-jp/261bb1fd-abae-4ed6-80a8-90d5fc3bb8c6) 要素を使用して、既定のスタート ページを設定する方法に関する指示を指します。  
  
-   VSIX マニフェストの[Name](http://msdn.microsoft.com/ja-jp/d99d38d1-060b-401a-9b9f-ede2c6213a11) 要素と [Description](http://msdn.microsoft.com/ja-jp/24ddc57e-e991-4a43-b0c9-0e76da293e99) 要素を使用して、拡張機能をスタート ページとして明確に特定し、その目的を説明します。  
  
-   VSIX マニフェストに絶対パスが含まれていないことを確認します。  
  
-   [Visual Studio ギャラリー](http://go.microsoft.com/fwlink/?LinkID=123847) Web サイトにアップロードするときは、ユーザーが拡張機能をスタート ページとして識別できるように、意味のあるタグ付けを含めます。  
  
#### MSI  
 Windows インストーラー \(MSI\) パッケージで展開している、より大きな拡張機能の一部としてスタート ページを作成する場合は、そのスタート ページがターゲット コンピューターの既定のスタート ページとしてインストールされるように設定できます。 これを実現するには、スタート ページの .xaml ファイルの名前を、レジストリ キー HKCU\\Software\\Microsoft\\VisualStudio\\14.0\\StartPage\\Default\\ の URI 値に書き込みます。 このレジストリ値を設定するときには、次のガイドラインを使用します。  
  
-   インストーラーで、ユーザーが新しいスタート ページを既定とするかどうかを選択できるようにするための UI を提供します。  
  
-   ユーザーが拡張機能をアンインストールする場合は、以前のレジストリ値を復元します。  
  
### Windows Presentation Foundation \(WPF\)  
 XAML マークアップは、WPF のベスト プラクティスに従う必要があります。[!INCLUDE[TLA#tla_winclient](../misc/includes/tlasharptla_winclient_md.md)] と [!INCLUDE[TLA#tla_netframewk](../misc/includes/tlasharptla_netframewk_md.md)] のアプリケーション開発に関するベスト プラクティスについては、必要に応じて、次のトピックを参照してください。  
  
|領域|トピック|  
|--------|----------|  
|ユーザー補助|[Accessibility Best Practices](../Topic/Accessibility%20Best%20Practices.md)|  
|ローカリゼーション|[WPF のグローバリゼーションおよびローカリゼーションの概要](../Topic/WPF%20Globalization%20and%20Localization%20Overview.md)|  
|パフォーマンス|[WPF アプリケーションのパフォーマンスの最適化](../Topic/Optimizing%20WPF%20Application%20Performance.md)|  
|セキュリティ|[セキュリティ \(WPF\)](../Topic/Security%20\(WPF\).md)|  
  
## ユーザー インターフェイスのガイドライン  
 スタート ページにおいて便利で直感的なユーザー エクスペリエンスを実現するには、該当する場合、次の UI ガイドラインを使用します。  
  
### トップの行  
  
#### バナー  
  
-   バナー イメージの高さは、イメージを含む行の行定義の高さと同じにします。  
  
-   さまざまなウィンドウ サイズと画面解像度に対応するために、どの幅でも視覚的に心地よいバナー イメージを作成します。  
  
-   バナー領域をすっきりさせます。 ロゴに他のボタンやグラフィックを重ねないでください。  
  
### 左側の列  
  
#### ボタン領域  
  
-   ボタン領域には最もよく使用されるコントロールのみを配置し、最近使用したプロジェクトの名前が表示される余地を確保します。 ボタンの数は 5 未満にすることをお勧めします。  
  
#### 最近使ったプロジェクト  
  
-   このコントロールにより、ユーザーは最近使用したプロジェクトにアクセスすることができます。 表示するプロジェクトの数を 0 から 24 の範囲で設定できます。 このセクションはスタート ページで最もよく使用されるため、削除しないことをお勧めします。  
  
#### スタート ページのオプション  
  
-   スタート ページに、**\[プロジェクト読み込み後にページを閉じる\]** オプションと **\[スタートアップ時にページを表示する\]** オプションが表示されることを確認します。  
  
-   この領域の追加コントロールに関しては、チェック ボックスやオプション ボタンを使用し、コントロールがスタート ページの基本設定に関連するかどうかを確認することをお勧めします。  
  
### コンテンツ領域  
  
#### 最上位のタブ  
  
-   標準的な画面の幅でタブ コントロールが折り返されるほど多くのタブを追加しないでください。  
  
-   タブには簡潔でわかりやすい名前を使用します。  
  
-   タブがグループ化されたコンテンツ領域を表すことを確認します。  
  
#### サブレベルのタブ  
  
-   3 つ以上のサブトピックがある場合のみ、サブレベルのナビゲーションを使用します。  
  
-   標準的な画面の幅でタブ コントロールが折り返されるほど多くのタブを追加しないでください。  
  
-   タブには簡潔でわかりやすい名前を使用します。  
  
#### サブレベル タブのコンテンツ  
  
-   サブレベル タブに表示するコンテンツ項目は 5 つ以内にします。  
  
#### 項目のコンテンツ  
  
-   コンテンツ項目ごとに表示するリンクは 4 つ以下にします。  
  
-   コンテンツ項目にイメージを関連付ける場合は、すべてのイメージが 175 x 125 ピクセルであることを確認してください。  
  
-   コンテンツ項目には、簡潔でわかりやすいタイトルを使用します。  
  
-   コンテンツ項目の説明は 2 つ以下の文に制限します。  
  
### 全般  
  
#### アニメーション  
  
-   アニメーションを使用する場合は、0.5 秒以下に制限し、パフォーマンスが低下したと感じさせないようにします。  
  
#### 環境の色  
  
-   フォントと色のシステム設定を尊重します。  
  
-   明るい色の背景を使用します。  
  
-   リモート デスクトップの検出を使用して、リモート セッションでの色の低下が適切になるようにします。  
  
## 参照  
 [スタート ページのアーキテクチャ](/visual-cpp/misc/start-page-architecture)   
 [カスタム スタート ページを展開します。](../extensibility/deploying-custom-start-pages.md)   
 [Visual Studio のコマンドをスタート ページに追加します。](../extensibility/adding-visual-studio-commands-to-a-start-page.md)