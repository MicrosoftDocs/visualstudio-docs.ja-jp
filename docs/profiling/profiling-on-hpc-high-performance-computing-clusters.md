---
title: "高性能コンピューティング (HPC) クラスターでのプロファイリング | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-debug"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "vs.performance.hpc.wizard.exeoptions"
  - "vs.performance.hpc.wizard.summary"
  - "vs.performance.hpc.wizard.startoptions"
  - "vs.performance.hpc.wizard.intro"
  - "vs.performance.hpc.property.basic"
  - "vs.performance.hpc.wizard.application"
  - "vs.performance.hpc.wizard.clusteroptions"
  - "vs.performance.hpc.property.advanced"
helpviewer_keywords: 
  - "プロファイリング ツール、HPC"
  - "HPC プロファイリング"
ms.assetid: 1525bbdb-27da-4088-8487-a486cee5e7b3
caps.latest.revision: 22
author: "mikejo5000"
ms.author: "mikejo"
manager: "ghogen"
caps.handback.revision: 22
---
# 高性能コンピューティング (HPC) クラスターでのプロファイリング
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

サンプリング メソッドの [!INCLUDE[vsPreExt](../profiling/includes/vspreext_md.md)] プロファイリング ツールまたは [!INCLUDE[vsUltExt](../profiling/includes/vsultext_md.md)] プロファイリング ツールを使用して、Microsoft Windows HPC クラスターのコンピューティング ノード上でプロファイリングを実行できます。  HPC の詳細については Microsoft の Web サイト [Windows HPC](http://go.microsoft.com/fwlink/?LinkId=165393) で参照します。  
  
## 前提条件  
 HPC コンピューティング ノード上でプロファイリングを実行する前に、次の操作を実行する必要があります。  
  
-   [!INCLUDE[vsPreLong](../code-quality/includes/vsprelong_md.md)] と同じコンピューター上に Microsoft HPC Pack 2008 をインストールします。  これは、HPC クラスターの一部を構成するコンピューターである必要はありません。  で HPC Pack をインストールできます [Microsoft ダウンロード センター](http://go.microsoft.com/fwlink/?LinkID=177414)。  
  
-   プロファイリング ツールのスタドアロン バージョンと [!INCLUDE[net_v40_long](../profiling/includes/net_v40_long_md.md)] を HPC コンピューティング ノードにインストールします。  [!INCLUDE[dnprdnshort](../code-quality/includes/dnprdnshort_md.md)] のプログラムをインストールするスタンドアロンのなプロファイラーは [!INCLUDE[vsPreShort](../code-quality/includes/vspreshort_md.md)] のインストール メディアで使用できます。  **メモ** インストール後に計算を再起動する必要があります。[!INCLUDE[dnprdnshort](../code-quality/includes/dnprdnshort_md.md)]、プロファイリング ツールをインストールする前に、  
  
 アクティブな HPC コンピューティング ノードに [!INCLUDE[net_v40_long](../profiling/includes/net_v40_long_md.md)] とスタンドアロンのプロファイリング ツールをインストールし、クラスター マシン上でのプロファイリングを有効にするには、次の手順を実行します。  
  
1.  HPC Pack がインストールされているコンピューターで、コマンド プロンプト ウィンドウを開きます。  
  
2.  コマンド プロンプト ウィンドウで、次のコマンドを別々に入力します。  
  
    1.  `clusrun /all /scheduler:` *%HeadNode% %FxPath%* `/q /norestart`  
  
    2.  `clusrun /all /scheduler:` *%HeadNode%* `shutdown /r /t 0 /d u:4:2 /c "Microsoft .NET Framework install required restart"`  
  
    3.  `clusrun /all /scheduler:` *%HeadNode% %ProfilerPath%* `/q /norestart`  
  
|||  
|-|-|  
|*%HeadNode%*|クラスターの先頭ノードの名前。|  
|*%FxPath%*|[!INCLUDE[net_v40_long](../profiling/includes/net_v40_long_md.md)] インストーラーのパス。  [!INCLUDE[vsPreShort](../code-quality/includes/vspreshort_md.md)] インストール メディア上のパスは、WCU\\dotNetFramework\\dotNetFx40\_Full\_x86\_x64.exe になります。|  
|*%ProfilerPath%*|プロファイリング ツール インストーラーのスタドアロン バージョンのパス。  [!INCLUDE[vsPreShort](../code-quality/includes/vspreshort_md.md)] インストール メディア上のパスは、Standalone Profiler\\x64\\vs\_profiler.exe になります。|  
  
## HPC コンピューティング ノード上でのプロファイリング  
 HPC パフォーマンス ウィザードを使用してプロファイリング セッションを構成し、HPC クラスターおよび対象の情報を指定します。  パフォーマンス セッションのプロパティ ページで、追加のオプションを指定できます。  プロファイリング ツールによって必要な対象バイナリが配置され、プロファイラーと HPC アプリケーションが起動されます。  
  
#### HPC コンピューティング ノード上でプロファイリングを実行するには  
  
1.  **\[分析\]** メニューの **\[パフォーマンス ウィザードの起動\]** をクリックします。  このコマンドが使用できない場合は、前の前提条件を確認してください。  
  
2.  ウィザードの最初のページで **\[次へ\]** をクリックします。  
  
3.  ウィザードの 2 ページ目で、プロファイリングを実行するアプリケーションを選択します。  
  
    -   [!INCLUDE[vs_current_short](../code-quality/includes/vs_current_short_md.md)] で現在開いているプロジェクトのプロファイリングを実行するには、**\[使用可能な 1 つ以上のプロジェクト\]** を選択してから、リスト内のプロジェクト名を選択します。  
  
    -   開いているプロジェクト内に存在しないバイナリのプロファイリングを実行するには、**\[実行可能ファイル \(.EXE ファイル\)\]** を選択します。  
  
4.  **\[次へ\]** をクリックします。  
  
5.  ウィザードの 3 ページ目で、次の操作を実行します。  
  
    -   開いているプロジェクト内に存在しない実行可能ファイルのプロファイリングを実行する場合は、バイナリ ファイルのパスを **\[実行可能ファイルへの完全パスを指定\]** に入力します。  
  
    -   開いているプロジェクト内に存在しない実行可能ファイルのプロファイリングを実行する場合は、**\[コマンド ライン引数\]** で指定されたプロセスに渡すコマンド ライン引数を任意に指定できます。  
  
    -   **\[リモート作業ディレクトリ\]** で、各コンピューティング ノード上のプロセス インスタンスで使用されるフォルダーへのパスを指定します。  
  
    -   **\[配置場所\]** で、HPC サーバーによるイメージの配置に使用されるディレクトリへのパスを指定します。  
  
6.  **\[次へ\]** をクリックします。  
  
7.  ウィザードの 4 ページ目で、次の操作を実行します。  
  
    -   **\[ヘッド ノード\]** ボックスで、プロファイリング実行において HPC の先頭ノードとして機能するコンピューターをクリックします。  \[ヘッド ノード\] に "localhost" を指定すると、クラスターを使用することなく、ローカル コンピューター上でプロファイリングを実行できます。  
  
    -   **\[プロセス数\]** ボックスで、実行するアプリケーションのインスタンス数をクリックします。  
  
    -   **\[プロファイル オプション\]** ボックスで、プロファイリング対象を選択します。  
  
         クラスター内の特定のプロセスをプロファイリングするには、**\[順位でのプロファイル\]** を選択し、ドロップダウン リストからプロセスの順位を選択します。  
  
         HPC クラスター内の特定のノード上で実行される 1 つ以上のプロセスをプロファイリングするには、**\[ノードでのプロファイル\]** を選択し、ドロップダウン リストからノードを選択します。  
  
8.  **\[次へ\]** をクリックします。  
  
9. ウィザードの 5 ページ目で、プロファイラーとプロファイリング プロセスをすぐに開始できます。または、パフォーマンス エクスプローラーを使用して後からプロファイリングを開始することもできます。  
  
    -   すぐにプロファイリングを開始する場合は、**\[ウィザードの完了後にプロファイルを起動する\]** を選択します。手動でプロファイリングを開始する場合は、このチェック ボックスをオフにします。  
  
10. \[完了\] をクリックします。  
  
## パフォーマンス セッションのプロパティ ページを使用した HPC プロファイリング プロパティの設定  
 パフォーマンス セッションのプロパティ ページの \[HPC 起動プロパティ\] ページで、HPC プロファイル ウィザードで設定されたパフォーマンス セッションのプロパティを変更できます。  \[HPC の詳細プロパティ\] ページで、追加のオプションを指定できます。  
  
#### パフォーマンス セッションのプロパティ ページを開くには  
  
1.  必要に応じて、パフォーマンス エクスプローラーでパフォーマンス セッション ファイル \(拡張子 .psess が付いたファイル\) を開きます。  **\[ファイル\]** メニューの **\[開く\]** をクリックし、ファイルを探します。  
  
2.  パフォーマンス エクスプローラーでパフォーマンス セッション名を右クリックし、**\[プロパティ\]** をクリックします。  
  
3.  \[プロパティ ページ\] ダイアログ ボックスで、次のいずれかの操作を実行します。  
  
    -   HPC プロファイリングを有効にする場合は、**\[全般\]** をクリックして **\[HPC クラスターで収集\]** を選択します。HPC プロファイリングを無効にする場合は、このチェック ボックスをオフにします。  
  
    -   HPC アプリケーションの開始プロパティを変更する場合は、**\[HPC 起動プロパティ\]** をクリックします。  
  
    -   追加のオプションを指定する場合は、**\[HPC 詳細プロパティ\]** をクリックします。  
  
### HPC 起動プロパティ  
  
|プロパティ|説明|  
|-----------|--------|  
|**ヘッド ノード**|プロファイリング実行において HPC の先頭ノードとして機能するコンピューターを指定します。|  
|**プロセス数**|プロファイリング対象のアプリケーション内で実行するアプリケーションのインスタンス数を指定します。|  
|**順位でのプロファイル**|クラスター内の特定のプロセスをプロファイリングするには、**\[順位でのプロファイル\]** を選択し、ドロップダウン リストからプロセスの順位を選択します。|  
|**ノードでのプロファイル**|HPC クラスター内の特定のノード上で実行される 1 つ以上のプロセスをプロファイリングするには、**\[ノードでのプロファイル\]** を選択し、ドロップダウン リストからノードを選択します。|  
|**リモート作業ディレクトリ**|各コンピューティング ノード上のプロセス インスタンスで使用されるフォルダーへのパスを指定します。|  
|**配置場所**|HPC サーバーによるイメージの配置に使用されるディレクトリへのパスを指定します。|  
  
### 高度なプロパティ  
  
|プロパティ|説明|  
|-----------|--------|  
|**プロジェクト名**|現在の [!INCLUDE[vs_current_short](../code-quality/includes/vs_current_short_md.md)] プロジェクトまたはソリューションの名前を指定します。|  
|**プロファイラーの停止時にクリーンアップ**|実行ディレクトリに配置されたバイナリを削除する場合は、このオプションを選択します。  ただし、ユーザー プログラムによって作成されたファイルとディレクトリは削除されません。  実行ディレクトリと配置ディレクトリが IDE で作成されている場合、これらのディレクトリは IDE によって削除されますが、IDE 以外の環境で配置されたファイルがディレクトリ内に存在する場合は削除されません。|  
|**配置する追加ファイル**|コンピューティング ノード上に配置する追加ファイルをセミコロンで区切った一覧を指定します。  省略記号ボタン \(**\[...\]**\) をクリックしてダイアログ ボックスを使用すると、複数のファイルを選択できます。|  
|**Mpiexec コマンド**|MPI アプリケーションを開始するためのアプリケーションを指定します。  既定値は **mpiexec.exe** です。|  
|**Mpiexec の引数**|mpiexec.exe コマンドに渡す引数を指定します。|  
|**クラスター上の要求されたノード**|アプリケーションを実行するクラスター上のノード数を指定します。|  
|**CRT ファイルの配置**|C\/C\+\+ ランタイムをクラスター上に配置する場合は、このオプションを選択します。|  
|**プロファイル前スクリプト**|プロファイリング セッションの開始前に、ローカルの開発用コンピューター上で実行するスクリプトのパスとファイル名を指定します。|  
|**プロファイル前スクリプトの引数**|プロファイル前スクリプトに渡す引数を指定します。|  
|**プロファイル後スクリプト**|プロファイリング セッションの終了後に、ローカルの開発用コンピューター上で実行するスクリプトのパスとファイル名を指定します。|  
|**プロファイル後スクリプトの引数**|プロファイル後スクリプトに渡す引数を指定します。|