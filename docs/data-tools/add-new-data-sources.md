---
title: 新しいデータ ソースの追加
ms.date: 11/21/2018
ms.topic: conceptual
f1_keywords:
- vs.datasource.datasourcefieldspicker
helpviewer_keywords:
- data [Visual Studio], data sources
- data sources
ms.assetid: ed28c625-bb89-4037-bfde-cfa435d182a2
author: ghogen
ms.author: ghogen
manager: jillfra
ms.workload:
- data-storage
ms.openlocfilehash: 555d32eb295e944060d2efe0b843e9d157b7c675
ms.sourcegitcommit: 95f26af1da51d4c83ae78adcb7372b32364d8a2b
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/13/2020
ms.locfileid: "79301207"
---
# <a name="add-new-data-sources"></a>新しいデータ ソースの追加

Visual Studio の .NET データ ツールのコンテキストでは、*用語データ ソース*は、データ ストアに接続し、.NET アプリケーションでデータを使用できるようにする .NET オブジェクトを指します。 Visual Studio デザイナーは、データ ソースの出力を使用して、データベース オブジェクトを [**データ ソース**] ウィンドウからドラッグ アンド ドロップするときに、データをフォームにバインドする定型コードを生成できます。 この種類のデータ ソースは次のようになります。

- ある種のデータベースに関連付けられている Entity Framework モデル内のクラス。

- 何らかのデータベースに関連付けられているデータセット。

- Windows 通信基盤 (WCF) データ サービスや REST サービスなどのネットワーク サービスを表すクラス。

- SharePoint サービスを表すクラス。

- ソリューション内のクラスまたはコレクション。

> [!NOTE]
> データ バインディング機能、データセット、エンティティ フレームワーク、LINQ to SQL、WCF、または SharePoint を使用していない場合は、「データ ソース」の概念は適用されません。 SQLCommand オブジェクトを使用してデータベースに直接接続し、データベースと直接通信するだけです。

データ ソースを作成および編集するには、Windows フォームまたは Windows プレゼンテーション基盤アプリケーションの**データ ソース構成ウィザード**を使用します。 Entity Framework では、最初にエンティティ クラスを作成し、プロジェクト**の新しいデータ ソースの追加**(この記事で後述する詳細)**を選択** > してウィザードを開始します。

![データ ソース構成ウィザード](../data-tools/media/data-source-configuration-wizard.png)

## <a name="data-sources-window"></a>[データ ソース] ウィンドウ

データ ソースを作成すると、[**データ ソース**] ツール ウィンドウに表示されます。

> [!TIP]
> [データ**ソース**] ウィンドウを開くには、プロジェクトが開いているかどうかを確認**し、Shift**+**Alt**+**D**キーを押すか、[**他の Windows** > データ**ソース**の**表示]** > を選択します。

データ ソースは、[**データ ソース**] ウィンドウからフォーム デザインサーフェイスまたはコントロールにドラッグできます。 これにより、データ ストアのデータを表示する定型コードが生成されます。

次の図は、Windows フォームにドロップされたデータセットを示しています。 アプリケーションで**F5 を**選択すると、基になるデータベースのデータがフォームのコントロールに表示されます。

![データ ソースのドラッグ操作](../data-tools/media/raddata-data-source-drag-operation.png)

## <a name="data-source-for-a-database-or-a-database-file"></a>データベースまたはデータベース ファイルのデータ ソース

データベースまたはデータベース ファイルのデータ ソースとして使用するデータセットまたは Entity Framework モデルを作成できます。

### <a name="dataset"></a>データセット

データセットをデータ ソースとして作成するには、[**プロジェクト** > の**新しいデータ**ソースの追加] を選択して**データ ソース構成ウィザード**を実行します。 **データベース**データ ソースの種類を選択し、プロンプトに従って、新規または既存のデータベース接続またはデータベース ファイルを指定します。

### <a name="entity-classes"></a>エンティティ クラス

データ ソースとしてエンティティ フレームワーク モデルを作成するには

1. エンティティ**データ モデル ウィザード**を実行して、エンティティ クラスを作成します。 [**プロジェクト追加** > **新しい項目** > **ADO.NET エンティティ データ モデル**] を選択します。

   ![新しいエンティティ フレームワーク モデル プロジェクト項目](../data-tools/media/raddata-new-entity-framework-model-project-item.png)

1. モデルを生成する方法を選択します。

   ![エンティティ データ モデル ウィザード](../data-tools/media/raddata-entity-data-model-wizard.png)

1. モデルをデータ ソースとして追加します。 生成されたクラスは、[**オブジェクト**] カテゴリを選択すると **、データ ソース構成ウィザード**に表示されます。

   ![エンティティ クラスを使用したデータ ソース構成ウィザード](../data-tools/media/raddata-data-source-configuration-wizard-with-entity-classes.png)

## <a name="data-source-for-a-service"></a>サービスのデータ ソース

サービスからデータ ソースを作成するには、データ**ソース構成ウィザード**を実行し、**サービス**データ ソースの種類を選択します。 これは [**サービス参照の追加**] ダイアログ ボックスへのショートカットにすぎず、**ソリューション エクスプローラ**でプロジェクトを右クリックし、[**サービス参照の追加]** を選択してアクセスすることもできます。

サービスからデータ ソースを作成すると、Visual Studio によりサービス参照がプロジェクトに追加されます。 Visual Studio では、サービスが返すオブジェクトに対応するプロキシ オブジェクトも作成されます。 たとえば、データセットを返すサービスは、プロジェクト内でデータセットとして表現され、特定の型を返すサービスは、プロジェクト内で、返される型として表現されます。

次の種類のサービスからデータ ソースを作成できます。

- [WCF データ サービス](/dotnet/framework/data/wcf/wcf-data-services-overview)

- [WCF サービス](../data-tools/windows-communication-foundation-services-and-wcf-data-services-in-visual-studio.md)

- [Web サービス]

    > [!NOTE]
    > [**データ ソース**] ウィンドウに表示される項目は、サービスが返すデータによって異なります。 サービスによっては、**データ ソース構成ウィザード**でバインドできるオブジェクトを作成するための十分な情報を提供しないものもあります。 たとえば、サービスが型指定されていないデータセットを返す場合、ウィザードを完了しても [**データ ソース**] ウィンドウに項目は表示されません。 これは、型指定されていないデータセットからはスキーマが提供されず、したがってウィザードでデータ ソースを作成するための十分な情報が得られないためです。

## <a name="data-source-for-an-object"></a>オブジェクトのデータ ソース

1 つ以上のパブリック プロパティを公開する任意のオブジェクトからデータ ソースを作成できます。それには、**データ ソース構成ウィザード**を実行し、データ ソースの種類として **[オブジェクト]** を選択します。 オブジェクトのすべてのパブリック プロパティは、**[データ ソース]** ウィンドウに表示されます。 Entity Framework を使用していて、モデルを生成している場合は、アプリケーションのデータ ソースであるエンティティ クラスを見つけます。

[**データ オブジェクトの選択]** ページで、ツリー ビューのノードを展開して、バインドするオブジェクトを見つけます。 ツリー ビューには、プロジェクト、およびプロジェクトによって参照されるアセンブリやその他のプロジェクトのノードが含まれます。

ツリー ビューに表示されないアセンブリまたはプロジェクト内のオブジェクトにバインドする場合は、[**参照の追加**] をクリックし、[参照の**追加] ダイアログ ボックス**を使用して、アセンブリまたはプロジェクトへの参照を追加します。 参照を追加すると、アセンブリまたはプロジェクトがツリー ビューに追加されます。

> [!NOTE]
> オブジェクトがツリー ビューに表示される前に、オブジェクトを含むプロジェクトをビルドする必要がある場合があります。

> [!NOTE]
> ドラッグ アンド ドロップ データ バインディングをサポートするには、<xref:System.ComponentModel.ITypedList>または<xref:System.ComponentModel.IListSource>インターフェイスを実装するオブジェクトに既定のコンストラクターが必要です。 それ以外の場合、Visual Studio はデータ ソース オブジェクトをインスタンス化できず、項目をデザイン サーフェイスにドラッグするとエラーが表示されます。

## <a name="data-source-for-a-sharepoint-list"></a>リストのデータ ソース

**データ ソース構成ウィザード**を実行し、データ ソースの種類として **[SharePoint]** を選択すると、SharePoint リストからデータ ソースを作成できます。 SharePoint は WCF データ サービスを使用してデータを公開するため、SharePoint データ ソースの作成は、サービスからデータ ソースを作成するのと同じです。 **データ ソース構成ウィザード**で **[SharePoint]** 項目をクリックすると、**[サービス参照の追加]** ダイアログ ボックスが表示されます。このダイアログ ボックスで、SharePoint サーバーを指定することにより SharePoint データ サービスに接続します。 これには、SharePoint SDK が必要です。

## <a name="see-also"></a>関連項目

- [.NET 用の Visual Studio データ ツール](../data-tools/visual-studio-data-tools-for-dotnet.md)
