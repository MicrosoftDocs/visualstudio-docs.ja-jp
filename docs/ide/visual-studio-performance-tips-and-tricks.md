---
title: "Visual Studio のパフォーマンスのヒントとテクニック | Microsoft Docs"
ms.date: 08/07/2017
ms.reviewer: 
ms.suite: 
ms.technology:
- vs-ide-general
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- debugger
ms.assetid: 2fbcb59e-e981-4b40-8b7a-c1140d31ec4b
caps.latest.revision: 1
author: mikejo5000
ms.author: mikejo
manager: ghogen
translation.priority.ht:
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- ru-ru
- zh-cn
- zh-tw
translation.priority.mt:
- cs-cz
- pl-pl
- pt-br
- tr-tr
ms.translationtype: HT
ms.sourcegitcommit: fe6d864baf518cba882cea8e985fdacbfdf5b8b2
ms.openlocfilehash: 53c31da02b643114d9b152a0cde180ff5f6a5b7e
ms.contentlocale: ja-jp
ms.lasthandoff: 08/09/2017

---
# <a name="visual-studio-performance-tips-and-tricks"></a>Visual Studio のパフォーマンスのヒントとテクニック

Visual Studio のパフォーマンスの推奨事項は、まれなケースで発生する可能性があるメモリ不足の状況を想定したものです。 これらの状況では、使っていない可能性がある特定の Visual Studio の機能を最適化できます。 以下のヒントは一般的な推奨事項を意図したものではありません。

> [!NOTE]
> メモリの問題で製品の使用が困難な場合は、フィードバック ツールを使ってお知らせください。

## <a name="optimize-your-environment"></a>環境を最適化する

- **64 ビット OS を使う**

    システムを Windows の 32 ビット版から 64 ビット版にアップグレードすると、Visual Studio が使用できる仮想メモリの量が 2 GB から 4 GB に増えます。 これにより、Visual Studio は 32 ビット プロセスですが非常に大きいワークロードを処理できるようになります。

    詳しくは、「[Memory limits](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366778(v=vs.85).aspx#memory_limits)」(メモリの制限) および「[Using /LARGEADDRESSAWARE on 64-bit Windows](https://blogs.msdn.microsoft.com/oldnewthing/20050601-24/?p=35483/)」(64 ビット Windows での /LARGEADDRESSAWARE の使用) をご覧ください。

## <a name="configure-solution-and-projects"></a>ソリューションとプロジェクトを構成する

多くのプロジェクトを含む非常に大きいソリューションがある場合、次の最適化を行うと効果がある可能性があります。

- **ライトウェイト ソリューション ロードを有効にする**

    **ライトウェイト ソリューション ロード**を使うと、ソリューション内の一部のプロジェクトの読み込みが後回しにされるため、メモリおよび CPU のパフォーマンスが向上する場合があります。 この機能はソリューションごとに有効にすることもできます。 このオプションの既定値はオフです。

    **ライトウェイト ソリューション ロード**を有効にするには、**[ツール] > [オプション] > [プロジェクトおよびソリューション] > [ライトウェイト ソリューション ロード]** の順に選びます。

    このモードでは一部の IDE 機能を使うことができません。 この選択が役立つかどうかを判断するには、「[Shorter solution load time](https://blogs.msdn.microsoft.com/visualstudio/2016/10/11/shorter-solution-load-time-in-visual-studio-15/)」(ソリューションの読み込み時間の短縮) および「[Visual Studio の起動時間の最適化](https://docs.microsoft.com/en-us/visualstudio/ide/optimize-visual-studio-startup-time#speed-up-solution-load)」をご覧ください。

- **プロジェクトをアンロードする**

    ソリューション エクスプローラーの右クリック コンテキスト メニューを使って、使用頻度の低いプロジェクトを個別に手動でアンロードできます。

- **ソリューションをリファクタリングする**

    1 つのソリューションを、よく使われるプロジェクトを含む複数の小さいソリューション ファイルに分割できます。 このリファクタリングを行うと、ワークフローのメモリ使用量が大幅に減ります。 また、ソリューションが小さいほど読み込みも速くなります。

## <a name="configure-debugging-options"></a>デバッグ オプションを構成する
一般にデバッグ セッション中は少ないメモリで実行している場合は、1 つまたは複数の構成を変更することでパフォーマンスを最適化できます。

- **マイ コードのみを有効にする**

    最も簡単な最適化は、**マイ コードのみ**機能を有効にすることです。この機能は、ユーザーのプロジェクトのシンボルのみを読み込みます。 この機能を有効にすると、マネージ アプリケーション (.NET) のデバッグ用に大量のメモリを節約できます。 一部のプロジェクトの種類では、このオプションは既定で既に有効になっています。

    **マイ コードのみ**を有効にするには、**[ツール] > [オプション] > [デバッグ] > [全般]** の順に選び、**[マイ コードのみを有効にする]** をオンにします。

- **読み込むシンボルを指定する**

    ネイティブ デバッグでは、シンボル ファイル (.pdb) の読み込みには多くのメモリ リソースが必要です。 デバッガーのシンボル設定を構成することで、メモリを節約できます。 通常は、ユーザーのプロジェクトからのみモジュールを読み込むようにソリューションを構成します。

    シンボルの読み込みを指定するには、**[ツール] > [オプション] > [デバッグ] > [シンボル]** の順に選びます。

    オプションを **[すべてのモジュール]** ではなく **[指定したモジュールのみ]** に設定した後、読み込むモジュールを指定します。 デバッグ中に、**[モジュール]** ウィンドウで特定のモジュールを右クリックして、シンボルの読み込みにモジュールを明示的に含めることもできます  (デバッグ中にウィンドウを開くには、**[デバッグ] > [Windows] > [モジュール]** の順に選びます)。

    詳しくは、「[Understanding symbol files and Visual Studio’s symbol settings](https://blogs.msdn.microsoft.com/visualstudioalm/2015/01/05/understanding-symbol-files-and-visual-studios-symbol-settings/)」(シンボル ファイルおよび Visual Studio のシンボルの設定について) をご覧ください。

- **診断ツールを無効にする**

    CPU プロファイルを使い終わったら無効にすることをお勧めします。 この機能は大量のリソースを使う場合があります。 CPU プロファイルを有効にすると、後続のデバッグ セッションを通してその状態が維持されるので、終了したら明示的にオフにする必要があります。 診断ツールで提供される機能が必要ない場合は、デバッグ中に診断ツールを無効にすることで、リソースを節約できる場合があります。

    診断ツールを無効にするには、デバッグ セッションを開始し、**[ツール] > [オプション] > [デバッグ中に診断ツールを有効にする]** の順に選んで、オプションを無効にします。

    詳しくは、「[Visual Studio のプロファイリング機能ツアー](https://docs.microsoft.com/en-us/visualstudio/profiling/profiling-tools)」をご覧ください。

## <a name="disable-tools-and-extensions"></a>ツールと拡張機能を無効にする
一部のツールや拡張機能を無効にすると、パフォーマンスが向上することがあります。

> [!TIP]
> 多くの場合、一度に 1 つの拡張機能を無効にしてパフォーマンスを再確認することで、パフォーマンスの問題を分離できます。

### <a name="managed-language-services-roslyn"></a>マネージ言語サービス (Roslyn)

Roslyn のパフォーマンスに関する考慮事項については、「[Performance considerations for large solutions](https://github.com/dotnet/roslyn/wiki/Performance-considerations-for-large-solutions)」(大きいソリューションでのパフォーマンスの考慮事項) をご覧ください。

- **完全なソリューション分析を無効にする**

    Visual Studio は、ビルドを呼び出す前にエラーに関する豊富なエクスペリエンスを提供するため、ソリューション全体に対して分析を実行します。 この機能は、可能な限り早くエラーを特定するのに役立ちます。 ただし、非常に大きいソリューションでは、この機能は大量のメモリ リソースを消費する場合があります。 メモリの不足状況や同様の問題が発生している場合は、このエクスペリエンスを無効にしてこれらのリソースを解放できます。 このオプションは、既定では、Visual Basic に対しては有効になり、C# に対しては無効になります。

    **完全なソリューション分析**を無効にするには、**[ツール] > [オプション] > [テキスト エディター] > [Visual Basic] または [C#]** の順に選びます。 **[詳細]** を選び、**[完全ソリューション解析を有効にする]** をオフにします。

- **CodeLens を無効にする**

    Visual Studio は、表示される各メソッドに対して**すべての参照を検索**タスクを実行します。 CodeLens は、参照数のインライン表示などの機能を提供します。 処理は別のプロセス (たとえば、ServiceHub.RoslynCodeAnalysisService32) で実行されます。 非常に大きなソリューションまたはリソースに制約があるシステムでは、この機能は、低い優先順位で実行してもパフォーマンスに大きく影響する可能性があります。 このプロセスの CPU 使用率が高い場合、またはメモリの問題が発生する場合は (たとえば、4 GB のコンピューターで大規模なソリューションを読み込むとき)、この機能を無効にしてリソースを解放できます。

    CodeLens を無効にするには、**[ツール] > [オプション] > [テキスト エディター] > [すべての言語] > [CodeLens]** の順に選んで、この機能をオフにします。

    この機能は、Visual Studio Professional と Visual Studio Enterprise で使用できます。

### <a name="other-tools-and-extensions"></a>他のツールと拡張機能

- **拡張機能を無効にする**

    拡張機能は Visual Studio に追加された追加ソフトウェア コンポーネントであり、新しい機能を提供したり、既存の機能を拡張したりします。 拡張機能がメモリ リソースの問題の原因になることがよくあります。 メモリ リソースの問題が発生する場合は、一度に 1 つの拡張機能を無効にして、シナリオまたはワークフローに与える影響を確認します。

    拡張機能を無効にするには、**[ツール] > [拡張機能と更新プログラム]** の順に選び、特定の拡張機能を無効にします。

- **XAML デザイナーを無効にする**

    XAML デザイナーは既定で有効にされますが、XAML ファイルを開いた場合にのみリソースを消費します。 XAML ファイルを使う場合でも、デザイナー機能が必要ないときは、この機能を無効にして、若干のメモリを解放できます。

    XAML デザイナーを無効にするには、**[ツール] > [オプション] > [XAML デザイナー] > [XAML デザイナーを有効にする]** の順に選んで、オプションをオフにします。

- **ワークロードを削除する**

    Visual Studio インストーラーを使って、使われなくなったワークロードを削除できます。 このようにすると、不要になったパッケージとアセンブリをスキップして、起動時および実行時のコストを合理化できます。

## <a name="force-a-garbage-collection"></a>ガベージ コレクションを強制する

CLR では、ガベージ コレクションのメモリ管理システムが使われます。 このシステムでは、不要になったオブジェクトによってメモリが使われることがあります。 この状態は一時的なものです。ガベージ コレクターは、そのパフォーマンスとリソース使用のヒューリスティックに基づいて、このメモリを解放します。 Visual Studio のホット キーを使って、CLR に未使用のメモリを強制的に回収させることができます。 膨大な量のガベージが収集を待っている場合に、ガベージ コレクションを強制すると、devenv.exe プロセスのメモリ使用量の低下をタスク マネージャーで確認できます。 この方法を使う必要はほとんどありません。 ただし、コストのかかる操作 (フル ビルド、デバッグ セッション、ソリューション オープン イベントなど) が完了した後は、プロセスによって実際に使われていたメモリの量を確認するのに役立ちます。 Visual Studio にはマネージとネイティブが混在しているので、ネイティブ アロケーターとガベージ コレクターの間での限られたメモリ リソースの競合が発生する可能性があります。 大量のメモリが使われている状況では、ガベージ コレクターを強制的に実行すると役に立つことがあります。

ガベージ コレクションを強制的に行うには、ホット キー **Ctrl + Alt + Shift + F12**、**Ctrl + Alt + Shift + F12** (2 回押します) を使います。

ベージ コレクションを強制するとシナリオが確実に動くようになる場合、この動作はバグである可能性があるので、Visual Studio のフィードバック ツールを使ってレポートを提出してください。

CLR ガベージ コレクターについて詳しくは、「[Fundamental of Garbage Collection](https://msdn.microsoft.com/en-us/library/ee787088(v=vs.110).aspx)」(ガベージ コレクションの基礎) をご覧ください。

## <a name="see-also"></a>関連項目  
 [Visual Studio IDE](../ide/index.md)

