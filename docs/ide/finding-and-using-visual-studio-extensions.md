---
title: "Visual Studio 拡張機能の検索と使用 | Microsoft Docs"
ms.custom: 
ms.date: 06/07/2017
ms.reviewer: 
ms.suite: 
ms.technology: vs-ide-general
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords: vs.ExtensionManager
helpviewer_keywords:
- install extensions
- install packages
- managing extensions visual studio
ms.assetid: 4ca92d93-31b9-47ef-8109-4a429d9e2ca3
caps.latest.revision: "42"
author: gewarren
ms.author: gewarren
manager: ghogen
ms.workload: multiple
ms.openlocfilehash: 6ed49a18c7497eefc21a7fe7bfe9d35003863a5e
ms.sourcegitcommit: 32f1a690fc445f9586d53698fc82c7debd784eeb
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/22/2017
---
# <a name="find-and-use-visual-studio-extensions"></a>Visual Studio 拡張機能の検索と使用

Visual Studio 拡張機能は、Visual Studio 内で実行されるコード パッケージで、Visual Studio の機能が追加または強化されます。 Visual Studio の拡張機能について詳しくは「 [Visual Studio SDK](../extensibility/visual-studio-sdk.md)」をご覧ください。

**[拡張機能と更新プログラム]** ダイアログ ボックスを使用すると、Visual Studio の拡張機能やサンプルを Web サイトまたは他の場所から入手してインストールし、これらを有効化、無効化、更新、またはアンインストールすることができます。 **[ツール] / [拡張機能と更新プログラム]**を使用するか、 **[クイック起動]** ウィンドウに「 **拡張機能** 」と入力してください。 ダイアログ ボックスには、インストールされているサンプルと拡張機能の更新プログラムも表示されます。 また、Web サイトから拡張機能をダウンロードしたり、他の開発者から入手したりすることもできます。

> [!NOTE]
> Visual Studio 2015 以降では、Visual Studio Marketplace でホストされている拡張機能が自動的に更新されます。  この設定は、 **[拡張機能と更新プログラム]** ダイアログを使用して変更できます。  詳細については、後述の「 **拡張機能の自動更新** 」を参照してください。

## <a name="finding-visual-studio-extensions"></a>Visual Studio 拡張機能の検索

拡張機能は [Visual Studio Marketplace](https://marketplace.visualstudio.com/vs) からインストールできます。 拡張機能とは、Visual Studio に機能を追加するためのコントロール、サンプル、テンプレート、ツール、またはその他のコンポーネントです。 Visual Studio では、VSIX パッケージ形式の拡張機能がサポートされています。これには、プロジェクト テンプレート、項目テンプレート、 **ツールボックス** 項目、Managed Extension Framework (MEF) コンポーネント、VSPackages が含まれます。 MSI ベースの拡張機能をダウンロードしてインストールすることもできますが、 **[拡張機能と更新プログラム]** ダイアログ ボックスでこれらを有効化または無効化することはできません。 Visual Studio Marketplace には、VSIX および MSI の両方の拡張機能が含まれています。

## <a name="installing-or-uninstalling-visual-studio-extensions"></a>Visual Studio 拡張機能のインストールまたはアンインストール

**[拡張機能と更新プログラム]**から、インストールする拡張機能を見つけます。 (拡張機能の名前か名前の一部がわかっている場合は、**[検索]** ウィンドウで検索できます。)**[ダウンロード]** をクリックします。  拡張機能がインストール対象としてスケジュールされます。 拡張機能は Visual Studio のすべてのインスタンスが閉じられた後にインストールされます。

依存関係がある拡張機能のインストールを試みると、依存関係の対象が既にインストールされているかどうかがインストーラーで検証されます。 インストールされていない場合は、拡張機能のインストール前にインストールする必要がある依存関係の一覧が、 **[拡張機能と更新プログラム]** ダイアログ ボックスに示されます。

拡張機能の使用を停止するには、その拡張機能を無効化またはアンインストールします。 拡張機能を無効にした場合、その拡張機能はインストールされたままですが、アンロードされます。 無効にすることができるのは、VSIX 拡張機能のみです。MSI を使用してインストールした拡張機能は、アンインストールすることのみできます。 拡張機能を見つけて、 **[アンインストール]** または **[無効にする]**をクリックします。 無効にした拡張機能をアンロードするために Visual Studio を再起動する必要があります。

## <a name="per-user-and-administrative-extensions"></a>ユーザー単位の拡張機能と管理者用拡張機能

ほとんどの拡張機能はユーザー単位の拡張機能であり、**%LocalAppData%\Microsoft\VisualStudio\\<Visual Studio version\>\Extensions\\** フォルダーにインストールされます。 一部の拡張機能は管理者用拡張機能であり、**\<Visual Studio installation folder>\Common7\IDE\Extensions\\** フォルダーにインストールされます。

エラーや悪意のあるコードを含む可能性がある拡張機能からシステムを保護するために、通常ユーザーのアクセス許可で Visual Studio が実行されている場合にのみユーザー単位の拡張機能を読み込むように制限できます。 そうすれば、管理ユーザーのアクセス許可で Visual Studio を実行している場合には、ユーザー単位の拡張機能が無効にされます。 これを行うには、 **[拡張機能と更新プログラム]** オプションのページで、**[ツール]、[オプション]**、 **[環境]**、 **[拡張機能と更新プログラム]**と移動するか、 **[クイック起動]** ウィンドウに「 **拡張機能** 」と入力します。 **[管理者として実行しているときにユーザーの拡張機能を読み込む]** チェック ボックスをオフにして、Visual Studio を再起動します。

## <a name="automatic-extension-updates"></a>拡張機能の自動更新

ユーザー単位の拡張機能は、Visual Studio Marketplace で新しいバージョンが使用可能になったときに、自動的に更新されます。  拡張機能の新しいバージョンが検出され、バックグラウンドでインストールされます。その後、Visual Studio の次回再起動時に、拡張機能の新しいバージョンが実行されます。

自動的に更新できるのは、ユーザー単位の拡張機能だけです。  すべてのユーザーに対してインストールされる管理拡張機能は更新されないため、**[拡張機能と更新プログラム]** ダイアログの **[更新プログラム]** ノードを使用して新しいバージョンを手動でインストールします。 どの拡張機能が自動的に更新されるかは、**[拡張機能と更新プログラム]** ダイアログの拡張機能の詳細ウィンドウで確認できます。

自動更新を無効にする場合は、すべての拡張機能または特定の拡張機能のみを対象としてこの機能を無効にできます。

- すべての拡張機能の自動更新を無効にするには、**[拡張機能と更新プログラム]** ダイアログ ボックスの **[拡張機能と更新プログラム設定の変更]** リンクをクリックし、**[拡張機能を自動的に更新する]**をオフにします。

- 特定の拡張機能の自動更新を無効にするには、**[拡張機能と更新プログラム]** ダイアログの右側にある拡張機能の詳細ウィンドウで、**[この拡張機能を自動的に更新する]** オプションをオフにします。

> [!NOTE]
> Visual Studio 2015 更新プログラム 2 より、ユーザー単位の拡張機能を自動更新するか、すべてのユーザー拡張機能を更新するか、両方を行うか (初期設定) 指定できます (**[ツール]、[オプション]、[環境]、[拡張機能と更新プログラム]**)。

## <a name="extension-crash-notifications"></a>拡張機能のクラッシュ通知

Visual Studio 2017 (バージョン 15.3 - プレビュー) では、前回のセッション中に拡張機能がクラッシュした可能性がある場合に通知されます。 Visual Studio がクラッシュすると、例外スタックが保存されます。 Visual Studio を次回起動したときに、リーフからベースの方向にスタックが調査されます Visual Studio で、フレームがインストール済みで有効な拡張機能の一部であるモジュールに属していると判断されると、次のようなメッセージが通知されます。

"A previous session terminated unexpectedly. Disabling extension 'extension_name' might help prevent similar issues." (前のセッションが予期せずに終了しました。拡張機能 '<拡張機能名>' を無効にすると、同様の問題を回避できる可能性があります。)

この通知は無視することができます。または、次のいずれかの操作を実行することもできます。

- **[Disable this extension]\(この拡張機能を無効にする\)** を選択します。 この拡張機能が無効になり、無効にする処理を反映するためにシステムの再起動が必要かどうかが通知されます。 必要に応じて、**[拡張機能と更新プログラム]** ダイアログ ボックスで拡張機能を再び有効にすることができます。

- **[Don’t show again for this extension]\(この拡張機能で今後このメッセージを表示しない\)** を選択します。 IDE でこの拡張機能に関連するクラッシュの通知は表示されなくなりますが、他の拡張機能に関連するクラッシュの通知は表示されます。

- **[詳細を表示]** を選択すると、既定のブラウザーにそのヘルプ トピックが表示されます。

- 通知の最後にある **[X]** ボタンを選択すると、通知は閉じられます。 今後のセッションで同じ拡張機能がクラッシュに関係した場合は、通知が再び表示されます。

> [!NOTE]
> クラッシュ通知は、拡張機能のモジュールのいずれかがクラッシュのためにスタックしていることを示しているだけです。 必ずしも、拡張機能自体がクラッシュの原因とは限りません。 拡張機能から Visual Studio の一部であるコードが呼び出され、そのコードがクラッシュの原因である可能性があります。 ただし、クラッシュにつながるシナリオが重要ではない場合でも、通知が有効な場合があります。 この場合、この拡張機能を無効にすると、生産性に影響を与えることなく、今後同じクラッシュが回避されます。

## <a name="sample-master-copies-and-working-copies"></a>マスター コピーと作業コピーのサンプル

オンライン サンプルをインストールすると、ソリューションは次の 2 つの場所に格納されます。

- 作業コピーは、 **[新しいプロジェクト]** ダイアログ ボックスで指定した場所に格納されます。

- これとは別に、マスター コピーがコンピューター上に格納されます。

**[拡張機能と更新プログラム]** ダイアログ ボックスを使用すると、次のサンプル関連タスクを実行できます。

- インストールしたサンプルのマスター コピーを一覧表示する。

- サンプルのマスター コピーを無効化またはアンインストールする。

- 特定のテクノロジまたは機能に関連するサンプルのコレクションであるサンプル パックをインストールする。

- 個々のオンライン サンプルをインストールする (この操作は、 **[新しいプロジェクト]** ダイアログ ボックスでも実行できます)。

- インストール済みサンプルのソース コード変更が発行されたときに更新通知を表示する。

- 更新通知があったときにインストール済みサンプルのマスター コピーを更新する。

## <a name="installing-without-using-the-extensions-and-updates-dialog-box"></a>[拡張機能と更新プログラム] ダイアログ ボックスを使用しないインストール操作

.vsix ファイルにパッケージ化された拡張機能が、Visual Studio Marketplace 以外の場所から取得できる場合があります。 **[拡張機能と更新プログラム]** ダイアログ ボックスでは、これらのファイルを検出できませんが、.vsix ファイルをインストールすることはできます。これには、.vsix ファイルをダブルクリックするか、ファイルを選択して Enter キーを押します。 その後、指示に従って操作します。 拡張機能がインストールされたら、 **[拡張機能と更新プログラム]** ダイアログ ボックスを使用して、拡張機能を有効化、無効化、またはアンインストールできます。

## <a name="extension-types-not-supported-by-the-extensions-and-updates-dialog-box"></a>[拡張機能と更新プログラム] ダイアログ ボックスでサポートされない種類の拡張機能

Visual Studio は Microsoft インストーラー (MSI) でインストールされる拡張機能を引き続きサポートしますが、 **[拡張機能と更新プログラム]** ダイアログ ボックスは修正がないとサポートされません。

> [!TIP]
> MSI ベースの拡張機能に extension.vsixmanifest ファイルが含まれている場合は、 **[拡張機能と更新プログラム]** ダイアログ ボックスに拡張機能が表示されます。
