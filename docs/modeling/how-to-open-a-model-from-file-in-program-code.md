---
title: "方法: プログラム コード内のファイルからモデルを開く | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
ms.assetid: d7d68697-5418-4263-bdb2-48401924ea71
caps.latest.revision: 8
author: "alancameronwills"
ms.author: "awills"
manager: "douge"
caps.handback.revision: 8
---
# 方法: プログラム コード内のファイルからモデルを開く
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

アプリケーションの DSL モデルを開くことができます。  
  
 [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] の拡張子 \(ModelBus をこの目的で使用できます。  ModelBus はモデルでの要素を参照するとモデルを検索するに移動する標準的な機能を提供します。  詳細については、「[Visual Studio Modelbus を使用して、モデルの統合](../modeling/integrating-models-by-using-visual-studio-modelbus.md)」を参照してください。  
  
## \[対象とする Framework\]  
 **.NET Framework 4** にアプリケーション プロジェクトの  **対象のフレームワーク**  を設定します。  
  
#### ターゲット フレームワークを設定するには  
  
1.  DSL モデルを読み込みするアプリケーションの [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] プロジェクトを開きます。  
  
2.  **ソリューション エクスプローラー**で、プロジェクトを右クリックし、**\[プロパティ\]** をクリックします。  
  
3.  プロジェクトのプロパティ\] ウィンドウで\[入力\] ENT4ENT タブで**.NET Framework 4** に ENT5ENT \[入力\] フィールドを設定します。  
  
> [!NOTE]
>  プロジェクトの作成\] ダイアログ ボックスで \[\] を選択します ENT2ENT これが必要になる場合があります。  ターゲット フレームワークは **.NET Framework 4 Client Profile** 必要があります。  
  
## References  
 [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] アプリケーション プロジェクトに参照を追加する必要があります :  
  
-   `Microsoft.VisualStudio.Modeling.Sdk.11.0`  
  
    -   追加の \[.NET**\] タブにあるのこれは**ダイアログ ボックスの参照**はない場合** `%Program Files% \ Microsoft Visual Studio 2010 SDK \ VisualStudioIntegration \ Common \` Assemblies \\ クリックします。 \[参照\] タブを移動および  
  
-   Bin フォルダーの下に DSL のプロジェクトを探します DSL のアセンブリ。  この名前は通常です : フォーム *YourCompany*。*YourProject*`。Dsl.dll`。  
  
## DSL の重要なクラス  
 DSL を読み取るコードを記述する前にDSL によって生成されるクラスの名前を指定する必要があります。  DSL のソリューションでは**\*\*\* Dsl \*\*\*** でプロジェクトを開き\[入力\] フォルダー ENT6ENT " を参照してください。  またプロジェクト  **参照設定**  の DSL のアセンブリをクリックしダブル  **オブジェクト ブラウザー**  の DSL の名前空間を開きます。  
  
 これらは特定する必要のあるクラスです :  
  
-   \-*YourDslRootClass* これは `DslDefinition.dsl` のルート クラスの名前です。  
  
-   *YourDslName* `SerializationHelper` \- このクラスはDSL のプロジェクトの `SerializationHelper.cs` で定義されます。  
  
-   *YourDslName*  `ドメイン モデル`  \- このクラスはDSL のプロジェクトの `DomainModel.cs` で定義されます。  
  
## ファイルからの読み取り  
 次の例では次のような重要なクラスを持つ DSL を読み込むように設計されています :  
  
-   FamilyTreeModel  
  
-   FamilyTreeSerializationHelper  
  
-   FamilyTreeDomainModel  
  
 この DSL の他のドメインはクラスです。  
  
```  
using System;  
using Microsoft.VisualStudio.Modeling;  
using Company.FamilyTree; // Your DSL namespace  
  
namespace StandaloneReadDslConsole  
{ class Program  
  { static void Main(string[] args)  
    {  
      // The path of a DSL model file:  
      string dslModel = @"C:\FamilyTrees\Tudor.ftree";  
      // Set up the Store to read your type of model:  
      Store store = new Store(  
        typeof(Company.FamilyTree.FamilyTreeDomainModel));  
      // The Model type generated by the DSL:  
      FamilyTreeModel familyTree;  
      // All Store changes must be in a Transaction:  
      using (Transaction t =   
        store.TransactionManager.BeginTransaction("Load model"))  
      {  
        familyTree =   
           FamilyTreeSerializationHelper.Instance.  
              LoadModel(store, dslModel, null, null, null);  
        t.Commit(); // Don't forget this!  
      }  
      // Now we can read the model:  
      foreach (Person p in familyTree.People)  
      {  
        Console.WriteLine(p.Name);   
        foreach (Person child in p.Children)  
        {  
          Console.WriteLine("    " + child.Name);  
        }  
} } } }  
```  
  
## ファイルへの保存  
 前のコードで次の追加をモデルに変更を加えファイルに保存します。  
  
```  
using (Transaction t =  
  store.TransactionManager.BeginTransaction("update model"))  
{  
  // Create a new model element:  
  Person p = new Person(store);  
  // Set its embedding relationship:  
  p.FamilyTreeModel = familyTree;  
  // - same as: familyTree.People.Add(p);  
  // Set its properties:  
  p.Name = "Edward VI";  
  t.Commit(); // Don't forget this!  
}  
// Save the model:  
try  
{  
  SerializationResult result = new SerializationResult();  
  FamilyTreeSerializationHelper.Instance  
    .SaveModel(result, familyTree, @"C:\FamilyTrees\Tudor-upd.ftree");  
  // Report any error:  
  if (result.Failed)  
  {  
    foreach (SerializationMessage message in result)  
    {  
      Console.WriteLine(message);  
    }  
  }  
}  
catch (System.IO.IOException ex)  
{ ... }  
```