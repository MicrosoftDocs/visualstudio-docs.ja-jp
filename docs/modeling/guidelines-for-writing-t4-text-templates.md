---
title: "T4 テキスト テンプレートの記述に関するガイドライン |Microsoft ドキュメント"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 04dd3fc4-10e8-488a-bdea-4d615f50f063
caps.latest.revision: 9
author: alancameronwills
ms.author: awills
manager: douge
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: fd26c504273cae739ccbeef5e406891def732985
ms.openlocfilehash: 7d9dd7193455a625b0410eaca3b2bd243c109743
ms.lasthandoff: 02/22/2017

---
# <a name="guidelines-for-writing-t4-text-templates"></a>T4 テキスト テンプレートの記述に関するガイドライン
プログラム コードまたはその他のアプリケーション リソースで生成している場合に役立ちます。 これらの一般的なガイドラインがあります[!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]します。 これらが、ルールには修正していません。  
  
## <a name="guidelines-for-design-time-t4-templates"></a>デザイン時 T4 テンプレートのガイドライン  
 デザイン時 T4 テンプレートは、コードを生成するテンプレート、[!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]デザイン時にプロジェクトです。 詳細については、次を参照してください。 [T4 テキスト テンプレートを使用して、デザイン時コード生成](../modeling/design-time-code-generation-by-using-t4-text-templates.md)します。  
  
 アプリケーションの可変部分を生成します。  
 コードの生成が、プロジェクト中に変更することがありますか、アプリケーションの異なるバージョン間で変化するアプリケーションのこれらの側面に最も適しています。 生成する必要のあるものをより簡単に判別できるように、不変的な部分からこれらの変数の側面を分離します。 たとえば、アプリケーションでは、Web サイトを提供する場合は、関数&1; つのページからのナビゲーション パスを定義するロジックを提供している標準的なページを区切ります。  
  
 1 つまたは複数のソース モデル内の可変部分をエンコードします。  
 モデルは、ファイルまたはデータベースの各テンプレートが生成されるコードの変数部分に特定の値を取得するというです。 モデルには、データベース、デザイン、図、またはドメイン固有言語の XML ファイルを指定できます。 多くのファイルを生成する&1; つのモデルを使用する通常、[!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]プロジェクトです。 各ファイルは、別のテンプレートから生成されます。  
  
 プロジェクトでは、1 つ以上のモデルを使用できます。 たとえば、Web ページ、およびページのレイアウトの別のモデル間のナビゲーションのためのモデルを定義できます。  
  
 ユーザーのニーズとボキャブラリを実装ではなく、モデルの焦点を当てます。  
 たとえば、Web サイトのアプリケーションでは、Web ページおよびハイパーリンクを参照するモデルを想定します。  
  
 理想的には、モデルが表す情報の種類に適した表示形式を選択します。 たとえば、Web サイトを通じてナビゲーション パスのモデルでは、四角形や矢印のダイアグラム可能性があります。  
  
 生成されたコードをテストします。  
 必要のあるユーザーに生成されるコードが機能することを確認するのにには、手動または自動テストを使用します。 コードの生成元となる同じモデルからのテストが生成されないようにします。  
  
 場合によっては、一般的なテストはモデルに直接します。 たとえば、Web サイトの各ページに、他のナビゲーションによってアクセスできることを確認するテストを作成します。  
  
 カスタム コードの許可: 部分クラスを生成します。  
 作成したコードを手動でさらに、生成されたコードには、できます。 コード生成スキームを生じる可能性のあるすべてのバリエーションを考慮するではありません。 そのため、生成されたコードの一部を無効またはに追加するはずです。 ここで、生成された資料は「.NET 言語など[!INCLUDE[csprcs](../data-tools/includes/csprcs_md.md)]または[!INCLUDE[vbprvb](../code-quality/includes/vbprvb_md.md)]、2 つの方法は特に便利です。  
  
-   生成されたクラスを部分にする必要があります。 これにより、生成されたコードにコンテンツを追加します。  
  
-   クラスは、もう一方を継承する&1; つのペアで生成する必要があります。 基本クラスはすべて、生成されるメソッドとプロパティを含める必要があり、派生クラスがコンス トラクターのみを含める必要があります。 これにより、手動で記述したコード生成されたメソッドをオーバーライドします。  
  
 XML など生成された他の言語を使用して、`<#@include#>`ディレクティブを手動で作成し、生成されたコンテンツを単純に結合します。 複雑なケースで、生成されたファイルをすべて手動で記述したファイルを結合する後処理のステップを記述する必要があります。  
  
 一般的なマテリアルをインクルード ファイルまたは実行時テンプレートに移動します。  
 テキストおよび複数のテンプレートにコードのようなブロックを繰り返しを避けるためを使用して、`<#@ include #>`ディレクティブです。 詳細については、次を参照してください。 [T4 Include ディレクティブ](../modeling/t4-include-directive.md)します。  
  
 独立したプロジェクトの実行時テキスト テンプレートを作成して、デザイン時テンプレートからこれらを呼び出します。 これを行うを使用して、`<#@ assembly #>`ディレクティブで使用すると、別のプロジェクトにアクセスします。 例については、次を参照してください。 ["継承でテキスト テンプレート"Gareth Jones のブログで](http://go.microsoft.com/fwlink/?LinkId=208373)します。  
  
 コードの大きなブロックを移動し、別のアセンブリに検討してください。  
 クラス機能ブロックと大きなコード ブロックがある場合は場合、は、このコードの一部を別のプロジェクトをコンパイルするメソッドに移動する便利な場合があります。 使用することができます、`<#@ assembly #>`ディレクティブで使用すると、テンプレート内のコードにアクセスします。 詳細については、次を参照してください。 [T4 アセンブリ ディレクティブ](../modeling/t4-assembly-directive.md)します。  
  
 テンプレートを継承できる抽象クラスでメソッドを配置することができます。 抽象クラスは、 <xref:Microsoft.VisualStudio.TextTemplating.TextTransformation?displayProperty=fullName>。</xref:Microsoft.VisualStudio.TextTemplating.TextTransformation?displayProperty=fullName>から継承する必要があります。 詳細については、次を参照してください。 [T4 テンプレート ディレクティブ](../modeling/t4-template-directive.md)します。  
  
 構成ファイルではなく、コードを生成します。  
 変数アプリケーションの作成方法の&1; つでは、構成ファイルを受け取る汎用プログラム コードを記述します。 この方法で記述されたアプリケーションは、非常に柔軟なアプリケーションをリビルドすることがなく、ビジネス要件を変更するときに再構成することができます。 ただし、この方法の欠点は、アプリケーションが特定のアプリケーションよりも少ないウェルを実行します。 また、一部は、ほとんどのジェネリック型を処理する必要がある常に、そのプログラム コードはより読みにくくなり、保守、されます。  
  
 これに対し、コンパイル前に生成される可変部分がアプリケーションできる厳密に型指定します。 これにより、ソフトウェアのはるかに簡単で手動で記述したコードを記述し、自動的に生成された統合より信頼性の高い部分。  
  
 コード生成のすべてのメリットを取得するには、構成ファイルではなく、プログラム コードを生成してください。  
  
 生成されたコード フォルダーを使用します。  
 という名前のプロジェクト フォルダーにテンプレートと、生成されたファイルを配置**生成されたコード**ようにするには、直接編集することはファイルではないことをオフにします。 オーバーライドまたは生成されたクラスに追加するカスタム コードを作成する場合は、という名前のフォルダーにそれらのクラスを配置**カスタム コード**します。 一般的なプロジェクトの構造は、次のようになります。  
  
```  
MyProject  
   Custom Code  
      Class1.cs  
      Class2.cs  
   Generated Code  
      Class1.tt  
          Class1.cs  
      Class2.tt  
          Class2.cs  
   AnotherClass.cs  
  
```  
  
## <a name="guidelines-for-run-time-preprocessed-t4-templates"></a>実行時 (前処理された) T4 テンプレートのガイドライン  
 継承されたテンプレートに共通のマテリアルを移動します。  
 メソッドと T4 テキスト テンプレート間でのテキスト ブロックを共有するのにには、継承を使用します。 詳細については、次を参照してください。 [T4 テンプレート ディレクティブ](../modeling/t4-template-directive.md)します。  
  
 使用することも実行時のテンプレートを持つファイルが含まれています。  
  
 部分クラスに、大量のコードを移動します。  
 各実行時テンプレートには、テンプレートと同じ名前を持つ部分クラス定義が生成されます。 同じクラスの別の部分定義を含むコード ファイルを記述することができます。 この方法でクラスには、メソッド、フィールド、およびコンス トラクターを追加できます。 これらのメンバーは、テンプレート内のコード ブロックから呼び出すことができます。  
  
 この方法の利点は、IntelliSense は使用可能なため、コードは簡単に記述すると、ことです。 また、プレゼンテーションと基になるロジックの間の分離を強化を実現できます。  
  
 たとえば、 **MyReportText.tt**:  
  
 `The total is: <#= ComputeTotal() #>`  
  
 **MyReportText Methods.cs**:  
  
 `private string ComputeTotal() { ... }`  
  
 カスタム コードの許可: 拡張ポイントを提供します。  
 仮想メソッドの生成を検討\<#+ クラス機能ブロック #> します。 これにより、1 つのテンプレートを変更しなくてもさまざまなコンテキストで使用できます。 テンプレートを変更するには、代わりに、最小の追加のロジックを提供する派生クラスを作成できます。 派生クラスは、正規のどちらかのコードを指定できますか、実行時テンプレートができます。  
  
 たとえば、MyStandardRunTimeTemplate.tt: で  
  
```  
This page is copyright <#= CompanyName() #>.  
<#+ protected virtual string CompanyName() { return ""; } #>  
```  
  
 アプリケーションのコード。  
  
```  
class FabrikamTemplate : MyStandardRunTimeTemplate  
{  
  protected override string CompanyName() { return "Fabrikam"; }  
}  
...  
  string PageToDisplay = new FabrikamTemplate().TextTransform();  
  
```  
  
## <a name="guidelines-for-all-t4-templates"></a>すべての T4 テンプレートのガイドライン  
 テキストの生成からのデータ収集を分離します。  
 計算とテキスト ブロックの混在を回避しようとしてください。 各テキスト テンプレートに&1; つ目を使用して\<# コード ブロック #> 変数を設定し、複雑な計算を実行します。 テンプレートまたは&1; つ目の末尾までの最初のテキスト ブロックから\<#+ クラス機能ブロック #> 長い式を避けるため、およびテキスト ブロックがない限り、ループや条件を回避します。 この実習では、テンプレートが読みやすさと管理します。  
  
 使用しない`.tt`インクルード ファイル  
 別のファイル名拡張子を使用して`.ttinclude`インクルード ファイル。 使用`.tt`ファイル、実行時またはデザイン時テキスト テンプレートを処理するだけです。 場合によっては、[!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]認識`.tt`ファイルを自動的に処理するためには、そのプロパティを設定します。  
  
 固定のプロトタイプとして各テンプレートを開始します。  
 生成して、これが正しいことを確認するコードまたはテキストの例を記述します。 次の拡張子を .tt に変更し、モデルを読み取ることによって、コンテンツを変更するコードを徐々 に挿入します。  
  
 型指定されたモデルの使用を検討してください。  
 XML またはデータベース スキーマを作成するには、モデルの場合、ドメイン固有言語 (DSL) を作成すると便利場合があります。 DSL には、スキーマ、および属性を表すプロパティ内の各ノードを表すクラスが生成される利点があります。 これは、ビジネス モデルの観点からプログラミング可能なことを意味します。 例:  
  
```  
Team Members:  
<# foreach (Person p in team.Members)   
 { #>   
    <#= p.Name #>   
<# } #>  
```  
  
 モデルの場合、図の使用を検討してください。  
 多くのモデルが最も効果的に表示され、非常に大きなしている場合に特にテキスト テーブルの単なるとして管理されています。  
  
 ただし、一部の種類のビジネス要件、複雑なリレーションシップと、ワークフローのセットを明確にすることが重要と図が最も適しています中です。 図の利点は、ユーザーおよびその他の利害関係者の意見交換する簡単であります。 ビジネス要件のレベルでのモデルからコードを生成してする柔軟性を高める、コードの要件を変更するときにします。  
  
 ドメイン固有言語 (DSL) として、ダイアグラムの種類を設計することもできます。 コードは、UML および Dsl の両方から生成できます。 詳細については、次を参照してください。[データを分析するとアーキテクチャのモデリング](../modeling/analyze-and-model-your-architecture.md)します。  
  
## <a name="see-also"></a>関連項目  
 [T4 テキスト テンプレートを使用したデザイン時コード生成](../modeling/design-time-code-generation-by-using-t4-text-templates.md)   
 [T4 テキスト テンプレートを使用した実行時テキスト生成](../modeling/run-time-text-generation-with-t4-text-templates.md)

