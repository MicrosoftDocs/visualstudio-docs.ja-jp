---
title: T4 テキスト テンプレートの記述に関するガイドライン |Microsoft ドキュメント
ms.custom: ''
ms.date: 11/04/2016
ms.topic: conceptual
author: gewarren
ms.author: gewarren
manager: douge
ms.workload:
- multiple
ms.technology: vs-ide-modeling
ms.openlocfilehash: 4438bacd59eb0552521024de712b6d6989af8b19
ms.sourcegitcommit: 6a9d5bd75e50947659fd6c837111a6a547884e2a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/16/2018
---
# <a name="guidelines-for-writing-t4-text-templates"></a>T4 テキスト テンプレートの記述に関するガイドライン
これらの一般的なガイドラインは、プログラム コードまたはその他のアプリケーションのリソースを生成している場合に役立つ可能性があります[!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]です。 ルール問題を解決できません。  
  
## <a name="guidelines-for-design-time-t4-templates"></a>デザイン時 T4 テンプレートに関するガイドライン  
 デザイン時 T4 テンプレートでコードを生成するテンプレート、[!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]デザイン時にプロジェクト。 詳細については、次を参照してください。 [T4 テキスト テンプレートを使用して、デザイン時コード生成](../modeling/design-time-code-generation-by-using-t4-text-templates.md)です。  
  
 アプリケーションの変数の要素を生成します。  
 コードの生成は、プロジェクト中に変更する可能性がありますか、アプリケーションの異なるバージョン間で変化するアプリケーションの側面に最適です。 生成される必要のあるものをより簡単に判断できるように、不変的な部分からこれらの変数の側面を区切ります。 たとえば、アプリケーションでは、Web サイトを提供する場合は、ページ間のナビゲーション パスを定義するロジックから関数を提供している標準のページを区切ります。  
  
 1 つまたは複数のソース モデルに変動する部分をエンコードします。  
 モデルは、ファイルまたは各テンプレートを読み取りますが生成されたコードの可変部分についての特定の値を取得するデータベースです。 モデルには、データベース、デザイン、図、またはドメイン固有言語の XML ファイルを指定できます。 多くのファイルを生成する 1 つのモデルを使用する通常、[!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]プロジェクト。 各ファイルは、別のテンプレートから生成されます。  
  
 プロジェクトでは、複数のモデルを使用できます。 たとえば、Web ページ、およびページのレイアウトの別のモデル間のナビゲーションのためのモデルを定義する場合があります。  
  
 ユーザーのニーズやボキャブラリを実装ではなく、モデルの重点を置きます。  
 たとえば、Web サイトのアプリケーションでは、Web ページおよびハイパーリンクを参照するモデルを想像です。  
  
 理想的には、モデルを表す情報の種類に合ったプレゼンテーションの形式を選択します。 たとえば、Web サイトを通じてナビゲーション パスのモデルでは、四角形や矢印のダイアグラム可能性があります。  
  
 生成されたコードをテストします。  
 結果として得られるコードが必要のあるユーザーとして動作することを確認するのにには、手動または自動テストを使用します。 コードの生成元となる、同じモデルからのテストの生成を回避します。  
  
 場合によっては、一般的なテストに対して行える、モデル直接です。 たとえば、Web サイトのすべてのページからその他のナビゲーションからアクセスできることを保証するテストを記述できます。  
  
 カスタム コードを許可する: 部分クラスを生成します。  
 作成したコードを手動でさらに、生成されたコードには、できます。 コード生成スキームが生じる可能性のあるすべてのバリエーションを考慮できることはできません。 そのため、生成されたコードの一部を上書きまたは追加する表示されるはずです。 .NET 言語内で生成されたマテリアルをここではなど[!INCLUDE[csprcs](../data-tools/includes/csprcs_md.md)]または[!INCLUDE[vbprvb](../code-quality/includes/vbprvb_md.md)]、2 つの方法は特に便利です。  
  
-   生成されたクラスを部分にする必要があります。 これにより、生成されたコードにコンテンツを追加することができます。  
  
-   クラスは、継承、他の 1 つのペアで生成する必要があります。 基本クラスは、すべての生成メソッドとプロパティを含める必要があり、派生クラスでコンス トラクターのみを含める必要があります。 これにより、生成されたメソッドのオーバーライドを手動で記述したコード。  
  
 XML など生成された他の言語を使用して、`<#@include#>`ディレクティブを手動で作成し、生成されたコンテンツの単純な組み合わせです。 複雑な場合を生成されたファイルをすべて手動で記述したファイルを組み合わせた後処理のステップを記述する必要があります。  
  
 インクルード ファイルまたは実行時テンプレートに共通のマテリアルを移動します。  
 複数のテンプレートのテキストおよびコードのようなブロックの繰り返しを避けるためを使用して、`<#@ include #>`ディレクティブです。 詳細については、次を参照してください。 [T4 Include ディレクティブ](../modeling/t4-include-directive.md)です。  
  
 別のプロジェクトでの実行時テキスト テンプレートをビルドし、デザイン時テンプレートからこれらを呼び出すことができます。 これを行うを使用して、`<#@ assembly #>`ディレクティブを別のプロジェクトにアクセスします。 例については、次を参照してください。 ["継承でテキスト テンプレート"Gareth Jones のブログで](http://go.microsoft.com/fwlink/?LinkId=208373)です。  
  
 別のアセンブリに大量のコードの移動を検討してください。  
 大規模なコード ブロックおよびクラス機能ブロックがある場合は、このコードの一部を別のプロジェクトをコンパイルするメソッドに移動すると便利ですがあります。 使用することができます、`<#@ assembly #>`テンプレート内のコードにアクセスするディレクティブ。 詳細については、次を参照してください。 [T4 アセンブリ ディレクティブ](../modeling/t4-assembly-directive.md)です。  
  
 テンプレートが継承できる抽象クラスにメソッドを配置することができます。 抽象クラスを継承する必要があります<xref:Microsoft.VisualStudio.TextTemplating.TextTransformation?displayProperty=fullName>です。 詳細については、次を参照してください。 [T4 テンプレート ディレクティブ](../modeling/t4-template-directive.md)です。  
  
 構成ファイルではなく、コードを生成します。  
 変数のアプリケーションを作成する 1 つの方法では、構成ファイルを受け取る汎用プログラム コードを作成します。 この方法で記述されたアプリケーションは、非常に柔軟なビジネス要件を変更したら、アプリケーションを再構築しないでを再構成することができます。 ただし、この方法の欠点は、アプリケーションで特定のアプリケーションよりも適切に機能を実行することです。 またがある常にほとんどのジェネリック型を処理するために一部、プログラム コードは読み取りおよび、メンテナンスが難しくなります。  
  
 これに対し、コンパイル前に生成される可変部分がアプリケーションできる厳密に型指定します。 これにより、ソフトウェアのはるかに簡単で手動で記述したコードを記述し、自動的に生成された統合より信頼性の高い部分。  
  
 コード生成の完全な利点を取得するには、構成ファイルではなくプログラム コードを生成する再試行してください。  
  
 生成されたコード フォルダーを使用します。  
 という名前のプロジェクト フォルダーに、テンプレート、生成されたファイルを配置**生成されたコード**にするには、これらが直接編集するファイルではないことをオフにします。 上書きするか、生成されたクラスに追加するカスタム コードを作成する場合は、という名前のフォルダーにそれらのクラスを配置**カスタム コード**です。 一般的なプロジェクトの構造は、次のようになります。  
  
```  
MyProject  
   Custom Code  
      Class1.cs  
      Class2.cs  
   Generated Code  
      Class1.tt  
          Class1.cs  
      Class2.tt  
          Class2.cs  
   AnotherClass.cs  
  
```  
  
## <a name="guidelines-for-run-time-preprocessed-t4-templates"></a>実行時 (前処理された) T4 テンプレートに関するガイドライン  
 継承されたテンプレートに共通のマテリアルを移動します。  
 メソッドと T4 テキスト テンプレート間でのテキスト ブロックを共有するのに継承を使用することができます。 詳細については、次を参照してください。 [T4 テンプレート ディレクティブ](../modeling/t4-template-directive.md)です。  
  
 使用することもを実行時テンプレートを持つファイルが含まれます。  
  
 部分クラスに、大量のコードを移動します。  
 各実行時テンプレートは、テンプレートと同じ名前のある部分クラス定義を生成します。 同じクラスの別の部分定義を含むコード ファイルを記述することができます。 この方法でクラスには、メソッド、フィールド、およびコンス トラクターを追加できます。 これらのメンバーは、テンプレート内のコード ブロックから呼び出すことができます。  
  
 これの利点は、IntelliSense は使用可能なため、コードは、記述を簡単にします。 また、プレゼンテーションと基になるロジックの間の分離を強化しを実現できます。  
  
 たとえば、 **MyReportText.tt**:  
  
 `The total is: <#= ComputeTotal() #>`  
  
 **MyReportText Methods.cs**:  
  
 `private string ComputeTotal() { ... }`  
  
 カスタム コードを許可する: 拡張ポイントを提供します。  
 仮想メソッドの生成を検討\<#+ クラス機能ブロック #>。 これにより、変更しなくてもさまざまなコンテキストで使用する 1 つのテンプレートです。 テンプレートを変更するには、代わりに最小の追加のロジックを提供する派生クラスを構築できます。 派生クラスは、正規のどちらかのコードを指定できますも、実行時テンプレートできます。  
  
 たとえばで MyStandardRunTimeTemplate.tt:  
  
```  
This page is copyright <#= CompanyName() #>.  
<#+ protected virtual string CompanyName() { return ""; } #>  
```  
  
 アプリケーションのコード。  
  
```  
class FabrikamTemplate : MyStandardRunTimeTemplate  
{  
  protected override string CompanyName() { return "Fabrikam"; }  
}  
...  
  string PageToDisplay = new FabrikamTemplate().TextTransform();  
  
```  
  
## <a name="guidelines-for-all-t4-templates"></a>すべての T4 テンプレートに関するガイドライン  
 テキストの生成から別のデータ収集  
 計算とテキスト ブロックの混合を回避しようとしてください。 各テキスト テンプレートで 1 つを使用して\<# コード ブロック #> の変数を設定し、複雑な計算を実行します。 テンプレート、または最初の最後までの最初のテキスト ブロック\<#+ クラス機能ブロック #> 長い式を避けるため、およびテキスト ブロックがない限り、ループや条件を回避します。 この方法は、読み取りし、保守を簡単にテンプレートをによりします。  
  
 使用しない`.tt`インクルード ファイル  
 など、別のファイル名拡張子を使用して`.ttinclude`インクルード ファイル。 使用して`.tt`ファイルと実行時またはデザイン時テキスト テンプレートを処理するだけです。 場合によっては、[!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]認識`.tt`ファイルし、自動的に処理するためには、そのプロパティを設定します。  
  
 固定のプロトタイプとして各テンプレートを開始します。  
 生成して、これが正しいことを確認する、コードまたはテキストの例を記述します。 次にその拡張子を .tt に変更し、段階的モデルを読み取ることによって、コンテンツを変更するコードを挿入します。  
  
 型指定されたモデルの使用を検討してください。  
 XML またはデータベースのスキーマを作成するには、モデルの場合、ドメイン固有言語 (DSL) を作成すると便利ですがあります。 DSL には、スキーマ、および属性を表すプロパティ内の各ノードを表すクラスが生成される利点があります。 これは、ビジネス モデルの観点からプログラミング可能なことを意味します。 例えば:  
  
```  
Team Members:  
<# foreach (Person p in team.Members)   
 { #>   
    <#= p.Name #>   
<# } #>  
```  
  
 モデルのダイアグラムの使用方法を検討してください。  
 多くのモデルが最も効果的に表示されは非常に大きい場合に特にテキスト テーブル、単として管理されています。  
  
 ただし、一部の種類のビジネス要件、複雑なリレーションシップとワーク フローのセットを明確にすることが重要と図が最も適しています中。 ダイアグラムの利点であることに、ユーザーおよびその他の利害関係者に簡単です。 ビジネス要件のレベルでのモデルからコードを生成してする柔軟性を高める、コード、要件が変わったときにします。  
  
 ドメイン固有言語 (DSL) として、ダイアグラムの種類を設計することもできます。 コードは、UML および Dsl の両方から生成できます。 詳細については、次を参照してください。[分析およびモデリング アーキテクチャ](../modeling/analyze-and-model-your-architecture.md)です。  
  
## <a name="see-also"></a>関連項目  
 [T4 テキスト テンプレートを使用したデザイン時コード生成](../modeling/design-time-code-generation-by-using-t4-text-templates.md)   
 [T4 テキスト テンプレートを使用した実行時テキスト生成](../modeling/run-time-text-generation-with-t4-text-templates.md)
