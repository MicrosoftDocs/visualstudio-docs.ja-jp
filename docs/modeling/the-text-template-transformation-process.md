---
title: テキスト テンプレート変換プロセス
description: テキストテンプレート変換プロセスで入力としてテキストテンプレートファイルを取得し、出力として新しいテキストファイルを生成する方法について説明します。
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- text templates, transformation process
author: JoshuaPartlow
ms.author: joshuapa
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: f0caadfe9abf38b2d83995da7efa32d618b4bfe0
ms.sourcegitcommit: 4d394866b7817689411afee98e85da1653ec42f2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/12/2020
ms.locfileid: "97362653"
---
# <a name="the-text-template-transformation-process"></a>テキスト テンプレート変換プロセス
テキストテンプレート変換プロセスは、テキストテンプレートファイルを入力として受け取り、新しいテキストファイルを出力として生成します。 たとえば、テキストテンプレートを使用して Visual Basic または C# コードを生成したり、HTML レポートを生成したりすることができます。

 このプロセスには、エンジン、ホスト、ディレクティブプロセッサの3つのコンポーネントが含まれます。 エンジンはプロセスを制御します。ホストおよびディレクティブプロセッサとやり取りして、出力ファイルを生成します。 ホストは、ファイルやアセンブリの検索など、環境との相互作用を提供します。 ディレクティブプロセッサでは、XML ファイルまたはデータベースからのデータの読み取りなどの機能が追加されます。

 テキストテンプレート変換プロセスは2つの手順で実行されます。 まず、エンジンは、生成された変換クラスと呼ばれる一時クラスを作成します。 このクラスには、ディレクティブとコントロールブロックによって生成されるコードが含まれています。 その後、生成された変換クラスをコンパイルして実行し、出力ファイルを生成します。

## <a name="components"></a>コンポーネント

|コンポーネント|説明|カスタマイズ可能 (はい/いいえ)|
|-|-|-|
|エンジン|エンジンコンポーネントは、テキストテンプレート変換プロセスを制御します。|不正解です。|
|ホスト|ホストは、エンジンとユーザー環境の間のインターフェイスです。 Visual Studio は、テキスト変換プロセスのホストです。|はい。 カスタムホストを作成することができます。|
|ディレクティブプロセッサ|ディレクティブプロセッサは、テキストテンプレートのディレクティブを処理するクラスです。 ディレクティブを使用すると、入力ソースからテキストテンプレートにデータを提供できます。|はい。 カスタムディレクティブプロセッサを作成できます。|

## <a name="the-engine"></a>エンジン
 エンジンは、ホストから文字列としてテンプレートを受信します。これにより、変換プロセスで使用されるすべてのファイルが処理されます。 次に、エンジンは、ホストに対して、カスタムディレクティブプロセッサおよび環境のその他の側面を検索するように要求します。 次に、生成された変換クラスをコンパイルして実行します。 生成されたテキストは、エンジンによってホストに返されます。これにより、通常、テキストがファイルに保存されます。

## <a name="the-host"></a>ホスト
 ホストは、次のように、変換プロセス以外の環境に関連するすべての処理を行います。

- エンジンまたはディレクティブプロセッサによって要求されたテキストファイルとバイナリファイルを検索します。 ホストは、ディレクトリおよびグローバルアセンブリキャッシュを検索して、アセンブリを見つけることができます。 ホストは、エンジンのカスタムディレクティブプロセッサコードを見つけることができます。 ホストは、テキストファイルを検索して読み取り、その内容を文字列として返すこともできます。

- 生成された変換クラスを作成するためにエンジンによって使用される標準アセンブリと名前空間のリストを提供します。

- 生成された変換クラスをエンジンがコンパイルして実行するときに使用されるアプリケーションドメインを提供します。 テンプレートコードのエラーからホストアプリケーションを保護するために、別のアプリケーションドメインが使用されます。

- 生成された出力ファイルを書き込んでいます。

- 生成された出力ファイルの既定の拡張機能を設定します。

- テキストテンプレートの変換エラーを処理しています。 たとえば、ホストは、ユーザーインターフェイスのエラーを表示したり、ファイルに書き込んだりできます。 (Visual Studio では、エラーはエラーメッセージウィンドウに表示されます)。

- ユーザーが値を指定せずにディレクティブを呼び出した場合は、必要なパラメーター値を指定します。 ディレクティブプロセッサでは、ディレクティブの名前とパラメーターを指定し、ホストに既定値がある場合はそれを指定するように要求できます。

## <a name="directives-and-directive-processors"></a>ディレクティブとディレクティブプロセッサ
 ディレクティブは、テキストテンプレート内のコマンドです。 生成プロセスにパラメーターを提供します。 通常、ディレクティブは、モデルまたはその他の入力のソースと種類、および出力ファイルのファイル名拡張子を定義します。

 ディレクティブプロセッサは、1つまたは複数のディレクティブを処理できます。 テンプレートを変換する場合は、テンプレート内のディレクティブを処理できるディレクティブプロセッサをインストールしておく必要があります。

 ディレクティブは、生成された変換クラスにコードを追加することによって機能します。 テキストテンプレートからディレクティブを呼び出すと、生成された変換クラスを作成するときに、すべてのディレクティブ呼び出しがエンジンによって処理されます。 ディレクティブを正常に呼び出した後、テキストテンプレートに記述する残りのコードは、ディレクティブによって提供される機能に依存する可能性があります。 たとえば、テンプレート内のディレクティブに対して次の呼び出しを行うことができ `import` ます。

 `<#@ import namespace="System.Text" #>`

 標準ディレクティブプロセッサは、このを、 `using` 生成された変換クラスのステートメントに変換します。 その後 `StringBuilder` 、テンプレートコードの他の部分でクラスをとして修飾することなく使用でき `System.Text.StringBuilder` ます。
