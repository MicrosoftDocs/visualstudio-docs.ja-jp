---
title: コード マップ
ms.date: 05/16/2018
ms.topic: conceptual
f1_keywords:
- vs.progression.codemap
- vs.progression.standardgraphsdialog
helpviewer_keywords:
- DGML
- graph documents
- code visualization [Visual Studio]
- dependencies, visualizing
- dependency graphs
author: gewarren
ms.author: gewarren
manager: douge
ms.workload:
- multiple
ms.prod: visual-studio-dev15
ms.technology: vs-ide-modeling
ms.openlocfilehash: 5625d79221416a8799d120530d3c463041412417
ms.sourcegitcommit: 4f82c178b1ac585dcf13b515cc2a9cb547d5f949
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/30/2018
ms.locfileid: "39341226"
---
# <a name="map-dependencies-with-code-maps"></a>コード マップで依存関係をマッピングします。

複数のコード間の依存関係を視覚化するには、コード マップを作成します。 コード マップを使用せず、ファイルと行のコード全体を読むコードがどの一緒に収まりますを参照してください。

![Visual Studio でコード マップで依存関係の表示](../modeling/media/codemapsmainintro.png)

を作成およびコード マップを編集するには、Visual Studio Enterprise edition が必要です。 Visual Studio Community、Professional エディションでは、Enterprise edition で生成されたダイアグラムを開くことができますが、編集することはできません。

> [!NOTE]
> Visual Studio Professional を使用している他のユーザーで Visual Studio Enterprise で作成したマップを共有する前に、(非表示の項目、展開されたグループ、グループ間リンクなど)、マップ上のすべての項目を表示することを確認します。

これらの言語でコードの依存関係をマップすることができます。

- Visual c# または Visual Basic では、ソリューションまたはアセンブリ (*.dll*または *.exe*)

- Visual C プロジェクト、ヘッダー ファイルでネイティブまたはマネージ C または C++ コード (*.h*または`#include`)、またはバイナリ

- Microsoft Dynamics AX の .NET モジュールから作られた X++ プロジェクトおよびアセンブリ

> [!NOTE]
> C# または Visual Basic 以外のプロジェクト、コード マップを開始または既存のコード マップに項目を追加するためのオプションを減らすにがあります。 たとえば、C++ プロジェクトのテキスト エディター内のオブジェクトを右クリックすることも、コード マップにそのオブジェクト追加することもできません。 ただし、ドラッグ アンド ドロップまたはファイルからの個々 のコード要素**ソリューション エクスプ ローラー**、**クラス ビュー**、および**オブジェクト ブラウザー**します。

## <a name="install-code-map-and-live-dependency-validation"></a>インストール コード マップやライブ依存関係検証

Visual Studio 2017 では、コード マップを作成するに最初にインストール、**コード マップ**と**ライブ依存関係検証**コンポーネント。

1. 開いている**Visual Studio インストーラー**します。 開くことができます、Windows のスタート メニューから Visual Studio 内で、選択して**ツール** > **ツールの入手と機能**します。

1. **[個々のコンポーネント]** タブを選択します。

1. 下へスクロールして、**コード ツール**セクションし、選択**コード マップ**と**ライブ依存関係検証**です。

   ![Visual Studio インストーラーでコード マップやライブ依存関係検証コンポーネント](media/modeling-components.png)

1. **[変更]** を選択します。

   **コード マップ**と**ライブ依存関係検証**コンポーネントのインストールを開始します。 Visual Studio を終了するよく寄せられる可能性があります。

## <a name="add-a-code-map"></a>コード マップを追加します。

空のコード マップを作成し、アセンブリ参照、ファイル、フォルダーなどの上に項目をドラッグしてまたはすべてのコード マップまたはソリューションの一部を生成することができます。

空のコード マップを追加します。

1. **ソリューション エクスプローラー**で、最上位のソリューション ノードのショートカット メニューを表示します。 選択**追加** > **新しい項目の**します。

2. **新しい項目の追加**ダイアログで、**インストール済み**、選択、**全般**カテゴリ。

3. 選択、 **Directed Graph Document(.dgml)** テンプレートと、選択**追加**します。

   > [!TIP]
   > 表示されない場合、テンプレートの一覧の一番下までスクロールのでこのテンプレートは、アルファベット順に表示されない場合があります。

   ソリューションの空のマップが表示されます。**ソリューション項目**フォルダー。

同様に、新しいコード マップ ファイルを作成を選択して、ソリューションに追加せず**アーキテクチャ** > **新しいコード マップ**または**ファイル** > **新しい** > **ファイル**します。

## <a name="generate-a-code-map-for-your-solution"></a>ソリューションのコード マップを生成します。

ソリューション内のすべての依存関係を参照してください。

1. メニュー バーで、**アーキテクチャ** > **ソリューションのコード マップを生成**します。 コードが、前回のビルド以降に変更されていない場合は選択**アーキテクチャ** > **ビルドなしでソリューションのコード マップを生成**代わりにします。

   ![コード マップ生成コマンド](../modeling/media/codemapsarchitecturemenu.png)

   最上位レベル アセンブリとそれらの間の集約されたリンクを表示するマップが生成されます。 集約リンクを広げると、表される依存関係が多くなります。

2. コード マップ ツールバーの **[凡例]** ボタンを使用して、プロジェクトの種類のアイコン (テスト プロジェクト、Web プロジェクト、Phone プロジェクトなど)、コード項目 (クラス、メソッド、プロパティなど)、および関係の種類 (継承元、実装、呼び出しなど) のリストを表示または非表示にします。

   ![アセンブリの最上位の依存関係グラフ](../modeling/media/dependencygraph_toplevelassemblies.png)

   このソリューション例には、ソリューション フォルダー (**[テスト]** と **[コンポーネント]**)、テスト プロジェクト、Web プロジェクト、およびアセンブリが含まれています。 既定では、コンテインメイト リレーションシップはすべて、展開および折りたたみができる *グループ*として表示されます。 **[外部]** グループには、プラットフォームの依存関係など、ソリューションの外部のものがすべて含まれます。 外部アセンブリには、使用中の項目のみが表示されます。 既定では、視認性を高めるため、システムの基本型はマップに表示されません。

3. マップをドリル ダウンするには、プロジェクトおよびアセンブリを表すグループを展開します。 **CTRL キーを押しながら A キー** を押してすべてのノードを選択し、ショートカット メニューから **[グループ]**、 **[展開]** の順に選択すると、すべてを展開できます。

   ![コード マップ内のすべてのグループを展開する](../modeling/media/codemapsexpandallgroups.png)

4. ただし、これは大規模なソリューションには不向きな場合があります。 実際、複雑なソリューションでは、メモリ制限のためにすべてのグループを展開できない場合があります。 代わりに、個々のノードを展開して内部を表示します。 マウス ポインターをノード上に移動し、シェブロン (下矢印) が表示されたらクリックします。

   ![コード マップ内のノードを展開する](../modeling/media/dependencygraph_containment.png)

   または、キーボードを使用して項目を選択し、プラス キー (**+**) を押します。 さらに深いレベルのコードを確認するには、名前空間、型、およびメンバーに対して同じ操作を行います。

   > [!TIP]
   > コードの使用の詳細については、マップ、マウス、キーボード、およびタッチ、参照を使用して[参照およびコード マップの再配置](../modeling/browse-and-rearrange-code-maps.md)します。

5. マップを簡略化し個々の部分に注目するには、コード マップ ツールバーで **[フィルター]** を選択し、必要なノードおよびリンクの種類だけを選択します。 たとえば、すべてのソリューション フォルダーとアセンブリのコンテナーを非表示にできます。

   ![コンテナーをフィルター処理して、マップを簡略化する](../modeling/media/codemapsfilterfoldersassemblies.png)

   個々のグループおよび項目をマップで非表示にしたりマップから削除したりして、マップを簡略化できます。この操作は、基のソリューション コードには影響を与えません。

6. 項目間のリレーションシップを表示するには、マップでそれらを選択します。 リンクの色は、 **[凡例]** ウィンドウの表示に対応しており、リレーションシップの種類を表しています。

   ![ソリューション間の依存関係を表示する](../modeling/media/codemapsmainintro.png)

   この例で、紫色のリンクは呼び出し、点線のリンクは参照、および薄青色のリンクはフィールド アクセスを表しています。 緑色のリンクは継承を表す場合もありますが、複数のリレーションシップ (または *カテゴリ* ) の種類を表す *集約リンク*の可能性もあります。

   > [!TIP]
   > 緑色のリンクが表示されている場合、単に継承関係の存在のみを示しているわけではない可能性があります。 メソッドの呼び出しも存在する場合がありますが、これらは継承関係によって非表示になっています。 特定の種類のリンクを表示するチェック ボックスを使用して、**フィルター**必要のない型を非表示にするウィンドウ。

7. 項目またはリンクに関する詳細情報を確認するには、ポインターをその項目の上に移動してツールヒントを表示します。 これにより、コード要素またはリンクが表すカテゴリの詳細が表示されます。

   ![リレーションシップのカテゴリを表示する](../modeling/media/codemapsshowlinkcatgories.png)

8. 集約リンクによって表される項目と依存関係を調べるには、最初にリンクを選択して、そのショートカット メニューを開きます。 **[寄与するリンクの表示]** または **[新しいコード マップ上の寄与するリンクの表示]** をクリックします。 これにより、リンクの両端のグループが展開され、リンクに関係する項目と依存関係のみが表示されます。

9. マップの特定の部分に注目するため、必要のない項目を削除できます。 たとえば、クラス ビューとメンバー ビューを詳細表示するには、 **[フィルター]** ウィンドウですべての名前空間ノードをフィルター処理するだけです。

   ![クラスとメンバーのレベルまでグループをドリルダウンする](../modeling/media/dependencygraph_expandedselectedgroups_2012.png)

10. 複雑なソリューション マップで必要な項目に注目するもう 1 つの方法は、既存のマップから、選択した項目を含む新しいマップを生成することです。 保持**Ctrl**に集中し項目を選択するときに、ショートカット メニューを開くし、選択**選択範囲から新しいグラフを**します。

   ![選択された項目を新しいコード マップに表示する](../modeling/media/codemapsshowonnewmap.png)

11. 含んでいるコンテキストは、新しいマップに引き継がれます。 ソリューション フォルダーとその他の任意のコンテナーを使用して確認する非表示にする、**フィルター**ウィンドウ。

   ![コンテナーをフィルター処理してビューを簡略化する](../modeling/media/codemapsexpandnewgroups.png)

12. グループを展開し、リレーションシップを表示するマップ内の項目を選択します。

   ![リレーションシップを表示する項目を選択する](../modeling/media/codemapsviewnewrelationships.png)

関連項目:

- [コード マップの参照および再配置](../modeling/browse-and-rearrange-code-maps.md)
- [DGML ファイルを編集してコード マップをカスタマイズする](../modeling/customize-code-maps-by-editing-the-dgml-files.md)
- により、コードの潜在的な問題を見つける[アナライザーの実行](../modeling/find-potential-problems-using-code-map-analyzers.md)

## <a name="view-specific-dependencies-in-a-code-map"></a>コード マップの特定依存関係の表示

保留中の変更をいくつかのファイルを実行するコード レビューがあるとします。 これらの変更の依存関係を表示するため、これらのファイルからコード マップを作成できます。

   ![特定の依存関係をコード マップに表示する](../modeling/media/codemapsspecificdependenciesintro.png)

1. **ソリューション エクスプ ローラー**プロジェクト、アセンブリ参照、フォルダー、ファイル、型、またはマップするメンバーを選択します。

   ![マップする項目を選択する](../modeling/media/codemapsselectinsolutionexplorer.png)

1. **ソリューション エクスプ ローラー**ツールバーで、選択**コード マップに表示**![グラフから選択したノード](../modeling/media/createnewgraphfromselectedbutton.gif)です。 1 つまたは一連の項目のショートカット メニューを開き、選択**コード マップに表示**します。

   項目をドラッグすることもできます。**ソリューション エクスプ ローラー**、**クラス ビュー**、または**オブジェクト ブラウザー**、に、[新しい](#add-a-code-map)または既存のコードをマップします。 項目の親階層を含めるには、プレス アンド ホールド、 **Ctrl**キーの項目をドラッグするか、使用中に、**親を含める**既定のアクションを指定するコード マップ ツールバーでボタンをクリックします。 など、Visual Studio の外部からのアセンブリ ファイルをドラッグすることも**Windows エクスプ ローラー**します。

   > [!NOTE]
   > Microsoft Store では、Windows Phone など複数のアプリで共有されるプロジェクトから項目を追加すると、現在アクティブなアプリ プロジェクトと共にマップにその項目が表示されます。 コンテキストを別のアプリ プロジェクトに変更し、共有プロジェクトからさらに項目を追加した場合、その項目は、新しくアクティブになったアプリ プロジェクトと共に表示されます。 マップ上の項目に実行する操作は、同じコンテキストを共有する項目にのみ適用されます。

3. アセンブリ内の選択した項目がマップに表示されます。

   ![マップでグループとして表示するように選択された項目](../modeling/media/codemapsshowitemsfromsolnexplorer.png)

4. 項目を確認するには、その項目を展開します。 マウス ポインターを項目の上に移動し、シェブロン (下矢印) アイコンが表示されたらクリックします。

   ![コード マップ内のノードを展開します。](../modeling/media/dependencygraph_containment.png)

   すべての項目を展開するには、選択を使用して**Ctrl**+**A**し、マップのショートカット メニューを開いてから選択**グループ** >  **展開**します。 ただし、すべてのグループを展開すると使用に適さないマップになったりメモリの問題が発生したりする場合、このオプションは使用できません。

5. 続行すると、必要に応じてクラスとメンバーのレベルまでで、目的の項目を展開します。

   ![クラスとメンバーのレベルにグループを展開する](../modeling/media/codemapsexpandtoclassandmember.png)

   コードには表示されませんがメンバーを表示するには、マップで、をクリックして、**子の再フェッチ**アイコン![子の再フェッチ アイコン](../modeling/media/dependencygraph_deletednodesicon.png)グループの左上隅にあります。

6. マップ上の項目に関連する項目をさらに表示するには、1 つを選択し、コード マップ ツールバーで **[関連表示]** を選択して、マップに追加する関連項目の種類を選択します。 または、1 つまたは複数の項目を選択、ショートカット メニューを開いて、および選択し、**表示**マップに追加する関連項目の種類のオプション。 例えば:

    **アセンブリ**の場合、次のように選択します。

    |||
    |-|-|
    |**参照されるアセンブリの表示**|このアセンブリの参照先のアセンブリを追加します。 外部アセンブリは **[外部]** グループに表示されます。|
    |**参照元のアセンブリの表示**|このアセンブリを参照するソリューション内のアセンブリを追加します。|

    **名前空間**の場合、表示されていなければ、 **[含んでいるアセンブリの表示]** をクリックします。

    **クラス** または **インターフェイス**の場合は、次から選択します。

    |||
    |-|-|
    |**基本型の表示**|クラスの場合、基底クラスおよび実装されたインターフェイスを追加します。<br /><br /> インターフェイスの場合、基本インターフェイスを追加します。|
    |**派生型の表示**|クラスの場合、派生クラスを追加します。<br /><br /> インターフェイスの場合、派生インターフェイスと、実装するクラスまたは構造体を追加します。|
    |**参照される型の表示**|すべてのクラスと、このクラスが使用するメンバーを追加します。|
    |**参照元の型の表示**|すべてのクラスと、このクラスを使用するメンバーを追加します。|
    |**含んでいる名前空間の表示**|親の名前空間を追加します。|
    |**含んでいる名前空間とアセンブリの表示**|親コンテナーの階層を追加します。|
    |**すべての基本型の表示**|基底クラスまたはインターフェイス階層を再帰的に追加します。|
    |**すべての派生型の表示**|クラスの場合、すべての派生クラスを再帰的に追加します。<br /><br /> インターフェイスの場合、すべての派生インターフェイスと、実装するクラスまたは構造体を再帰的に追加します。|

     **メソッド**の場合、次から選択します。

    |||
    |-|-|
    |**呼び出されるメソッドの表示**|このメソッドが呼び出すメソッドを追加します。|
    |**参照されるフィールドの表示**|このメソッドが参照するフィールドを追加します。|
    |**含んでいる型の表示**|親の型を追加します。|
    |**含んでいる型、名前空間、およびアセンブリの表示**|親コンテナーの階層を追加します。|
    |**オーバーライドされたメソッドの表示**|他のメソッドをオーバーライドするか、インターフェイスのメソッドを実装するメソッドの場合、オーバーライドされた基底クラスのすべての抽象メソッドまたは仮想メソッド、および実装されたインターフェイスのメソッドがある場合はそのメソッドを追加します。|

     **フィールド** または **プロパティ**の場合、次から選択します。

    |||
    |-|-|
    |**含んでいる型の表示**|親の型を追加します。|
    |**含んでいる型、名前空間、およびアセンブリの表示**|親コンテナーの階層を追加します。|

    ![このメンバーによって呼び出されるメソッドを表示する](../modeling/media/codemapsshowrelatedmethods.png)

7. マップには、リレーションシップが表示されます。 この例では、によって呼び出されるメソッドがマップに表示されます、`Find`メソッドと、ソリューションまたは外部の場所。

   ![特定の依存関係をコード マップに表示する](../modeling/media/codemapsspecificdependenciesintro.png)

8. マップを簡略化し個々の部分に注目するには、コード マップ ツールバーで **[フィルター]** を選択し、必要なノードおよびリンクの種類だけを選択します。 たとえば、ソリューション フォルダー、アセンブリ、および名前空間の表示をオフにします。

   ![フィルター ペインを使用して表示を簡略化する](../modeling/media/almcodemapfilterpane.png)

## <a name="see-also"></a>関連項目

- [ビデオ: Visual Studio 2015 コード マップを使用したコードの設計を理解する](https://channel9.msdn.com/Events/Visual-Studio/Connect-event-2015/502)]
- [コード マップを使用してアプリケーションをデバッグする](../modeling/use-code-maps-to-debug-your-applications.md)
- [デバッグ中に呼び出し履歴に対するメソッドをマップします。](../debugger/map-methods-on-the-call-stack-while-debugging-in-visual-studio.md)
- [コード マップ アナライザーを使用して潜在的な問題を検索する](../modeling/find-potential-problems-using-code-map-analyzers.md)
- [コード マップの参照および再配置](../modeling/browse-and-rearrange-code-maps.md)
- [DGML ファイルを編集してコード マップをカスタマイズする](../modeling/customize-code-maps-by-editing-the-dgml-files.md)
