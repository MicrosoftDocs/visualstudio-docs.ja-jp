---
title: "依存関係図: ガイドライン |Microsoft ドキュメント"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- architecture, dependency diagrams
- dependency diagrams
- diagrams - modeling, layer
- constraints, architectural
ms.assetid: 2903bec7-a93b-46a6-aac6-994ac4f3f1a7
caps.latest.revision: 55
author: alexhomer1
ms.author: ahomer
manager: douge
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: fd26c504273cae739ccbeef5e406891def732985
ms.openlocfilehash: 8233d0d6ce81a0869e99f5baf45b7ef7b3fc9019
ms.lasthandoff: 02/22/2017

---
# <a name="dependency-diagrams-guidelines"></a>依存関係図: ガイドライン
作成することで大まかに言えば、アプリケーションのアーキテクチャを記述*、依存関係図*Visual Studio でします。 コードが依存関係図を使用してコードを検証することによってこのような設計と一致していることを確認します。 レイヤーの検証をビルド プロセスに含めることもできます。 参照してください[Channel 9 ビデオ: デザインと、依存関係図の使用によるアーキテクチャの検証](http://go.microsoft.com/fwlink/?LinkID=252073)します。  
  
 この機能をサポートする Visual Studio のバージョンを参照してください[アーキテクチャとモデリング ツールのバージョンのサポート](../modeling/what-s-new-for-design-in-visual-studio.md#VersionSupport)します。  
  
## <a name="what-is-a-dependency-diagram"></a>依存関係ダイアグラムとは何ですか。  
 従来のアーキテクチャ図のようには、依存関係のダイアグラムは、主要なコンポーネントや機能ユニットの設計とその相互依存関係を識別します。 呼ばれる図上の各ノード、*レイヤー*、名前空間、プロジェクト、または他の成果物の論理グループを表します。 設計に必要な依存関係を描画できます。 従来のアーキテクチャ図とは異なり、ソース コード内の実際の依存関係が意図したとおりのものであることを検証できます。 
          [!INCLUDE[esprtfs](../code-quality/includes/esprtfs_md.md)] で定期的なビルドの検証パーツを作成すると、今後変更が繰り返されても、プログラム コードがシステムのアーキテクチャに準拠している状態を維持できます。 参照してください[、依存関係図: リファレンス](../modeling/layer-diagrams-reference.md)します。  
  
##  <a name="a-nameupdatea-how-to-design-or-update-your-app-with-dependency-diagrams"></a><a name="Update"></a>設計または依存関係のダイアグラムのアプリケーションを更新する方法  
 次の手順では、開発プロセス内で、依存関係図を使用する方法の概要を示します。 このトピックの後半のセクションでは、各手順について詳細に説明します。 新しく設計を行う場合は、既存のコードを扱う手順は省略してください。  
  
> [!NOTE]
>  これらの手順は順序が決まっているわけではありません。 複数のタスクを並行して実行することも、状況に合わせてタスクの順序を変えることも、プロジェクト内で繰り返すたびに毎回同じ手順を実行することもできます。  
  
1.  [依存関係図を作成する](#Create)全体のアプリケーション、またはその内のレイヤーです。  
  
2.  [主要な機能領域またはコンポーネントを表すレイヤーを定義する](#CreateLayers)アプリケーションのです。 これらのレイヤーには、その機能に合わせて "プレゼンテーション" や "サービス" などの名前を付けます。 ある場合、[!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]ソリューションでは、コレクションを使用して、各レイヤーに関連付けることができます*アーティファクト*プロジェクト、名前空間、ファイルなど、します。  
  
3.  [既存の依存関係を検出](#Generate)層の間です。  
  
4.  [レイヤーと依存関係を編集](#EditArchitecture)更新を表示する、コードに反映するをデザインします。  
  
5.  [アプリケーションの新しい領域をデザインする](#NewAreas)をプリンシパルのアーキテクチャ ブロックまたはコンポーネントを表すレイヤーを作成し、各レイヤーが、他のユーザーを使用する方法を表示する依存関係を定義します。  
  
6.  [レイアウトと、図の外観を編集](#EditLayout)同僚に相談するためです。  
  
7.  [依存関係図と照らし合わせてコードを検証する](#Validate)コードとする必要がアーキテクチャの間の競合を明らかにします。  
  
8.  [コードを更新、新しいアーキテクチャに準拠](#UpdateCode)します。 検証によって競合が報告されなくなるまで、コードの開発とリファクタリングを繰り返します。  
  
9. [ビルド プロセスにレイヤー検証を組み込む](#BuildValidation)を設計に準拠したコードの状態を確認します。  
  
##  <a name="a-namecreatea-create-a-dependency-diagram"></a><a name="Create"></a>依存関係図を作成します。  
 モデリング プロジェクト内の依存関係図を作成してください。 既存のモデリング プロジェクトに新しい依存関係図を追加、依存関係ダイアグラムの新しいモデリング プロジェクトを作成、または既存の依存関係図を同じモデリング プロジェクト内でコピーできます。  
  
> [!IMPORTANT]
>  追加、ドラッグ、または別のモデリング プロジェクトまたはソリューション内の別の場所には、モデリング プロジェクトから既存の依存関係図をコピーします。 この方法でコピーされる依存関係ダイアグラムは、図を変更する場合でも、元の図と同じ参照があります。 これにより、レイヤー検証は正しく機能せず、要素が欠落したり、図を開こうとすると他のエラーが発生するなど、他の問題が生じる可能性があります。  
  
 参照してください[コードから依存関係図を作成](../modeling/create-layer-diagrams-from-your-code.md)します。  
  
##  <a name="a-namecreatelayersa-define-layers-to-represent-functional-areas-or-components"></a><a name="CreateLayers"></a>機能領域またはコンポーネントを表すレイヤーを定義します。  
 レイヤーの論理グループを表す*アーティファクト*プロジェクト、コード ファイル、名前空間、クラス、およびメソッドのなどです。 Visual C# .NET プロジェクトおよび Visual Basic .NET プロジェクトの成果物からレイヤーを生成したり、Word ファイルや PowerPoint プレゼンテーションなどのドキュメントをリンクして仕様や計画をレイヤーに添付したりすることができます。 各レイヤーは、図では四角形として表示されます。また各レイヤーでは、レイヤーにリンクされている成果物の数が表示されます。 レイヤーには、より具体的なタスクを記述する入れ子になったレイヤーを含めることができます。  
  
 一般的に、レイヤーには、その機能に合わせて "プレゼンテーション" や "サービス" などの名前を付けます。 密に相互依存している成果物は、同じレイヤーに配置します。 別々に更新できる成果物や別のアプリケーションで使用できる成果物は、異なるレイヤーに配置してください。 レイヤー パターンの詳細については、パターン >/documents/report1.rdl」のプラクティス サイトを参照してください。 [http://go.microsoft.com/fwlink/?LinkId=145794](http://go.microsoft.com/fwlink/?LinkId=145794)します。  
  
> [!TIP]
>  特定の種類の成果物は、レイヤーにリンクすることがありますが、依存関係図と照らし合わせた検証はサポートしていません。 成果物が検証をサポートするかどうかを表示するには、開く**レイヤー エクスプ ローラー**を調べる、**検証をサポート**成果物のリンクのプロパティです。 参照してください[レイヤー間の既存の依存関係を検出](#Generate)します。  
  
 よく知らないアプリケーションを更新する場合は、コード マップを作成することもできます。 これらの図を利用することで、コードを検証するときに、パターンと依存関係を見つけやすくなります。 ソリューション エクスプローラーを使って、名前空間やクラスを調べることができます。これらは、通常は既存のレイヤーに対応しています。 ソリューション エクスプ ローラーから、依存関係図にドラッグしてこれらのコードの成果物をレイヤーに割り当てます。 依存関係図を使用して、コードを更新および整合によって、デザインに役立つことができます。  
  
 参照トピック  
  
-   [コードから依存関係図を作成します。](../modeling/create-layer-diagrams-from-your-code.md)  
  
-   [コード マップを使用してアプリケーションをデバッグする](../modeling/use-code-maps-to-debug-your-applications.md)  
  
-   [ソリューション間の依存関係をマップする](../modeling/map-dependencies-across-your-solutions.md)  
  
##  <a name="a-namegeneratea-discover-existing-dependencies-between-layers"></a><a name="Generate"></a>レイヤー間の既存の依存関係を検出します。  
 依存関係が存在するのは、あるレイヤーに関連付けられている成果物が、別のレイヤーに関連付けられている成果物を参照している場合です。 たとえば、あるレイヤー内のクラスが、別のレイヤー内のクラスを保持する変数を宣言する場合などです。 既存の依存関係を検出するには、リバース エンジニアリングします。  
  
> [!NOTE]
>  成果物の種類によっては、依存関係をリバース エンジニアリングできないものもあります。 たとえば、テキスト ファイルにリンクされているレイヤーから、またはそのレイヤーに対して依存関係をリバース エンジニアリングすることはできません。 リバース エンジニア リングできる依存関係のあるどの成果物を表示するには、1 つまたは複数のレイヤーを右クリックし、をクリックし、**リンクの表示**します。 **レイヤー エクスプ ローラー**、確認、**検証をサポート**列です。 依存関係は成果物についてこのコラムのリバース エンジニア リングにできません**False**します。  
  
#### <a name="to-reverse-engineer-existing-dependencies-between-layers"></a>レイヤー間の既存の依存関係をリバース エンジニアリングするには  
  
-   1 つの層または複数のレイヤーを選択を選択したレイヤーを右クリックし、をクリックし、**依存関係の生成**します。  
  
 通常は、不要な依存関係がいくつか見つかります。 これらの依存関係を編集して、目的の設計に準拠するようアラインできます。  
  
##  <a name="a-nameeditarchitecturea-edit-layers-and-dependencies-to-show-the-intended-design"></a><a name="EditArchitecture"></a>レイヤーと依存関係を表示して目的の設計を編集します。  
 システムまたは対象とするアーキテクチャを対象となる変更を記述するのにには、依存関係図を編集するのに、次の手順を使用します。 また、リファクタリングの変更を行い、コードを拡張する前に構造を改良することもできます。 参照してください[コードの構造を改良する](#Improving)です。  
  
|**目的**|**次の手順を実行します。**|  
|------------|-----------------------------|  
|不要な依存関係を削除する|依存関係をクリックし、キーを押します**削除**します。|  
|依存関係の方向を変更または制限する|設定の**方向**プロパティです。|  
|新しい依存関係を生成する|使用して、**依存関係**と**双方向の依存関係**ツールです。<br /><br /> 複数の依存関係を描画するには、ツールをダブルクリックします。 完了したら、クリックして、**ポインター**ツールまたはキーを押して、 **ESC**キー。|  
|レイヤーに関連付けられている成果物が、指定した名前空間に依存できないように指定する|レイヤーの名前空間を入力**Namespace 依存関係の禁止**プロパティです。 セミコロンを使用して (**;**) 名前空間を分離します。|  
|レイヤーに関連付けられている成果物を、指定した名前空間に所属させることができないように指定する|レイヤーの名前空間を入力**禁止された名前空間**プロパティです。 セミコロンを使用して (**;**) 名前空間を分離します。|  
|レイヤーに関連付けられている成果物を、指定した名前空間のいずれかに必ず所属させるように指定する|レイヤーの名前空間を入力**名前空間のために必要な**プロパティです。 セミコロンを使用して (**;**) 名前空間を分離します。|  
  
###  <a name="a-nameimprovinga-improving-the-structure-of-the-code"></a><a name="Improving"></a>コードの構造を改良します。  
 リファクタリングの変更を行ってもアプリケーションの振る舞いは変わりませんが、将来、コードの変更や拡張が容易になります。 適切に構成されたコードでは、依存関係のダイアグラムに簡単に抽出されるデザインを持っています。  
  
 たとえば、各名前空間を表すレイヤーをコードで生成し、依存関係をリバース エンジニアリングした場合は、レイヤー間の一方向の依存関係が最小限であることを確認する必要があります。 クラスまたはメソッドをレイヤーとして使用して、より詳細に図を生成した場合は、完成した図も同じ特性を備えている必要があります。  
  
 そうでない場合は、コードは難しくなるライフ サイクル全体で変更して、依存関係図を使用した検証に適さなくなります。  
  
##  <a name="a-namenewareasa-design-new-areas-of-your-application"></a><a name="NewAreas"></a>アプリケーションの新しい領域をデザインします。  
 新規プロジェクトの開発を新たに開始する場合や、新規プロジェクトで新しい領域の設計を開始する場合、コードの開発前にレイヤーと依存関係を描画することで、主要なコンポーネントを把握できます。  
  
-   **特定できるアーキテクチャ パターンを表示する**依存関係の図に、可能な場合です。 たとえば、デスクトップ アプリケーションを説明する依存関係図では、プレゼンテーション層、ドメイン ロジック、およびデータ ストアなどのレイヤーを追加できます。 アプリケーション内で&1; つの機能をカバーする依存関係図では、モデル、ビュー、およびコント ローラーなどのレイヤーがあります。 このようなパターンの詳細については、次を参照してください。 [>/documents/report1.rdl」の Patterns Practices: アプリケーションのアーキテクチャ](http://go.microsoft.com/fwlink/?LinkId=145794)します。  
  
     類似のパターンを生成することがよくある場合は、カスタム ツールを生成します。 参照してください[定義のカスタム モデリング ツールボックス項目](../modeling/define-a-custom-modeling-toolbox-item.md)します。  
  
-   **各レイヤーのコードを生成します**名前空間、クラス、コンポーネントなどです。 これにより、コードの追跡やレイヤーへのコードのリンクが容易になります。 成果物を生成するごとに、すぐに適切なレイヤーにリンクさせてください。  
  
-   **ほとんどのクラスやその他の成果物をレイヤーにリンクする必要はありません**既にレイヤーにリンクされている名前空間などのより大きな成果物に収まるためです。  
  
-   **新機能の新しい図を作成する**です。 通常、アプリケーション全体を記述する&1; つまたは複数の依存関係図があります。 アプリケーション内の新機能を設計するときには、既存の図を流用しないでください。 代わりに、コードの新しい部分を反映した独自の図を生成します。 新しい図には、新機能のプレゼンテーション レイヤー、ドメイン ロジック レイヤー、データベース レイヤーなどを追加できます。  
  
     アプリケーションをビルドするときに、全体を示す図とより詳細な機能の図の両方に対してコードが検証されます。  
  
##  <a name="a-nameeditlayouta-edit-the-layout-for-presentation-and-discussion"></a><a name="EditLayout"></a>プレゼンテーションとディスカッションのレイアウトを編集します。  
 レイヤーおよび依存関係を識別しやすくするには、またはチーム メンバーとそれらについて話し合うことができるようにするには、次の方法で図の外観およびレイアウトを編集します。  
  
-   レイヤーのサイズ、形状、および位置  
  
-   レイヤーと依存関係の色  
  
    -   1 つまたは複数のレイヤーまたは依存関係、右クリックし、およびクリック選択**プロパティ**します。 **プロパティ**ウィンドウで、編集、**色**プロパティです。  
  
##  <a name="a-namevalidatea-validate-the-code-against-the-diagram"></a><a name="Validate"></a>図に照らし合わせてコードを検証します。  
 図を編集した後は、コードに対して随時手動で検証を行うか、ローカル ビルドまたは [!INCLUDE[esprbuild](../misc/includes/esprbuild_md.md)]を実行するたびに自動的に検証を行うことができます。  
  
 参照トピック  
  
-   [依存関係図をコードを検証します。](../modeling/validate-code-with-layer-diagrams.md)  
  
-   [ビルド プロセスにレイヤー検証を含める](#BuildValidation)  
  
##  <a name="a-nameupdatecodea-update-the-code-to-conform-to-the-new-architecture"></a><a name="UpdateCode"></a>新しいアーキテクチャに準拠するようにコードを更新します。  
 通常、エラーは最初に更新された依存関係図と照らし合わせてコードを検証したときに表示されます。 これらのエラーには、いくつかの原因が考えられます。  
  
-   成果物が不適切なレイヤーに割り当てられている。 この場合、成果物を移動します。  
  
-   クラスなどの成果物が、アーキテクチャに違反する形で別のクラスを使用している。 この場合、コードをリファクタリングして依存関係を削除します。  
  
 これらのエラーを解決するには、コードを更新して、検証時にエラーが表示されなくなるようにします。 通常、これは反復的な作業になります。 これらのエラーの詳細については、次を参照してください。[依存関係図をコードの検証](../modeling/validate-code-with-layer-diagrams.md)します。  
  
> [!NOTE]
>  開発またはコードをリファクタリングする、新しい成果物を依存関係図にリンクがあります。 これは必ずしも必要な作業ではありません。たとえば、レイヤーが既存の名前空間を表しており、新しいコードでこれらの名前空間に要素を追加するだけの場合は不要です。  
  
 開発プロセスの実行中は、検証時に報告される一部の競合を抑制できます。 たとえば、既に解決したエラーや特定のシナリオに関連しないエラーを抑制できます。 エラーを抑制した場合は、[!INCLUDE[esprfound](../code-quality/includes/esprfound_md.md)] で作業項目をログに記録することをお勧めします。 このタスクを実行するには、「[依存関係図コードの検証](../modeling/validate-code-with-layer-diagrams.md)します。  
  
##  <a name="a-namebuildvalidationa-include-layer-validation-in-the-build-process"></a><a name="BuildValidation"></a>ビルド プロセスにレイヤー検証を含める  
 依存関係図に従ってコードでの将来の変更を確認するには、ソリューションの標準的なビルド プロセスにレイヤー検証が含まれます。 他のチーム メンバーがソリューションをビルドするたびに、コード内の依存関係と依存関係図との違いはビルド エラーとして報告されます。 ビルド プロセスにレイヤー検証を追加する方法の詳細については、次を参照してください。[依存関係図をコードの検証](../modeling/validate-code-with-layer-diagrams.md)します。  
  
## <a name="see-also"></a>関連項目  
 [依存関係図: リファレンス](../modeling/layer-diagrams-reference.md)   
 [コードから依存関係図を作成します。](../modeling/create-layer-diagrams-from-your-code.md)

