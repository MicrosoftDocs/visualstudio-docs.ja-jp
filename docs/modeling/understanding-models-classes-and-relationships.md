---
title: モデル、クラス、およびリレーションシップについて
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- Domain-Specific Language, models
author: JoshuaPartlow
ms.author: joshuapa
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: c2e8891307520ee841fbed1591565624f2016939
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/02/2020
ms.locfileid: "75565904"
---
# <a name="understanding-models-classes-and-relationships"></a>モデル、クラス、およびリレーションシップについて
ドメイン固有言語 (DSL) は、DSL 定義ファイルと、ユーザーが記述するカスタムプログラムコードによって定義されます。 DSL ソリューションのプログラムコードの大部分は、このファイルから生成されます。

 このトピックでは、DSL 定義の中心となる機能について説明します。

## <a name="the-dsl-definition"></a>DSL 定義
 を開くと `Dsl\DslDefinition.dsl` 、Visual Studio のウィンドウは次の図のようになります。

 ![DSL デザイナー](../modeling/media/dsl_designer.png)

 Dsl 定義図には、DSL 定義の中で最も重要な情報が表示されています。 追加情報 (DslDefinition. dsl の一部でもあります) が DSL エクスプローラーに表示されます。これは通常、図の横に表示されます。 この図は、最も頻繁に実行されるタスクと、より高度なカスタマイズのための DSL エクスプローラーを使用して操作します。

 DSL 定義図は、モデル要素を定義するドメインクラスと、モデル要素間のリンクを定義するリレーションシップを示しています。 また、モデル要素をユーザーに表示するために使用される図形とコネクタも表示されます。

 ![スイムレーンを含む DSL デザイナー](../modeling/media/dsl_desinger.png)

 図または DSL エクスプローラーで DSL 定義の項目を選択すると、その項目に関する情報がプロパティウィンドウに表示されます。 [DSL の詳細] ウィンドウに追加情報が表示される場合があります。

### <a name="models-are-instances-of-dsls"></a>モデルは Dsl のインスタンス
 *モデル*は、ユーザーによって作成された DSL のインスタンスです。 モデルには、定義したドメインクラスのインスタンスであるモデル要素と、定義したドメインリレーションシップのインスタンスである要素間のリンクが含まれます。 モデルには、モデルの要素とリンクを図に表示する図形とコネクタを含めることもできます。 DSL 定義には、図形クラス、コネクタクラス、および図のクラスが含まれています。

 DSL 定義は *ドメインモデル*とも呼ばれます。 DSL 定義またはドメインモデルは、ドメイン固有言語のデザイン時表現であるのに対し、モデルはドメイン固有言語の実行時インスタンス化です。

## <a name="domain-classes-define-model-elements"></a>ドメインクラスがモデル要素を定義する
 ドメインクラスは、ドメイン内のさまざまな要素を作成するために使用されます。ドメインリレーションシップは、要素間のリンクです。 これらは、モデルの作成時にデザイン固有言語のユーザーによってインスタンス化される要素とリンクのデザイン時表現です。

 この図は、music library DSL のユーザーによって作成されたモデルを示しています。 ミュージックアルバムは、曲のリストを含むボックスで表されます。 アーティストは、角ボックスによって表され、投稿されたアルバムに接続されます。

 ![生成された DSL のインスタンス モデル](../modeling/media/music_instance.png)

 DSL 定義では、2つの側面が分離されています。 モデル図のモデル要素の外観は、図形クラスとコネクタクラスを使用して定義されます。 モデルに含まれる情報は、ドメインクラスとドメインリレーションシップを使用して定義されます。

 次の図は、音楽ライブラリの DSL 定義におけるドメインクラスとリレーションシップを示しています。

 ![埋め込みリレーションシップと参照リレーションシップ](../modeling/media/music_classes.png)

 この図は、音楽、アルバム、アーティスト、楽曲という4つのドメインクラスを示しています。 ドメインクラスは、Name、Title などのドメインプロパティを定義します。 インスタンスモデルでは、これらのプロパティの値がダイアグラムに表示されます。

 これらのクラスの間には、MusicHasAlbums、MusicHasArtists、AlbumbHasSongs、ArtistAppearedOnAlbums というドメインリレーションシップがあります。 リレーションシップには、1 ..1、0.. * などの多重度があります。 たとえば、すべての曲は、AlbumHasSongs 関係を通じて1つのアルバムにのみ関連付ける必要があります。 すべてのアルバムには、任意の数の曲を含めることができます。

### <a name="rearranging-the-dsl-definition-diagram"></a>DSL 定義図の並べ替え
 この図に示すように、DSL 定義図ではドメインクラスが数回表示される場合があることに注意してください。 常に1つのメインビューがあり、いくつかの *参照* ビューを表示できます。

 DSL 定義図を再配置するには、次の操作を行います。

- [ **ツリーをここに移動** ] と [ツリーの **分割** ] コマンドを使用して、メインビューと参照ビューを交換します。 1つのドメインクラスを右クリックすると、これらのコマンドが表示されます。

- Ctrl + ↑キーと Ctrl + Down キーを押して、ドメインクラスとシェイプクラスを並べ替えます。

- 各図形の右上にあるアイコンを使用して、クラスを折りたたんだり展開したりします。

- ドメインクラスの下部にある負符号 (-) をクリックして、ツリーの一部を折りたたみます。

## <a name="inheritance"></a>継承
 ドメインクラスは、継承を使用して定義できます。 継承の派生を作成するには、[継承] ツールをクリックし、派生クラスをクリックしてから、基本クラスをクリックします。 モデル要素には、その独自のドメインクラスで定義されているすべてのプロパティと、基本クラスから継承されたすべてのプロパティがあります。 また、リレーションシップのロールも継承します。

 リレーションシップ、図形、およびコネクタ間で継承を使用することもできます。 継承は同じグループ内に保持する必要があります。 図形をドメインクラスから継承することはできません。

## <a name="domain-relationships"></a>ドメインリレーションシップ
 モデル要素は、リレーションシップによってリンクできます。 リンクは常にバイナリです。これらは、厳密に2つの要素をリンクします。 ただし、要素には、他のオブジェクトへのリンクが多数含まれている場合があります。また、同じ要素のペア間に複数のリンクを含めることもできます。

 異なるクラスの要素を定義できるのと同様に、さまざまな種類のリンクを定義できます。 リンクのクラスは、 *ドメインリレーションシップ*と呼ばれます。 ドメインリレーションシップは、そのインスタンスが接続できる要素のクラスを指定します。 リレーションシップの各 end は *ロール*と呼ばれ、ドメインリレーションシップは、リレーションシップ自体に加えて、2つのロールの名前を定義します。

 ドメインリレーションシップには、埋め込みリレーションシップと参照リレーションシップの2種類があります。 DSL 定義図では、埋め込みリレーションシップに各ロールの実線が含まれており、参照リレーションシップに破線が付いています。

### <a name="embedding-relationships"></a>埋め込みリレーションシップ
 ルートを除く、モデル内のすべての要素は、1つの埋め込みリンクのターゲットです。 したがって、モデル全体では、埋め込みリンクの1つのツリーが形成されます。 埋め込みリレーションシップは、包含または所有権を表します。 このように関連付けられている2つのモデル要素は、親と子とも呼ばれます。 子は、親に埋め込まれていると言います。

 リンクの埋め込みは、通常、図のコネクタとして明示的に表示されるわけではありません。 代わりに、通常はコンテインメントによって表されます。 モデルのルートは図によって表され、図に埋め込まれている要素は図形としてダイアグラムに表示されます。

 この例では、ルートクラスの Music は、曲に AlbumHasSongs を埋め込む MusicHasAlbums という、アルバムへの埋め込みリレーションシップを持っています。 曲は、各アルバム内のリストに項目として表示されます。 また、音楽にはアーティストクラスへの MusicHasArtists が埋め込まれており、そのインスタンスも図に図形として表示されます。

 既定では、埋め込み要素は、親が削除されると自動的に削除されます。

 モデルを XML 形式でファイルに保存すると、シリアル化をカスタマイズしていない限り、埋め込み要素は親の内部に入れ子になります。

> [!NOTE]
> 埋め込みは継承とは異なります。 埋め込みリレーションシップの子は、親のプロパティを継承しません。 埋め込みは、モデル要素間のリンクの一種です。 継承はクラス間の関係であり、モデル要素間のリンクは作成しません。

### <a name="embedding-rules"></a>埋め込みルール
 インスタンスモデルのすべての要素は、モデルのルートを除き、1つの埋め込みリンクのターゲットである必要があります。

 したがって、ルートクラスを除くすべての非抽象ドメインクラスは、少なくとも1つの埋め込みリレーションシップのターゲットであるか、または基底クラスからの埋め込みを継承する必要があります。 クラスは2つ以上の埋め込みのターゲットにすることができますが、そのインスタンスモデル要素は一度に1つの親を持つことしかできません。 ターゲットからソースへの多重度は、0 ..1 または 1 ..1 でなければなりません。

### <a name="the-explorer-displays-the-embedding-tree"></a>エクスプローラーに埋め込みツリーが表示されます。
 DSL 定義では、モデル図と共にユーザーに表示されるエクスプローラーも作成されます。

 ![生成された DSL のエクスプローラー](../modeling/media/music_explorer.png)

 図を定義していない要素も含めて、モデル内のすべての要素がエクスプローラーに表示されます。 要素と埋め込みリレーションシップが示されますが、参照リレーションシップは表示されません。

 要素のドメインプロパティの値を表示するには、ユーザーがモデル図またはモデルエクスプローラーで要素を選択し、プロパティウィンドウを開きます。 ダイアグラムに表示されていないものも含め、すべてのドメインプロパティが表示されます。 この例では、各曲にタイトルとジャンルの両方がありますが、図にはタイトルの値のみが表示されています。

## <a name="reference-relationships"></a>参照リレーションシップ
 参照リレーションシップは、埋め込まれていない任意の種類のリレーションシップを表します。

 参照リレーションシップは、通常、図形間のコネクタとして図に表示されます。

 モデルの XML 表現では、2つの要素間の参照リンクがモニカーを使用して表され *ます。* つまり、モニカーは、モデル内の各要素を一意に識別する名前です。 各モデル要素の XML ノードには、リレーションシップの名前ともう一方の要素のモニカーを指定するノードが含まれています。

## <a name="roles"></a>ロール
 各ドメインリレーションシップには、ソースロールとターゲットロールという2つのロールがあります。

 次の図では、 **発行** 元ドメインクラスと **PublisherCatalog** ドメインリレーションシップの間の行がソースロールです。 ドメインリレーションシップと **アルバム** ドメインクラスの間の線は、ターゲットロールです。

 ![ロールおよびプロパティ](../modeling/media/propertycode.png)

 リレーションシップに関連付けられている名前は、モデルをトラバースするプログラムコードを記述するときに特に重要です。 たとえば、DSL ソリューションをビルドすると、生成されたクラスの発行元には、アルバムのコレクションであるプロパティカタログがあります。 クラスアルバムには、クラス Publisher の単一インスタンスであるプロパティ発行者があります。

 DSL 定義でリレーションシップを作成すると、プロパティ名とリレーションシップ名に既定値が与えられます。 ただし、変更することはできます。

## <a name="multiplicities"></a>多
 多重度は、ドメインリレーションシップで同じロールを持つことができる要素の数を指定します。 この例では、カタログロールの0対多 (0. \* .) の多重度**Catalog**設定によって、**発行元**ドメインクラスの任意のインスタンスが、指定した数の**PublisherCatalog**リレーションシップリンクを持つことができることが指定されています。

 図に入力するか `Multiplicity` 、[ **プロパティ** ] ウィンドウでプロパティを変更して、ロールの多重度を構成します。 次の表では、このプロパティの設定について説明します。

|複数要素の接続性の種類|説明|
|-|-|
|0.. * (0 個以上)|ドメインクラスの各インスタンスは、リレーションシップの複数のインスタンスを持つことができます。また、リレーションシップのインスタンスを持つこともできません。|
|0 ..1 (0 ~ 1)|ドメインクラスの各インスタンスは、リレーションシップのインスタンスを1つしか持つことができません。また、リレーションシップのインスタンスも存在しません。|
|1 ..1 (1)|ドメインクラスの各インスタンスは、リレーションシップのインスタンスを1つ持つことができます。 ロールクラスのインスタンスから、このリレーションシップのインスタンスを複数作成することはできません。 検証が有効になっている場合、ロールクラスのインスタンスにリレーションシップのインスタンスが存在しないときに検証エラーが表示されます。|
|1.. * (1 対多)|この多重度を持つロールのクラスの各インスタンスは、リレーションシップの複数のインスタンスを持つことができ、各インスタンスにはリレーションシップのインスタンスが少なくとも1つ存在する必要があります。 検証が有効になっている場合、ロールクラスのインスタンスにリレーションシップのインスタンスが存在しないときに検証エラーが表示されます。|

## <a name="domain-relationships-as-classes"></a>クラスとしてのドメインリレーションシップ
 リンクは、ModelElement の派生クラスである LinkElement のインスタンスとしてストアに表されます。 ドメインリレーションシップでは、ドメインモデルダイアグラムでこれらのプロパティを定義できます。

 また、他のリレーションシップのソースまたはターゲットとのリレーションシップを作成することもできます。 ドメインモデルダイアグラムで、ドメインリレーションシップを右クリックし、[ **クラスとして表示**] をクリックします。 [クラスの追加] ボックスが表示されます。 これにより、リレーションシップを接続できます。

 ドメインクラスの場合と同様に、継承によってリレーションシップを定義できます。 派生リレーションシップを選択し、プロパティウィンドウで **基本リレーションシップ** を設定します。

 派生リレーションシップは、その基本リレーションシップを専門としています。 リンク先のドメインクラスは、基本リレーションシップによってリンクされたクラスから派生する必要があります。 派生したリレーションシップのリンクがモデル内に作成されると、派生リレーションシップと基本リレーションシップの両方のインスタンスになります。 プログラムコードでは、ベースまたは派生クラスのいずれかによって生成されたプロパティを使用して、リンクの反対側の端に移動できます。

## <a name="see-also"></a>こちらもご覧ください

- [ドメイン固有言語ツールの用語集](https://msdn.microsoft.com/ca5e84cb-a315-465c-be24-76aa3df276aa)
