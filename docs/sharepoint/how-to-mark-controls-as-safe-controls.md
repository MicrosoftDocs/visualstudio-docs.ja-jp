---
title: "方法: コントロールを安全なコントロールとしてマークする"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "安全なコントロール [Visual Studio での SharePoint 開発]"
  - "Visual Studio での SharePoint 開発, 高度なパッケージ化ツール"
  - "Visual Studio での SharePoint 開発, 安全なコントロール"
ms.assetid: 813727d5-6750-407c-a23e-c38dd611e78c
caps.latest.revision: 16
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 15
---
# 方法: コントロールを安全なコントロールとしてマークする
  SharePoint では、セキュリティのために、スクリプト インジェクションから保護されている Web コントロールと保護されていない Web コントロールが区別されます。  保護されているコントロール \(*安全なコントロール*\) には、信頼されていないユーザーもアクセスできます。  コントロールを安全としてマークするには、SharePoint プロジェクト項目の \[安全なコントロール エントリ\] プロパティを使用するか、パッケージにアセンブリを追加するときに**パッケージ デザイナー**を使用して設定します。  詳細については、次のトピックを参照してください  
  
 [web.config ファイルの設定の変更](http://go.microsoft.com/fwlink/?LinkId=178965) および  のイベント ハンドラーに配置する必要があります。[安全なコントロールとして Web Part Assembly の登録](http://go.microsoft.com/fwlink/?LinkId=171013)  
  
> [!IMPORTANT]  
>  以降の手順は、単に説明のために記載されています。  コントロールを安全としてマークするのは、安全であることがわかっている場合だけにしてください。  
  
## \[安全なコントロール エントリ\] プロパティでの安全なコントロールの指定  
  
#### \[安全なコントロール エントリ\] プロパティでコントロールを安全または安全でないとしてマークするには  
  
1.  可視 Web パーツ プロジェクトを含む SharePoint ソリューションを作成します。  
  
2.  テキスト ボックスとボタンの 2 つのコントロールを Web パーツに追加します。  名前は既定値 \(TextBox1 と Button1\) のままにしておきます。  
  
3.  Web パーツの **\[安全なコントロール エントリ\]** プロパティに 2 つのエントリを追加します。  これを行うには、**\[プロパティ\]** ウィンドウの **\[安全なコントロール エントリ\]** のプロパティの横にある省略記号 \(![ASP.NET モバイル デザイナー楕円](../sharepoint/media/mwellipsis.png "ASP.NET モバイル デザイナー楕円")\) ボタンをクリックします。  
  
     **\[安全なコントロール エントリ\]** ダイアログ ボックスが表示されます。  
  
4.  **\[安全なコントロール エントリ\]** ダイアログ ボックスで、**\[メンバー\]** のペインに 2 個の安全なコントロール エントリを追加するに **\[追加\]** ボタンの倍を選択する: ボタンの 1 とテキスト ボックスの 1。  
  
5.  一つ目の安全なコントロール エントリを選択し、**\[False\]** に **\[Button1\]** に **\[安全\]** のプロパティ、**\[型の名前\]** のプロパティ、および **\[False\]** に **\[スクリプトに対して安全\]** のプロパティの値を変更します。  
  
     これにより、このボタン コントロールは、安全でないコントロールとして指定されました。  
  
6.  リスト内の 2 番目の安全なコントロール エントリを選択します。  **\[安全\]** のプロパティの値を **\[True\]** としておき、**\[TextBox1\]** に **\[型の名前\]** のプロパティと **\[True\]** に **\[スクリプトに対して安全\]** のプロパティを設定します。  
  
     これにより、このテキスト ボックス コントロールは、スクリプト インジェクションに対して安全なコントロールとしてマークされました。  
  
7.  ダイアログ ボックスを閉じるに **\[OK\]** ボタンをクリックします。  
  
## パッケージ デザイナーでの安全なコントロールの指定  
  
#### パッケージ デザイナーでコントロールを安全または安全でないとしてマークするには  
  
1.  可視 Web パーツ プロジェクトを含む SharePoint ソリューションを作成します。  
  
2.  テキスト ボックスとボタンの 2 つのコントロールを Web パーツに追加します。  名前は既定値 \(TextBox1 と Button1\) のままにしておきます。  
  
     後ほど使用するため、コントロールの名前空間を控えておきます。  
  
3.  メニュー バーで、プロジェクトをビルドするには、**\[ソリューションのビルド\]\[ビルド\]** をクリックします。  
  
4.  SharePoint ソリューションをもう 1 つ作成します。  
  
5.  **\[ソリューション エクスプローラー\]** で、Package.Package ファイルのショートカット メニューを開き、**\[パッケージ デザイナー\]** を開くに **\[開く\]** をクリックします。  
  
6.  **\[パッケージ デザイナー\]** で、**\[詳細\]** タブをクリックします。  
  
7.  **\[追加アセンブリ\]** で、**\[追加\]** をクリックし、一覧から **\[既存のアセンブリの追加\]** をクリックします。  
  
8.  **\[既存のアセンブリの追加\]** ダイアログ ボックスで、**\[ソース パス\]** の横にある省略記号 \(![ASP.NET モバイル デザイナー楕円](../sharepoint/media/mwellipsis.png "ASP.NET モバイル デザイナー楕円")\) ボタンをクリックします。  
  
9. アセンブリが、手順 1 で作成した選択し、**\[開く\]** ボタンをクリックします。SharePoint ソリューションから。  
  
10. この例では、**\[配置ターゲット\]** オプションは "GlobalAssemblyCache" のままにしておきます。  
  
     これにより、アセンブリがシステムのグローバル アセンブリ キャッシュ \(GAC: Global Assembly Cache\) に配置されます。  アセンブリを Web アプリケーション \(Bin\) フォルダーに配置する場合は、代わりにそのオプションを選択します。  詳細については、参照します [SharePoint Foundation の Deploying Web Parts](http://go.microsoft.com/fwlink/?LinkId=177509)。  
  
11. **\[安全なコントロール\]** ボックスで、**\[新しい項目を追加するにはここをクリックします\]** ボタンをクリックします。  
  
12. 次の表を使用してプロパティの値を入力します。  
  
    |プロパティ名|値|  
    |------------|-------|  
    |名前空間|コントロールの完全修飾名前空間 \("**BdcModelProject1.VisualWebPart1**" など\)。|  
    |型の名前|Button1|  
    |アセンブリ名|厳密なアセンブリ名 \("Microsoft.Office.SharePoint.ClientExtensions, Version\=14.0.0.0, Culture\=neutral, PublicKeyToken\=71e9bce111e9429c" など\)。|  
    |\[安全\]|**\[安全\]** チェック ボックスをオフにします。|  
    |\[スクリプトに対して安全\]|**\[スクリプトに対して安全\]** チェック ボックスをオフのままにします。|  
  
    > [!NOTE]  
    >  **パッケージ デザイナー**の **\[詳細設定\]** タブを使用して追加したアセンブリでは、**\[アセンブリ名\]** の値をトークンにすることはできません。厳密な名前付きアセンブリを指定する必要があります。  詳細については、参照します [Creating and Using Strong\-Named Assemblies](http://go.microsoft.com/fwlink/?LinkId=177513)。  
  
13. 安全なコントロール エントリをもう一つ作成するには、Tab キーを押します。  
  
14. **\[新しい項目を追加するにはここをクリックします\]** ボタンをもう一度クリックします。  
  
15. 次の表を使用してプロパティの値を入力します。  
  
    |プロパティ名|値|  
    |------------|-------|  
    |名前空間|コントロールの完全修飾名前空間 \("**BdcModelProject1.VisualWebPart1**" など\)。|  
    |型の名前|TextBox1|  
    |アセンブリ名|厳密なアセンブリ名 \("Microsoft.Office.SharePoint.ClientExtensions, Version\=14.0.0.0, Culture\=neutral, PublicKeyToken\=71e9bce111e9429c" など\)。|  
    |\[安全\]|**\[安全\]** チェック ボックスをオンにします。|  
    |\[スクリプトに対して安全\]|**\[スクリプトに対して安全\]** チェック ボックスをオンにします。|  
  
16. Tab キーを選択し、ダイアログ ボックスを閉じるに **\[OK\]** ボタンをクリックします。  
  
## 参照  
 [プロジェクト項目でのパッケージ化と配置の情報の提供](../sharepoint/providing-packaging-and-deployment-information-in-project-items.md)   
 [SharePoint ソリューションのパッケージ化と配置](../sharepoint/packaging-and-deploying-sharepoint-solutions.md)  
  
  