---
title: SharePoint のサイト列、コンテンツ タイプ、リストの作成
titleSuffix: ''
description: このチュートリアルでは、カスタムのサイト列 (フィールド)、サイト列を使用するカスタムのコンテンツ タイプ、SharePoint でコンテンツ タイプを使用するリストを作成します。
ms.custom: SEO-VS-2020
ms.date: 02/02/2017
ms.topic: how-to
f1_keywords:
- VS.SharePointTools.ListDesigner.GeneralMessageHelp
- Microsoft.VisualStudio.SharePoint.Designers.ListDesigner.ViewModels.ListViewModel.SortingAndGrouping
- VS.SharePointTools.ListDesigner.SortingGrouping
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- SharePoint development in Visual Studio, list definitions
- SharePoint development in Visual Studio, list instances
- SharePoint development in Visual Studio, fields
- SharePoint development in Visual Studio, content types
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: d205203797d8bd50c7b3132df86fbff9dbad1771
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/08/2021
ms.locfileid: "99937694"
---
# <a name="walkthrough-create-a-site-column-content-type-and-list-for-sharepoint"></a>チュートリアル: SharePoint のサイト列、コンテンツ タイプ、リストの作成
  次の手順では、カスタムの SharePoint サイト列 (または "*フィールド*") と、サイト列を使用するコンテンツ タイプを作成する方法について説明します。 また、新しいコンテンツ タイプを使用するリストを作成する方法も示します。

 このチュートリアルでは、次のタスクについて説明します。

- [カスタム サイト列の作成](#create-custom-site-columns)。

- [カスタム コンテンツ タイプの作成](#create-a-custom-content-type)。

- [リストの作成](#create-a-list)。

- [アプリケーションのテスト](#test-the-application)。

  [!INCLUDE[note_settings_general](../sharepoint/includes/note-settings-general-md.md)]

## <a name="prerequisites"></a>必須コンポーネント
 このチュートリアルを実行するには、次のコンポーネントが必要です。

- サポート対象エディションの Windows と SharePoint

- [!INCLUDE[vsprvs-current](../sharepoint/includes/vsprvs-current-md.md)]

## <a name="create-custom-site-columns"></a>カスタム サイト列の作成
 この例では、病院で患者を管理するためのリストを作成します。 まず、[!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] で SharePoint プロジェクトを作成し、次のようにサイト列を追加する必要があります。

#### <a name="to-create-the-project"></a>プロジェクトを作成するには

1. [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] **[ファイル]** メニューで、 **[新規]**  >  **[プロジェクト]** の順にクリックします。
::: moniker range="=vs-2017"
2. **[新しいプロジェクト]** ダイアログ ボックスで、 **[Visual C#]** または **[Visual Basic]** の **[Office/SharePoint]** ノードを展開し、 **[SharePoint ソリューション]** を選択します。

3. **[テンプレート]** ウィンドウで、インストールした SharePoint の特定のバージョンに対応する **SharePoint の空のプロジェクト** を選択します。 たとえば、SharePoint 2016 がインストールされている場合は、 **[SharePoint 2016 - 空のプロジェクト]** テンプレートを選択します。  

4. プロジェクトの名前として「**クリニック**」と入力し、 **[OK]** をクリックします。

5. **[デバッグのサイトとセキュリティ レベルの指定]** ダイアログで、新しいカスタム フィールド項目を追加するローカル SharePoint サイトの URL を入力するか、既定の場所 (`http://<`*SystemName*`>/)` を使用します。

6. **[この SharePoint ソリューションの信頼レベル]** セクションで、デフォルト値の **[サンドボックス ソリューションとして配置する]** を使用します。

     サンドボックス ソリューションとファーム ソリューションの詳細については、「[サンドボックス ソリューションの考慮事項](../sharepoint/sandboxed-solution-considerations.md)」を参照してください。

7. **[完了]** をクリックします。 これで、プロジェクトが **ソリューション エクスプローラー** に一覧表示されます。
::: moniker-end
::: moniker range=">=vs-2019"
2.  **[新しいプロジェクトの作成]** ダイアログで、インストールした SharePoint の特定のバージョンに対応する **SharePoint の空のプロジェクト** を選択します。 たとえば、SharePoint 2016 がインストールされている場合は、 **[SharePoint 2016 - 空のプロジェクト]** テンプレートを選択します。
    [!INCLUDE[new-project-dialog-search](../sharepoint/includes/new-project-dialog-search-md.md)]

3. プロジェクトの名前として「**クリニック**」と入力し、 **[作成]** ボタンをクリックします。

4. **[デバッグのサイトとセキュリティ レベルの指定]** ダイアログで、新しいカスタム フィールド項目を追加するローカル SharePoint サイトの URL を入力するか、既定の場所 (`http://<`*SystemName*`>/)` を使用します。

5. **[この SharePoint ソリューションの信頼レベル]** セクションで、デフォルト値の **[サンドボックス ソリューションとして配置する]** を使用します。

     サンドボックス ソリューションとファーム ソリューションの詳細については、「[サンドボックス ソリューションの考慮事項](../sharepoint/sandboxed-solution-considerations.md)」を参照してください。

6. **[完了]** をクリックします。 これで、プロジェクトが **ソリューション エクスプローラー** に一覧表示されます。
::: moniker-end

#### <a name="to-add-site-columns"></a>サイト列を追加するには

1. 新しいサイト列を追加します。 これを行うには、**ソリューション エクスプローラー** で **[クリニック]** プロジェクトを右クリックし、 **[追加]**  >  **[新しい項目]** を選択します。

2. **[新しい項目の追加]** ダイアログ ボックスで **[サイト列]** を選択し、名前を「**患者名**」に変更して、 **[追加]** ボタンをクリックします。

3. サイト列の *Elements.xml* ファイルで、 **[型]** 設定を **[テキスト]** のままにし、 **[グループ]** 設定を **[クリニックのサイト列]** に変更します。 完了すると、サイト列の *Elements.xml* ファイルは次の例のようになります。

    ```xml
    <Field
         ID="{f9ba60d1-5631-41fb-b016-a38cf48eef63}"
         Name="PatientName"
         DisplayName="Patient Name"
         Type="Text"
         Required="FALSE"
         Group="Clinic Site Columns">
    </Field>
    ```

    > [!TIP]
    > [サイト列] の名前にキャメル ケース形式を使用すると、表示名にスペースが自動で追加されます。
    > SharePoint にソリューションを配置しようとすると問題が発生する可能性があるため、[サイト列] の名にスペースを使用しないことをお勧めします。

4. 同じ手順を使用して、さらに 2 つのサイト列をプロジェクトに追加します。 **[患者 ID]** ([型] = [整数]) と **[医師名]** ([型] = [テキスト]) です。 [グループ] 値を **[クリニックのサイト列]** に設定します。

## <a name="create-a-custom-content-type"></a>カスタム コンテンツ タイプの作成
 次に、前の手順で作成したサイト列を含むコンテンツ タイプを [連絡先] コンテンツ タイプに基づいて作成します。 コンテンツ タイプを既存のコンテンツ タイプに基づくことで、新しいコンテンツ タイプで使用する複数のサイト列が基になるコンテンツ タイプによって提供されるため、時間を節約できます。

#### <a name="to-create-a-custom-content-type"></a>カスタム コンテンツ タイプを作成するには

1. プロジェクトにコンテンツ タイプを追加します。 これを行うには、**ソリューション エクスプローラー** で、プロジェクト ノードを選択します。

2. メニュー バーで **[プロジェクト]**  >  **[新しい項目の追加]** の順に選択します。

3. **[Visual C#]** または **[Visual Basic]** で **[SharePoint]** ノードを展開し、 **[2010]** ノードを選択します。

4. **[テンプレート]** ウィンドウで、 **[コンテンツ タイプ]** テンプレートを選択し、名前を「**患者情報**」に変更して、 **[追加]** ボタンを選択します。

     **SharePoint カスタマイズ ウィザード** が開きます。

5. **[このコンテンツ タイプの継承元となる基本コンテンツ タイプ]** で、新しいコンテンツ タイプの基になるコンテンツ タイプとして **[連絡先]** を選択し、 **[完了]** ボタンを選択します。

     これにより、以前に定義したサイト列に加えて、[連絡先] コンテンツ タイプの他の便利なサイト列にもアクセスできるようになります。

6. コンテンツ タイプ デザイナーが表示されたら、 **[列]** タブで、前に定義した 3 つのサイト列 ( **[患者名]** 、 **[患者 ID]** 、および **[医師名]** ) を追加します。 これらの列を追加するには、 **[表示名]** のサイト列リストで最初のリスト ボックスを選択し、リスト内の各サイト列を 1 つずつ選択します。

    > [!TIP]
    > サイト列をより迅速に選択するには、列名の最初の数文字を入力してリストをフィルター処理します。

7. 3 つのカスタム サイト列に加えて、サイト列リストから **[コメント]** サイト列を追加します。

8. **[患者名]** と **[患者 ID]** サイト列の **[必須]** チェック ボックスをオンにして、必須フィールドにします。

9. **[コンテンツ タイプ]** タブで、コンテンツ タイプの名前が **[患者情報]** になっていることを確認し、説明を「**患者情報カード**」に変更します。

10. **[グループ名]** を **[クリニック コンテンツ タイプ]** に変更し、その他の設定は既定値のままにします。

11. メニューバーで、 **[ファイル]**  >  **[すべてを保存]** の順に選択し、コンテンツ タイプ デザイナーを閉じます。

## <a name="create-a-list"></a>リストを作成する
 次に、新しいコンテンツ タイプとサイト列を使用するリストを作成します。

#### <a name="to-create-a-list"></a>リストを作成するには

1. プロジェクトにリストを追加します。 これを行うには、**ソリューション エクスプローラー** で、プロジェクト ノードを選択します。

2. メニュー バーで **[プロジェクト]**  >  **[新しい項目の追加]** の順に選択します。

3. **[Visual C#]** または **[Visual Basic]** の **[SharePoint]** ノードを展開します。

4. **[テンプレート]** ウィンドウで、 **[リスト]** テンプレートを選択し、名前を「**患者**」に変更して、 **[追加]** ボタンを選択します。

5. **[リストをカスタマイズする基準]** 設定を **[既定 (カスタム リスト)]** のままにして、 **[完了]** ボタンを選択します。

6. リスト デザイナーで **[コンテンツ タイプ]** ボタンをクリックして、 **[コンテンツ タイプ設定]** ダイアログ ボックスを表示します。

7. 新しい行を選択し、コンテンツ タイプのリストで **[患者情報]** コンテンツ タイプを選択し、 **[OK]** ボタンをクリックします。

     これにより、 **[患者情報]** コンテンツ タイプのすべてのサイト列がリストに追加されます。

8. 次の項目を除く、リスト内のすべてのサイト列を削除します。

    - 患者 ID

    - 患者名

    - 自宅電話番号

    - 電子メール

    - 医師名

    - コメント

9. **[列の表示名]** で、空の行を選択し、カスタム リスト列を追加し、「**病院**」という名前を付けます。 データ型は **[1 行テキスト]** のままにします。

     カスタム リスト列は、このリストにのみ適用されます。 リストにカスタム リスト列を追加すると、リストに追加されたすべての列を含む新しいリスト コンテンツ タイプが作成され、既定のリストとして設定されます。

    > [!TIP]
    > サイト列のリストから列を選択すると、既存のサイト列が使用されます。 ただし、リストの列を選択せずに列名の値を入力すると、同じ名前の列が既にリストに存在する場合でも、カスタム リスト列が作成されます。

     必要に応じて、カスタム リスト列のデータ型を **[1 行テキスト]** に設定するのではなく、この列のデータ型を [参照] に設定し、その値をテーブルまたは別のリストから取得することもできます。 参照列の詳細については、[SharePoint 2010 でのリスト リレーションシップ](/previous-versions/msp-n-p/ff798514(v=pandp.10))に関するページ、および[参照とリスト リレーションシップ](/previous-versions/office/developer/sharepoint-2010/ff623048(v=office.14))に関するページを参照してください。

10. **[患者 ID]** および **[患者名]** ボックスの横にある **[必須]** チェック ボックスをオンにします。

11. **[ビュー]** タブで、ビューを作成するための空の行を選択します。 **[ビュー名]** 列の下の空白行に「**患者の詳細**」と入力します。

     **[ビュー]** タブで、SharePoint リストに表示する列を指定できます。

12. 新しい **[患者の詳細]** 行を選択し、 **[既定値として設定]** ボタンを選択します。

     新しいビューは、リストの既定のビューになります。

13. 次の列を **[選択された列]** リストに次の順序で追加します。

    - 患者 ID

    - 患者名

    - 自宅電話番号

    - 電子メール

    - 医師名

    - 病院

    - コメント

14. **[プロパティ]** リストで、 **[並べ替えとグループ化]** プロパティを選択し、省略記号ボタン ![省略記号アイコン](../sharepoint/media/ellipsisicon.gif "省略記号アイコン") をクリックして **[並べ替えとグループ化]** ダイアログ ボックスを表示します。

15. **[列名]** リストで、 **[患者名]** を選択し、 **[並べ替え]** 列が **[昇順]** に設定されていることを確認してから、 **[OK]** ボタンを選択します。

## <a name="test-the-application"></a>アプリケーションをテストする
 カスタムのサイト列、コンテンツ タイプ、およびリストの準備ができたので、SharePoint に配置し、アプリケーションを実行してテストします。

#### <a name="to-test-the-application"></a>アプリケーションをテストするには

1. メニュー バーで、 **[ファイル]**  >  **[すべてを保存]** の順に選択します。

2. **F5** キーを選択してアプリケーションを実行します。

     アプリケーションがコンパイルされ、その機能が SharePoint に配置され、アクティブ化されます。

3. クイック ナビゲーション バーで、 **[患者]** リンクを選択して、 **[患者]** リストを表示します。

     リストの列名は、[!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] の **[ビュー]** タブで入力したものと一致している必要があります。

4. **[新しい項目の追加]** リンクを選択して、患者情報カードを作成します。

5. フィールドに情報を入力し、 **[保存]** ボタンを選択します。

     新しいレコードがリストに表示されます。

## <a name="see-also"></a>関連項目
- [SharePoint のサイト列、コンテンツ タイプ、リストの作成](../sharepoint/creating-site-columns-content-types-and-lists-for-sharepoint.md)
- [SharePoint ソリューションの開発](../sharepoint/developing-sharepoint-solutions.md)
- [方法: カスタムのフィールドの種類を作成する](/previous-versions/office/developer/sharepoint-2010/bb862248(v=office.14))
- [コンテンツ タイプ](/previous-versions/office/developer/sharepoint-2010/ms479905(v=office.14))
- [[列]](/previous-versions/office/developer/sharepoint-2010/ms196085(v=office.14))
