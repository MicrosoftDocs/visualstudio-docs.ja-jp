---
title: "方法: 特定のリスト インスタンスに対するイベント レシーバーを作成する | Microsoft Docs"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "イベント レシーバー [Visual Studio での SharePoint 開発]"
  - "Visual Studio での SharePoint 開発, イベント レシーバー"
ms.assetid: 4b4b3564-161a-4327-8963-50896c084ac2
caps.latest.revision: 13
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 12
---
# 方法: 特定のリスト インスタンスに対するイベント レシーバーを作成する
  リスト インスタンス イベント レシーバーは、リスト定義のインスタンスで発生したイベントに応答します。  イベント レシーバー テンプレートでは、特定のリスト インスタンスをターゲットにすることはできませんが、リスト定義をスコープとするイベント レシーバーを特定のリスト インスタンス内のイベントに応答するように変更できます。  
  
 特定のリスト インスタンスをターゲットにするには、イベント レシーバーの Elements.xml で `ListTemplateId` を `ListUrl` に置き換え、リスト インスタンスの URL を追加します。  
  
## リスト インスタンス イベント レシーバーの作成  
 次の手順では、リスト項目イベント レシーバーをカスタムお知らせリスト インスタンスで発生したイベントにのみ応答するように変更する方法を示します。  
  
#### イベント レシーバーを特定のリスト インスタンスに応答するように変更するには  
  
1.  ブラウザーで SharePoint サイトを開きます。  
  
2.  ナビゲーション ペインで、**\[リスト\]** リンク。  
  
3.  **\[すべてのサイト コンテンツ\]** ページで、**\[作成\]** リンクをクリックします。  
  
4.  **\[作成\]** ダイアログ ボックスで、**\[お知らせ\]** の種類を選択し、TestAnnouncements お知らせを付けておくと、**\[作成\]** ボタンをクリックします。  
  
5.  [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] で、イベント レシーバー プロジェクトを作成します。  
  
6.  **\[使用するイベント レシーバーの種類\]** の一覧で、**\[リスト項目イベント\]** をクリックします。  
  
    > [!NOTE]  
    >  リスト定義をスコープとする他の種類のイベント レシーバーも選択できます \(**\[リスト電子メール イベント\]** や **\[リスト ワークフロー イベント\]** など\)。  
  
7.  **\[イベント ソースとなる項目\]** の一覧で、**\[お知らせ\]** をクリックします。  
  
8.  **\[次のイベントを処理\]** の一覧で、**\[項目が追加されています\]** のチェック ボックスをオンにし、**\[完了\]** ボタンをクリックします。  
  
9. **\[ソリューション エクスプローラー\]** で、EventReceiver1 で、Elements.xml ファイルを開きます。  
  
     イベント レシーバーは、次の行で、現在、お知らせリスト定義を参照する:  
  
    ```  
    <Receivers ListTemplateId="104">  
    ```  
  
     次のテキストに次の行を変更する:  
  
    ```  
    <Receivers ListUrl="Lists/TestAnnouncements">  
    ```  
  
     この行は、作成したばかりの新しい **TestAnnouncements** お知らせリストで発生したイベントだけに応答するようにイベント レシーバーに命令します。  `ListURL` 属性は、SharePoint サーバーの任意のリスト インスタンスを参照するように変更できます。  
  
10. イベント レシーバーのコード ファイルを開き、ItemAdding メソッドの中にブレークポイントを配置します。  
  
11. ソリューションをビルドして実行するには、F5 キーを押します。  
  
12. SharePoint のナビゲーション ペインで、**\[TestAnnouncements\]** リンクをクリックします。  
  
13. **\[新しいお知らせの追加\]** リンクをクリックします。  
  
14. お知らせのタイトルを入力し、**\[保存\]** ボタンをクリックします。  
  
     カスタムお知らせリストに新しい項目が追加されると、ブレークポイントにヒットします。  
  
15. 再開するには、F5 キーを押します。  
  
16. ナビゲーション ペインで、**\[リスト\]** リンクを選択し、**\[お知らせ\]** リンクをクリックします。  
  
17. 新しいお知らせを追加します。  
  
     このイベント レシーバーは、カスタムお知らせリスト インスタンス **TestAnnouncements** のイベントにのみ応答するように構成されているので、新しいお知らせではトリガーされません。  
  
## 参照  
 [方法: イベント レシーバーを作成する](../sharepoint/how-to-create-an-event-receiver.md)   
 [Developing SharePoint Solutions](../sharepoint/developing-sharepoint-solutions.md)  
  
  