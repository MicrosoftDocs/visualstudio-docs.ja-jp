---
title: テスト エクスプローラーによる単体テストの実行、ビルド、およびデバッグ
description: Visual Studio でテスト エクスプローラーを使用してテストを実行する方法について説明します。 このトピックでは、ビルドの後の自動テストの実行の有効化、テスト結果の表示、テストの一覧のグループ化とフィルター処理、再生リストの作成、テストのデバッグ、およびテストのショートカットの使用方法について説明します。
ms.date: 11/04/2016
ms.prod: visual-studio-dev15
ms.topic: conceptual
f1_keywords:
- vs.unittesting.testexplorer.overview
ms.author: gewarren
manager: jillfra
ms.workload:
- multiple
author: gewarren
ms.openlocfilehash: fd829083cc86d16dd01186bd848c6bc29c062ef5
ms.sourcegitcommit: 2193323efc608118e0ce6f6b2ff532f158245d56
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/25/2019
ms.locfileid: "55000312"
---
# <a name="run-unit-tests-with-test-explorer"></a>テスト エクスプローラーを使用して単体テストを実行する

**テスト エクスプローラー**を使用し、Visual Studio またはサードパーティの単体テスト プロジェクトから単体テストを実行します。 **テスト エクスプローラー**を使用し、テストをカテゴリにまとめたり、テストの一覧にフィルターを適用したり、テストのプレイリストを実行したりすることもできます。 テストをデバッグし、テストのパフォーマンスとコード カバレッジを分析できます。

Visual Studio には、マネージド コードおよびネイティブ コード用の Microsoft 単体テスト フレームワークが含まれます。 ただし、**テスト エクスプローラー**では、テスト エクスプローラーのアダプターを実装した単体テスト フレームワークも実行できます。 サードパーティの単体テスト フレームワークのインストールの詳細については、「[サードパーティ製の単体テスト フレームワークをインストールする](../test/install-third-party-unit-test-frameworks.md)」を参照してください。

**テスト エクスプローラー**は、ソリューション内の複数のテスト プロジェクト、および運用コード プロジェクトに含まれるテスト クラスからテストを実行できます。 テスト プロジェクトは別の単体テスト フレームワークを使用できます。 テスト対象のコードを .NET Framework 用に記述する場合、対象コードの言語にかかわらず、.NET Framework も対象とする言語でテスト プロジェクトを記述できます。 ネイティブ C/C++ コード プロジェクトは、C++ の単体テスト フレームワークを使用してテストする必要があります。 詳細については、[C/C++ 用の単体テストの作成](writing-unit-tests-for-c-cpp.md)に関するページを参照してください。

## <a name="run-tests-in-test-explorer"></a>テスト エクスプローラーでテストを実行する

テスト プロジェクトをビルドすると、テストはテスト エクスプローラーに表示されます。 テスト エクスプローラーが表示されない場合は、Visual Studio メニューの **[テスト]** をクリックし、 **[Windows]**、 **[テスト エクスプローラー]** の順に選択します。

![単体テスト エクスプローラー](../test/media/ute_failedpassednotrunsummary.png)

テストを実行して、記述し、再実行すると、テスト エクスプローラーに **[失敗したテスト]**、 **[成功したテスト]**、 **[スキップされたテスト]** 、および **[テストを実行しない]** の既定のグループの結果が表示されます。 テスト エクスプローラーでテストをグループ化する方法を変更できます。

**テスト エクスプローラー**のツール バーからテストの検索、整理、実行の作業の多くを行うことができます。

![テスト エクスプローラー ツールバーからテストを実行](../test/media/ute_toolbar.png)

### <a name="run-tests"></a>テストの実行

ソリューション内のすべてのテスト、グループ内のすべてのテスト、または選択した一連のテストを実行できます。 次のいずれかの操作を行います。

- ソリューション内のすべてのテストを実行するには、 **[すべて実行]** をクリックします。

- 既定のグループ内のすべてのテストを実行するには、**[実行]** をクリックし、メニューでグループを選択します。

- 実行する個々のテストを選択し、選択したテストの右クリック メニューを開いて、**[選択したテストの実行]** を選択します。

- 個々のテストに実行順序を定める依存関係がない場合、ツール バーにある ![UTE&#95;parallelicon&#45;small](../test/media/ute_parallelicon-small.png) トグル ボタンで並列テストの実行を有効にします。 これにより、すべてのテスト実行にかかる時間を著しく短縮できます。

テストの実行中、**テスト エクスプローラー ウィンドウ**の一番上にある**成功/失敗ステータス バー**がアニメーション化されます。 テストの実行の終了時に、すべてのテストが成功した場合は、**成功/失敗ステータス バー**が緑色に変わり、いずれかのテストが失敗した場合は、赤色に変わります。

### <a name="run-tests-after-every-build"></a>各ビルドの後にテストを実行する

|ボタン|説明|
|-|-|
|![ビルド後に実行](../test/media/ute_runafterbuild_btn.png)|各ローカル ビルドの後で単体テストを実行するには、標準のメニューの **[テスト]** を選択し、**テスト エクスプローラー**のツール バーの **[ビルド後にテストを実行]** を選択します。|

## <a name="view-test-results"></a>テスト結果を表示する

テストを実行して、記述し、再実行すると、テスト エクスプローラーに **[失敗したテスト]**、 **[成功したテスト]**、 **[スキップされたテスト]** 、および **[テストを実行しない]** のグループの結果が表示されます。 テスト エクスプローラーの下部の詳細ペインに、テストの実行の概要が表示されます。

### <a name="view-test-details"></a>テストの詳細を表示する

個々のテストの詳細を表示するには、そのテストを選択します。

![テスト実行の詳細](../test/media/ute_testdetails.png)

テストの詳細ペインに次の情報が表示されます。

- テスト メソッドのソース ファイル名と行番号。

- テストの状態。

- テスト メソッドの実行に要した経過時間。

テストが失敗した場合、詳細ペインには次の情報も表示されます。

- テストの単体テスト フレームワークによって返されたメッセージ。

- テストが失敗した時刻のスタック トレース。

### <a name="view-the-source-code-of-a-test-method"></a>テスト メソッドのソース コードを表示する

 Visual Studio エディターでテスト メソッドのソース コードを表示するには、テストを選択し、右クリック メニューの **[テストを開く]** を選択します (キーボード:**F12** キー)。

## <a name="group-and-filter-the-test-list"></a>テスト リストをグループ化およびフィルター処理する

テスト エクスプローラーを使用すると、テストを定義済みのカテゴリにグループ化できます。 テスト エクスプローラーで実行されるほとんどの単体テスト フレームワークでは、独自のカテゴリおよびカテゴリ/値のペアを定義して、テストをグループ化することができます。 テストのプロパティに対して文字列を照合して、テストの一覧をフィルター処理することもできます。

### <a name="group-tests-in-the-test-list"></a>テストの一覧のテストをグループ化する

 テストの編成方法を変更するには、**[グループ化]** ボタン ![テスト エクスプローラー グループ ボタン](../test/media/ute_groupby_btn.png)の横にある下向き矢印を選択し、新しいグループ化の条件を選択します。

 ![テスト エクスプローラーでテストをカテゴリ別にグループ化する](../test/media/ute_groupbycategory.png)

### <a name="test-explorer-groups"></a>テスト エクスプローラーのグループ

|グループ化|説明|
|-|-----------------|
|**期間**|実行時間によるテストのグループ化:**高速**、**中**、**低速**|
|**Outcome**|実行結果によるテストのグループ化:**失敗したテスト**、**スキップされたテスト**、**成功したテスト数**|
|**Traits**|ユーザーが定義するカテゴリ/値のペアによるテストのグループ化。 特徴のカテゴリと値を指定する構文は、単体テスト フレームワークによって定義されます。|
|**プロジェクト**|プロジェクトの名前によるテストのグループ化。|

### <a name="group-by-traits"></a>特徴でグループ化する

 通常、特徴はカテゴリ名/値のペアですが、1 つのカテゴリにすることもできます。 特徴は、単体テスト フレームワークによってテスト メソッドとして識別されるメソッドに割り当てることができます。 単体テスト フレームワークは、特徴のカテゴリを定義できます。 特徴のカテゴリに値を追加して、独自のカテゴリ名/値のペアを定義できます。 特徴のカテゴリと値を指定する構文は、単体テスト フレームワークによって定義されます。

 **マネージド コード用の Microsoft 単体テスト フレームワークでの特徴の定義**

 マネージド アプリケーション用の Microsoft 単体テスト フレームワークで、<xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestPropertyAttribute> 属性の特徴の名前/値のペアを定義します。 テスト フレームワークには、次の定義済みの特徴も含まれています。

|特徴|説明|
|-|-----------------|
|<xref:Microsoft.VisualStudio.TestTools.UnitTesting.OwnerAttribute>|所有者カテゴリは、単体テスト フレームワークによって定義されます。所有者の文字列値を指定する必要があります。|
|<xref:Microsoft.VisualStudio.TestTools.UnitTesting.PriorityAttribute>|優先度カテゴリは、単体テスト フレームワークによって定義されます。優先度の整数値を指定する必要があります。|
|<xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestCategoryAttribute>|TestCategory 属性を使用すると、値なしでカテゴリを指定できます。 TestCategory 属性で定義されるカテゴリは、TestProperty 属性のカテゴリでもあります。|
|<xref:Microsoft.VisualStudio.TestTools.UnitTesting.TestPropertyAttribute>|TestProperty 属性を使用すると、特徴のカテゴリ/値のペアを定義できます。|

 **C++ 用の Microsoft 単体テスト フレームワークでの特徴の定義** 「[C++ 用の Microsoft 単体テスト フレームワークの使用方法](how-to-use-microsoft-test-framework-for-cpp.md)」を参照してください。

### <a name="search-and-filter-the-test-list"></a>テスト リストを検索およびフィルター処理する

テスト エクスプローラーのフィルターを使用して、表示および実行するプロジェクトのテスト メソッドを制限できます。

**テスト エクスプローラー**の検索ボックスに文字列を入力して **Enter** キーを押すと、完全修飾名にその文字列が含まれるテストだけを表示するようにテスト リストがフィルター処理されます。

異なる条件でフィルター処理するには

1. 検索ボックスの右にあるドロップダウン リストを開きます。

2. 新しい条件を選択します。

3. 引用符の間にフィルターの値を入力します。

![テスト エクスプローラーでテストをフィルター処理する](../test/media/ute_filtertestlist.png)

> [!NOTE]
> 検索では大文字と小文字を区別せず、指定された文字列が条件の値の一部と一致するかどうかを照合します。

|修飾子|説明|
|-|-----------------|
|**特徴**|特徴のカテゴリと値の両方から一致を検索します。 特徴のカテゴリと値を指定する構文は、単体テスト フレームワークによって定義されます。|
|**プロジェクト**|テスト プロジェクト名から一致を検索します。|
|**エラー メッセージ**|失敗したアサートが返すユーザー定義エラー メッセージから一致を検索します。|
|**ファイル パス**|テストのソース ファイルの完全修飾ファイル名から一致を検索します。|
|**Fully Qualified Name**|テストの名前空間、クラス、およびメソッドの完全修飾ファイル名から一致を検索します。|
|**出力**|標準出力 (stdout) または標準エラー (stderr) に書き込まれるユーザー定義のエラー メッセージを検索します。 出力メッセージを指定する構文は、単体テスト フレームワークによって定義されます。|
|**Outcome**|テスト エクスプローラーのカテゴリ名で一致を検索する:**失敗したテスト**、**スキップされたテスト**、**成功したテスト数**|

フィルター処理結果のサブセットを除外するには、次の構文を使用します。

```cpp
FilterName:"Criteria" -FilterName:"SubsetCriteria"
```

たとえば、`FullName:"MyClass" - FullName:"PerfTest"` の場合、名前に "PerfTest" も含むテストを除いて、名前に "MyClass" を含むすべてのテストを返します。

## <a name="create-custom-playlists"></a>カスタム プレイリストを作成する

 グループとして実行または表示するテストのリストを作成して保存できます。 プレイリストを選択すると、リスト内のテストがテスト エクスプローラーに表示されます。 テストを複数のプレイリストに追加することができ、既定の **[すべてのテスト]** プレイリストを選択すると、プロジェクトのすべてのテストを使用できます。

 ![プレイリストを選択](../test/media/ute_playlist.png)

 **プレイリストを作成するには**、テスト エクスプローラーで 1 つ以上のテストを選択します。 右クリック メニューで、**[プレイリストに追加]** > **[新しいプレイリスト]** を選択します。 **[新しいプレイリストの作成]** ダイアログ ボックスで指定した場所と名前で、ファイルを保存します。

 **プレイリストにテストを追加するには**、テスト エクスプローラーで 1 つ以上のテストを選択します。 右クリック メニューで、**[プレイリストに追加]** をクリックし、テストを追加するプレイリストを選択します。

 **プレイリストを開くには**、Visual Studio メニューから **[テスト]** > **[プレイリスト]** を選択し、最近使用されたプレイリストのリストから選択するか、**[プレイリストを開く]** を選択してプレイリストの名前と場所を指定します。

 個々のテストに実行順序を定める依存関係がない場合、ツール バーにある ![UTE&#95;parallelicon&#45;small](../test/media/ute_parallelicon-small.png) トグル ボタンで並列テストの実行を有効にします。 これにより、すべてのテスト実行にかかる時間を著しく短縮できます。

## <a name="debug-and-analyze-unit-tests"></a>単体テストをデバッグおよび分析する

### <a name="debug-unit-tests"></a>単体テストをデバッグする

テスト エクスプローラーを使用して、テストのデバッグ セッションを開始できます。 Visual Studio デバッガーを使用してコードをシームレスにステップ実行すると、テスト対象のプロジェクトと単体テストの間を切り替えることができます。 デバッグを開始するには:

1. Visual Studio エディターで、デバッグする 1 つ以上のテスト メソッドにブレークポイントを設定します。

    > [!NOTE]
    > テスト メソッドを任意の順序で実行できるため、デバッグするすべてのテスト メソッドにブレークポイントを設定します。

2. テスト エクスプローラーでテスト メソッドを選択し、右クリック メニューの **[選択したテストのデバッグ]** を選択します。

   デバッガーについて詳しくは、[Visual Studio でのデバッグ](../debugger/debugger-feature-tour.md)に関するページをご覧ください。

### <a name="diagnose-test-method-performance-issues"></a>テスト メソッドのパフォーマンスの問題を診断する

 テスト メソッドに時間がかかる原因を診断するには、エクスプローラーでメソッドを選択し、右クリック メニューの **[プロファイル]** を選択します。 「[パフォーマンス エクスプローラー](../profiling/performance-explorer.md)」を参照してください。

### <a name="analyze-unit-test-code-coverage"></a>単体テストのコード カバレッジを分析する

Visual Studio のコード カバレッジ ツールを使用して、単体テストで実際にテスト中の製品コードの量を確認できます。 選択したテストまたはソリューションのすべてのテストのコード カバレッジを実行できます。

ソリューションのテスト メソッドのコード カバレッジを実行するには:

1. Visual Studio メニューの **[テスト]** を選択し、 **[コード カバレッジの分析]** を選択します。

2. サブメニューから次のいずれかのコマンドを選択します。

    - **[選択されたテスト]** : テスト エクスプローラーで選択したテスト メソッドを実行します。

    - **[All tests (すべてのテスト)]** : ソリューション内のすべてのテスト メソッドを実行します。

**[コード カバレッジの結果]** ウィンドウに、行、関数、クラス、名前空間、およびモジュールで実行された製品コードのブロックのパーセンテージが表示されます。

詳細については、「[コード カバレッジを使用した、テストされるプロジェクトのコード割合の確認](../test/using-code-coverage-to-determine-how-much-code-is-being-tested.md)」を参照してください。

## <a name="test-shortcuts"></a>テスト ショートカット

テストは**テスト エクスプローラー**から実行できます。テストのコード エディター内で右クリックし、**[テストの実行]** を選択するか、Visual Studio の[テスト エクスプローラー ショートカット](../ide/default-keyboard-shortcuts-in-visual-studio.md#bkmk_testexplorerGLOBAL)を使用します。 ショートカットの一部はコンテキストベースです。 つまり、コード エディター内のカーソルの位置に基づいてテストが実行またはデバッグされます。 カーソルがテスト メソッド内にある場合、そのテスト メソッドが実行されます。 カーソルがクラス レベルにある場合、そのクラスのすべてのテストが実行されます。 名前空間レベルの場合も同じことが適用されます。

|頻繁に使用されるコマンド| ショートカット キー|
|-|------------------------|
|TestExplorer.DebugAllTestsInContext|**Ctrl**+**R**、**Ctrl**+**T**|
|TestExplorer.RunAllTestsInContext|**Ctrl**+**R**、**T**|

> [!NOTE]
> 抽象クラスではテストを実行できません。テストは抽象クラスでのみ定義され、インスタンス化されないためです。 抽象クラスでテストを実行するには、抽象クラスから誘導されるクラスを作成します。

## <a name="see-also"></a>関連項目

- [コードの単体テスト](../test/unit-test-your-code.md)
- [64 ビット プロセスとして単体テストを実行する](../test/run-a-unit-test-as-a-64-bit-process.md)
