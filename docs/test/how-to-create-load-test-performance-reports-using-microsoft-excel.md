---
title: Microsoft Excel を使用して Visual Studio ロード テスト パフォーマンス レポートを作成する
ms.date: 10/19/2016
ms.topic: conceptual
helpviewer_keywords:
- load tests, creating Excel reports
- load tests, reporting
ms.assetid: b87fb196-9973-4512-a924-088788def4ea
author: gewarren
ms.author: gewarren
manager: douge
ms.prod: visual-studio-dev15
ms.technology: vs-ide-test
ms.openlocfilehash: 7eda8336c45d0e0d90441ce918845d111976aaf4
ms.sourcegitcommit: ae46be4a2b2b63da7e7049e9ed67cd80897c8102
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/05/2018
ms.locfileid: "52896563"
---
# <a name="how-to-create-load-test-performance-reports-using-microsoft-excel"></a>方法: Microsoft Excel を使用してロード テスト パフォーマンス レポートを作成する

複数のテスト結果に基づいて、Microsoft Excel のロード テスト レポートを生成することができます。

[!INCLUDE [web-load-test-deprecated](includes/web-load-test-deprecated.md)]

次の 2 種類のロード テスト レポートを作成できます。

-   **比較の実行** 表と横棒グラフを使用して 2 つのロード テストの結果のデータを比較したレポートのセットが作成されます。

-   **傾向** 複数のロード テストの結果に基づく傾向分析を生成できます。 結果は折れ線グラフで表示されますが、データをピボットテーブルで表示することもできます。

> [!TIP]
> また、概要ビュー、グラフ ビュー、およびテーブル ビューのデータをコピー アンド ペーストすることにより、Microsoft Word レポートを手動で作成できます。 「[方法: Microsoft Word を使用してロード テスト パフォーマンス レポートを手動で作成する](../test/how-to-manually-create-a-load-test-performance-report-using-microsoft-word.md)」を参照してください。

どちらのレポートも、関係者とパフォーマンス データを共有し、システム全体のパフォーマンスおよび正常性が改善しているか悪化しているかを伝えるために使用できます。

レポート定義はロード テスト データベースに格納されます。 レポートが保存されるとき、レポートの定義がこのデータベースに保存され、後で再利用できます。

さらに、関係者がデータベースに接続しなくてもレポートを表示できるように、Excel ブックを関係者と共有することができます。

> [!NOTE]
> Excel ブックは共有できますが、スプレッドシートを変更できるのはコンピューターに Visual Studio をインストールしているユーザーのみです。 それ以外のユーザーは、**Office** のリボンに **[ロード テスト レポート]** オプションが表示されませんが、ブックを表示することはできます。

次の図は、トランザクション (買い物カゴの更新) の速度低下と (% プロセッサ) カウンターの減少の間の関連付けを表示するレポートの例です。 これは、潜在的な問題がデータベースでもネットワークでもなくアプリケーション コードに存在することを示しており、ASP.NET プロファイラーを使用した診断が推奨されます。

![アプリケーション コードにおける潜在的な問題](../test/media/lt_excel.png)

Excel レポートを生成するには、**ロード テスト アナライザー**のツール バーの **[Excel レポートの作成]** ボタンを使用するか、Excel で **Office** リボンの **[ロード テスト]** タブで **[ロード テスト レポート]** オプションを使用します。

> [!NOTE]
> ロード テストにコメントを追加すると、Excel レポートに表示されます。

## <a name="to-generate-load-test-comparison-reports-using-excel"></a>Excel を使用してロード テスト比較レポートを生成するには

1. レポートを生成する前に、ロード テストを実施する必要があります。

2. Excel のロード テスト レポートは、次の 2 つの方法で作成できます。

   - ロード テストの完了後、**[ロード テストの結果]** ページで、ツール バーの **[Excel レポートの作成]** を選びます。

      > [!NOTE]
      > **Web パフォーマンス テスト結果ビューアー** ツール バーの **[Excel レポートの作成]** ボタンが無効になっている場合、Microsoft Excel を 1 回実行して、このボタンを有効にする必要があります。 Visual Studio Enterprise のインストール時に、Visual Studio Enterprise のロード テスト用の Microsoft Excel アドインがコンピューターにコピーされます。ただし、このアドインのインストール プロセスを完了するには、Microsoft Excel を実行する必要があります。

      Microsoft Excel が開き、**ロード テスト レポートの生成ウィザード**が表示されます。

   **または**

   1. Microsoft Excel を開き、**Office** リボンの **[ロード テスト]** タブを選択し、**[ロード テスト レポート]** を選びます。

       **ロード テスト レポートの生成ウィザード**が表示されます。

   2. **[ロード テストを含むデータベースを選択]** ページの **[サーバー名]** の下に、ロード テストの結果が格納されているサーバーの名前を入力します。

   3. **[データベース名]** ドロップダウン リストで、ロード テストの結果が格納されているデータベースを選択します。

3. **[レポートの生成方法を選択してください。]** ページで、**[レポートの作成]** が選択されていることを確認し、**[次へ]** を選びます。

4. **[生成するレポートの種類を選択してください。]** ページで、**[比較の実行]** が選択されていることを確認し、**[次へ]** を選びます。

5. **[ロード テスト レポートの詳細を入力]** ページで、**[レポート名]** にレポートの名前を入力します。

6. レポートを生成するロード テストを選択し、**[次へ]** を選びます。

7. **[レポートの実行を選択]** ページの **[レポートに追加する 1 つ以上の実行を選択]** で、レポートで比較するロード テスト結果を 2 つ選択し、**[次へ]** を選びます。

   > [!NOTE]
   > 生成できるのは、2 つのロード テスト結果に基づく比較レポートのみです。 ロード テスト結果を 1 つしか選択していない場合、または 3 つ以上選択した場合は、警告メッセージが表示されます。

8. **[レポートのカウンターを選択]** ページの **[レポートに追加する 1 つ以上のカウンターを選択]** で、展開可能なカウンターの一覧からカウンターを選択して、レポートをカスタマイズできます。 レポートに選択した 2 つのテストの実行から、比較するカウンターを選択し、**[完了]** を選びます。

9. 次のスプレッドシート タブのある Excel ブック レポートが生成されます。

   - **目次**: ロード テスト レポートの名前と目次が表示されます。目次には、レポート内の各種タブへのリンクが含まれます。

   - **実行数**: レポートで比較される 2 つの実行に関する詳細が表示されます。

   - **テストの比較**: 比較される 2 つの実行間のパフォーマンスの低下と向上の詳細を示す棒グラフが表示されます。

   - **ページの比較**: テストの実行のさまざまなページについて 2 つの実行を比較する、棒グラフとパフォーマンス比較データ (%) が表示されます。

   - **コンピューター比較**: 使用されたコンピューターに基づく 2 つの実行の比較データが表示されます。

   - **誤差比較**: 2 つの実行で発生したエラーの種類と発生回数を比較します。

     > [!TIP]
     > レポートの有用性を高めるために、ロード テストと Web パフォーマンス テストでは、より詳細なレポートを実現するいくつかのプロパティを使用できます。 ページ要求には、レポートに表示されるプロパティが 2 つあります。"目標" と "レポート名" です。 ページ応答時間は目標に対比して報告され、レポート名はレポート内で URL の代わりに使用されます。 ロード テストの [実行設定] の [カウンター セットの管理] では、レポート コンピューターの名前に "コンピューター タグ" プロパティが表示されます。 これは、レポート内で特定のコンピューターの役割を示すために役立ちます。

## <a name="to-generate-load-test-trend-reports-using-excel"></a>Excel を使用してロード テスト傾向レポートを生成するには

1. レポートを生成する前に、ロード テストを実施する必要があります。

2. Excel のロード テスト レポートは、次の 2 つの方法で作成できます。

   - ロード テストの完了後、**[ロード テストの結果]** ページで、ツール バーの **[Excel レポートの作成]** を選びます。

      > [!NOTE]
      > **Web パフォーマンス テスト結果ビューアー** ツール バーの **[Excel レポートの作成]** ボタンが無効になっている場合、Microsoft Excel を 1 回実行して、このボタンを有効にする必要があります。 Visual Studio Enterprise のインストール時に、Visual Studio Enterprise のロード テスト用の Microsoft Excel アドインがコンピューターにコピーされます。ただし、このアドインのインストール プロセスを完了するには、Microsoft Excel を実行する必要があります。

      Microsoft Excel が開き、**ロード テスト レポートの生成ウィザード**が表示されます。

   **または**

   1. Microsoft Excel を開き、**Office** リボンの **[ロード テスト]** タブを選択し、**[ロード テスト レポート]** を選びます。

       **ロード テスト レポートの生成ウィザード**が表示されます。

   2. **[ロード テストを含むデータベースを選択]** ページの **[サーバー名]** の下に、ロード テストの結果が格納されているサーバーの名前を入力します。

   3. **[データベース名]** ドロップダウン リストで、ロード テストの結果が格納されているデータベースを選択します。

3. **[レポートの生成方法を選択してください。]** ページで、**[レポートの作成]** が選択されていることを確認し、**[次へ]** を選びます。

4. **[生成するレポートの種類を選択してください。]** ページで、**[傾向]** が選択されていることを確認し、**[次へ]** を選びます。

5. **[ロード テスト レポートの詳細を入力]** ページで、**[レポート名]** にレポートの名前を入力します。

6. レポートを生成するロード テストを選択し、**[次へ]** を選びます。

7. **[レポートの実行を選択]** ページの **[レポートに追加する 1 つ以上の実行を選択]** で、レポートで比較するロード テスト結果を選択し、**[次へ]** を選びます。

8. **[レポートのカウンターを選択]** ページの **[レポートに追加する 1 つ以上のカウンターを選択]** で、展開可能なカウンターの一覧からカウンターを選択して、レポートをカスタマイズできます。 傾向の分析で比較するカウンターを選択し、**[完了]** を選びます。

9. 目次のあるレポートが生成されます。目次には、レポートに生成された各種の Excel ブック タブへのリンクが含まれます。 これらのリンクは、傾向レポートに選択されたカウンターに基づいて生成されます。 たとえば、手順 7 で既定のカウンターを選択すると、手順 7 の一覧にあるカウンターごとにデータが生成され、Excel の各タブに個別に表示されます。 各カウンターに対して生成されたデータは、傾向を示すグラフとして表示されます。

   > [!TIP]
   > レポートの有用性を高めるために、ロード テストと Web パフォーマンス テストでは、より詳細なレポートを実現するいくつかのプロパティを使用できます。 ページ要求には、レポートに表示されるプロパティが 2 つあります。"目標" と "レポート名" です。 ページ応答時間は目標に対比して報告され、レポート名はレポート内で URL の代わりに使用されます。 ロード テストの [実行設定] の [カウンター セットの管理] では、レポート コンピューターの名前に "コンピューター タグ" プロパティが表示されます。 これは、レポート内で特定のコンピューターの役割を示すために役立ちます。

## <a name="net-framework-security"></a>.NET Framework のセキュリティ

ロード テストの結果とレポートには、機密情報になり得る情報が含まれており、コンピューターまたはネットワークに対する攻撃を行うために使用されるおそれがあります。 ロード テストの結果とレポートには、コンピューター名と接続文字列が含まれています。 ロード テストのレポートを他のユーザーと共有する場合は、この点に注意する必要があります。

## <a name="see-also"></a>関連項目

- [テストの比較または傾向分析のためにロード テストの結果レポートを作成する](../test/compare-load-test-results.md)