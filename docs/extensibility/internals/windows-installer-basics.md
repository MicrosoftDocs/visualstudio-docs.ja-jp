---
title: Windows インストーラーの基本概念 |Microsoft ドキュメント
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- Windows Installer, VSPackages
- VSPackages, Windows Installer basics
ms.assetid: 497e479b-add8-4644-870a-917f15306b97
author: gregvanl
ms.author: gregvanl
manager: douge
ms.workload:
- vssdk
ms.openlocfilehash: 8fba35aba1e1947ee4eeeb59ca2225253e2aa3a8
ms.sourcegitcommit: 6a9d5bd75e50947659fd6c837111a6a547884e2a
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/16/2018
---
# <a name="windows-installer-basics"></a>Windows インストーラーの基本操作
Windows インストーラーは、Windows インストーラー コンポーネント (WICs またはだけコンポーネントとも呼ばれます) と呼ばれる単位でこれらのタスクを実行するアプリケーションやユーザーのコンピューター上のソフトウェア製品をアンインストールします。 インストールと Windows インストーラーを使用して設定に対する参照カウントの基本単位は、各 WIC を識別する GUID。  
  
 Windows インストーラーの包括的なドキュメントについては、プラットフォーム SDK のトピックを参照してください。 [Windows インストーラー](http://msdn.microsoft.com/library/aa372866.aspx)です。  
  
## <a name="authoring-a-vspackage"></a>VSPackage の作成  
 Windows インストーラーは、Windows インストーラーは、インストール、アンインストール、または製品を修復し、セットアップのユーザー インターフェイス (UI) を実行する必要があります。 情報が含まれるインストール パッケージを使用します。 各インストール パッケージには、インストール データベース、概要情報ストリーム、およびインストールのさまざまな部分のデータ ストリームを含む .msi ファイルが含まれています。 インストーラーを使用するのには、インストールを作成する必要があります。 インストーラーでは、インストールのコンポーネントの概念を整理し、リレーショナル データベースのインストールに関する情報を格納、ため広範にインストール パッケージを作成するプロセスには、次の手順が必要です。  
  
1.  バージョン管理とサイド バイ サイドの戦略をサポートするために作成の設定を計画します。  
  
2.  ユーザーに提示する機能を識別します。  
  
3.  コンポーネントに、VSPackage と依存関係を整理します。  
  
4.  インストール情報をデータベースに設定します。  
  
5.  インストール パッケージを検証します。  
  
 このドキュメントでは、主に、プロセスの最初と 3 番目の手順を実行します。 これらの手順で、VSPackage の機能に編成する WICs 周囲、バージョン管理とサービスの今後のバージョンに対応する方針を設定することができますので[!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]です。 残りの 3 つの手順は、プラットフォーム SDK の Windows インストーラーのドキュメントで詳しく説明します。  
  
## <a name="key-terms"></a>主な用語  
 Windows インストーラー テクノロジに関連する主な用語の定義を次に示します。  
  
 リソース  
 ファイル、レジストリ キー、ショートカット、またはなどのコンピューターにインストールされている可能性があります。 これらのリソースは、Windows インストーラー コンポーネントに論理的にグループ化されます。  
  
 Windows インストーラー component (WIC)  
 インストールにインストールされ、単位としてアンインストールできる関連リソースの論理的なグループを表すの基本単位。 Windows インストーラー コンポーネントは、独自のコンポーネントの ID、または GUID によって識別されます。 さらに、Windows インストーラーは、その参照 WIC レベルでカウントを保持します。 最大バージョン管理の柔軟性を高めるには、指定された WIC に、DLL など、2 つ以上のプライマリのリソースを含めます。 識別し、WIC を設定、GUID を指定して配置した後に、その構成を変更できないことに注意してください。 詳細については、次を参照してください。[アプリケーション コンポーネントを整理する](http://msdn.microsoft.com/library/aa370561.aspx)です。  
  
 パッケージ (パッケージの再頒布可能パッケージ)  
 このファイルを指すこともあります .msi ファイルと外部のソース ファイルで構成される展開の単位。 パッケージには、Windows インストーラーが、UI を実行し、インストールまたはアプリケーションをアンインストールする必要があるすべての情報が含まれています。  
  
 .msi ファイル  
 手順と、アプリケーションのインストールに必要なデータを含む COM 構造化ストレージ ファイルです。 すべてのパッケージには、少なくとも 1 つの .msi ファイルが含まれています。 .Msi ファイルには、インストーラー データベース、概要情報ストリームおよび可能性のある 1 つまたは複数の変換および内部のソース ファイルが含まれています。 ファイルをインストールするキャビネットに圧縮し、.msi ファイル内のストリームに保存または格納されている、圧縮するか、ソース メディア上の .msi ファイルの外部圧縮されません。 詳細については、次を参照してください。 [Windows インストーラー ファイルの拡張子](http://msdn.microsoft.com/library/aa372842\(VS.85\).aspx)です。  
  
## <a name="windows-installer-rules-enforcement"></a>Windows インストーラー規則の適用  
 2 つの規則のセットでは、セットアップのコンポーネントでリソースの配置を決定します。 1 つの規則セットは保守自体には、Windows インストーラーによってインストールの作成者は、2 番目のセットを適用する必要があります。  
  
> [!NOTE]
>  Windows インストーラー規則の実施は、.msi ファイルの検証を実行する場合にのみ発生します。 ただしは、ベスト プラクティスとして、これらの規則を処理する留めてはします。 詳細については、次を参照してください。[インストール データベースを検証する](http://msdn.microsoft.com/library/aa372477\(VS.85\).aspx)と[パッケージの検証](http://msdn.microsoft.com/library/aa370569\(VS.85\).aspx)です。  
  
#### <a name="installer-enforced-rules"></a>インストーラーによって課されるルール  
  
-   コンポーネントには、すべてのファイルは、同じディレクトリにインストールする必要があります。 逆に、コンポーネントを分離する別のフォルダーにインストール ファイルが属している必要があります。  
  
-   コンポーネントごとの 1 つだけのキーのパスがあります。 キーのパスは、単にファイルまたはレジストリ キーを全体の構成要素を表します。  
  
#### <a name="component-provider-responsibilities"></a>コンポーネント プロバイダーの責任  
  
-   可能性があります今後のバージョンで個別に付属する 2 つのリソースは、個別のコンポーネントに存在する必要があります。 リソースがグループ化する、同じコンポーネントに、これらのリソースは別に出荷しないで、特定の場合に限りです。 実際には、ことをお勧めするすべての主要なリソース (Dll など) 別 WICs に常に存在します。 詳細については、次を参照してください。[インストーラー コンポーネントを定義する](http://msdn.microsoft.com/library/aa368269\(VS.85\).aspx)です。  
  
-   バージョン管理されたリソース必要があります出荷なしで 1 つ以上の WIC です。  
  
## <a name="see-also"></a>関連項目  
 [コンポーネントのルールが破損するいるとすると、どうなりますか。](http://msdn.microsoft.com/library/aa372795\(VS.85\).aspx)