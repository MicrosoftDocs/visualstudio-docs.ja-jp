---
title: "Windows インストーラーの基本概念 | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "Windows インストーラー、vspackages にあります。"
  - "Vspackages にある、Windows インストーラーの基本"
ms.assetid: 497e479b-add8-4644-870a-917f15306b97
caps.latest.revision: 12
ms.author: "gregvanl"
manager: "ghogen"
caps.handback.revision: 12
---
# Windows インストーラーの基本概念
[!INCLUDE[vs2017banner](../../code-quality/includes/vs2017banner.md)]

Windows インストーラーは、Windows インストーラーのコンポーネント \(WICs または単なるコンポーネントとも呼ばれます\) と呼ばれる単位でこれらのタスクを実行するアプリケーションやユーザーのコンピューター上のソフトウェア製品をアンインストールします。 インストールと Windows インストーラーを使用して設定に対する参照カウントの基本単位である各 WIC を識別する GUID。  
  
 Windows インストーラーの包括的なドキュメントについては、プラットフォーム SDK のトピックを参照してください。 [Windows インストーラー](http://msdn.microsoft.com/library/aa372866.aspx)します。  
  
## VSPackage を作成します。  
 Windows インストーラーは、Windows インストーラーは、インストール、アンインストール、または製品を修復し、セットアップ ユーザー インターフェイス \(UI\) を実行する必要がある情報が含まれている、インストール パッケージを使用します。 各インストール パッケージには、インストール データベース、概要情報ストリーム、およびインストールのさまざまな部分のデータ ストリームを含む .msi ファイルが含まれています。 インストーラーを使用するには、インストールを作成する必要があります。 インストーラーがコンポーネントの概念にインストールを整理、リレーショナル データベースのインストールに関する情報を格納するため、インストール パッケージを幅広くコンテンツ制作のプロセスには、次の手順が必要です。  
  
1.  バージョン管理とサイド バイ サイドの戦略をサポートするために作成、設定を計画します。  
  
2.  ユーザーに提供する機能を特定します。  
  
3.  コンポーネントに、vs パッケージと依存関係を整理します。  
  
4.  インストール データベース情報を入力します。  
  
5.  インストール パッケージを検証します。  
  
 このドキュメントでは、主に、プロセスの最初と 3 番目の手順を実行します。 これらの手順で編成する VSPackage 機能 WICs、バージョン管理とサービスの今後のバージョンに対応する方針をフレーム化できるように [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]します。 残りの 3 つの手順については、プラットフォーム SDK の Windows インストーラーのドキュメントで詳しく説明します。  
  
## 重要な用語  
 Windows インストーラー テクノロジに関連する重要な用語の定義を次に示します。  
  
 リソース  
 ファイル、レジストリ キー、ショートカット、またはにコンピューターにインストールされている可能性があります。 これらのリソースは、Windows インストーラーのコンポーネントに論理的にグループ化されます。  
  
 Windows インストーラーのコンポーネント \(WIC\)  
 関連リソースであり、インストールおよびアンインストールされる単位の論理グループを表すインストールの基本単位。 Windows インストーラーのコンポーネントは、独自のコンポーネント ID または GUID によって識別されます。 さらに、Windows インストーラーは、その参照は、WIC レベルでカウントを保持します。 柔軟性を最大のバージョン管理のためには、指定した WIC に、DLL などの 2 つ以上の主なリソースを含めます。 識別し、WIC を設定し、GUID を提供および展開しても後の構成を変更できないことに注意してください。 詳細については、次を参照してください。 [を整理するアプリケーション コンポーネントを](http://msdn.microsoft.com/library/aa370561.aspx)します。  
  
 パッケージ \(再頒布可能パッケージ\)  
 このファイルがポイントする .msi ファイルと外部のソース ファイルで構成される展開の単位。 パッケージには、Windows インストーラが UI を実行し、インストールまたはアプリケーションをアンインストールする必要があるすべての情報が含まれています。  
  
 .msi ファイル  
 手順については、アプリケーションをインストールするために必要なデータを格納している COM 構造化ストレージ ファイルです。 すべてのパッケージには、少なくとも 1 つの .msi ファイルが含まれています。 .Msi ファイルには、インストーラー データベース、概要情報のストリームと場合によって、1 つまたは複数の変換および内部のソース ファイルが含まれています。 ファイルをインストールするキャビネットに圧縮しの .msi ファイル内のストリームに格納または格納されている、圧縮されているか、外部のソース メディア上の .msi ファイルの圧縮されていません。 詳細については、次を参照してください。 [Windows インストーラー ファイルの拡張子](http://msdn.microsoft.com/library/aa372842\(VS.85\).aspx)します。  
  
## Windows インストーラーの規則の実施  
 2 つのルールのセットは、セットアップのコンポーネントを通じたリソースの配置を決定します。 1 つのルール セットは、インストールを作成した 2 番目のセットを適用して、自体には、Windows インストーラーによって管理されます。  
  
> [!NOTE]
>  Windows インストーラーの規則の適用は、.msi ファイルの検証を実行した場合にのみ発生します。 それにもかかわらずは、ベスト プラクティスとして、これらのルールを処理する留めてされます。 詳細については、次を参照してください。 [インストール データベースを検証する](http://msdn.microsoft.com/library/aa372477\(VS.85\).aspx) と [パッケージの検証](http://msdn.microsoft.com/library/aa370569\(VS.85\).aspx)します。  
  
#### インストーラーによって適用されたルール  
  
-   コンポーネントには、すべてのファイルは、同じディレクトリにインストールする必要があります。 逆に、コンポーネントを分離する個別のフォルダーにインストールされているファイルが属している必要があります。  
  
-   コンポーネントごとの 1 つだけのキーのパスがあります。 キーのパスは単に、ファイルまたはレジストリ キーで全体の構成要素を表します。  
  
#### コンポーネント プロバイダーの責任  
  
-   含まれているとは別に以降のバージョン 2 つのリソースは、個別のコンポーネントに存在する必要があります。 これらのリソースが個別に付属することはありませんがある場合にのみ、リソースを同じコンポーネントに分類する必要があります。 実際には、お勧めするすべての主要なリソース \(Dll など\) 別 WICs に常に存在します。 詳細については、次を参照してください。 [インストーラー コンポーネントを定義する](http://msdn.microsoft.com/library/aa368269\(VS.85\).aspx)します。  
  
-   バージョンのリソース必要があります出荷ない 1 つ以上の WIC でします。  
  
## 参照  
 [コンポーネント ルールが破損するとどうなりますか。](http://msdn.microsoft.com/library/aa372795\(VS.85\).aspx)