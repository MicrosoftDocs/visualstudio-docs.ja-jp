---
title: Windows インストーラの基本 |マイクロソフトドキュメント
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- Windows Installer, VSPackages
- VSPackages, Windows Installer basics
ms.assetid: 497e479b-add8-4644-870a-917f15306b97
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: aeea0b17a3c234bb7670642fb9ae0a442c9d60cd
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/06/2020
ms.locfileid: "80703414"
---
# <a name="windows-installer-basics"></a>Windows インストーラーの基本事項
Windows インストーラは、ユーザーのコンピュータにアプリケーションまたはソフトウェア製品をインストールしてアンインストールし、これらのタスクを Windows インストーラ コンポーネント (WIC またはコンポーネントと呼ばれることもあります) と呼ばれる単位で実行します。 GUID は、Windows インストーラを使用したセットアップのインストールと参照カウントの基本単位である各 WIC を識別します。

 Windows インストーラの包括的なドキュメントについては、「プラットフォーム SDK」のトピック「 Windows インストーラ 」を[参照してください](/previous-versions/2kt85ked(v=vs.120))。

## <a name="authoring-a-vspackage"></a>VS パッケージの作成
 Windows インストーラは、製品のインストール、アンインストール、または修復、およびセットアップ ユーザー インターフェイス (UI) の実行に必要な情報を含むインストール パッケージを使用します。 各インストール パッケージには、インストール データベース、概要情報ストリーム、およびインストールのさまざまな部分のデータ ストリームを含む .msi ファイルが含まれています。 インストーラを使用するには、インストールを作成する必要があります。 インストーラはコンポーネントの概念に基してインストールを整理し、インストールに関する情報をリレーショナル データベースに格納するため、インストール パッケージを作成するプロセスには、次の手順が大きく伴います。

1. バージョン管理とサイド バイ サイド戦略をサポートするように、セットアップの作成を計画します。

2. ユーザーに提示する機能を特定します。

3. VSPackage と依存関係をコンポーネントに整理します。

4. インストール データベースに情報を設定します。

5. インストール パッケージを検証します。

   このドキュメントは、主にプロセスの最初と 3 番目の手順に関係しています。 これらの手順では、バージョン管理とサービス戦略を組み立て、以降のバージョンの[!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]を考慮できるように、VSPackage 機能を WIC に編成します。 残りの 3 つの手順については、プラットフォーム SDK の Windows インストーラー ドキュメントで詳しく説明します。

## <a name="key-terms"></a>主な用語
 Windows インストーラ テクノロジに関連する主要な用語の定義を次に示します。

 リソース ファイル、レジストリ キー、ショートカットなど、コンピュータにインストールできます。 これらのリソースは、論理的に Windows インストーラ コンポーネントにグループ化されます。

 Windows インストーラ コンポーネント (WIC) 1 つのユニットとしてインストールおよびアンインストールされる関連リソースの論理グループを表すインストールの基本単位。 Windows インストーラー コンポーネントは、一意のコンポーネント ID (GUID) によって識別されます。 さらに、Windows インストーラは参照カウントを WIC レベルで維持します。 バージョン管理の柔軟性を最大限に高めるため、特定の WIC に DLL などのプライマリ リソースを 1 つ以下に含め、使用できます。 WIC を識別して設定し、GUID を指定して展開した後は、その構成を変更できないことに注意してください。 詳細については、「[アプリケーションをコンポーネントに整理する](/windows/desktop/Msi/organizing-applications-into-components)」を参照してください。

 パッケージ (Redist パッケージ) .msi ファイルと、このファイルが指す外部ソース ファイルで構成される展開の単位。 パッケージには、Windows インストーラが UI を実行し、アプリケーションをインストールまたはアンインストールするために必要なすべての情報が含まれています。

 .msi ファイル アプリケーションのインストールに必要な命令とデータを含む COM 構造化ストレージ ファイル。 各パッケージには、少なくとも 1 つの .msi ファイルが含まれています。 msi ファイルには、インストーラー データベース、概要情報ストリーム、および 1 つ以上の変換ファイルと内部ソース ファイルが含まれます。 インストールするファイルは、キャビネットに圧縮して .msi ファイル内のストリームに格納するか、ソース メディアの .msi ファイルの外部に格納、圧縮、または圧縮されていないファイルを格納できます。 詳細については、「 [Windows インストーラ ファイルの拡張子](/windows/desktop/Msi/windows-installer-file-extensions)」を参照してください。

## <a name="windows-installer-rules-enforcement"></a>Windows インストーラーの規則の適用
 2 つのルール セットによって、セットアップのコンポーネントを介したリソースの配置が決まります。 1 つの規則セットは Windows インストーラ自体によって維持されますが、2 番目のセットはインストール作成者として適用する必要があります。

> [!NOTE]
> Windows インストーラ規則の適用は、.msi ファイルの検証を実行した場合にのみ実行されます。 ただし、これらのルールはベスト プラクティスとして扱うように注意してください。 詳細については、「[インストール データベースの検証](/windows/desktop/Msi/validating-an-installation-database)」および「[パッケージ検証](/windows/desktop/Msi/package-validation)」を参照してください。

#### <a name="installer-enforced-rules"></a>インストーラによる強制ルール

- 特定のコンポーネント内のすべてのファイルを同じディレクトリにインストールする必要があります。 逆に、別々のフォルダにインストールされるファイルは、別々のコンポーネントに属している必要があります。

- コンポーネントごとに 1 つのキー パスしか指定できません。 キー パスは、コンポーネント全体を表すファイルまたはレジストリ キーです。

#### <a name="component-provider-responsibilities"></a>コンポーネント プロバイダの責任

- 後続のバージョンで個別に出荷される可能性のある 2 つのリソースは、別々のコンポーネントに存在する必要があります。 リソースが別々に出荷されることはないと確信できる場合にのみ、リソースを同じコンポーネントにグループ化する必要があります。 実際には、すべてのプライマリ リソース (たとえば、DLL) が常に別々の WIC に存在することを推奨します。 詳細については、「[インストーラ コンポーネントの定義](/windows/desktop/Msi/defining-installer-components)」を参照してください。

- バージョン管理されたリソースは、複数の WIC に出荷する必要はありません。

## <a name="see-also"></a>関連項目
- [コンポーネントルールが壊れた場合](/windows/desktop/Msi/what-happens-if-the-component-rules-are-broken)
