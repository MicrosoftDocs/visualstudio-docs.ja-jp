---
title: "Visual Studio SDK 内 | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "Visual Studio と SDK の統合のロードマップ"
  - "Visual Studio の統合 SDK のロードマップ"
  - "Visual Studio SDK の統合ロードマップ"
ms.assetid: 9118eaa4-0453-4dc5-9e16-c7062d254869
caps.latest.revision: 30
ms.author: "gregvanl"
manager: "ghogen"
caps.handback.revision: 30
---
# Visual Studio SDK 内
[!INCLUDE[vs2017banner](../../code-quality/includes/vs2017banner.md)]

ここでは、Visual Studio のアーキテクチャ、コンポーネント、サービス、スキーマ、ユーティリティ、およびなどを含め、Visual Studio 拡張機能に関する詳細な情報を説明します。  
  
## 機能拡張のアーキテクチャ  
 次の図は、Visual Studio 機能拡張のアーキテクチャを示しています。 Vspackage では、サービスとして、IDE 全体で共有されるアプリケーションの機能を提供します。 標準的な IDE では、サービスの範囲を広げてなど <xref:Microsoft.VisualStudio.Shell.Interop.SVsUIShell>, 、IDE ウィンドウの機能へのアクセスを提供します。  
  
 ![環境アーキテクチャ グラフィック](../../extensibility/internals/media/environment.png "environment")  
Visual Studio のアーキテクチャの汎用化されたビュー  
  
## Vspackages にあります。  
 VSPackages は、UI の要素、サービス、プロジェクト、エディター、およびデザイナーでの Visual Studio の拡張を構成するソフトウェア モジュールです。 Vspackages にあるとは、Visual Studio のサーバーの全体のアーキテクチャの単位です。 詳細については、「[Vspackages にあります。](../../extensibility/internals/vspackages.md)」を参照してください。  
  
## Visual Studio Shell  
 Visual Studio シェルでは、基本的な機能を提供し、そのコンポーネントの Vspackage および MEF の拡張機能間の相互通信をサポートします。 詳細については、「[Visual Studio Shell](../../extensibility/internals/visual-studio-shell.md)」を参照してください。  
  
## ユーザー エクスペリエンス ガイドライン  
 Visual Studio の新機能の設計を計画している場合は、デザインと使いやすさのヒントについては、次のガイドラインを確認を行う必要があります: [Visual Studio ユーザー エクスペリエンス ガイドライン](../../extensibility/ux-guidelines/visual-studio-user-experience-guidelines.md)です。  
  
## コマンド  
 コマンドは、印刷するドキュメント、ビューの更新ファイルの新規作成などのタスクを実行する関数です。  
  
 Visual Studio を拡張するときに、コマンドを作成し、Visual Studio シェルで登録します。 これらのコマンドはでどのように表示 IDE では、たとえば、メニューまたはツールバーを指定することができます。 通常にカスタム コマンドが表示されます。、 **ツール** で表示されるメニュー、およびツール ウィンドウを表示するためのコマンド、 **その他のウィンドウ** のサブメニュー、 **ビュー** メニュー。  
  
 コマンドを作成するときに、そのイベント ハンドラーを作成することも必要があります。 イベント ハンドラーとコマンドは、表示するか有効になっている、テキストに変更することができ、コマンドをアクティブ化されるときに適切に応答することが保証を決定します。 ほとんどの場合、IDE を使用してコマンドを処理、 <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget> インターフェイスです。 Visual Studio のコマンドを処理するには、ローカルの選択に基づくし、グローバルの選択に基づいて、最も外側のコンテキストを続行する、最も内側にあるコマンド コンテキストに開始されます。 メイン メニューに追加されたコマンドは、スクリプトを実行してすぐに利用可能です。  
  
 詳細については、「[コマンド、メニューのおよびツールバー](../../extensibility/internals/commands-menus-and-toolbars.md)」を参照してください。  
  
## メニューとツールバー  
 メニューとツールバーは、ユーザーがコマンドを呼び出す方法を提供します。 メニューは、通常、ツール ウィンドウの上部にある個々 のテキスト項目として表示されているコマンドの行または列はされます。 サブメニューは、ユーザーは、小さな矢印を含むコマンドをクリックしたときに表示されるセカンダリ メニューです。 ユーザーが特定の UI 要素を右クリックすると、コンテキスト メニューが表示されます。 一部の一般的なメニュー名が **ファイル**, 、**編集**, 、**ビュー**, 、および **ウィンドウ**します。 詳細については、「[拡張メニューとコマンド](../../extensibility/extending-menus-and-commands.md)」を参照してください。  
  
 ツールバーは、ボタンやコンボ ボックス、リスト ボックス、テキスト ボックスなど、他のコントロールの行または列には。 ツール バー ボタンが通常のフォルダー アイコンなどのアイコン イメージを持つ、 **ファイルを開く** コマンドまたはプリンターを **印刷** コマンドです。 ツールバーのすべての要素は、コマンドに関連付けられます。 ツール バー ボタンをクリックすると、関連付けられているコマンドを実行します。 ドロップダウン コントロールの場合、ドロップ ダウン リスト内の各項目は、別のコマンドに関連付けられます。 分割線コントロールなどのいくつかのツール バー コントロールも、ハイブリッドです。 コントロールの 1 つの辺がツール バー ボタン、もう一方の側は下向きの矢印をクリックすると、いくつかのコマンドを表示する.  
  
## ツール ウィンドウ  
 ツール ウィンドウは、情報を表示する、IDE で使用されます。**ツールボックス**, 、**ソリューション エクスプ ローラー**, 、**プロパティ** ウィンドウ、および **Web ブラウザー** ツール ウィンドウの例を示します。  
  
 ツール ウィンドウは、通常、ユーザーが対話するさまざまなコントロールを提供します。 たとえば、 **プロパティ** ウィンドウにより、ユーザーが特定の目的で使用されるオブジェクトのプロパティを設定します。**プロパティ** ウィンドウは、この意味で特殊なも一般的なさまざまな状況で使用できるためです。 同様に、 **出力** ウィンドウが Visual Studio での多くのサブシステムを使用すると、Visual Studio ユーザーに出力を行うために使用できるため、一般的なテキスト ベースの出力を提供するために特化されています。  
  
 さまざまなツール ウィンドウを含む Visual Studio の次の図を検討してください。  
  
 ![スクリーンショット](../../extensibility/internals/media/t1gui.png "T1gui")  
  
 ツール ウィンドウの一部がソリューション エクスプ ローラーのツール ウィンドウを表示し、他のツール ウィンドウを非表示にはタブをクリックして使用可能になりますが、1 つのペインにまとめてドッキングされます。 図に示すその他の 2 つのツール ウィンドウ、 **エラー一覧** と **出力** ウィンドウで、1 つのペインにまとめてドッキングされます。  
  
 また、メイン ドキュメント ウィンドウは、いくつかのエディター ウィンドウを示しています。 ツール ウィンドウは通常 1 つのインスタンスを持つ \(たとえば、1 つだけを開くことができます **ソリューション エクスプ ローラー**\)、エディター ウィンドウが別のドキュメントを編集するのにそれぞれ使用されますが、これらはすべて同じウィンドウにドッキングしている複数のインスタンスを持つことができます。 この図では 2 つのエディター ウィンドウ、フォームの 1 つのデザイナー ウィンドウとスタート ページを表示するブラウザー ウィンドウを持つドキュメント ウィンドウを使用します。 ドキュメント ウィンドウで、すべての windows、タブをクリックして、使用可能なが EditorPane.cs ファイルを含むエディター ウィンドウが表示され、アクティブです。  
  
 Visual Studio を拡張するときに、拡張機能とツールが Visual Studio ユーザーに便利な windows の対話を作成できます。 Visual Studio のユーザーがドキュメントを編集できるように、独自のエディターを作成することもできます。 ツール ウィンドウおよびエディターは Visual Studio に統合される、ために、プログラミングをドッキングするか、正しくタブに表示する必要はありません。 Visual Studio で正しく登録されているときにそれらが、自動的にツール ウィンドウと Visual Studio でのドキュメント ウィンドウの代表的な機能です。 詳細については、「[拡張とカスタマイズ ツール ウィンドウ](../../extensibility/extending-and-customizing-tool-windows.md)」を参照してください。  
  
## ドキュメント ウィンドウ  
 ドキュメント ウィンドウは、マルチ ドキュメント インターフェイス \(MDI\) ウィンドウのフレームを使用した子ウィンドウです。 ドキュメント ウィンドウは、テキスト エディター、フォーム エディター \(設計者とも呼ばれます\)、または編集コントロールをホストに使用される通常が、その他の機能の種類をホストすることもできます。**新しいファイル** \] ダイアログ ボックスには、Visual Studio にはドキュメント ウィンドウの例が含まれています。  
  
 ほとんどのエディターは、プログラミング言語または HTML ページ、フレーム セット、C\+\+ ファイルのヘッダー ファイルなどのファイルの種類に固有です。 テンプレートを選択して、 **新しいファイル** \] ダイアログ ボックスで、ユーザーを動的に作成、ドキュメント ウィンドウ、テンプレートに関連付けられているファイルの種類のエディターのです。 ドキュメント ウィンドウには、既存のファイルを開く際にも作成されます。  
  
 ドキュメント ウィンドウは、MDI クライアント領域に制限されます。 各ドキュメント ウィンドウは、最上部にタブを持つされ、タブ オーダーは、MDI 領域で開いている可能性がある他のウィンドウにリンクされます。 ドキュメント ウィンドウのタブを右クリックすると、MDI 領域を複数の水平または垂直タブ グループに分割するオプションを含むショートカット メニューが表示されます。 MDI 領域を分割により、複数のファイルを同時に表示できます。 詳細については、「[ドキュメント ウィンドウ](../../extensibility/internals/document-windows.md)」を参照してください。  
  
## エディター  
 Visual Studio のエディターを使用すると、カスタマイズして、マネージ機能拡張フレームワーク \(MEF\) を使用してコンテンツの種類に使用できます。 多くの場合は、VSPackage で MEF 拡張機能を結合するには、シェル \(メニュー コマンドやショートカット キーなど\) からの機能が追加する場合、エディターを拡張する VSPackage を作成する必要はありません。  
  
 データベースの読み書きをする場合、またはデザイナーを使用する場合などのカスタム エディターを作成することもできます。 メモ帳やワードパッドなどの外部エディターを使用することもできます。 詳細については、「[エディターと言語サービスの拡張機能](../../extensibility/editor-and-language-service-extensions.md)」を参照してください。  
  
## 言語サービス  
 Visual Studio エディターで新しいプログラミング キーワードまたはでも新しいプログラミング言語をサポートする場合は、言語サービスを作成します。 完全に、一部、またはまったくない、各言語のサービスが特定のエディター機能を実装できます。 言語サービスには、構成方法に応じて、構文の強調表示、かっこの一致、IntelliSense のサポート、およびその他のエディターの機能を指定できます。  
  
 言語サービスの中核は、パーサーとスキャナーです。 スキャナー \(または字句解析器\) がソース ファイルをトークンと呼ばれる要素に分割し、パーサーがそれらのトークンの間の関係を確立します。 言語サービスを作成するときに、Visual Studio には、トークンと言語の文法を理解できるように、パーサーとスキャナーを実装する必要があります。 マネージまたはアンマネージ言語サービスを作成することができます。 詳細については、「[従来の言語サービスの拡張機能](../../extensibility/internals/legacy-language-service-extensibility.md)」を参照してください。  
  
## プロジェクト  
 Visual Studio では、プロジェクトは、ソース コードとその他のリソースを作成する開発者が使用するコンテナーです。 プロジェクトを整理、ビルド、デバッグ、およびソース コードを配置することができます、Web サービスとデータベース、およびその他のリソースへの参照します。 Vspackage では、プロジェクトの種類、プロジェクト、サブタイプ、カスタム ツールを提供し、Visual Studio プロジェクト システムを拡張できます。  
  
 プロジェクトは、連携してアプリケーションを作成する 1 つまたは複数のプロジェクトのグループ化は、ソリューションの使用をも収集できます。 プロジェクトとステータスに関する情報をソリューションには、2 つのソリューション ファイル、テキスト ベースのソリューション \(.sln\) ファイルおよびバイナリのソリューション ユーザー オプション \(.suo\) ファイルに格納されます。 これらのファイルは以前のバージョンで使用されたグループ \(.vbg\) ファイルのような [!INCLUDE[vbprvb](../../code-quality/includes/vbprvb_md.md)], 、およびワークスペース \(.dsw\) とユーザーのオプション \(.opt\) ファイルの以前のバージョンで使用されていた [!INCLUDE[vcprvc](../../debugger/includes/vcprvc_md.md)]します。  
  
 詳細については、次のトピックを参照してください。[プロジェクト](../../extensibility/internals/projects.md) および[ソリューション](../../extensibility/internals/solutions.md).  
  
## プロジェクトおよび項目テンプレート  
 Visual Studio には、定義済みのプロジェクト テンプレートとプロジェクト項目テンプレートが含まれています。 また、独自のテンプレートを作成またはコミュニティからのテンプレートを取得し、Visual Studio に統合できます。[MSDN コード ギャラリー](http://code.msdn.microsoft.com/Project/ProjectDirectory.aspx?ProjectSearchText=visual%20studio) テンプレートおよび拡張機能にアクセスする場所です。  
  
 テンプレートには、プロジェクトの構造およびアプリケーション、コントロール、ライブラリ、またはクラスの特定の種類のビルドに必要な基本的なファイルが含まれます。 テンプレートのいずれかのようなソフトウェアを開発する場合は、テンプレートに基づいているプロジェクトを作成し、そのプロジェクト内のファイルを変更します。  
  
> [!NOTE]
>  このテンプレートのアーキテクチャはサポートされていません [!INCLUDE[vcprvc](../../debugger/includes/vcprvc_md.md)] プロジェクトです。 作成する方法については [!INCLUDE[vcprvc](../../debugger/includes/vcprvc_md.md)] プロジェクト テンプレートを参照してください [ウィザードのデザイン](/visual-cpp/ide/designing-a-wizard)します。  
  
 詳細については、「[プロジェクトとプロジェクト項目テンプレートを追加します。](../../extensibility/internals/adding-project-and-project-item-templates.md)」を参照してください。  
  
## プロパティとオプション  
 **プロパティ** ウィンドウには、1 つまたは複数選択した項目のプロパティが表示されます: [プロパティを拡張します。](../../extensibility/internals/extending-properties.md) \[オプション\] ページは、プログラミング言語や VSPackage など、特定のコンポーネントに関連するオプションのセットを含める: [オプションと \[オプション\] ページ](../Topic/Options%20and%20Options%20Pages.md)です。 設定は、通常の UI 関連の機能をインポートおよびエクスポートできます。 [ユーザー設定のサポート](../../extensibility/internals/support-for-user-settings.md)します。  
  
## Visual Studio のサービス  
 サービスは、使用するコンポーネントのインターフェイスの特定のセットを提供します。 Visual Studio には、一連の拡張機能を含め、すべてのコンポーネントで使用できるサービスが用意されています。 たとえば、Visual Studio のサービスは、ツール ウィンドウを表示するか、ヘルプ、ステータス バー、または UI イベントへのアクセスを有効にする、動的に非表示を有効にします。 Visual Studio エディターでは、エディターの拡張機能でインポート可能なサービスも提供します。 詳細については、「[使用して、サービスを提供します。](../../extensibility/using-and-providing-services.md)」を参照してください。  
  
## デバッガー  
 デバッガーは、言語固有のデバッグ コンポーネントをユーザー インターフェイスです。 新しい言語サービスを作成してある場合は、デバッガーにフックする特定のデバッグ エンジンを作成する必要があります。 詳細については、「[Visual Studio デバッガーの拡張性](../../extensibility/debugger/visual-studio-debugger-extensibility.md)」を参照してください。  
  
## ソース管理  
 ソース管理プラグインまたは VSPackage を実装する方法の詳細については、次を参照してください。 [ソース管理](../../extensibility/internals/source-control.md)します。  
  
## ウィザード  
 連携して、ウィザードを作成するには新しいプロジェクトの種類に、ユーザーがその型の新しいプロジェクトを作成するときに、正しい決定を下し、ウィザードを使用できるようにします。 詳細については、「[ウィザード](../../extensibility/internals/wizards.md)」を参照してください。  
  
## カスタム ツール  
 カスタム ツールでは、ツールをプロジェクト内の項目に関連付けるし、ファイルを保存するたびに、そのツールを実行できます。 詳細については、「[カスタム ツール](../../extensibility/internals/custom-tools.md)」を参照してください。  
  
## VSSDK ユーティリティ  
 VSSDK には、Vspackage のさまざまな側面を操作するために必要なユーティリティのセットが含まれています。 詳細については、「[VSSDK ユーティリティ](../../extensibility/internals/vssdk-utilities.md)」を参照してください。  
  
## Windows インストーラーを使用します。  
 場合によっては、VSIX インストーラーではなく、Windows インストーラーを使用する必要があります。 たとえば、レジストリに書き込む必要があります。 Windows インストーラーを拡張機能と使用については、次を参照してください。 [Windows インストーラーである Vspackage をインストールします。](../../extensibility/internals/installing-vspackages-with-windows-installer.md)します。  
  
## ヘルプ ビューアー  
 ヘルプ ビューアーには、独自のヘルプおよび F1 ページを統合できます。 詳細については、「[Microsoft ヘルプ ビューアー SDK](../../extensibility/internals/microsoft-help-viewer-sdk.md)」を参照してください。