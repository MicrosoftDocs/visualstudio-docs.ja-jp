---
title: "分離シェル アプリケーションのガイドラインを提供 | Microsoft Docs"
ms.custom: ""
ms.date: "12/03/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "Visual Studio シェル統合モードの保守"
  - "シェル統合モード [Visual Studio] の保守"
ms.assetid: 747d1a47-b8b3-4e8b-93c0-768724be48f2
caps.latest.revision: 15
caps.handback.revision: 15
ms.author: "gregvanl"
manager: "ghogen"
---
# 分離シェル アプリケーションのガイドラインを提供
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

分離された Visual Studio シェル アプリケーションを配布するときに、ソフトウェアの更新をインストールした後、アプリケーションに対して提供できる必要があります。 これを行うには、Microsoft インストーラー \(MSI\) ファイルを使用してアプリケーションをインストールする必要があります。 このようなインストールは、Web による再配布可能に Microsoft 製ソフトウェアの更新をダウンロードしてカスタムの介入なし、ユーザーが使用できます。  
  
## サービスの要件  
 分離シェルのインストールが、インストール プログラムは、次の 3 つの条件を満たしていることを確認することで更新を許可できるようにすることができます。  
  
### MSI を使用して、再配布します。  
 MSI を使用して、アプリケーションを再配布する必要があります、アプリケーションがクライアント コンピューターの物理的な場所には、MSI は製品の id を保持しているためです。 マージ モジュール \(.msm ファイル\) では、このような保証を指定しないと、使用しないでします。  
  
### カスタム動作のアカウンティング  
 カスタム アクションには、インストーラー プログラムでの非標準インストール ディレクティブがあります。 カスタム アクションは、ファイルの場所、レジストリ設定、ユーザーによる設定、またはその他のインストール項目などのパラメーターを変更します。 カスタム アクションは、インストール時にデータを操作する場合があります。  
  
 インストール プログラムでのカスタム アクションを使用する場合は、すべてのインストール時のカスタム アクションが、ユーザーがアプリケーションをアンインストールする場合は、アクションを元に戻す場合は、対応するカスタム アクションを持つ必要があることを確認する必要があります。 対応するため、インストール プログラムは失敗では、カスタム アクションをアンインストールする場合、アプリケーションの削除を残しても部分的にインストールされていることができます。  
  
-   ソフトウェアの更新は、これらのバージョンの変更や、ハッシュ値をファイルまたはハッシュの値の特定のバージョンに依存するカスタム アクションは失敗します。 ここでは、カスタム アクションは、これらの値を手動で更新する必要があります。 その他の問題は、ファイルまたはハッシュの値のバージョンが製品のバージョン間で共有されている場合に発生します。 可能な場合は、この依存関係を避けてください。  
  
### 共有ファイルへのアカウンティング  
 共有ファイルは、同じ名前を持ち、複数の製品で同じ場所にインストールされます。 バージョン、在庫維持単位 \(SKU\)、またはその両方でこれらの製品が異なる場合があり、製品は、特定のコンピューターに共存できます。 ただし、共有ファイルは、いくつかの理由をサービスの問題を作成します。  
  
-   共有ファイルを更新すると、1 つのアプリケーションの更新プログラムが更新されていない 2 番目のアプリケーションによって使用されるファイルのバージョンを変更するためにアプリケーション互換性の問題が発生することができます。 ファイルを共有する製品のインストーラーは、共有ファイルへの参照をカウントします。 そのため、製品をアンインストールしても、インストール済みインスタンスのカウントをデクリメント以降の共有ファイルには影響しません。  
  
-   Quick Fix Engineering \(QFE\) インストーラーには、QFE インストーラー サービスを提供する製品のバージョンのファイルのバージョンが元に戻します。 このプロセスは、可能性のある更新された共有ファイルが提供するアプリケーションを中断します。