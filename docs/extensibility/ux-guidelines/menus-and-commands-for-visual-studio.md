---
title: Visual Studio のメニューとコマンド |Microsoft Docs
ms.date: 11/04/2016
ms.topic: conceptual
ms.assetid: 0a1ed675-2bd1-4603-ba3a-f40dfb5cfb69
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: c1f22b7ac4377b600208c079b6af1eff7fc3cbfc
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/02/2020
ms.locfileid: "80698381"
---
# <a name="menus-and-commands-for-visual-studio"></a>Visual Studio のメニューとコマンド
## <a name="command-usage"></a>コマンドの使用法

### <a name="overview"></a>概要
 複数の独立した製品で構成されたスイートである Microsoft Office とは異なり、Visual Studio には、それぞれがコマンドセットをグローバル Visual Studio IDE に提供する多くの製品が含まれています。 IDE では、コンテキストに基づいてユーザーが使用できる機能をフィルター処理することで、何千ものコマンドの複雑さを管理しています。

 デザインウィンドウからコード編集ウィンドウへの切り替えなど、ユーザーのコンテキストが変更された場合、新しいコンテキストに関連付けられていない機能は表示されなくなります。 同時に、新しい機能は、プロパティやツールボックスのオプションなど、関連する動的な情報と共に使用されます。 ユーザーは、使用可能なコマンドセットのスワップを確認することはできません。 表示または非表示になっているコマンドによってユーザーの混乱や混乱が生じた場合は、UI デザインの調整が必要になります。 ユーザーの現在のコンテキストは、IDE のタイトルバー、プロパティウィンドウ、または [プロパティページ] ダイアログボックスなど、常に1つ以上の方法で示されます。

 コマンドバーを使用すると、UI の柔軟性を高めることができます。 Visual Studio 環境に固有のコマンド構造は、メインメニューとメインコマンドバーだけで、カスタマイズしたり、非表示にしたりすることもできます。 アプリケーションの状態に基づいて、他のコマンドバーが表示され、非表示になります。 ツールウィンドウとドキュメントエディターには、ウィンドウの端に埋め込まれたツールバーを含めることもできます。

#### <a name="basic-guidelines"></a>基本的なガイドライン

##### <a name="use-existing-shared-commands-command-groups-and-menus-whenever-possible"></a>可能な限り、既存の共有コマンド、コマンドグループ、およびメニューを使用します。
 通常、コマンドはコンテキストに基づいて表示されるため、既存の共有メニューやコマンドグループを使用すると、コンテキストの変更間でコマンドの構造が比較的安定したままになります。 共有コマンドを再利用し、関連する共有コマンドの近くに新しいコマンドを配置すると、IDE の複雑さが軽減され、ユーザーフレンドリなエクスペリエンスが向上します。 新しいコマンドを定義する必要がある場合は、既存の共有コマンドグループに配置してみてください。 新しいグループを定義する必要がある場合は、新しいトップレベルメニューを作成する前に、関連するコマンドグループの近くにある既存の共有メニューに配置します。

##### <a name="do-not-create-icons-for-every-command"></a>すべてのコマンドに対してアイコンを作成しないでください。
 コマンドアイコンを作成する前に、慎重に検討してください。 次のコマンドに対してのみ、アイコンを作成する必要があります。

- 既定のツールバーに表示されます。

- は、ユーザーによって [ **カスタマイズ...** ] ダイアログボックスを使用してツールバーに追加される可能性があります。

- 別の Microsoft 製品の同じアクションにアイコンが関連付けられている。

##### <a name="limit-the-addition-of-keyboard-shortcuts"></a>キーボードショートカットの追加を制限する
 ほとんどのユーザーは、使用可能なすべてのショートカットのほんの一部を利用しています。 わからない場合は、機能をキーボードショートカットにバインドしないでください。 新しいショートカットを追加する前に、ユーザーエクスペリエンスチームと協力してください。

##### <a name="give-commands-a-default-menu-placement"></a>コマンドに既定のメニューの配置を指定します。
 コマンドは他のユーザーによってカスタマイズされ、それに応じて設計されることに注意してください。 非表示のコマンドのようなものはありません。 すべての Visual Studio コマンドは、[ **ツール > カスタマイズ** ] ダイアログ、[コマンド] ウィンドウ、オートコンプリート、 **ツール > オプション > キーボード** ] ダイアログ、および開発ツール環境 (DTE) に表示されます。 ユーザーが簡単に見つけられるように、コマンドには、ctc ファイルの名前とツールヒントを指定してください。

##### <a name="do-not-duplicate-shared-commands-on-an-embedded-toolbar"></a>埋め込みツールバーで共有コマンドを複製しないでください。
 ユーザーのフォーカスの領域に近い場所にコマンドを配置すると便利です。 これを行う1つの方法は、ツールウィンドウまたはドキュメントエディターの上部に埋め込みツールバーを作成することです。 ツールバーに表示されるコマンドは、ウィンドウ内のコンテンツ領域に固有である必要があります。 これらのツールバーで共有コマンドを複製しないでください。 たとえば、埋め込みツールバー内に [保存] アイコンを配置しないでください。

### <a name="content-and-command-visibility"></a>コンテンツとコマンドの可視性
 コマンドは、 **環境**、 **階層**、 **ドキュメント**の各スコープに存在します。 コマンドの配置に自信を持たせるために、各スコープを理解します。

 **環境**スコープ内のコマンドは、プライマリコンテキストを確立し、複数のコンテキスト間で共有されます。 ドキュメントとツールウィンドウの表示または配置を変更します。 環境スコープ内のコマンドの中には、 **新しいプロジェクト**、 **サーバーへの接続**、 **プロセスのアタッチ**、 **切り取り**、 **コピー**、 **貼り付け**、 **検索**、 **オプション**、 **カスタマイズ**、 **新しいウィンドウ**、 **ヘルプの表示**などがあります。

 **階層**スコープ内のコマンドは、**プロジェクト**、**チーム**、**データ**などの Visual Studio の階層を管理します。 **デバッグ**、**ビルド**、**テスト**、**アーキテクチャ**、**分析**など、プロジェクトの subcontext に関連しています。 階層のスコープ内のコマンドの中には、[ **新しい項目の追加**]、[ **新しいクエリ**]、[ **プロジェクトの設定**]、[ **新しいデータソースの追加**]、[ **パフォーマンスウィザードの起動**]、および [ **新しいダイアグラム**] があります。

 **ドキュメント**スコープ内のコマンドは、コード、デザイン、作業項目クエリ (.wiq) などのドキュメントの内容に対して機能します。 また、ツールウィンドウのビューでも動作します。または、そのツールウィンドウ専用です。 ドキュメントスコープのコマンドは、[ **プロジェクトから削除**] など、それ自体が階層固有のファイルオブジェクトに対しても機能します。 ドキュメントスコープのコマンドの中には、 **リファクタリング > 名前の変更**、 **作業項目のコピーの作成**、[ **すべて展開**]、[ **すべて折りたたみ**]、および [ **ユーザータスクの作成**] があります。

### <a name="command-placement-decisions"></a>コマンド配置の決定
 コマンドの作成を決定したら、適切な配置と、ショートカットキーを作成するかどうかを決定する必要があります。 この決定パスに従って、コマンドの配置場所を設定します。

 ![コマンド配置の意思決定グラフ](../../extensibility/ux-guidelines/media/0501-a_commandplacement.png "0501-a_CommandPlacement")

 **Visual Studio でのコマンドの配置のためのデシジョンパス**

### <a name="command-placement-in-menus"></a>メニュー内のコマンドの配置

#### <a name="main-menu-bar"></a>メインメニューバー
 メインメニューバーは、UI に寄与する、コンテキスト固有のメニューパッケージのコマンドの標準の場所にする必要があります。 メインメニューバーは、他のコマンド構造とは異なります。環境では、表示するコマンドを制御するために使用されます。 他のすべてのコマンドバーは、コンテキストがないコマンドを単に無効にします (メニューまたはツールバーに配置されているかどうか)。

 環境では、IDE 全体と複数のタスクドメインに共通するメインメニューバーに組み込まれた一連のコマンドを定義します。 これらのコマンドは、環境に読み込まれている Vspackage に関係なく、常に表示されます。 Vspackage はこの一連のコマンドを拡張できますが、各製品からのコマンドセットとコマンドの配置は各チームの責任です。

 Visual Studio のメインメニューの構造は、次のメニューカテゴリに分けることができます。

##### <a name="core-menus"></a>コアメニュー

- ファイル

- [編集]

- 表示

- ツール

- ウィンドウ

- Help

##### <a name="project-specific-menus"></a>プロジェクト固有のメニュー

- Project

- Build

- デバッグ

##### <a name="context-specific-menus"></a>コンテキスト固有のメニュー

- チーム

- Data

- テスト

- Architecture

- 分析

##### <a name="document-specific-menus"></a>ドキュメント固有のメニュー

- Format

- テーブル

##### <a name="when-designing-main-menus-adhere-to-these-rules"></a>メインメニューをデザインするときは、次の規則に従います。

- 指定されたコンテキストで25の最上位レベルの項目を超えることはできません

- メニューの高さは600ピクセルを超えないようにする必要があります。

- Ultimate SKU や General Profile など、複数のコンテキストでメインメニューを評価します。

- ポップアップメニューは許容されます。

- ポップアップメニューには、少なくとも7つの項目が含まれている必要があります。

- ポップアップメニューに表示されるのは1レベルディープのみです。一部の Visual Studio メニュー項目にはカスケードサブメニューがありますが、このパターンは推奨されません。

- 6個以下の区切り記号を使用してください。 グループ化は次の図に従う必要があります。

     ![メイン メニューのグループ化のためのガイドライン](../../extensibility/ux-guidelines/media/0501-b_mainmenus.png "0501-b_MainMenus")

- 各グループ化を図に含める必要はありませんが、グループを追加することは制限されています。

- 各グループには、2 ~ 7 個のメニュー項目が必要です。

#### <a name="main-menu-ordering"></a>メインメニューの順序付け
 新しい最上位レベルの項目を追加する前に、既存のトップレベルメニューにコマンドを配置することを検討してください。 新しいトップレベルメニューを追加するときは、正しい場所に配置してください。 メニューがプロジェクト、コンテキスト、またはドキュメントに固有であるかどうかを判断します。 トップレベルメニューの名前は簡潔にし、1つの単語のみを使用します。

 コアメニューでは、コマンドの残りの部分をもう必要があります。 [ファイル]、[編集]、および [表示] は常に左に配置し、[ツール]、[ウィンドウ]、および [ヘルプ] は常に右側に配置する必要があります。

#### <a name="context-menus"></a>コンテキスト メニュー
 コンテキストメニュー内に多くの機能を配置すると、習得が困難になります。 メインメニューバーを使用して、すべての主要な機能を使用できるようにする必要があります。 コマンドの配置は、コマンドの重複を回避するために、既存のコマンドと調整する必要があります。 コンテキストメニューの場合、シェルは、コンテキストメニューがソリューション、プロジェクトノード、またはプロジェクト項目のどちらであるかに応じて、含まれる標準のメニューグループを定義します。

 コンテキストメニューをデザインする場合は、メインメニューの場合と同じ規則に従い、さらに次のようにします。

- トップレベルのメニュー項目を25個以下にしてください。

- ポップアップメニューは許容されますが、1レベルを超えることはできません。カスケード flyouts を使用することはできません。

- 6個以下の区切り記号を使用してください。

### <a name="command-placement-in-toolbars"></a>ツールバーでのコマンドの配置

#### <a name="general-toolbars"></a>全般ツールバー
 ツールバーをデザインおよび整列する場合は、次の標準に従います。

- ボタンごとに複数の動詞を使用しないでください。 1つのボタン = 1 つのアクション。

- ラベルを使用して補強する必要がある場合にのみ、アイコンの横にテキストを使用します。

- 1つのセッションで複数回切り替えられるプロパティには、コンボボックスを排他的に使用します。 それ以外の場合は、他の場所でプロパティを公開します。

- コンボボックスの幅は、ボックス内の最も長い項目の幅 + 30% と同じでなければなりません。 たとえば、最も長い項目が200ピクセルの場合、コンボボックスは260ピクセル幅である必要があります。

- 区切り記号の使用を制限します。 ドロップダウンリストの横にある区切り記号は、表示区切り記号として機能するため、アンチパターンになります。

- アイコングループには 3 ~ 6 個のアイコンが含まれている必要があります。

- 修飾子によって複数の便利なコマンドが生成される場合は、最後の設定を格納する分割ボタンを使用します。

     ![Visual Studio での分割ボタン](../../extensibility/ux-guidelines/media/0501-c_splitbuttons.png "0501-c_SplitButtons")

     **分割ボタンの例。左側の6つのコマンドは、代わりに1つのボタンに収まります。**

#### <a name="product-specific-toolbars"></a>製品固有のツールバー
 各製品には、頻繁に使用される重要なコマンドを含む既定のツールバーが用意されており、製品のインストール後に Visual Studio を初めて起動するときに、各製品の既定のツールバーが表示されます。

 製品では、IDE によって提供される共有コマンドグループおよびメニューも利用する必要があります。 各共有コマンドグループは、ユーザーにとって意味のある方法で関連コマンドを整理することを目的とした共有メニューに配置されます。 複雑さを軽減するために、この共有コマンド構造を活用することが重要です。

#### <a name="global-toolbars"></a>グローバルツールバー
 グローバルツールバーは、すぐに1行に収める必要があります。 新しいグローバルツールバーを作成する場合は、そのツールバーの種類のガイドラインに従います。

 **ツールバーの一般的なガイドライン:**

- 各ツールバーには、一般的なコントロール (グリッパー、オーバーフロー) で24ピクセルあります。

- 各ツールバーボタンは、余白を含む22ピクセル幅です。 アイコンを分割ボタンにすると、別の11ピクセルの幅が追加されます。

- ツールバー間でのコマンドの複製は許可されています。

  **ドキュメント固有のツールバー** は、特定の種類のファイルがアクティブになったときに表示され、別の種類のファイルがアクティブになると表示されなくなります。

- ドキュメント固有のツールバーには、12個を超えるボタンを含めることはできません。

- ツールバーの幅の合計が300ピクセルを超えることはできません。

- 各ファイルの種類には、1つの埋め込みツールバーと1つのドキュメント固有のグローバルツールバーがありますが、両方を指定することはできません。

  **コンテキスト固有のツールバー** は、特定のコンテキストが設定されている場合に表示され、長期間アクティブなままになる傾向があります。

- すべてのコンテキスト固有のツールバーのボタン制限は18です。

- コンテキストがアクティブなときに、ほとんどのユーザーがこのツールバーのコマンドを一貫して使用しない場合は、このツールバーをコンテキストに関連付けないでください。

- コンテキストの終了時にツールバーが表示されないことを確認します。 これらのツールバーは、起動時に表示されません。

  **コンテキストのないツールバー** は自動的に表示されません。 これらの表示は、ユーザーがアクティブにしたときにのみ表示されます。 最大幅は200ピクセル未満のままにします。

### <a name="general-organization-and-shell-defined-groups"></a>一般的な組織とシェルで定義されたグループ
 既存の共有コマンド、コマンドグループ、およびメニューを使用します。 新しいコマンドを定義する必要がある場合は、既存の共有コマンドグループに配置してみてください。 新しいグループを定義する必要がある場合は、新しいトップレベルメニューを作成する前に、関連するコマンドグループの近くにある既存の共有メニューに配置してみてください。 これにより、IDE でのコマンドの配置の一貫性を確保しながら、コマンドの複雑さが軽減されます。

 次の図は、通常、デザイナースタイルのドキュメントウィンドウのコンテキストで表示される [共有 **形式** ] メニューを示しています。

 ![Visual Studio でのコールアウト付きの [書式] メニュー](../../extensibility/ux-guidelines/media/0501-d_formatmenu.png "0501-d_FormatMenu")

 **Visual Studio のメニューグループ**

### <a name="reducing-and-reusing-commands"></a>コマンドの削減と再利用
 コマンドは通常、コンテキストに基づいて表示されるため、ユーザーが特定の時点で確認できるコマンドの数を減らすことができます。 ただし、既存の共有メニューとコマンドグループを再利用して、コンテキストの変更間でコマンドの構造が比較的安定していることを確認する必要もあります。

 共有コマンドを再利用し、関連する共有コマンドの近くに新しいコマンドを配置すると、IDE の複雑さが軽減され、ユーザーフレンドリなエクスペリエンスが向上します。

## <a name="naming-commands"></a>コマンドの名前付け

### <a name="naming-conventions"></a>名前付け規則
 コマンドラインを使用するかキーボードショートカットにバインドすることにより、ユーザーがコマンドを見つけて実行できるように、一貫性のあるコマンドの名前付けが重要になります。 コマンド名を使用すると、ツールバーまたはカスケードメニューまたはショートカットメニューに表示されるコマンドの目的をユーザーが理解するのにも役立ちます。

#### <a name="when-naming-commands"></a>コマンドに名前を付ける場合:

- テキストを作成して、簡単にローカライズできるようにします。 テキストのローカライズの詳細については、「 [ローカリゼーションのベストプラクティス](/dotnet/standard/globalization-localization/best-practices-for-developing-world-ready-apps#localization-best-practices)」を参照してください。

- 簡潔にします。 コマンドで使用する単語数は3文字以下にする必要があります。

- タイトルの大文字と小文字を区別する: 各単語の最初の文字は大文字にする必要があります。 Visual Studio でのテキストの書式設定の詳細については、「 [テキストのスタイル](../../extensibility/ux-guidelines/fonts-and-formatting-for-visual-studio.md#BKMK_TextStyle)」を参照してください。

- コマンドが配置される場所を考慮してください。 トップレベルメニューまたはフライアウトですか。 たとえば、フライアウトで整列コマンドをグループ化する場合、最上位のコマンドは "Align" で、フライアウトコマンドは "Left"、"Right"、"Center"、"Justify" などにする必要があります。 ポップアップコマンドに "左揃え" または "右揃え" という名前を指定すると冗長になります。

     ![Visual Studio での [書式] メニュー](../../extensibility/ux-guidelines/media/0502-a_formatmenu.png "0502-a_FormatMenu")

### <a name="using-icons-with-commands"></a>コマンドでのアイコンの使用
 コマンドとアイコンの組み合わせを使用して、スペアにします。 一意のイメージをコマンドに関連付けることによって、そのコマンドを識別するためのユーザーの能力が hastens されます。ただし、画像を使いやすくすることができます。 次の規則は、コマンドアイコンを作成するかどうかを決定するときに役立ちます。

#### <a name="use-an-icon-with-a-command-only-if"></a>次の場合にのみ、コマンドでアイコンを使用します。

- 同じコマンドには、Microsoft Office アプリケーションの1つなど、別の主要な Microsoft 製品に関連付けられたアイコンがあります。

- コマンドは、既定のツールバーに配置されます。

- コマンドは、ユーザーが **[カスタマイズ...** ] ダイアログボックスを使用してツールバーに追加することが多い特別なコマンドです。

## <a name="access-and-shortcut-keys"></a>アクセスとショートカットキー

### <a name="overview"></a>概要
 キーボードキーの割り当てには、次の2種類があります。

- **アクセスキー** (アクセラレータとも呼ばれます) では、コマンドを実行したり、ダイアログ UI で各ラベルに対してキーボードアクセスを許可したりできます。 アクセスキーは、主にアクセシビリティを目的としており、すべてのメニューやダイアログボックスコントロールに割り当てられており、覚えではなく、現在のウィンドウのみに影響し、ローカライズされています。

- **ショートカットキー** は、主に Control (Ctrl) キーと Function (Fn) キーシーケンスを使用します。 上級ユーザー向けに設計されており、生産性を高めることができます。 これらは、最も頻繁に使用されるコマンドにのみ割り当てられ、メインメニューをバイパスしながらすばやくアクセスできます。 ショートカットキーは覚えにすることを目的としています。そのため、プロファイルスキームと一致する必要があります。 ショートカットキーのスキームは、プロファイルによって異なる場合があります。 ユーザーは、 **ツール > オプション > キーボード**を使用して、ショートカットキーをカスタマイズできます。

### <a name="assigning-access-keys"></a>アクセスキーの割り当て
 アクセスキーは、Alt + 英数字キーで構成されます。 例外を発生させずに、各メニュー項目にアクセスキーを割り当てます。 Windows と、アクセスキーの割り当てに関する一般的な規則に従います。 たとえば、 **File > New** のアクセスキーは常に **Alt、F、N**のようにする必要があります。

 ' I ' (大文字または小文字) または小文字の "l" のような1ピクセル幅の文字を使用しないでください。また、ディセンダー (g、j、p、q、および y) を含む文字は区別しにくいため、使用しないでください。

 可能な場合は、重複するキーを使用しないようにしてください。 重複が回避されない場合、メニューシステムは、キーを使用するすべてのコマンドを順番に実行することによって競合を処理します。 例として、"N" アクセスキーを複製する [ファイル] メニューの [Number] コマンドを実行すると、 **alt、f、** n は新しいファイルを作成し、 **alt、f、n、n** は "number" コマンドを実行します。

### <a name="assigning-shortcut-keys"></a>ショートカットキーの割り当て
 新しいショートカットキーが割り当てられないようにします。これは、すべてのコマンドに必要ではなく、過剰使用する場合はシステム (およびユーザーメモリ) を消費するためです。 カスタマーエクスペリエンス向上プログラム (CEIP) のデータは、Visual Studio ユーザーが統合されたショートカットのごく一部のみを使用することを示します。

 ショートカットを定義するときは、次の規則に従います。

- **Control (Ctrl) キーと Function (Fn) キーシーケンスを使用します。**

- **頻繁に使用するショートカットを保持します。** 最も人気のあるショートカットを維持します。

- **エディターのショートカットを簡単に入力できるようにします。** コードの記述時に開発者が最も必要とするコマンドに、簡単な型のショートカットをバインドします。 たとえば、 **InvokeSmartTag** には、Alt + Shift + F10 ではなく、Ctrl +/のようなクイックショートカットキーが必要です。

- **一貫してテーマを持つショートカットを使用します。**

- **Windows のガイドラインに従って、使用する修飾子キーを決定します。** ドキュメント全体に適用されるコマンドなど、大規模な効果を持つコマンドには、Ctrl キーの組み合わせを使用します。 標準のショートカットキーのアクションを拡張または補完するコマンドには、Shift キーの組み合わせを使用します。 Ctrl + Alt の組み合わせは使用しないでください。

- **余分なショートカットを削除します。** 従来の機能がある場合は、アクセスキーによって同じコマンドにすばやくアクセスできる場合は、極端な infrequency (CEIP データから10回未満) または infrequency (CEIP データから100回未満) で使用されるショートカットを削除することを検討してください。 たとえば、Alt、H、C はヘルプ/内容を開きます。

  ショートカットの可用性を確認する簡単な方法はありません。 ショートカットを追加する場合は、次の手順を実行します。

1. [Visual Studio 2013 のショートカット](http://visualstudioshortcuts.com/2013/)の一覧を確認し、同様のコマンドがあるかどうかを確認します。

2. [ **ツール] > [オプション > 環境 > キーボード]** にアクセスし、ショートカットをテストします。 「次の追加のキーボードマップスキームを適用する」に記載されている各キーボードマップスキームを確認します。 一般的な、C#、VB、および C++ のプロファイルについては、一意のショートカットが共有されていることを確認してください。 ショートカットは、これらの場所のいずれにもマップされていない場合に使用できます。
