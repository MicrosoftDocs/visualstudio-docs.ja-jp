---
title: "Visual Studio のアプリケーション パターン |Microsoft ドキュメント"
ms.custom: 
ms.date: 04/26/2017
ms.reviewer: 
ms.suite: 
ms.technology: vs-ide-sdk
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 8ed68602-4e28-46fe-b39f-f41979b308a2
caps.latest.revision: "7"
author: gregvanl
ms.author: gregvanl
manager: ghogen
ms.openlocfilehash: 0fad2e8d63b0005addab20756501d18fe872b4c3
ms.sourcegitcommit: f40311056ea0b4677efcca74a285dbb0ce0e7974
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/31/2017
---
# <a name="application-patterns-for-visual-studio"></a>Visual Studio のアプリケーション パターン
##  <a name="BKMK_WindowInteractions"></a>ウィンドウの相互作用  
  
### <a name="overview"></a>概要  
Visual Studio で使用される 2 つのメイン ウィンドウ型は、ドキュメント エディターやツール ウィンドウです。 まれですが、可能な大きなモードレス ダイアログ ボックスは、します。 これらは、シェル モードレスすべてが、そのパターンは根本的に異なります。 このセクションでは、ドキュメント ウィンドウ、ツール ウィンドウ、およびモードレスのダイアログの違いについて説明します。 モーダル ダイアログのパターンについては、「[ダイアログ](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_Dialogs)です。  
  
### <a name="comparing-window-usage-patterns"></a>ウィンドウの使用状況パターンの比較  
**ドキュメント ウィンドウ**ほぼ常に表示されるドキュメント内でもします。 これにより、ドキュメント エディター"center ステージ"を周囲の補足的なツール ウィンドウを整列します。  
  
A**ツール ウィンドウ**は、ほとんどの場合、IDE の端と折りたたまれているより小さな個別のウィンドウとして表示されます。 表示、非表示、または自動非表示を指定できます。 ただし、場合もありますツール ウィンドウの表示、ドキュメント ウェルをオフにすると、**ウィンドウ/ドッキング**ウィンドウのプロパティです。 広くなります。 ただし、一般的な設計の決定も: Visual Studio に統合すると、ツール ウィンドウまたはドキュメント ウィンドウに、機能を表示する必要がありますかどうかを決定する必要があります。  
  
**モードレス ダイアログ**Visual Studio で推奨されていません。 最もモードレス ダイアログ ボックスは、定義上、フローティング ツール ウィンドウ、およびその方法で実装する必要があります。 ここで、シェルの側にドッキングされている標準のツール ウィンドウのサイズが小さすぎる場合は、モードレス ダイアログが許可されています。 ここで、ユーザーがダイアログをセカンダリのモニターに移動する可能性がある場合にも使用します。  
  
慎重にどのコンテナーの種類に関する必要があると考えてください。 UI の設計のため、共通の使用状況パターンに関する考慮事項は、次の表にされます。  
  
||ドキュメント ウィンドウ|ツール ウィンドウ|モードレス ダイアログ|  
|-|---------------------|-----------------|---------------------|  
| **位置** | 常にも、ドキュメント内に位置し、IDE の端の周りをドッキングしません。 「プルできます」メイン シェルから個別にフローティング表示できるようにします。 | IDE の端を通常タブ ドッキングします、は、配置するカスタマイズされた自動非 (固定)、またはドキュメント内でもドッキングします。|大規模なフローティング ウィンドウが、IDE とは別です。 |  
| **モデルをコミットします。** | *遅延コミット*<br /><br /> ドキュメントにデータを保存するために、ユーザーが発行する必要があります、**ファイル&gt;保存**、**名前を付けて保存**、または**すべて保存**コマンド。 ドキュメント ウィンドウが、保存のいずれかにコミットされている「ダーティになった」こと内のデータの概念コマンド。 ドキュメント ウィンドウを閉じるときにすべての内容がディスクに保存されるか失われました。 | *即時コミット*<br /><br /> 保存されていないモデル。 ファイルの編集を支援する inspector ツール ウィンドウでファイルがアクティブなエディターまたはデザイナーで開く必要がありますをエディターまたはデザイナーは、保存を所有しています。 | *遅延または即時コミット*<br /><br /> ほとんどの場合、大きなモードレス ダイアログでは、変更をコミットする、操作を行う必要し、ダイアログ セッション内で加えられた変更をロールバックする「キャンセル」操作できます。  これにより、ことで、ツール ウィンドウは常に、直ちにコミット モデル、ツール ウィンドウからモードレス ダイアログ ボックスが区別されます。 |  
| **可視性** | *(ファイル) を作成する開くおよび閉じる*<br /><br /> ドキュメント ウィンドウを開くと、既存のドキュメントを開くか、新しいドキュメントを作成するテンプレートを使用してによって行われます。 ない"オープン\<特定のエディター >"コマンド。 | *非表示にして表示*<br /><br /> 単一インスタンスのツール ウィンドウを非表示か表示されることができます。 ビュー内かどうかの内容と、ツール ウィンドウ内の状態を永続化または非表示します。 ツール ウィンドウの複数インスタンスする終了したりできるよう非表示にします。 マルチ インスタンスのツール ウィンドウが閉じている場合は、ツール ウィンドウ内の状態と内容は破棄されます。 | *コマンドからの起動*<br /><br /> ダイアログ ボックスは、タスク ベースのコマンドから起動されます。 |  
| **インスタンス** | *複数インスタンス*<br /><br /> 一部のエディターにも同じファイルを 1 つ以上のエディターで開くことができるようにする、いくつかのエディターが同時に、別のファイルの編集で開くことができる (を使用して、**ウィンドウ&gt;新しいウィンドウ**コマンド)。<br /><br /> 単一のエディターが同時に (プロジェクト デザイナー) 1 つまたは複数のファイルを編集することがあります。 | *1 つまたは複数 instance*<br /><br /> (プロパティ ブラウザー) と同じコンテキストを使用するか (タスク一覧、ソリューション エクスプ ローラー) は、他のウィンドウにフォーカス/コンテキストをプッシュする内容を変更します。<br /><br /> ない限り、説得力のある理由に、単一インスタンスおよび複数インスタンスの両方のツール ウィンドウがアクティブなドキュメント ウィンドウに関連付けする必要があります。 | *単一インスタンス* |  
| **例** | **テキスト エディター**などのコード エディター<br /><br /> **デザイン サーフェイス**フォーム デザイナーまたはモデリング サーフェスのように、<br /><br /> **ダイアログ ボックスのようなレイアウトを制御**などのマニフェスト デザイナー | **ソリューション エクスプ ローラー**ソリューションが提供され、ソリューション内に含まれるプロジェクト<br /><br /> **サーバー エクスプ ローラー**を開くには、ウィンドウで、ユーザーが選択したサーバーとデータの接続の階層ビューを提供します。 クエリと同様に、データベース階層からオブジェクトを開く、ドキュメント ウィンドウが開き、クエリを編集することができます。<br /><br /> **プロパティ ブラウザー**ドキュメント ウィンドウまたは別のツール ウィンドウのいずれかを選択したオブジェクトのプロパティを表示します。 プロパティは、階層グリッド ビューで、または複雑なダイアログのようなコントロールで表示され、ユーザーがこれらのプロパティの値を設定できるようにします。 | |  
  
##  <a name="BKMK_ToolWindows"></a>ツール ウィンドウ  
  
### <a name="overview"></a>概要  
ツール ウィンドウは、ドキュメント ウィンドウで発生する、ユーザーの作業をサポートします。 Visual Studio が提供し、操作できる基本的なルート オブジェクトを表す階層を表示する、使用できます。  
  
IDE の新しいツール ウィンドウを検討するときの作成者を行ってください。  
  
-   既存のツール ウィンドウのタスクに適したを使用して、同様の機能で新しいポリシーを作成できません。 新しいツール ウィンドウは、大きく異なる「ツール」または同様のウィンドウにオンにしたり、既存のウィンドウ ピボット ハブに統合することはできませんの機能が提供されている場合にのみ作成する必要があります。  
  
-   ツール ウィンドウの上部にあるが、必要な場合は、標準のコマンド バーを使用します。  
  
-   コントロールの表示およびキーボード ナビゲーションの他のツール ウィンドウに既に存在パターンと一致します。  
  
-   他のツール ウィンドウでコントロールのプレゼンテーションと一致します。  
  
-   ようにドキュメントに固有のツール ウィンドウ自動表示可能であれば、親ドキュメントをアクティブにするタイミングにのみ表示されるようにします。  
  
-   そのウィンドウの内容がキーボード (矢印キーをサポートする) を使用してナビゲート可能なことを確認します。  
  
#### <a name="tool-window-states"></a>ツール ウィンドウの状態  
Visual Studio のツール ウィンドウには、(自動的に隠す機能) のようなユーザーでアクティブ化されるこれらの一部は、別の状態があります。 他の状態、自動表示と同様に、正しいコンテキストに存在し、必要ない場合に非表示にするツール ウィンドウを許可します。 合計で 5 つのツール ウィンドウの状態があります。  
  
-   **ドッキング ピン留め**ツール ウィンドウは、ドキュメント領域の 4 辺のいずれかにアタッチできます。 プッシュピン アイコンは、ツール ウィンドウのタイトル バーに表示されます。 ツール ウィンドウは、シェルと他のツール ウィンドウの端に垂直または水平にドッキングでき、タブにリンクされることができます。  
  
-   **自動非**ツール ウィンドウはピン留めできません。 ウィンドウは、ドキュメント領域の端に (ツール ウィンドウ、およびアイコンの名前) を使用してタブを残したまま、見えないスライドできます。 ツール ウィンドウはスライドして、ユーザーがタブ上に置いたときにします。  
  
-   **自動表示**ツール ウィンドウは、エディターのように、UI の別の部分が起動するかフォーカス時に自動的に表示されます。  
  
-   **浮動小数点**ツール ウィンドウ、IDE の外部マウス ポインターを移動します。 これは、マルチ モニターの構成に役立ちます。  
  
-   **タブ付きドキュメント**ツール ウィンドウをドキュメント内でもドッキングできます。 これより広い領域が許容枠の端にドッキングする必要があるオブジェクト ブラウザーのように、大規模なツール ウィンドウに役立ちます。  
  
![ツール ウィンドウの状態を Visual Studio で](../../extensibility/ux-guidelines/media/0702-01_toolwindowstates.png "0702 01_ToolWindowStates")<br />Visual Studio でのツール ウィンドウの状態
  
#### <a name="single-instance-and-multi-instance"></a>単一インスタンスおよび複数インスタンス  
ツール ウィンドウは、単一インスタンスまたは複数のインスタンスです。 いくつかの単一インスタンスのツール ウィンドウは、複数インスタンスのツール ウィンドウがない場合があります間アクティブなドキュメント ウィンドウに関連付けられた考えられます。 マルチ インスタンス ツールの windows に応答、**ウィンドウ&gt;新しいウィンドウ**コマンドで、ウィンドウの新しいインスタンスを作成します。 次の図は、ウィンドウのインスタンスがアクティブなときに、新規ウィンドウ を有効にするツール ウィンドウを示しています。  
  
!['新しいウィンドウ' コマンド ウィンドウのインスタンスを有効にするツール ウィンドウがアクティブな](../../extensibility/ux-guidelines/media/0702-02_toolwindowenablingcommand.png "0702 02_ToolWindowEnablingCommand")<br />ツール ウィンドウのウィンドウのインスタンスがアクティブなときに、' 新規ウィンドウ ' を有効にします。  
  
単一インスタンスのツール ウィンドウを非表示または表示され、ツール ウィンドウの複数インスタンスで終了したりできるよう非表示にできます。 タブにリンクされた、フローティング、またはマルチ ドキュメント インターフェイス (MDI) 子ウィンドウ (ドキュメント ウィンドウに類似) として設定されて、すべてのツール ウィンドウをドッキングされることができます。 すべてのツール ウィンドウは、[ウィンドウ] メニューの適切なウィンドウ管理コマンドに応答する必要があります。  
  
![ウィンドウ管理メニュー コマンドでは、Visual Studio ウィンドウ](../../extensibility/ux-guidelines/media/0702-03_windowmanagementcontrols.png "0702 03_WindowManagementControls")<br />Visual Studio のウィンドウ メニューにウィンドウ管理コマンド
  
#### <a name="document-specific-tool-windows"></a>ドキュメントに固有のツール ウィンドウ  
ドキュメントの特定の種類に基づいて変更するのには、一部のツール ウィンドウは設計されています。 これらのウィンドウは、IDE で作業中のドキュメント ウィンドウに適用可能な機能を反映するために継続的に更新します。  
  
ツール ウィンドウの内容が変更を選択されたエディターを反映するには、ツールボックス、ドキュメント アウトラインがあります。 これらのウィンドウは、エディター ウィンドウにコンテキストを提供しませんをフォーカスがあるときに透かしを表示します。  
  
#### <a name="navigable-list-tool-windows"></a>ツール ウィンドウのナビゲート可能なリスト  
一部のツール ウィンドウは、ナビゲート可能な項目が、ユーザーが操作の一覧を表示します。 この種類のウィンドウでは、常にあります一覧で、現在の項目のフィードバックをウィンドウがアクティブでない場合でも。 一覧に対処する必要があります、 **GoToNextLocation**と**GoToPrevLocation**も、ウィンドウで現在選択されている項目を変更してコマンド  
  
ツール ウィンドウのナビゲート可能な一覧には、ソリューション エクスプ ローラーと検索結果 ウィンドウがあります。  
  
### <a name="tool-window-types"></a>ツール ウィンドウの種類  
  
#### <a name="common-tool-windows-and-their-functions"></a>一般的なツール ウィンドウとその機能

**階層的なツール ウィンドウ**
| ツール ウィンドウ | 関数 | 
| --- | --- | 
| ソリューション エクスプローラー | プロジェクト、その他のファイル、およびソリューション項目に含まれているドキュメントの一覧を表示する階層ツリー。 プロジェクト内のアイテムの表示は、プロジェクトの種類 (たとえば、参照に基づく、ディレクトリ ベース、または混合モードの種類) を所有しているパッケージで定義されます。 | 
| クラス ビュー | クラスおよびドキュメント、ファイル自体に依存しないのワーキング セットのさまざまな要素の階層ツリー。 | 
| サーバー エクスプローラー | ソリューションのすべてのサーバーとデータ接続を表示する階層ツリー。 | 
| [ドキュメント アウトライン] | アクティブ ドキュメントの階層構造です。 | 

**ツール ウィンドウのグリッド**
| ツール ウィンドウ | 関数 | 
| --- | --- | 
| プロパティ | 値ピッカーをこれらのプロパティを編集すると、選択したオブジェクトのプロパティの一覧を表示するグリッドです。 | 
| タスク一覧 | により、ユーザーの作成/編集/削除タスクとコメントをグリッドです。 | 

**コンテンツのツール ウィンドウ**
| ツール ウィンドウ | 関数 | 
| --- | --- | 
| ヘルプ | 「操作方法」からのヘルプを見るのさまざまなメソッドへのアクセスをユーザーに許可する ウィンドウ MSDN フォーラムにビデオです。 | 
| ダイナミック ヘルプを表示 | 現在の選択範囲に該当するトピックへのリンクを表示するツール ウィンドウ。 | 
| オブジェクト ブラウザー | 階層化されたオブジェクト コンポーネントで、左側のウィンドウとオブジェクトのプロパティと、右側の列内のメソッドの一覧を含む 2 つの列フレーム セット。 | 

**ダイアログのツール ウィンドウ**
| ツール ウィンドウ | 関数 | 
| --- | --- | 
| [検索] | ダイアログ ボックスまたは検索における検索し、置換、ソリューション内のさまざまなファイルをユーザーことができます。 |
| 高度な検索 | ダイアログ ボックスまたは検索における検索し、置換、ソリューション内のさまざまなファイルをユーザーことができます。 | 

**他のツール ウィンドウ**
| ツール ウィンドウ | 関数 | 
| --- | --- | 
| ツールボックス | ツール ウィンドウは、一貫性のあるドラッグ ソースを提供するすべてのデザイナーのデザイン画面上に削除される要素を格納するために使用します。 |
| スタート ページ | 開発者向けのニュース、Visual Studio ヘルプ、および最近使用したプロジェクトのフィードへのアクセス権を持つユーザーのポータル、Visual Studio です。 ユーザーから StartPage.xaml ファイルをコピーしてカスタム スタート ページを作成できます、"Common7\IDE\StartPages\" Visual Studio program files ディレクトリを Visual Studio で StartPages フォルダーにディレクトリ、およびし編集するか、XAML のドキュメント手の形または Visual Studio または別のコード エディターで開きます。 | 

**デバッガーのツール ウィンドウ**
| ツール ウィンドウ | 関数 | 
| --- | --- |
| Autos ||  
| イミディエイト ||  
| 出力 | テキスト形式のイベントや状態を宣言する必要があるたびに、出力ウィンドウを使用できます。 |  
| メモリ ||  
| ブレークポイント ||  
| 実行中 ||  
| ドキュメント ||  
| 呼び出し履歴 ||  
| ローカル ||  
| ウォッチ ||  
| 逆アセンブリ ||  
| レジスタ ||  
| スレッド ||  
  
##  <a name="BKMK_DocumentEditorConventions"></a>ドキュメント エディターの表記規則  
  
### <a name="document-interactions"></a>ドキュメントの相互作用  
"Document well"、ide の領域が最も大きいは、ここでユーザー一般に中心とする、支援補足的なツール ウィンドウで、タスクを完了するためにします。 文書の編集者は、ユーザーが開き、Visual Studio 内で保存する作業の基本的な単位を表します。 ソリューション エクスプ ローラーや他のアクティブな階層ウィンドウに関連付けられている選択範囲の厳密な意味は保持されます。 ユーザーが、これらの階層ウィンドウの 1 つをポイントして、ソリューション、プロジェクト、または Visual Studio パッケージによって提供される他のルート オブジェクトのいずれかをドキュメントが含まれているとの関係を認識しているはずです。  
  
ドキュメントの編集には、一貫性のあるユーザー エクスペリエンスが必要です。 前のタスクの代わりにウィンドウの管理とコマンドの検索に重点を置くユーザーを許可するのには、そのドキュメントの種類を編集するため、ユーザーのタスクに最適なドキュメント ビュー戦略を選択します。  
  
#### <a name="common-interactions-for-the-document-well"></a>ドキュメント ウェルの一般的な相互作用  
  
-   共通の一貫性のある相互作用モデルを維持**新しいファイル**と**ファイルを開く**で発生します。  
  
-   ドキュメント ウィンドウが開いたときに、関連するウィンドウおよびメニューに関連する機能を更新します。  
  
-   などの共通のメニューにメニュー コマンドが統合されて適切に**編集**、**形式**、および**ビュー**メニュー。 大量の特殊化されたコマンドが使用可能な場合には、新しいメニューを作成することができます。 ドキュメントにフォーカスがある場合にのみ、この新しいメニューが表示されます。  
  
-   埋め込みツールバーは、エディターの上部に配置できます。 エディターの外部に表示される個別のツールバーを持つようにこれをお勧めします。  
  
-   ソリューション エクスプ ローラーまたは類似のアクティブな選択を常に維持 [階層] ウィンドウ。  
  
-   ソリューション エクスプ ローラーでドキュメントをダブルクリックとして同じアクションを実行する必要があります**開く**です。  
  
-   ユーザーをオーバーライドまたは特定のドキュメントの種類を使用して、[既定のアクションをリセットできるようにする必要があります、ドキュメントの種類の 1 つ以上のエディターを使用することができる場合、**ファイルを開く**ファイルを右クリックしを選択] ダイアログ ボックス**開く**ショートカット メニューからです。  
  
-   ドキュメントのウィザードをも構築しません。  
  
### <a name="user-expectations-for-specific-document-types"></a>特定のドキュメントの種類のユーザーの期待  
ドキュメント エディターのいくつかの異なる基本型があるし、それぞれが、同じ種類の他のユーザーと一貫性のある相互作用のセット。  
  
-   **テキスト ベースのエディター:**コード エディター、ログ ファイル  
  
-   **デザイン サーフェイス:** WPF フォーム デザイナー、Windows フォーム  
  
-   **ダイアログ スタイルの編集:**マニフェスト デザイナー、プロジェクトのプロパティ  
  
-   **モデル デザイナー:** 、ワークフロー デザイナー、codemap、アーキテクチャの図の流れ  
  
またはも、ドキュメントを使用するいくつかのエディター以外の種類があります。 ドキュメント自体を編集がない、次のドキュメント ウィンドウの標準的な対話する必要はします。  
  
-   **レポート:** IntelliTrace レポート、HYPER-V は、レポート、プロファイラー レポート  
  
-   **ダッシュ ボード:**診断ハブ  
  
#### <a name="text-based-editors"></a>テキスト ベースのエディター  
  
-   ドキュメントは、プレビュー タブ モデルを開かずに、ドキュメントをプレビューするために参加します。  
  
-   ドキュメント アウトラインなどのコンパニオン ツール ウィンドウ内では、ドキュメントの構造を表すことができます。  
  
-   IntelliSense (該当する場合) が、他のコード エディターで一貫して動作します。  
  
-   ポップアップや補助的な UI は、既存のような UI、CodeLens のと同様のスタイルとパターンに従います。  
  
-   または、ステータス バーに、ドキュメントの上部にある情報バー コントロールでドキュメントの状態に関するメッセージが表示されます。  
  
-   ユーザーは、フォントおよび色を使用しての外観をカスタマイズできる必要があります、**ツール > オプション**ページ、共有の [フォントおよび色] ページまたは特定のエディターを 1 つのいずれか。  
  
#### <a name="design-surfaces"></a>デザイン画面  
  
-   空のデザイナーは、作業を開始する方法を示す画面で、透かしが必要です。  
  
-   ビューの切り替えのメカニズムをダブルクリックしてコード エディター、または両方のウィンドウとの対話を許可するドキュメント ウィンドウ内のタブを開くなどの既存のパターンに従います。  
  
-   固有のツール ウィンドウが必要ない場合、ツールボックスを使用して、デザイン画面に要素を追加することを行ってください。  
  
-   画面上のアイテムには、一貫性のある選択モデルに従います。  
  
-   など、埋め込みのツールバーにドキュメントに固有のコマンドのみであり、一般的なコマンドが含まれている**保存**です。  
  
#### <a name="dialog-style-editors"></a>スタイル ダイアログ エディター  
  
-   コントロールのレイアウトは、通常のダイアログのレイアウト規則に従う必要があります。  
  
-   エディター内のタブは、ドキュメント タブの外観と一致しないように、許可されている内部 タブの 2 つのスタイルのいずれかに一致する必要があります。  
  
-   ユーザーは、キーボードのみを使用するコントロールと対話できる必要があります。標準のニーモニックを使用して、エディターをアクティブ化とタブのコントロールを通して、または、いずれか。  
  
-   デザイナーには、共通モデルの保存を使用する必要があります。 全体的な保存やコミット ボタン配置する必要ありません画面で、適切な他のボタンがあります。  
  
#### <a name="model-designers"></a>モデル デザイナー  
  
-   空のデザイナーは、作業を開始する方法を示す画面で、透かしが必要です。  
  
-   デザイン画面に要素を追加することは、ツールボックスを使用して行う必要があります。  
  
-   画面上のアイテムには、一貫性のある選択モデルに従います。  
  
-   など、埋め込みのツールバーにドキュメントに固有のコマンドのみであり、一般的なコマンドが含まれている**保存**です。  
  
-   凡例の指示またはウォーターマークの表面に表示されます。  
  
-   ユーザーは、使用するフォントと色の外観をカスタマイズできる必要があります、**ツール > オプション**ページ、共有の [フォントおよび色] ページまたは特定のエディターを 1 つのいずれか。  
  
#### <a name="reports"></a>レポート  
  
-   レポートは通常情報専用であり、モデルの保存 に参加しません。 ただし、他の関連情報または展開したり折りたたんだりするセクションへのリンクなどの操作が含まれる場合します。  
  
-   サーフェイス上のほとんどのコマンドは、ハイパーリンク、ボタンではないをする必要があります。  
  
-   レイアウトは、ヘッダーが含まれます、標準のレポート レイアウトのガイドラインに従う必要があります。  
  
#### <a name="dashboards"></a>ダッシュボード  
  
-   ダッシュ ボード必要はありませんが相互作用モデル自体には、さまざまな他のツールを提供するための手段として機能します。  
  
-   モデルの保存 で、参加しません。  
  
-   ユーザーは、エディターをアクティブ化して、コントロール間をタブ移動するか、標準のニーモニックを使用して、キーボードのみを使用するコントロールと対話できる必要があります。  
  
##  <a name="BKMK_Dialogs"></a>ダイアログ ボックス  
  
### <a name="introduction"></a>はじめに  
Visual Studio でのダイアログでは、通常 1 つの個々 のユーザーの作業単位をサポートする必要があり、し、破棄できます。  
  
ダイアログ ボックスを必要があることを確認したらがある場合、3 つのオプションの優先順位で。  
  
1.  Visual Studio での共有ダイアログのいずれかの機能を統合します。  
  
2.  既存のようなダイアログで検出されたパターンを使用して、独自のダイアログを作成します。  
  
3.  新しいダイアログ ボックス、次の interaction およびレイアウトのガイドラインを作成します。  
  
このセクションでは、Visual Studio ワークフロー内の適切なダイアログ パターンと、ダイアログのデザインの一般的な規則を選択する方法について説明します。  
  
### <a name="themes"></a>テーマ  
Visual Studio でのダイアログ ボックスでは、次の 2 つの基本的なスタイルのいずれかに従います。  
  
#### <a name="standard-unthemed"></a>標準 (unthemed)  
大部分のダイアログ ボックスの標準のユーティリティのダイアログ ボックスは、unthemed をする必要があります。 「最新の」定型のボタンやコントロールを作成しようとしたり再テンプレート共通コントロールではなくをしないでください。 コントロールとに従って chrome 外観[ ダイアログ ボックスの標準の Windows デスクトップの相互作用ガイドライン](https://msdn.microsoft.com/en-us/library/windows/desktop/dn742499\(v=vs.85\).aspx)です。  
  
#### <a name="themed"></a>テーマ  
Specialty「署名」ダイアログは、テーマが適用された可能性があります。 テーマが適用されたダイアログ ボックスでは、スタイルに関連付けられているいくつかの特別な相互作用のパターンを持つ独自の外観があります。 テーマのダイアログは、これらの要件を満たしている場合のみ。  
  
-   ダイアログ ボックスが表示され、多くの場合、または多くのユーザーによって使用される共通のエクスペリエンスは、(たとえば、**新しいプロジェクト**ダイアログ。  
  
-   ダイアログには、著名な製品ブランド要素が含まれています (たとえば、**アカウント設定**ダイアログ)。  
  
-   他のテーマが適用されたダイアログ ボックスを含む大きなフローの一部として、ダイアログ ボックスが表示されます (たとえば、**接続済みサービスの追加**ダイアログ)。  
  
-   ダイアログ ボックスは、昇格または製品バージョンを区別する戦略的な役割を果たす、エクスペリエンスの重要な部分です。  
  
テーマが適用されたダイアログを作成するには、適切な環境の色を使用し、正しいレイアウトと相互作用のパターンに従います。 (を参照してください[for Visual Studio のレイアウト](../../extensibility/ux-guidelines/layout-for-visual-studio.md))。  
  
### <a name="dialog-design"></a>ダイアログのデザイン  
適切に設計されたダイアログ ボックスは、次の要素を考慮に入れておきます。  
  
-   サポートされているユーザーのタスク  
  
-   ダイアログのテキストのスタイル、言語、および用語集  
  
-   コントロールの選択肢と UI 規則  
  
-   視覚的なレイアウトの仕様とコントロールの配置  
  
-   キーボード アクセス  
  
#### <a name="content-organization"></a>コンテンツの編成  
これらの基本的な種類のダイアログの相違点を考慮してください。  
  
-   [単純なダイアログ](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_SimpleDialogs)1 つのモーダル ウィンドウでコントロールを表示します。 プレゼンテーションには、複雑なコントロール パターン、フィールドの選択、アイコン バーなどのバリエーションが含まれます。  
  
-   [ダイアログ ボックスを階層化](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_LayeredDialogs)1 つの UI コントロールの複数のグループを構成するときに、実際の画面を最大限に活用するために使用します。 ダイアログ ボックスのグループ化「階層化されている」タブ コントロール、ナビゲーションのリスト コントロールまたはボタンをユーザーが特定の時点で表示するグループ化を選択できるようにします。  
  
-   [ウィザード](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_Wizards)ユーザー タスクの完了に向けた手順の論理シーケンス全体を送信するのに便利です。 一連の選択肢は、シーケンシャル パネル、前のパネルで行った選択に依存するさまざまなワークフロー (「分岐」) の場合もあります概要で提供されます。  
  
####  <a name="BKMK_SimpleDialogs"></a>単純なダイアログ ボックス  
単純なダイアログは、1 つのモーダル ウィンドウ内のコントロールのプレゼンテーションです。 このプレゼンテーションには、フィールドの選択などの複雑なコントロール パターンのバリエーションが含まれます。 単純なダイアログは、標準の一般的なレイアウトだけでなく、複雑なコントロールのグループ化に必要な特定のレイアウトに従います。
  
![> 作成厳密な名前キーは、Visual Studio での単純なダイアログの例を示します。] (../../extensibility/ux-guidelines/media/0704-01_createstrongnamekey.png "0704 01_CreateStrongNameKey")<br />作成する厳密な名前キーは、Visual Studio での単純なダイアログの例を示します。
  
####  <a name="BKMK_LayeredDialogs"></a>階層化ダイアログ  
複数層のダイアログ ボックスには、タブ、ダッシュ ボード、および埋め込みのツリーが含まれます。 1 つの UI で提供されるコントロールの複数のグループがある場合は、不動産を最大限に使用されます。 ユーザーが任意の時点で表示するグループ化を選択できるように、グループに配置されます。  
  
最も簡単な場合は、グループ化を切り替えるためのメカニズムは、タブ コントロールです。 使用可能ないくつかの選択肢ができます。 優先順位を指定し、最も適切なスタイルを選択する方法の重ね順を参照してください。  
  
**ツール&gt;オプション**ダイアログが埋め込まれたツリーを使用して階層化 ダイアログ ボックスの例を示します。  
  
![ツール > オプションは、Visual Studio での階層ダイアログの例を示します。] (../../extensibility/ux-guidelines/media/0704-02_toolsoptions.png "0704 02_ToolsOptions")<br />ツール > オプションは、Visual Studio での階層ダイアログの例を示します。
  
####  <a name="BKMK_Wizards"></a>ウィザード  
ウィザードは、タスクを完了するまでに、ユーザーの手順の論理シーケンス全体をリダイレクトするため便利です。 シーケンシャルなパネルは、一連の選択肢が提供され、ユーザーは、次に進む前に、各ステップを続行する必要があります。 後のための十分な既定値は、使用可能な**完了**ボタンが有効にします。  
  
 モーダル ウィザードがタスクに使用されること。  
  
-   ユーザーの選択に応じて異なるパスを提供する場所、分岐を含む  
  
-   以降の手順が上記のステップからの入力をユーザーに依存する場合、手順間の依存関係を含める  
  
-   十分に複雑な選択肢を提供し、各ステップで返される結果を説明する UI を使用することは、します。  
  
-   トランザクション、すべての変更がコミットされるまでそのままで完了する手順のセットを必要とします。  
  
### <a name="common-conventions"></a>一般的な規則  
最適な設計とをダイアログ ボックスを使用して機能を実現するためにダイアログのサイズ、位置、標準、コントロールの構成と配置、UI テキスト、タイトル バー、コントロール ボタン、およびアクセス キーでこれらの規則に従います。  
  
レイアウトに固有のガイドラインについては、次を参照してください。 [for Visual Studio のレイアウト](../../extensibility/ux-guidelines/layout-for-visual-studio.md)です。  
  
#### <a name="size"></a>サイズ  
ダイアログ ボックスが最小 1024 x 768 の画面解像度に収まるようにし、初期のダイアログのサイズが 900 x 700 ピクセルを超えないです。 ダイアログ ボックスのサイズを変更すると、できることがありますが、必須ではありません。  
  
ダイアログのサイズ変更可能な場合の 2 つの推奨事項があります。  
  
1.  最小サイズが、定義されているコントロールの最適化は、ダイアログの、クリッピングなしに設定し、適切なローカライズ成長に対応する調整します。  
  
2.  ユーザー スケール サイズが保持されるセッションです。 たとえば場合は、ユーザーは、150% するためのダイアログを拡張、ダイアログ ボックスの後続の起動は 150% で表示されます。  
  
#### <a name="position"></a>位置  
ダイアログ ボックスは、ide の最初の起動時に中央揃えで表示されます必要があります。 サイズを変更できないダイアログ ボックスの最後の位置は、それ以降の起動時の中央に表示されるように、永続化する必要はありません。 

をダイアログのサイズ変更可能な場合は、それ以降の起動時サイズを永続化する必要があります。 サイズ変更のモーダル ダイアログ ボックスの位置は、永続化する必要はありません。 IDE 内で中央揃えに表示する方法、ユーザーのディスプレイの構成が変更されたときに、予期しないまたは使用不可の位置に表示されるダイアログ ボックスの発生を防止します。 

移動できるモードレスのダイアログ ボックスのユーザーの位置を維持するそれ以降の起動時、ダイアログ ボックスは、大規模なワークフローの一環として頻繁に使用する可能性があります。  
  
最上位のダイアログを右側に連鎖する必要がありますのダイアログ ボックスでは、他のダイアログを起動する必要があります、ときに、下の新しい場所に移動することをユーザーに明らかなように親からです。  
  
#### <a name="modality"></a>モーダルかどうか  
モーダルの中では、ユーザーが完了するか、続行する前に、ダイアログ ボックスを取り消す必要があることを意味します。 モーダル ダイアログ ボックスでは、環境内の他の部分との対話ユーザーをブロックするため、機能のタスク フローそれらの使用できるだけ控えめします。 モーダル操作が必要な場合は、Visual Studio は、ダイアログの数と共有に機能を取り込むことができますがします。 新しいダイアログ ボックスを作成する必要がある場合は、同様の機能と既存のダイアログの相互作用のパターンに従います。  
  
ユーザーは、一度に 2 つのアクティビティを実行する必要がある場合と同様に**検索**と**置換**新しいコードを書き込み中に、ダイアログするモードレスようにして、ユーザーはそれらの間に簡単に切り替えることができます。 通常、visual Studio は、この種類のリンクされたタスクのエディター サポート ツール ウィンドウを使用します。  
  
#### <a name="control-configuration"></a>コントロールの構成  
Visual Studio で同じことを実現する既存のコントロール構成と一致します。  
  
#### <a name="title-bars"></a>タイトル バー  
  
-   タイトル バーのテキストは、起動したコマンドの名前を反映する必要があります。  
  
-   ダイアログのタイトル バーにアイコンを使用しません。 システムが必要な 1 つの場合、Visual Studio のロゴを使用します。  
  
-   ダイアログ ボックスのない最小限に抑えるか、ボタンを最大化します。  
  
-   タイトル バーのヘルプ ボタンは廃止されました。 新しいダイアログ ボックスにそれらを追加しないでください。 存在する場合は概念的には、タスクに関連するヘルプ トピックを開始します。  
  
 ![Visual Studio のダイアログ ボックスのタイトル バーのガイドライン仕様](../../extensibility/ux-guidelines/media/0704-03_titlebarspecs.png "0704 03_TitleBarSpecs")<br />Visual Studio のダイアログ ボックスのタイトル バーのガイドラインの仕様
  
#### <a name="control-buttons"></a>コントロールのボタン  
一般に、 **OK**、**キャンセル**、および**ヘルプ**ボタンは、ダイアログ ボックスの右下隅の水平方向に整列する必要があります。 代替垂直スタックには、ダイアログ コントロールのボタンを備えた visual 混乱であれば、ダイアログの下部にあるその他のいくつかのボタンがある場合は許可されています。  
  
![Visual Studio のダイアログ ボックスでコントロールのボタンの許容可能な構成](../../extensibility/ux-guidelines/media/0704-04_controlbuttonconfig.png "0704 04_ControlButtonConfig")<br />Visual Studio のダイアログ ボックスでコントロールのボタンの許容可能な構成
  
ダイアログ ボックスでは、既定のコントロール ボタンを含める必要があります。 既定値として使用する最適なコマンドを確認するのには、(優先度順に表示されます)、次のオプションから選択します。  
  
-   既定値として、最も安全かつ最も安全なコマンドを選択します。 これは、意図しないシステムへのアクセスとデータの損失を防ぐために最も可能性の高いコマンドを選択することを意味します。  
  
-   データの損失やセキュリティの要因はない場合は、利便性に基づく既定のコマンドを選択します。 既定値として最も可能性の高いコマンドなどにより、ダイアログ ボックスは、頻度または反復的なタスクをサポートしている場合、ユーザーのワークフローが向上します。  
  
既定のコマンドを完全に破壊的な操作を選択しないでください。 このようなコマンドが存在する場合、代わりに既定値としてより安全なコマンドを選択します。  
  
#### <a name="access-keys"></a>アクセス キー  
アクセス キーを使用しないでください**OK**、**キャンセル**、または**ヘルプ**ボタン。 これらのボタンは、既定では、ショートカット キーにマップされます。  
  
| ボタン名 | キーボード ショートカット |  
| --- | --- |  
| OK | Enter |  
| キャンセル | Esc |  
| ヘルプ | F1 |  
  
#### <a name="imagery"></a>画像  
ダイアログ ボックスでイメージを多用します。 領域を使用するだけで、ダイアログ ボックスで 大きいアイコンを使用しないでください。 警告アイコンまたはステータス アニメーションと同様に、ユーザーにメッセージを伝達するの重要な一部である場合にのみ、イメージを使用します。  
  
###  <a name="BKMK_PrioritizingAndLayering"></a>優先順位を付けると、レイヤー化  
  
#### <a name="prioritizing-your-ui"></a>UI の優先順位付け  
Forefront に特定の UI 要素を移動しより高度な動作とダイアログ ボックスにオプション (あいまいなコマンドを含む) に配置する必要がある場合があります。 領域を確保することでことで、表示されている既定のテキスト ラベルが UI で、ダイアログ ボックスが表示されると、forefront に一般的に使用される機能を表示します。  
  
#### <a name="layering-your-ui"></a>UI をレイヤー化  
ダイアログが必要ですが、ユーザーに提示する、関連する機能が単純なダイアログに表示できる内容を超えるを特定する場合は、レイヤーの UI にする必要があります。 Visual Studio を使用して、最も一般的な重ねメソッドはタブと通路またはダッシュ ボードです。 場合によっては、展開したり折りたたんだりできる領域は適切なにあります。 アダプティブ UI が Visual Studio で通常推奨されません。  
  
階層化 タブのようなコントロールを使用して UI のさまざまな方法に長所と短所があります。 状況に合わせて適切な層手法を選択していることを確認するには下の一覧を確認します。  
  
##### <a name="tabbing"></a>タブ移動  
  
| メカニズムの切り替え | 利点と適切な使用 | 短所と不適切な使用 |  
| --- | --- | --- |  
| タブ コントロール | 関連する設定 ダイアログ ページを論理的にグループ化します。<br /><br />5 つより少ない (または、ダイアログ ボックスで 1 つの行に合わせてタブの数) に役立つ関連するコントロール ダイアログ ボックスのページ<br /><br />タブ ラベルを簡単にする必要があります: コンテンツを容易に識別できる 1 つまたは 2 つの単語<br /><br />一般的なシステム ダイアログのスタイル<br /><br />例:**エクスプ ローラー&gt;アイテムのプロパティ** | わかりやすい短いラベルの作成は難しいがあります。<br /><br />一般には、拡張が過去の 1 つのダイアログ ボックスで 5 つのタブ<br /><br />不適切なは、1 つの行 (重ね順の代替手法を使用) の多くのタブがある場合<br /><br />拡張できません。 |  
| サイド バー ナビゲーション | その他のカテゴリ タブよりも含むことができる単純な切り替え装置<br /><br />カテゴリ (階層構造) の単純なリスト<br /><br />拡張可能です<br /><br />例:**をカスタマイズしています.&gt;コマンドを追加します。** | 水平方向の領域よりも少ない 3 つのグループがある場合の適切な使い方ではありません。<br /><br />タスクがドロップダウン リストに適したより適切にされる可能性があります。 |  
| ツリー コントロール | 無制限のカテゴリでは、します。<br /><br />グループ化やカテゴリの階層では、します。<br /><br />拡張可能です<br /><br />例:**ツール&gt;オプション** | 頻度の高い入れ子構造の階層には、過剰な水平方向にスクロール可能性があります。<br /><br />Visual Studio がツリー ビューの思わぬ意味 |  
| ウィザード | タスク ベースで連続的な手順に従って、ユーザーを示すことで、タスクの完了に使用しますウィザードは高レベルのタスクを表し、各パネルが全体的なタスクを実行するために必要なサブタスクを表します。<br /><br />タスクは、ときに、ユーザーは、複数のエディターを使用して、ツール ウィンドウのタスクを完了する必要がそれ以外の場合と、Ui の境界を越える場合に便利です。<br /><br />タスクの分岐が必要な場合に役立ちます。<br /><br />タスクには、手順間の依存関係が含まれている場合に役立ちます。<br /><br />別のようなダイアログの数を減らすために 1 つのダイアログ ボックスで意思決定の 1 つの分岐でのいくつかのようなタスクを提示するときに便利です。 | シーケンシャル ワークフローを必要としないタスクに対して不適切です<br /><br />ユーザーが過負荷状態になり、ステップが多すぎると、ウィザードによってになることができます。<br /><br />ウィザードには、実際の画面が限られている本質的に |  
  
##### <a name="hallways-or-dashboards"></a>通路またはダッシュ ボード  
通路とダッシュ ボードは、ダイアログやその他のダイアログ ボックスおよびウィンドウへのポインターを起動する役目をするパネルがします。 すぐにサーフェスのみ、最も一般的なオプション、コマンド、およびユーザーがすぐに一般的なタスクを実行できるように、設定を適切に設計された「廊下」です。 実際の廊下では、その背後にあるルームにアクセスする出入りを提供するようにはここより一般的な UI は個別「ルーム」(多くの場合、その他のダイアログ ボックス) のメインの廊下からアクセスできる関連する機能に収集されます。  
  
代わりに、UI をより一般的な機能を別の場所をリファクタリングとは、単にダッシュ ボードではなく、単一のコレクションで使用可能なすべての機能を提供します。  
  
![Outlook で追加の UI を公開するための廊下の概念](../../extensibility/ux-guidelines/media/0704-08_hallway.png "0704 08_Hallway")<br />Outlook で追加の UI を公開するための廊下の概念
  
##### <a name="adaptive-ui"></a>アダプティブ UI  
使用状況に基づいて、UI の表示と非表示、または自己報告のユーザー エクスペリエンスが必要な UI を表示するのには他の部分を非表示の別の方法を示します。 これは、UI を非表示かを決めるためのアルゴリズムは複雑になることができ、ルールは、一部のケースのセットの間違ったが必ず、Visual Studio で、推奨されません。  
  
##  <a name="BKMK_Projects"></a>プロジェクト  
  
### <a name="projects-in-the-solution-explorer"></a>ソリューション エクスプ ローラーでプロジェクト  
ほとんどのプロジェクトは、その参照に基づく、ディレクトリ ベース、または混合に分類されます。 次の 3 つすべての種類のプロジェクトは、ソリューション エクスプ ローラーで同時にサポートされます。 プロジェクトを操作するために、ユーザー エクスペリエンスのルートは、このウィンドウ内行われます。 別のプロジェクト ノードは、参照、ディレクトリ、または混在モードの種類のプロジェクトには、プロジェクト固有のユーザーのパターンに分岐する前に開始点として適用される一般的な相互作用のパターンはします。  
  
プロジェクトには常にする必要があります。  
  
-   プロジェクトの内容を整理するフォルダーをプロジェクトに追加する機能のサポート  
  
-   プロジェクトの永続化を一貫したモデルを管理します。  
  
プロジェクトの一貫性のある相互作用のモデルの管理もする必要があります。  
  
-   プロジェクト項目の削除  
  
-   ドキュメントの保存  
  
-   プロジェクト プロパティの編集  
  
-   代替ビューで、プロジェクトの編集  
  
-   ドラッグ アンド ドロップ操作  
  
### <a name="drag-and-drop-interaction-model"></a>ドラッグ アンド ドロップ操作モデル  
プロジェクトを通常分類自体の参照をベースとして (記憶域内のプロジェクト アイテムへの参照のみを保持すること)、ディレクトリ ベースの (唯一のプロジェクト項目を物理的に永続化することが格納されているプロジェクトの階層内で)、または混合 (参照を保持することまたは 物理アイテム) で変更します。 IDE 内で同時に 3 つすべての種類のプロジェクトに対応、**ソリューション エクスプ ローラー**です。  
  
ドラッグ アンド ドロップの観点から、次の特性を内のプロジェクトの種類ごとに適用する必要があります、**ソリューション エクスプ ローラー**:  
  
-   **プロジェクトの参照に基づく:**重要な点は、プロジェクトがストレージ内の項目への参照をドラッグすることです。 参照に基づくプロジェクトは、移動操作のソースとして動作しているときにのみプロジェクトからアイテムへの参照を削除する必要があります。 項目いない実際に削除してください、ハード ドライブから。 参照に基づくプロジェクトは、移動またはコピー操作のターゲットとして機能、際は、アイテムのプライベート コピーを作成せず、元のソース項目への参照を追加、します。  
  
-   **プロジェクトのディレクトリに基づく:**ドラッグ アンド ドロップの観点から、プロジェクトが参照ではなく、物理的なアイテムの周囲でドラッグすることです。 ディレクトリ ベースのプロジェクトは、移動操作のソースとして動作している場合、ハード ドライブから物理的な項目を削除するだけでなく、プロジェクトから削除することを終了しなければなりません。 ディレクトリ ベースのプロジェクトは、移動またはコピー操作のターゲットとして機能する場合、は、元の項目のコピーのターゲットの場所にそのください。  
  
-   **混在ターゲット プロジェクト:**ドラッグ アンド ドロップの観点からこのプロジェクトの種類の動作に基づきます (記憶域内の項目への参照) または、項目自体のいずれかにドラッグされている項目の種類。 上記の参照、および物理アイテムの正しい動作。  
  
プロジェクトの種類を 1 つだけがあった場合、**ソリューション エクスプ ローラー**、ドラッグ アンド ドロップ操作を簡単にするになります。 各プロジェクト システムは、独自のドラッグ アンド ドロップの動作を定義する機能があるため、予測可能なユーザー エクスペリエンスに (Windows エクスプ ローラー ドラッグ アンド ドロップの動作に基づく) 特定のガイドラインに従ってください。  
  
-   操作をドラッグして、変更されていない、**ソリューション エクスプ ローラー** (と Ctrl も Shift キーが押さ)、移動操作になります。  
  
-   Shift キーを押しドラッグ操作は、移動操作にもなります。  
  
-   Ctrl キーを押しドラッグ操作は、コピー操作になります。  
  
-   参照をベースと混合プロジェクト システムは、元の項目にリンク (または参照) を追加するという概念をサポートします。 これらのプロジェクトがドラッグ アンド ドロップ操作の対象が場合に (ときに**ctrl キーを押しながら shift キーを押し**押されている)、プロジェクトに追加されているアイテムへの参照が発生する必要があります、  
  
すべてのドラッグ アンド ドロップ操作は、参照に基づく、ディレクトリ ベースおよび混在プロジェクトの組み合わせでわかりやすい。 具体的には、問題と、ソース ディレクトリ ベースのプロジェクトでは、移動の完了時に、ソース アイテムを削除する必要があるため、ディレクトリ ベースの移行元のプロジェクトと参照ベースの移行先のプロジェクト間の移動操作を許可する見かけ上です。 対象の参照に基づくプロジェクトししてしまいます、削除された項目への参照。  
  
また、誤解を招くとターゲット参照に基づくプロジェクトはソース項目の独立したコピーにしないようにするために、この種のプロジェクト間でコピー操作を許可する見かけ上です。 同様に、ctrl キーを押しながら shift キーを押し、ディレクトリ ベースの移行先のプロジェクトにドラッグすることは許可されておらず、ディレクトリ ベースのプロジェクトが参照を保持できないためです。 ドラッグ アンド ドロップ操作がサポートされていない場合、IDE を削除を許可しないようにし、(、ポインターの表に示すように) 非ドロップ カーソルが、ユーザーを表示します。  
  
ドラッグ アンド ドロップの動作を正しく実装するのには、ドラッグ ソース プロジェクトをその性質上、ターゲット プロジェクトへの通信をする必要があります。 (たとえばが、参照またはディレクトリに基づくか)この情報は、ソースによって提供されるクリップボードの形式で表されます。 ドラッグ (またはクリップボードのコピーの操作) のソースとしてプロジェクトに表示するいずれかの`CF_VSREFPROJECTITEMS`または`CF_VSSTGPROJECTITEMS`それぞれ、かどうかに応じて、プロジェクト参照に基づくディレクトリ ベースです。 これらの形式の両方のコンテンツを持つ、同じデータ ウィンドウに類似した`CF_HDROP`の書式を除いて、ファイル名ではなく、文字列のリストは、二重の`NULL`のリストを終了`Projref`文字列 (から返される`IVsSolution::GetProjrefOfItem`または`::GetProjrefOfProject`必要に応じて)。  
  
Drop (またはクリップボード貼り付けの操作) のターゲットとしてプロジェクトを承諾`CF_VSREFPROJECTITEMS`と`CF_VSSTGPROJECTITEMS`ドラッグ アンド ドロップ操作の正確な処理は、ターゲット プロジェクトと、ソース プロジェクトの性質によって異なりますが、します。 ソース プロジェクトには、その性質上で提供するかどうかを宣言しています`CF_VSREFPROJECTITEMS`または`CF_VSSTGPROJECTITEMS`です。 ドロップのターゲットが独自の性質を理解し、移動、コピー、かどうかを決定するのに十分な情報をこのようにはまたはリンクを実行する必要があります。 ユーザーは、Ctrl、Shift または ctrl キーと Shift キーを押すとするドラッグ アンド ドロップ操作を実行する必要がありますも変更されます。 ドロップ ターゲットを適切に示す操作を事前にで実行することは重要であるその`DragEnter`と`DragOver`メソッドです。 **ソリューション エクスプ ローラー**ソース プロジェクトとターゲットのプロジェクトが同じプロジェクトがかどうかを自動的に認識します。  
  
Visual Studio のインスタンス (たとえば、devenv.exe を別のインスタンスを 1 つ) からプロジェクト項目をドラッグすることは具体的にはできません。 **ソリューション エクスプ ローラー**直接もこれを無効にします。  
  
ユーザーは、項目を選択し、ターゲットの場所にドラッグすると、次のマウス ポインターの表示され、アイテムを削除する前に確認するドラッグ アンド ドロップ操作の効果を決定できる常にする必要があります。  
  
| マウス ポインター | コマンド | 説明 |  
| :---: | --- | --- |  
| ![マウスの [ドロップしない] アイコン](../../extensibility/ux-guidelines/media/0706-01_mousenodrop.png "0706 01_MouseNoDrop") | ドロップしません。 | 指定した場所に項目を削除できません。 |  
| ![マウスの [コピー] アイコン](../../extensibility/ux-guidelines/media/0706-02_mousecopy.png "0706 02_MouseCopy") | コピー | 項目は、ターゲットの場所にコピーされます。 |  
| ![マウス"move"アイコン](../../extensibility/ux-guidelines/media/0706-03_mousemove.png "0706 03_MouseMove") | 移動 | 項目は、ターゲットの場所に移動されます。 |  
| ![マウスの 参照の追加"アイコン](../../extensibility/ux-guidelines/media/0706-04_mouseaddref.png "0706 04_MouseAddRef") | 参照の追加 | 選択された項目への参照は、ターゲットの場所に追加されます。 |

#### <a name="reference-based-projects"></a>プロジェクトの参照に基づく  
 次の表は、参照されるベースの移行先のプロジェクトの押されたソース項目と修飾子キーの特性に基づき実行する必要があります (切り取り/コピー/貼り付けます) だけでなくドラッグ アンド ドロップ操作をまとめたものです。  
  
| 修飾子 | カテゴリ | ソース項目: 参照/リンク | ソース項目: 項目またはファイル システムの物理 (`CF_HDROP`) |  
| --- | --- | --- | --- |  
| 修飾子なし | 操作 | 移動 | リンク |  
| 修飾子なし | ターゲット | 元の項目への参照を追加します。 | 元の項目への参照を追加します。 |  
| 修飾子なし | ソース | 元の項目への参照を削除 | 元の項目が保持されます。 |  
| 修飾子なし | 結果 | `DROPEFFECT_MOVE`アクションとして返される`::Drop`され、項目がストレージ内の元の場所に残ります | `DROPEFFECT_LINK`アクションとして返される`::Drop`され、項目がストレージ内の元の場所に残ります |  
| Shift キーを押しながらドラッグ | 操作 | 移動 | ドロップしません。 |  
| Shift キーを押しながらドラッグ | ターゲット | 元の項目への参照を追加します。 | ドロップしません。 |  
| Shift キーを押しながらドラッグ | ソース | 元の項目への参照を削除 | ドロップしません。 |  
| Shift キーを押しながらドラッグ | 結果 | `DROPEFFECT_MOVE`アクションとして返される`::Drop`され、項目がストレージ内の元の場所に残ります | ドロップしません。 |  
| Ctrl キーを押しながらドラッグ | 操作 | コピー | ドロップしません。 |  
| Ctrl キーを押しながらドラッグ | ターゲット | 元の項目への参照を追加します。 | ドロップしません。 |  
| Ctrl キーを押しながらドラッグ | ソース | 元の項目への参照を保持します。 | ドロップしません。 |  
| Ctrl キーを押しながらドラッグ | 結果 | `DROPEFFECT_COPY`アクションとして返される`::Drop`され、項目がストレージ内の元の場所に残ります | ドロップしません。 |  
| Ctrl キーを押しながら shift キーを押しながらドラッグ | 操作 | リンク | リンク |  
| Ctrl キーを押しながら shift キーを押しながらドラッグ | ターゲット | 元の項目への参照を追加します。 | 元の項目への参照を追加します。 |  
| Ctrl キーを押しながら shift キーを押しながらドラッグ | ソース | 元の項目への参照を保持します。 | 元の項目が保持されます。 |  
| Ctrl キーを押しながら shift キーを押しながらドラッグ | 結果 | `DROPEFFECT_LINK`アクションとして返される`::Drop`され、項目がストレージ内の元の場所に残ります | `DROPEFFECT_LINK`アクションとして返される`::Drop`され、項目がストレージ内の元の場所に残ります |  
| Ctrl キーを押しながら shift キーを押しながらドラッグ | メモ | Windows エクスプ ローラーのショートカット キーのドラッグ アンド ドロップの動作と同じです。 ||  
| 切り取り/貼り付け | 操作 | 移動 | リンク |  
| 切り取り/貼り付け | ターゲット | 元の項目への参照を追加します。 | 元の項目への参照を追加します。 |  
| 切り取り/貼り付け | ソース | 元の項目への参照を保持します。|元の項目が保持されます。 |  
| 切り取り/貼り付け | 結果 | 項目がストレージ内の元の場所に残ります | 項目がストレージ内の元の場所に残ります |  
| コピー/貼り付け | 操作 | コピー | リンク |  
| コピー/貼り付け | ソース | 元の項目への参照を追加します。 | 元の項目への参照を追加します。 |  
| コピー/貼り付け | 結果 | 元の項目への参照を保持します。 | 元の項目が保持されます。 |  
| コピー/貼り付け | 操作 | 項目がストレージ内の元の場所に残ります | 項目がストレージ内の元の場所に残ります |  
  
#### <a name="directory-based-projects"></a>ディレクトリ ベースのプロジェクト  
次の表は、ディレクトリ ベースの移行先のプロジェクトの押されたソース項目と修飾子キーの特性に基づき実行する必要があります (切り取り/コピー/貼り付けます) だけでなくドラッグ アンド ドロップ操作をまとめたものです。  
  
| 修飾子 | カテゴリ | ソース項目: 参照/リンク | ソース項目: 項目またはファイル システムの物理 (`CF_HDROP`) |  
| --- | --- | --- | --- |  
| 修飾子なし | 操作 | 移動 | 移動 |  
| 修飾子なし | ターゲット | ターゲットの場所にコピー項目 | ターゲットの場所にコピー項目 |  
| 修飾子なし | ソース | 元の項目への参照を削除 | 元の項目への参照を削除 | | 修飾子なし | 結果 | `DROPEFFECT_MOVE`アクションとして返される`::Drop`され、項目がストレージ内の元の場所に残ります | `DROPEFFECT_MOVE`アクションとして返される`::Drop`され、項目がストレージ内の元の場所に残ります |  
| Shift キーを押しながらドラッグ | 操作 | 移動 | 移動 |  
| Shift キーを押しながらドラッグ | ターゲット | ターゲットの場所にコピー項目 | ターゲットの場所にコピー項目 |  
| Shift キーを押しながらドラッグ | ソース | 元の項目への参照を削除 | 元の場所から項目を削除します。 |
| Shift キーを押しながらドラッグ | 結果 | `DROPEFFECT_MOVE`アクションとして返される`::Drop`され、項目がストレージ内の元の場所に残ります | `DROPEFFECT_MOVE`アクションとして返される`::Drop`され、項目がストレージ内の元の場所に残ります |  
| Ctrl キーを押しながらドラッグ | 操作 | コピー | コピー |  
| Ctrl キーを押しながらドラッグ | ターゲット | ターゲットの場所にコピー項目 | ターゲットの場所にコピー項目 |  
| Ctrl キーを押しながらドラッグ | ソース | 元の項目への参照を保持します。 | 元の項目への参照を保持します。 |  
| Ctrl キーを押しながらドラッグ | 結果 | `DROPEFFECT_COPY`アクションとして返される`::Drop`され、項目がストレージ内の元の場所に残ります | `DROPEFFECT_COPY`アクションとして返される`::Drop`され、項目がストレージ内の元の場所に残ります |  
| Ctrl キーを押しながら shift キーを押しながらドラッグ | | ドロップしません。 | ドロップしません。 |  
| 切り取り/貼り付け | 操作 | 移動 | 移動 |  
| 切り取り/貼り付け | ターゲット | ターゲットの場所にコピー項目 | ターゲットの場所にコピー項目 |  
| 切り取り/貼り付け | ソース | 元の項目への参照を削除 | 元の場所から項目を削除します。 |  
| 切り取り/貼り付け | 結果 | 項目がストレージ内の元の場所に残ります | 記憶域内の元の場所から削除されます。 |  
| コピー/貼り付け | 操作 | コピー | コピー |  
| コピー/貼り付け | ターゲット | 元の項目への参照を追加します。 | ターゲットの場所にコピー項目 |  
| コピー/貼り付け | ソース | 元の項目が保持されます。 | 元の項目が保持されます。 |  
| コピー/貼り付け | 結果 | 項目がストレージ内の元の場所に残ります | 項目が元の場所を記憶域に残ります |
  
#### <a name="mixed-target-projects"></a>混在ターゲット プロジェクト  
次の表は、混在ターゲット プロジェクトの押されたソース項目と修飾子キーの特性に基づき実行する必要があります (切り取り/コピー/貼り付けます) だけでなくドラッグ アンド ドロップ操作をまとめたものです。  
  
| 修飾子 | カテゴリ | ソース項目: 参照/リンク | ソース項目: 項目またはファイル システムの物理 (`CF_HDROP`) |  
| --- | --- | --- | --- |
| 修飾子なし | 操作 | 移動 | 移動 |
| 修飾子なし | ターゲット | 元の項目への参照を追加します。 | ターゲットの場所にコピー項目 |
| 修飾子なし | ソース | 元の項目への参照を削除 | 元の項目への参照を削除 |
| 修飾子なし | 結果 | `DROPEFFECT_ MOVE`アクションとして返される`::Drop`され、項目がストレージ内の元の場所に残ります | `DROPEFFECT_ MOVE`アクションとして返される`::Drop`と記憶域内の元の場所からアイテムを削除 |
| Shift キーを押しながらドラッグ | 操作 | 移動 | 移動 |
| Shift キーを押しながらドラッグ | ターゲット | 元の項目への参照を追加します。 | ターゲットの場所にコピー項目 |
| Shift キーを押しながらドラッグ | ソース | 元の項目への参照を削除 | 元の場所から項目を削除します。 | 
| Shift キーを押しながらドラッグ | 結果 | `DROPEFFECT_ MOVE`アクションとして返される`::Drop`され、項目がストレージ内の元の場所に残ります | `DROPEFFECT_ MOVE`アクションとして返される`::Drop`と記憶域内の元の場所からアイテムを削除 |
| Ctrl キーを押しながらドラッグ | 操作 | コピー | コピー |
| Ctrl キーを押しながらドラッグ | ターゲット | 元の項目への参照を追加します。 | ターゲットの場所にコピー項目 |
| Ctrl キーを押しながらドラッグ | ソース | 元の項目への参照を保持します。 | 元の項目が保持されます。 |
| Ctrl キーを押しながらドラッグ | 結果 | `DROPEFFECT_ COPY`アクションとして返される`::Drop`され、項目がストレージ内の元の場所に残ります | `DROPEFFECT_ COPY`アクションとして返される`::Drop`され、項目がストレージ内の元の場所に残ります |
| Ctrl キーを押しながら shift キーを押しながらドラッグ | 操作 | リンク | リンク |
| Ctrl キーを押しながら shift キーを押しながらドラッグ | ターゲット | 元の項目への参照を追加します。 | 元のソース アイテムへの参照を追加します。 |
| Ctrl キーを押しながら shift キーを押しながらドラッグ | ソース | 元の項目への参照を保持します。 | 元の項目が保持されます。 |
| Ctrl キーを押しながら shift キーを押しながらドラッグ | 結果 | `DROPEFFECT_ LINK`アクションとして返される`::Drop`され、項目がストレージ内の元の場所に残ります | `DROPEFFECT_ LINK`アクションとして返される`::Drop`され、項目がストレージ内の元の場所に残ります |
| 切り取り/貼り付け | 操作 | 移動 | 移動 |
| 切り取り/貼り付け | ターゲット | ターゲットの場所にコピー項目 | ターゲットの場所にコピー項目 |
| 切り取り/貼り付け | ソース | 元の項目への参照を削除 | 元の場所から項目を削除します。 |
| 切り取り/貼り付け | 結果 | 項目がストレージ内の元の場所に残ります | 記憶域内の元の場所から削除されます。 |
| コピー/貼り付け | 操作 | コピー | コピー |
| コピー/貼り付け | ターゲット | 元の項目への参照を追加します。 | ターゲットの場所にコピー項目 |
| コピー/貼り付け | ソース | 元の項目が保持されます。 | 元の項目が保持されます。 |
| コピー/貼り付け | 結果 | 項目がストレージ内の元の場所に残ります | 項目がストレージ内の元の場所に残ります |
  
これらの詳細のドラッグを実装するときに考慮される必要があります、**ソリューション エクスプ ローラー**:  
  
-   選択範囲が複数あるシナリオの設計します。  
  
-   ファイル名 (完全パス) は、ターゲット プロジェクト全体で一意である必要があります。 または、削除する必要があることはできません。  
  
-   フォルダー名は一意である必要があります (大文字と小文字) が破棄されるレベルです。  
  
-   ドラッグ (上記のシナリオには指定されていない) の時にオープンかクローズであるファイルの動作の相違があります。  
  
-   最上位レベルのファイルがフォルダー内のファイルよりも少し異なる方法で動作します。  
  
注意すべき別の問題は、開いているデザイナーまたはエディターを持つアイテムの移動操作を処理する方法を示します。 予想される動作は、次のように (これはすべてのプロジェクト タイプに適用されます) には。  
  
1.  エディターまたはデザイナーを開くには未保存の変更がない場合、エディターまたはデザイナー ウィンドウ サイレント モードでクローズされます。  
  
2.  エディターまたはデザイナーを開くには、未保存の変更がある場合、ドラッグのソースが待つドロップが発生して、ユーザーと、次のようなプロンプト ウィンドウを閉じる前に、開いているドキュメントでコミットされていない変更を保存するように依頼するには:  
  
    ```  
    ==========================================================   
         One or more open documents have unsaved changes.  
    Do you want to save uncommitted changes before proceeding?   
                      [Yes]  [No]  [Cancel]   
    ==========================================================  
    ```  
  
これは、ユーザーに、ターゲットは、そのコピーを作成する前に、進行中の作業を保存する機会を与えます。 新しいメソッド`IVsHierarchyDropDataSource2::OnBeforeDropNotify`がこの処理を有効にする追加されました。  
  
ターゲットは、コピー、項目の状態は記憶域であるため (いないユーザーが選択した場合、エディターで未保存の変更を含む**いいえ**)。 ターゲットには、そのコピーが完了した後 (で`IVsHierarchyDropDataSource::Drop`)、ソースを移動操作の削除の部分を完了する機会が与えられます (で`IVsHierarchyDropDataSource::OnDropNotify`)。  
  
変更を保存して、エディターは開いたのままにする必要があります。 変更を保存してそれらのドキュメントでは、つまり、移動操作のコピーの部分が実行されますが、削除の部分は中止されます。 ユーザーが選択したときに複数の選択のシナリオで**いいえ**未保存の変更でそれらのドキュメントを終了または、削除しないでくださいが保存されていない変更がない閉じおよび削除する必要があります。