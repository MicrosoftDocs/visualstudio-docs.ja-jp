---
title: コマンド フラグ要素 |マイクロソフトドキュメント
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- CommandFlag element (VSCT XML schema)
- VSCT XML schema elements, CommandFlag
ms.assetid: 5ef63399-d2db-4dc1-97ce-be1bd4ef4e39
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 84138a69dbb42fc349c12276fd7cca4b593e4d47
ms.sourcegitcommit: ade07bd1cf69b8b494d171ae648cfdd54f7800d3
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/21/2020
ms.locfileid: "81649365"
---
# <a name="command-flag-eelement"></a>コマンド・フラグ・エエレメント
親要素を変更します。

## <a name="syntax"></a>構文

```
<CommandFlag>DynamicVisibility</CommandFlag>
```

## <a name="attributes-and-elements"></a>属性と要素
 次のセクションでは、有効な要素値について説明します。

### <a name="attributes"></a>属性
 [なし] :

### <a name="child-elements"></a>子要素

|値|説明|
|-----------|-----------------|
|許可パラム|ユーザーがコマンドの正規名を入力するときに **、コマンド**ウィンドウにコマンド パラメーターを入力できることを示します。<br /><br /> 有効な対象:`Button`|
|常に作成します。|メニューは、グループやボタンがなくても作成されます。<br /><br /> 有効な対象:`Menu`|
|[CaseSensitive]|ユーザーエントリは大文字と小文字を区別します。<br /><br /> 有効な対象:`Combo`|
|コマンドウェルオンズのみ|コマンドがトップレベルメニューに表示されず、追加のシェルカスタマイズ (キーボードショートカットへのバインドなど) に使用できるようにする場合は、このフラグを適用します。 VSPackage をインストールした後、これらのコマンドをカスタマイズするには **、[オプション]** ダイアログ ボックスを開き、[**キーボード環境**] カテゴリの下でコマンドの配置を編集します。 このフラグは、ショートカット メニュー、ツールバー、メニュー コントローラ、サブメニューの配置には影響しません。<br /><br /> 有効な場合`Button`:`Combo`|
|デフォルト無効|既定では、コマンドを実装する VSPackage が読み込まれていないか`QueryStatus`、メソッドが呼び出されていない場合は無効になります。<br /><br /> 有効な場合`Button`:`Combo`|
|デフォルトドッキング|既定でドッキングされます。 この設定は常にドッキングされているため、ツールバーには適用されません。|
|デフォルト不可視|既定では、コマンドを実装する VSPackage が読み込まれていないか`QueryStatus`、メソッドが呼び出されていない場合は、コマンドは非表示になります。<br /><br /> このフラグを組み合わせることをお`DynamicVisibility`勧めします。<br /><br /> に有効: `Button` `Combo`,`Menu`|
|ドントキャッシュ|開発環境では、このコマンドのメソッド`QueryStatus`の結果はキャッシュされません。<br /><br /> メニューの場合、メニューの項目のテキストをキャッシュしないようにメニュー コント ローラーに指示します。 このフラグは、動的な項目または動的テキストを持つ項目がメニューに含まれている場合に使用します。<br /><br /> 有効な場合`Button`:`Menu`|
|ダイナミックアイテムスタート|動的リストの先頭を示します。 これにより、OLECMDERR_E_UNSUPPORTED フラグが返されるまで、リスト項目のメソッド`QueryStatus`を連続的に呼び出して、リストを構築できます。 これは、最近使用された (MRU) リストやウィンドウリストなどの項目に適しています。<br /><br /> 有効な対象:`Button`|
|ダイナミックな可視性|コマンドの表示設定は、メソッドまたは`QueryStatus``VisibilityConstraints`セクションに含まれているコンテキスト GUID を使用して変更できます。<br /><br /> メニューおよびツール ウィンドウのツール バーに表示されるコマンドに適用されますが、メイン ウィンドウに表示されるトップレベルのツールバーには表示されません。 トップレベルのツールバー項目は、メソッドからOLECMDF_INVISIBLEフラグが返されたときに無効にすることはできますが、非表示に`QueryStatus`することはできません。 ツール ウィンドウのツールバーに表示されるツールバー コマンドは非表示にすることができます。<br /><br /> メニュー上では、このフラグは、すべてのメンバーが非表示のときに自動的に非表示にする必要があることを示します。 トップレベルメニューには既にこの動作が存在するため、通常、このフラグはサブメニューに割り当てられます。<br /><br /> このフラグは`DefaultInvisible`フラグと組み合わせる必要があります。<br /><br /> に有効: `Button` `Combo`,`Menu`|
|フィルタキー機能|[コンボ要素](../extensibility/combo-element.md)の下の「フィルタ キー」のトピックを参照してください。<br /><br /> 有効な対象:`Combo`|
|メニューコントローラ|このコマンドがメニュー コントローラに配置されている場合、コマンドは常にデフォルトです。つまり、メニュー コントローラ ボタン自体が選択されると、コマンドが選択されます。 メニュー コントローラにフラグが`TextIsAnchorCommand`設定されている場合、メニュー コントローラはフラグを持つコマンドからもそのテキスト`FixMenuController`を取得します。<br /><br /> メニュー コントローラのコマンドは 1 つだけ`FixMenuController`で、フラグを持つ必要があります。 複数のコマンドがマークされている場合、メニューの最後のコマンドがデフォルトのコマンドになります。<br /><br /> 有効な対象:`Button`|
|アイコンアンドテキスト|メニューとツールバーにアイコンとテキストを表示します。<br /><br /> に有効: `Button` `Combo`,`Menu`|
|オートコンプリートなし|オートコンプリート機能は無効です。<br /><br /> 有効な対象:`Combo`|
|ボタンなしカスタマイズ|ユーザーにこのボタンをカスタマイズさせないでください。<br /><br /> 有効な場合`Button`:`Combo`|
|ノーキーカスタマイズ|キーボードのカスタマイズを有効にしないでください。<br /><br /> 有効な場合`Button`:`Combo`|
|メニューの表示|このコマンドがメニュー コントローラに配置されている場合、ドロップダウン リストにコマンドは表示されません。<br /><br /> 有効な対象:`Button`|
|リスト|使用可能なツールバーの一覧には表示されません。 これは、ツールバーメニューの種類に対してのみ有効です。<br /><br /> 有効な対象:`Menu`|
|ノーツールバー閉じる|ユーザーはツール バーを閉じることができません。 これは、ツールバーメニューの種類に対してのみ有効です。<br /><br /> 有効な対象:`Menu`|
|Pict|ツールバーにはアイコンのみを表示し、メニューにはテキストのみを表示します。 アイコンを指定しない場合は、ツールバーにクリック可能な空白スペースが表示されます。<br /><br /> 有効な対象:`Button`|
|ポストエクセ|コマンドを非ブロックにします。 開発環境では、すべての前処理クエリが完了するまで実行を延期します。<br /><br /> 有効な対象:`Button`|
|ルートトドックス|コマンドはアクティブドキュメントにルーティングされます。<br /><br /> 有効な対象:`Button`|
|水平方向にストレッチ|このフラグを設定すると、幅はコンボ ボックスの最小幅になり、ツールバーに空き領域がある場合は、コンボ ボックスが使用可能な領域を埋めるように伸縮します。 この問題は、ツールバーが水平方向にドッキングされ、ツール バーの 1 つのコンボ ボックスだけがフラグを使用できる場合にのみ発生します (フラグは最初のコンボ ボックス以外では無視されます)。<br /><br /> 有効な対象:`Combo`|
|テキストの変更|コマンドまたはメニューテキストは、通常はメソッドを使用して実行時に`QueryStatus`変更できます。<br /><br /> 有効な場合`Button`:`Menu`|
|テキストの変更ボタン|有効な対象:`Button`|
|テキストはアンカーコマンド|メニュー コントローラの場合、メニューのテキストはデフォルトの (アンカー) コマンドから取得されます。 アンカー コマンドは、最後に選択されたコマンドまたはラッチされたコマンドです。 このフラグが設定されていない場合、メニュー コントローラは独自`MenuText`のフィールドを使用します。 ただし、メニュー コントローラをクリックしても、そのコントローラから最後に選択したコマンドは有効になります。<br /><br /> このフラグをフラグと組み合わせること`TextChanges`をお勧めします。<br /><br /> このフラグは、タイプがメニュー コント ローラーまたはメニュー コント ローラーラッチのメニューにのみ適用されます。<br /><br /> 有効な対象:`Menu`|
|メニューメニュー|メニューコントローラ`MenuText`のフィールドを使用します。 既定のフィールドは`ButtonText`です。<br /><br /> 有効な対象:`Button`|
|テキストメニュー使用ボタン|メニューの`ButtonText`フィールドを使用します。 既定のフィールドは`MenuText`、指定されている場合です。<br /><br /> 有効な対象:`Button`|
|テキストのみ|ツールバーまたはメニューにテキストのみを表示しますが、アイコンを指定してもアイコンは表示しません。<br /><br /> 有効な対象:`Button`|

### <a name="parent-elements"></a>親要素

|要素|説明|
|-------------|-----------------|
|[ボタン要素](../extensibility/buttons-element.md)|[Button 要素](../extensibility/button-element.md)のグループを提供します。|
|[メニュー要素](../extensibility/menus-element.md)|VSPackage が実装するすべてのメニューを定義します。|

## <a name="see-also"></a>関連項目
- [コマンド テーブル (.Vsct) ファイル](../extensibility/internals/visual-studio-command-table-dot-vsct-files.md)
